[
    {
        "type": "pull_request",
        "url": "https://github.com/beaulabs/terraform_aws_ec2_instance/pull/4",
        "content": {
            "title": "a more cheaper instance",
            "body": "",
            "comments": [],
            "commits": [
                "d6df68da5ae58fb5c650c6be15d9d8e676a129db"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/modernisation-platform/pull/4534",
        "content": {
            "title": "\u2747\ufe0f Add Cost Explorer's Create Report permission for Data Engineers",
            "body": "Adds `ce:CreateReport` to data engineering role\r\n\r\nResolves https://github.com/ministryofjustice/data-platform-support/issues/152",
            "comments": [
                "#### `TFSEC Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nTFSEC will check the following folders:\n```\n\n</details>\n\n#### `Checkov Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nCheckov will check the following folders:\n```\n\n</details>\n\n#### `CTFLint Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nSetting default tflint config...\nRunning tflint --init...\nInstalling `terraform` plugin...\nInstalled `terraform` (source: github.com/terraform-linters/tflint-ruleset-terraform, version: 0.2.1)\ntflint will check the following folders:\n```\n\n</details>\n",
                "#### `TFSEC Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nTFSEC will check the following folders:\n```\n\n</details>\n\n#### `Checkov Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nCheckov will check the following folders:\n```\n\n</details>\n\n#### `CTFLint Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nSetting default tflint config...\nRunning tflint --init...\nInstalling `terraform` plugin...\nInstalled `terraform` (source: github.com/terraform-linters/tflint-ruleset-terraform, version: 0.2.1)\ntflint will check the following folders:\n```\n\n</details>\n"
            ],
            "commits": [
                "a2f96249b44f2500d030284936d582ba80c7fff5",
                "eaf93c7df2ff5b14342e551f359df4d0beafd950"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/modernisation-platform/pull/1015",
        "content": {
            "title": "enable PITR to squash CKV_AWS_28",
            "body": "Enables continuous backups. In this case the cost is negligeable due to low volumes of data being stored in this data base. https://aws.amazon.com/dynamodb/pricing/on-demand/",
            "comments": [
                "#### `TFSEC Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nTFSEC will check the following folders:\nterraform/modernisation-platform-account\n\n*****************************\n\nRunning TFSEC in terraform/modernisation-platform-account\nExcluding the following checks: AWS095\nWARNING: Failed to load module: missing module with source 'github.com/ministryofjustice/modernisation-platform-terraform-s3-bucket?ref=v3.0.0' -  try to 'terraform init' first\nWARNING: Failed to load module: missing module with source 'github.com/ministryofjustice/modernisation-platform-terraform-baselines?ref=v3.0.2' -  try to 'terraform init' first\nWARNING: Failed to load module: missing module with source 'github.com/ministryofjustice/modernisation-platform-terraform-trusted-advisor?ref=v2.0.0' -  try to 'terraform init' first\nWARNING: Failed to load module: missing module with source 'github.com/ministryofjustice/modernisation-platform-terraform-iam-superadmins?ref=v1.0.5' -  try to 'terraform init' first\n\n  times\n  ------------------------------------------\n  disk i/o             5.578503ms\n  parsing HCL          51.701\u00b5s\n  evaluating values    2.113239ms\n  running checks       3.161958ms\n\n  counts\n  ------------------------------------------\n  files loaded         11\n  blocks               57\n  modules              0\n\n  results\n  ------------------------------------------\n  critical             0\n  high                 0\n  medium               0\n  low                  0\n  ignored              2\n\nNo problems detected!\n\ntfsec_exitcode=0\n```\n\n</details>\n\n#### `Checkov Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nCheckov will check the following folders:\nterraform/modernisation-platform-account\n\n*****************************\n\nRunning Checkov in terraform/modernisation-platform-account\n\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy bridgecrew.io | version: 2.0.374 \n\nterraform scan results:\n\nPassed checks: 47, Failed checks: 3, Skipped checks: 0\n\nCheck: CKV_AWS_119: \"Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK\"\n\tFAILED for resource: aws_dynamodb_table.state-lock\n\tFile: /dynamodb.tf:1-20\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-dynamodb-tables-are-encrypted\n\n\t\t1  | resource \"aws_dynamodb_table\" \"state-lock\" {\n\t\t2  |   name         = \"modernisation-platform-terraform-state-lock\"\n\t\t3  |   billing_mode = \"PAY_PER_REQUEST\"\n\t\t4  |   hash_key     = \"LockID\"\n\t\t5  | \n\t\t6  |   attribute {\n\t\t7  |     name = \"LockID\"\n\t\t8  |     type = \"S\"\n\t\t9  |   }\n\t\t10 | \n\t\t11 |   server_side_encryption {\n\t\t12 |     enabled = true\n\t\t13 |   }\n\t\t14 | \n\t\t15 |   point_in_time_recovery {\n\t\t16 |     enabled = true\n\t\t17 |   }\n\t\t18 | \n\t\t19 |   tags = local.tags\n\t\t20 | }\n\n\nCheck: CKV_AWS_149: \"Ensure that Secrets Manager secret is encrypted using KMS\"\n\tFAILED for resource: aws_secretsmanager_secret.ci_iam_user_keys\n\tFile: /secrets.tf:12-16\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-secrets-manager-secret-is-encrypted-using-kms\n\n\t\t12 | resource \"aws_secretsmanager_secret\" \"ci_iam_user_keys\" {\n\t\t13 |   name        = \"ci_iam_user_keys\"\n\t\t14 |   description = \"Access keys for the CI user, this secret is used by GitHub to set the correct repository secrets.\"\n\t\t15 |   tags        = local.tags\n\t\t16 | }\n\n\nCheck: CKV_AWS_149: \"Ensure that Secrets Manager secret is encrypted using KMS\"\n\tFAILED for resource: aws_secretsmanager_secret.member_ci_iam_user_keys\n\tFile: /secrets.tf:27-31\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-secrets-manager-secret-is-encrypted-using-kms\n\n\t\t27 | resource \"aws_secretsmanager_secret\" \"member_ci_iam_user_keys\" {\n\t\t28 |   name        = \"member_ci_iam_user_keys\"\n\t\t29 |   description = \"Access keys for the CI user, this secret is used by GitHub to set the correct repository secrets.\"\n\t\t30 |   tags        = local.tags\n\t\t31 | }\n\n\ncheckov_exitcode=1\n```\n\n</details>\n\n#### `CTFLint Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nRunning tflint --init...\nInstalling `aws` plugin...\nInstalled `aws` (source: github.com/terraform-linters/tflint-ruleset-aws, version: 0.6.0)\ntflint will check the following folders:\nterraform/modernisation-platform-account\n\n*****************************\n\nRunning tflint in terraform/modernisation-platform-account\ntflint_exitcode=0\n```\n\n</details>\n",
                "\ud83d\udc4d "
            ],
            "commits": [
                "bc346a5604045d29b4b427c926f3e70d69440698"
            ]
        },
        "codes": [
            "awareness",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/guilhermerenew-zz/infra-cost/pull/5",
        "content": {
            "title": "function lambda added",
            "body": "Updating Lambda function for cost testing! \ud83d\ude80 ",
            "comments": [],
            "commits": [
                "91154d78cdbdc338a00ca54c9de6e07cef11dd72",
                "a4fa35e08e71e56e4bed9910707941025552e1db",
                "8e602ce8bc1f97571e6662d7ce296f489f965433"
            ]
        },
        "codes": [
            "awareness",
            "feature"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/guilhermerenew-zz/infra-cost/pull/4",
        "content": {
            "title": "working on stack!",
            "body": "## About\r\nInfracost shows cloud cost estimates for Terraform projects. It helps developers, devops and others to quickly see the cost breakdown and compare different options upfront. https://www.infracost.io/docs/\r\n## Demo CLI installed \ud83d\udc4b\ud83c\udffe \r\n#### Supported resources\r\nThe quickest way to find out if your Terraform resources are supported is to run Infracost with the --show-skipped option. This shows the unsupported resources, some of which might be free. You could also run the following command to only see the unsupported resources: infracost --format=json --log-level=warn | jq \".resourceSummary.unsupportedCounts\"\r\nInfracost supports the following Terraform resources. We do not take into account free tiers that apply to some resources as it can be difficult to detect which accounts they apply to; you can still see costs going up or down based on changes since we're consistent.\r\n#### Amazon Web Services (AWS) \ud83d\ude80 \r\nOn-demand prices are used. In some cases, AWS Spot prices are also supported, but AWS Reserved Instance prices are not supported since it is difficult to tell from Terraform resources whether they could be utilized.\r\n\r\n![image](https://user-images.githubusercontent.com/38333115/110233069-4a682980-7f00-11eb-9407-e0c740ddb9ee.png)\r\n\r\n#### Usage methods \ud83d\ude42 \r\nInfracost can be run with different options depending on the use-case. As mentioned in the FAQ, you can run Infracost in your Terraform directories without worrying about security or privacy issues as no cloud credentials, secrets, tags or Terraform resource identifiers are sent to the open-source Cloud Pricing API. Infracost does not make any changes to your Terraform state or cloud resources. The Cloud Pricing API does not become aware of your cloud spend; it returns price points to the CLI so calculations can be done on your machine.",
            "comments": [],
            "commits": [
                "29c19bf56dd1aa68ef5f1caae8cb97f5a36bb39f",
                "f58c6c8d3cd35c2b80021d1c422f76b85e73c116",
                "04e6d871d5a02f9f1b9e82eeebacc4217183638b",
                "19d66674534c604fe2fec71abf3fff392dc51ff6"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1737",
        "content": {
            "title": "Update infra-assets to TF 1.4 and AWS provider v4. ",
            "body": "Didn't fancy adding to the replication config while it was still using the ancient legacy provider objects. In fact I'm fairly sure the legacy API doesn't even support replicating to more than one destination.\r\n\r\nThis is more prep work for enabling replication from production to the non-production environments, to replace the old Jenkins script that ran `aws s3 sync`.\r\n\r\nWhile we're at it, stop backing up\\* the non-prod buckets (since there's no benefit in keeping them, not even for testing replication config changes).\r\n\r\nRollout: already applied everywhere (with the 0.12 -> 0.13 -> 1.4 dance, and the \"expire everything via a lifecycle rule\" trick for cheaply deleting the unnecessary non-prod \"assets-backup\" buckets)\r\n\r\nFollows from #1736.\r\nhttps://trello.com/c/e3Rb0HFK\r\n\r\n\\* insert TED talk about replication is not backup yada yada\r\n\r\n#### Alternatives considered\r\n\r\nBriefly considered using `STANDARD_IA` for replicating to the backup buckets, but it's not worth it because it boils down to: we might save ~ USD 250/year in return for a non-negligible risk of a huge unexpected bill if someone accidentally issues an expensive operation on the backup bucket (which contains a lot of objects).\r\n\r\nAlso considered moving this module to the govuk-infrastructure repo now, but it's easier to get it up-to-date here first and then move it across later.",
            "comments": [],
            "commits": [
                "f2257abf38cbabb1320de06dbf7265973546ee30",
                "ac26b61c8de1f6e8807cc662390c7d61ab174940",
                "3ee776c9afff2df2c6b6ddefb734da17f4a70715"
            ]
        },
        "codes": [
            "saving",
            "storage",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1637",
        "content": {
            "title": "Use cheaper and faster gp3 block storage for mirrorer.",
            "body": "The mirror job keeps overrunning because it's so slow, so let's update to the current generation of block storage and see if that helps.\r\n\r\nTested: updated the volume to gp3 in staging via the AWS web console and [ran the mirrorer job](https://docs.publishing.service.gov.uk/manual/alerts/mirror-sync.html#troubleshooting).\r\n\r\nRollout: already switched to gp3 in staging and prod; this just brings Terraform into line.",
            "comments": [],
            "commits": [
                "ffa75257747f225577616e6cf517eee965221041"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/543",
        "content": {
            "title": "Make our monitoring instances m5.large instead of t2",
            "body": "The monitoring instance that runs Icinga and Smokey in Integration has\r\nbegun running out of CPU credits. This is making it difficult to\r\ndiagnose problems elsewhere in the stack. Making it an m5.large costs\r\n~$77pcm instead of ~$36pcm, and doubles the RAM.\r\n\r\n<img width=\"889\" alt=\"screen shot 2018-04-16 at 09 49 19\" src=\"https://user-images.githubusercontent.com/18276/38799617-d5005dea-415c-11e8-9329-b27bc22b9f3b.png\">",
            "comments": [
                "Seems only in the last few days, but I think it's an important enough instance to not want to worry about it for the sake of $31pcm.",
                "Seems like a good idea, although how long has it been struggling for? Has it used this much CPU all the time since launch?"
            ],
            "commits": [
                "2ee1ff690416016dfed50dab6f516559f2270bf9"
            ]
        },
        "codes": [
            "awareness",
            "increase"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1455",
        "content": {
            "title": "Make Prometheus storage volume configurable and upgrade to gp3.",
            "body": "This enables us to add more timeseries storage space in prod, which was running out.\r\n\r\ngp3 is cheaper and faster, so no reason not to use it.",
            "comments": [
                "looks good"
            ],
            "commits": [
                "806b1a2a47f2f4e580e524b2cf8cc5928749d972"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1274",
        "content": {
            "title": "postgres: Increase instance size to db.m5.12xlarge",
            "body": "- We're using too old a Postgres version (9.6.old-patch) for Amazon to\r\n  let us use `db.m5.8xlarge`:\r\n\r\n```\r\n* module.postgresql-primary_rds_instance.aws_db_instance.db_instance: 1 error occurred:\r\n* aws_db_instance.db_instance: Error modifying DB Instance blue-postgresql-primary: InvalidParameterCombination: RDS does not support creating a DB instance with the following combination: DBInstanceClass=db.m5.8xlarge, Engine=postgres, EngineVersion=9.6.11, LicenseModel=postgresql-license. For supported combinations of instance class and database engine version, see the documentation.\r\n```\r\n\r\n- Instead, we're upgrading to the next unrestricted database instance.\r\n  This costs an extra $2254/month compared to what we have _now_\r\n  (`db.m5.4xlarge`)\r\n\r\nRelated PRs (specifically relevant to costings): #1264.\r\n\r\n[Trello](https://trello.com/c/qmqXBJnM/1833-increase-postgres-rds-instance)",
            "comments": [],
            "commits": [
                "6283dd7b80fd26ff09d242555a6e56c2eb75471b"
            ]
        },
        "codes": [
            "awareness",
            "storage",
            "increase"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1264",
        "content": {
            "title": "postgresql: Bump production database instance size to db.m5.8xlarge",
            "body": "- We're seeing spiky CPU usage, going up to 99%, when scheduled publishing occurs at 0930, and emails are sent out at various points during the day.\n- Tuning the apps would take longer and maybe not even be feasible as scheduled publishing has to happen, and so does sending urgent emails.\n- We could investigate splitting the databases out into `publishing-api-postgresql` and `email-alert-api-postgresql`, but we attempted that before and [resolved to not do it](https://github.com/alphagov/govuk-aws/commit/c51e8bbf879dd867b73bec4f71ba7271703e1909) (also for [publishing-api](https://github.com/alphagov/govuk-aws/pull/1086/commits/3f7cc071b4361e5df15ac1dfb2a1e3c565bb8678)).\n- According to https://www.ec2instances.info/rds/?region=eu-west-1&cost_duration=monthly, base cost for the old instance type is ~$1150/month. The bigger instance type specified here costs ~$2300/month. That's an increase of $1150 / month, or $13,800 / year.\n\nhttps://trello.com/c/JuO6EDwH/1781-5-investigate-postgres-blue-postgresql-primary-hitting-maximum-cpu-utilization",
            "comments": [
                "Go for it \ud83d\udc4d ",
                "We (@thomasleese, @sengi and I) had a conversation on Slack and we've decided to try more optimisations - such as using `jsonb` (a feature of Postgres 9.6 which is the version we have in AWS) first before spending this amount of money without full belief that it will work. I guess more cards will appear for that spike and it'll be a joint effort. Also, we could try upgrading the RDS Postgres from 9 to 10 or 11, plus enabling enhanced monitoring to see where the problems really lie.",
                "We need to do this. We've got an OK on the spend."
            ],
            "commits": [
                "ef79a5aec29133d4c479652863c61f943fbdb42b"
            ]
        },
        "codes": [
            "awareness",
            "storage",
            "increase"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1394",
        "content": {
            "title": "Create a shared memcached cluster for Frontend",
            "body": "The theory here is that having a shared rails cache should improve\r\nperformance of the frontend applications now that we've scaled them\r\nup to a large number of instances.\r\n\r\nWe're particularly hoping to see improvements between `collections` and\r\n`mapit`, as the responses from mapit are highly cacheable (postcodes\r\ndon't change local authority very often.\r\n\r\n`infra-security-groups` will need to be applied first, as `app-frontend`\r\ndepends on a new output.\r\n\r\nThe `r6g` instance type is the default if you click through in the AWS\r\nconsole. AWS suggest that the ARM based processers work well with\r\nelasticache:\r\n\r\nhttps://aws.amazon.com/about-aws/whats-new/2020/10/amazon-elasticache-now-supports-m6g-and-r6g-graviton2-based-instances/\r\n\r\nThe choice between `m6g` and `r6g` is arbitrary - `r6g` comes first in\r\nthe dropdown in the console.\r\n\r\nThe choice of `large` (rather than `xlarge` or higher) is also\r\narbitrary. I'm assuming that the failure mode for this will be graceful,\r\nas it's just a cache, so starting small and scaling based on metrics\r\nfeels reasonable. You could argue the other way though (start big and\r\nmake it smaller based on metrics).\r\n\r\n## Release Plan\r\n\r\n* [x] Merge this PR\r\n* [x] Apply `infra-security-groups` from master in integration\r\n* [x] Apply `app-frontend` from master in integration\r\n* [x] Apply `infra-public-services` from master in integration\r\n* [x] Apply `infra-security-groups` from master in staging\r\n* [x] Apply `app-frontend` from master in staging\r\n* [x] Apply `infra-public-services` from master in staging\r\n* [x] Apply `infra-security-groups` from master in production\r\n* [x] Apply `app-frontend` from master in production\r\n* [x] Apply `infra-public-services` from master in production\r\n* [x] Update https://github.com/alphagov/govuk-puppet/pull/10896 to target integration and staging, but leave production using local caches\r\n* [x] Merge [the govuk-puppet PR](https://github.com/alphagov/govuk-puppet/pull/10896)\r\n* [x] Apply govuk-puppet from master in integration\r\n* [x] Apply govuk-puppet from master in staging\r\n* [x] Apply govuk-puppet from master in production (should be almost a no-op - setting `MEMCACHE_SERVERS` to 127.0.0.1:11211 which is the default)\r\n* [x] Test the performance of the shared cache in staging (because we've traffic replay there, so it's more realistic)\r\n* [x] If we're happy, raise a govuk-puppet PR to use the shared cache in production\r\n* [x] ????\r\n* [x] Profit!\r\n* [x] Raise a PR in govuk-aws-data to scale down the elasticache memcached instance in integration - [done](https://github.com/alphagov/govuk-aws-data/pull/826)\r\n* [ ] Merge https://github.com/alphagov/govuk-aws-data/pull/826 to scale down elasticache in integration\r\n* [ ] Apply `app-frontend` from master in integration",
            "comments": [
                "Looks good to me"
            ],
            "commits": [
                "9ae1da7f2faec049c32af182a19824db8cc0d91f",
                "7347ffdca98f95627d5eed61ede09559bc24432e",
                "bd31e2354ece632cd0aa94b8b9f6474b06fe2846",
                "b4094f63c5d4a216ed7ade1a51ea3653222cf222",
                "e15c638636a730a24f18076fe14723132de45d0e"
            ]
        },
        "codes": [
            "saving",
            "cluster",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1253",
        "content": {
            "title": "Add data science data app",
            "body": "This PR adds a new `app-data-science-data` project. The aim of this project is to act as a central place to encapsulate all of the data processing / pre-processing required by data science projects such as related links and the knowledge graph.\r\n\r\nBy creating this central place to run all data processing / pre-processing, we can generate data once and have many apps / services consume only the data _they_ need, rather than having to go through the process of data generation themselves. This in turn will help to reduce costs by allowing those apps / services to use a smaller instance type (for apps) / complete in a shorter amount of time (for processes).\r\n\r\nTrello: https://github.com/alphagov/govuk-aws/pull/1253",
            "comments": [
                "LGTM"
            ],
            "commits": [
                "32b0505e91c8398534d695bc5ad6d75e21dcf0be",
                "85aef8d70cee2ba69f95637a747ebddb26e95ed2",
                "91db79be3db4c0907e5344e49578f514257a60cc",
                "8fb9963a20ca0d169863659eeb04ef59f0e96245"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/962",
        "content": {
            "title": "Update app-elasticsearch5 for Training environment",
            "body": "Add backend to build app-elasticsearch5 in the Training environment.\r\n\r\nAdd parameters to select which domain to use with the DNS records (Training\r\ndoes not use the stack domain).\r\n\r\nTraining app-elasticsearch5 runs with fewer instances and t2.smalls to save\r\non costs.",
            "comments": [
                "LGTM"
            ],
            "commits": [
                "74fe1ac392549eb3aad67d239310b92cc9f0dd10"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1242",
        "content": {
            "title": "Change instance type to r4.2xlarge",
            "body": "The Knowledge Graph is running out of memory on start-up when it generates the data it needs. Changing the instance type from `m5.2xlarge` to `r4.2xlarge` doubles the amount of RAM available (from 32GB to 64GB), whilst minimally increasing cost.",
            "comments": [],
            "commits": [
                "e91c7912b25beb51199ccfff2414668bcc69186e"
            ]
        },
        "codes": [
            "awareness",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1401",
        "content": {
            "title": "Add logging for queries which are waiting on locks to be relased",
            "body": "See individual commits for more thorough details of each change.\r\n\r\nThis change is designed to help us debug issues with slow queries. Specifically, it came out of some work I've been doing to investigate timeouts in the Email Alert API.\r\n\r\nThese changes are mostly useful for Email Alert API, but I've decided to apply them across all our databases for consistency.\r\n\r\n[Trello Card](https://trello.com/c/AHKVvZb2/2290-investigate-500-errors-in-email-alert-frontend)",
            "comments": [
                "Also agree with the first commit. I'm a bit confused by the motivation for the second, though, and in general for this PR. As I understand it, if the issues were due to deadlock, we would see a \"deadlock detected\" message in our logs. But I don't think we are. The first commit only seems to have value in the presence of deadlock, but again that doesn't seem to be the cause of the issue @thomasleese is investigating (unless I've missed something).\r\n\r\nCould you help me understand the reasoning a bit better?",
                "> Could you help me understand the reasoning a bit better?\r\n\r\nMy understand of the documentation is that the `log_locks_wait` option will give us a log entry if a query is waiting on any kind of lock - not just if it's deadlocked. It just happens to use the `deadlock_timeout` option to decide how long to wait before logging that a query is waiting.\r\n\r\nSo my main justification _in this PR_ for increasing the `deadlock_timeout` option was to make it easier to spot these log entries by increasing the threshold and therefore reducing any potential noise. Now that has the side effect of also changing how long before deadlocks will be detected, but my reading of the documentation suggested that the default of 1 second is perhaps too short for our purposes anyway.\r\n\r\nI hope that helps!",
                "Oh, I see. Thanks for explaining again. I got a bit confused by read [this page](https://dba.stackexchange.com/questions/249901/what-is-the-performance-cost-of-enabling-log-lock-waits-on-postgres), but I think the interpretation is actually that these logs are written anyway, irrespective of actual deadlock.\r\n\r\nThe second commit still seems a bit arbitrary: do we have any evidence the initial output would be noisy? I don't think we expect any of our code to be waiting more than a second to acquire a lock, so any log entries could be symptomatic of bugs, and should hopefully be easy to filter out if they aren't. While deadlock should also hopefully be rare, I think @richardTowers has a point that this increases the response time in that scenario.\r\n\r\nWould it be a problem to try without the second commit, initially?\r\n\r\n(Correction: Email Alert API does serve user-facing requests synchronously, via various frontend apps.)",
                "> The second commit still seems a bit arbitrary: do we have any evidence the initial output would be noisy? I don't think we expect any of our code to be waiting more than a second to acquire a lock, so any log entries could be symptomatic of bugs, and should hopefully be easy to filter out if they aren't. While deadlock should also hopefully be rare, I think @richardTowers has a point that this increases the response time in that scenario.\r\n\r\nYeah, my thinking that it could be noisy is just a hunch at this point, and I agree, the second commit is definitely not necessary for the logging which is the main motivation for this change. I also agree that 2.5 seconds is completely arbitrary.\r\n\r\nHowever, it does appear that, based on reading the documentation, increasing the timeout a little bit could be beneficial for us. Given the docs say \"The check for deadlock is relatively expensive\" it made me wonder whether we might have a small performance boost if, for example, queries which normally take ~10 seconds to run (of which we definitely have some in the Publishing API when looking up content which are unlikely to be optimised further any time soon) only check for deadlocks 4 times rather than 10 times.\r\n\r\nIf we decide to take it out of this PR, I do think this is at least something we should investigate further at a later time.",
                "These look fine to me.\r\n\r\nLogging lock waits seems totally uncontroversial, especially since you're investigating this area.\r\n\r\nAs you mention in your commit message, changing the deadlock_timeout feels a bit more controversial. I guess the effect of this is that users will have to wait 2.5 secs for an error, instead of 1 sec. If it was just email API that would be no problem, as it's all async. It's a shame to have to do it for all of our DBs, but since we share RDS instances aggressively I don't think that's entirely avoidable. Might be worth considering only updating it on app-postgresql, rather than on transition and content-data's DBs? But happy for this to be merged if you think it's better to be consistent.",
                "SGTM - reasoning for both changes seems sound.\r\n\r\nI don't think the controversy over deadlock_timeout is warranted, given what you've pointed out. It seems a very low-risk change to me for all the reasons already mentioned. I say go for it.",
                "> only check for deadlocks 4 times rather than 10 times\r\n\r\nThat's a helpful argument. Since we don't expect deadlock for user-facing queries, the performance boost does seem to outweigh any negative user impact."
            ],
            "commits": [
                "5af25cdb8a99ae5873b21c823300cd3e5ead883f"
            ]
        },
        "codes": [
            "unrelated"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1400",
        "content": {
            "title": "Add lifecycle rules within govuk-data-infrastructure-integration bucket",
            "body": "This PR adds lifecycle rules within the `govuk-data-infrastructure-integration` bucket to keep only the last 30 days of data. This is necessary as we currently hold more data which is never used, so by only keeping the most recent month's worth of data we can reduce costs and remove noise.",
            "comments": [],
            "commits": [
                "f844cd8e254b161bebef04101f8ce177bcd0840c"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1310",
        "content": {
            "title": "Revert \"Switch to c5.xlarge instances for the Email Alert API\"",
            "body": "8GB of memory should be fine for the Email Alert API, but for the last\r\n4 Fridays, some of the Sidekiq processes for the Email Alert API have\r\nused lots of memory, beyond the limit set for the Icinga checks.\r\n\r\nUntil we've managed to address the excessive memory usage, and\r\nreliability of the jobs (Sidekiq isn't exactly reliable), going back\r\nto 16GB of memory might help to avoid issues with Sidekiq using all\r\nthe memory.\r\n\r\nThis reverts commit dae54679cf50585abddb6c4413b7b2a26b0492e5.",
            "comments": [
                "@cbaines it looks like this change may be unnecessary, given the following historical data. The logs also indicate the increase in memory itself has little/no effect until [we changed the restart thresholds](https://github.com/alphagov/govuk-puppet/pull/10476).\r\n\r\nWould it be advantageous or effortful to switch back?\r\n\r\n<img width=\"1008\" alt=\"Screenshot 2020-07-01 at 12 35 41\" src=\"https://user-images.githubusercontent.com/9029009/86240053-5db83d80-bb98-11ea-9772-acf93a69c60e.png\">\r\n",
                "> @cbaines it looks like this change may be unnecessary, given the following historical data.\r\n\r\nWell, the image you share sets out why this change was made. I assume the green lines are memory usage, and when it touches the red line on Friday the 12th and Friday the 19th, that's one of the machines running out of memory.\r\n\r\n> The logs also indicate the increase in memory itself has little/no effect until [we changed the restart thresholds](https://github.com/alphagov/govuk-puppet/pull/10476).\r\n\r\nThe increase back to 16GB of memory was only meant to reduce a repeat of the issues on the 12th and 19th. I think we can say in hindsight that the change was unnecessary (because no machine used more than 8GB of memory after the 19th), but that's not quite the same as saying it was ineffective.\r\n\r\n> Would it be advantageous or effortful to switch back?\r\n\r\nThe above graph shows that there hasn't been a similar issue with memory since the 19th, but I definitely don't know enough about the situation to say that this means that the services on these machines will be able to get by with a reduced amount of memory in the future. Someone more informed should make that decision if warranted.",
                "> Well, the image you share sets out why this change was made.\r\n\r\nSo it does - apparently I visually filter out spikes \ud83d\ude2c.\r\n\r\n> Someone more informed should make that decision if warranted.\r\n\r\nMy take is that the difference in cost is pretty negligable, and we don't have any data to suggest we're suffering from slower CPUs, but we do have data to suggest having more memory is valuable. It's unclear _exactly_ how much more memory we need(ed), but the new worker thresholds at least have the potential to consume it.\r\n\r\nConclusion: let's stay as we are until we have motivation to change.",
                "Looks good to me. I checked [the docs](https://aws.amazon.com/ec2/instance-types/) to see that this change only affects the allocated memory."
            ],
            "commits": [
                "dfe75b84befaff007c841b1d339e3c647d9a303f"
            ]
        },
        "codes": [
            "instance",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/387",
        "content": {
            "title": "Change instance types",
            "body": "",
            "comments": [],
            "commits": [
                "6cfda6ada5137b232ff442ae9f2aedc8520ee1b4",
                "aeb3bfbe393cdfc02e62b812843ed75cf5f245e4"
            ]
        },
        "codes": [
            "unrelated"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1680",
        "content": {
            "title": "Remove UK Cloud VPN",
            "body": "This is no longer required because we've worked with Civica to allowlist the IPs of our AWS NAT Gateways for the vast majority of their local authority customers.\r\n\r\nAdditionally, UK Cloud is in liquidation and is being shut down. The liquidators only expect the platform to be operational until 10 February 2023, and in the meantime the liquidators have been increasing prices exponentially to cover the costs of operating the platform with an ever diminished customer base.\r\n\r\nI have notified UK Cloud and the liquidators that from the end of December 2022 we no longer require our account.\r\n\r\nSee also https://github.com/alphagov/govuk-aws-data/pull/1144",
            "comments": [
                "The destroy plan in staging:\r\n\r\n```\r\n$ terraform plan -destroy -var-file=staging.tfvars                                                                                                                                                                  \r\nRefreshing Terraform state in-memory prior to plan...\r\nThe refreshed state will be used to calculate this plan, but will not be\r\npersisted to local or remote state storage.\r\n\r\ndata.terraform_remote_state.infra_networking: Refreshing state...\r\ndata.terraform_remote_state.infra_vpc: Refreshing state...\r\naws_customer_gateway.ukcloud_vpn_gateway: Refreshing state... (ID: cgw-0003cbc76f58f5fa2)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[2]: Refreshing state... (ID: vgw-07a35b30965dccb58_rtb-004e90edd1b3bb512)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[1]: Refreshing state... (ID: vgw-07a35b30965dccb58_rtb-05896e3b8657f76c2)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[0]: Refreshing state... (ID: vgw-07a35b30965dccb58_rtb-0757f8ce9a8f0de09)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[0]: Refreshing state... (ID: vgw-07a35b30965dccb58_rtb-0f89f08e09272cfe7)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[2]: Refreshing state... (ID: vgw-07a35b30965dccb58_rtb-0fb98c3bd38298229)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[1]: Refreshing state... (ID: vgw-07a35b30965dccb58_rtb-07e15602056ca4bfa)\r\naws_vpn_connection.aws_ukcloud_vpn: Refreshing state... (ID: vpn-00bd506788f9e7899)\r\naws_vpn_connection_route.civica_cidr: Refreshing state... (ID: 213.143.135.0/24:vpn-00bd506788f9e7899)\r\n\r\n------------------------------------------------------------------------\r\n\r\nAn execution plan has been generated and is shown below.\r\nResource actions are indicated with the following symbols:\r\n  - destroy\r\n\r\nTerraform will perform the following actions:\r\n\r\n  - aws_customer_gateway.ukcloud_vpn_gateway\r\n\r\n  - aws_vpn_connection.aws_ukcloud_vpn\r\n\r\n  - aws_vpn_connection_route.civica_cidr\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation[0]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation[1]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation[2]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[0]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[1]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[2]\r\n\r\n\r\nPlan: 0 to add, 0 to change, 9 to destroy.\r\n\r\n------------------------------------------------------------------------\r\n\r\nNote: You didn't specify an \"-out\" parameter to save this plan, so Terraform\r\ncan't guarantee that exactly these actions will be performed if\r\n\"terraform apply\" is subsequently run.\r\n```",
                "I'll destroy this in staging and production once the PR is approved (before merging).",
                "Staging destroy \u2705 \r\n\r\n```\r\n$ terraform destroy -var-file=staging.tfvars \r\ndata.terraform_remote_state.infra_vpc: Refreshing state...\r\ndata.terraform_remote_state.infra_networking: Refreshing state...\r\naws_customer_gateway.ukcloud_vpn_gateway: Refreshing state... (ID: cgw-0003cbc76f58f5fa2)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[2]: Refreshing state... (ID: vgw-07a35b30965dccb58_rtb-004e90edd1b3bb512)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[0]: Refreshing state... (ID: vgw-07a35b30965dccb58_rtb-0757f8ce9a8f0de09)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[2]: Refreshing state... (ID: vgw-07a35b30965dccb58_rtb-0fb98c3bd38298229)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[0]: Refreshing state... (ID: vgw-07a35b30965dccb58_rtb-0f89f08e09272cfe7)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[1]: Refreshing state... (ID: vgw-07a35b30965dccb58_rtb-07e15602056ca4bfa)\r\naws_vpn_connection.aws_ukcloud_vpn: Refreshing state... (ID: vpn-00bd506788f9e7899)\r\naws_vpn_connection_route.civica_cidr: Refreshing state... (ID: 213.143.135.0/24:vpn-00bd506788f9e7899)\r\n\r\nAn execution plan has been generated and is shown below.\r\nResource actions are indicated with the following symbols:\r\n  - destroy\r\n\r\nTerraform will perform the following actions:\r\n\r\n  - aws_customer_gateway.ukcloud_vpn_gateway\r\n\r\n  - aws_vpn_connection.aws_ukcloud_vpn\r\n\r\n  - aws_vpn_connection_route.civica_cidr\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation[0]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation[1]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation[2]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[0]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[1]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[2]\r\n\r\n\r\nPlan: 0 to add, 0 to change, 9 to destroy.\r\n\r\nDo you really want to destroy all resources?\r\n  Terraform will destroy all your managed infrastructure, as shown above.\r\n  There is no undo. Only 'yes' will be accepted to confirm.\r\n\r\n  Enter a value: yes\r\n\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[2]: Destroying... (ID: vgw-07a35b30965dccb58_rtb-0fb98c3bd38298229)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[1]: Destroying... (ID: vgw-07a35b30965dccb58_rtb-05896e3b8657f76c2)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[0]: Destroying... (ID: vgw-07a35b30965dccb58_rtb-0f89f08e09272cfe7)\r\naws_vpn_connection_route.civica_cidr: Destroying... (ID: 213.143.135.0/24:vpn-00bd506788f9e7899)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[1]: Destroying... (ID: vgw-07a35b30965dccb58_rtb-07e15602056ca4bfa)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[2]: Destroying... (ID: vgw-07a35b30965dccb58_rtb-004e90edd1b3bb512)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[0]: Destroying... (ID: vgw-07a35b30965dccb58_rtb-0757f8ce9a8f0de09)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[0]: Destruction complete after 0s\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[1]: Destruction complete after 0s\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[1]: Destruction complete after 0s\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[0]: Destruction complete after 0s\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[2]: Destruction complete after 0s\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[2]: Destruction complete after 0s\r\naws_vpn_connection_route.civica_cidr: Destruction complete after 0s\r\naws_vpn_connection.aws_ukcloud_vpn: Destroying... (ID: vpn-00bd506788f9e7899)\r\naws_vpn_connection.aws_ukcloud_vpn: Still destroying... (ID: vpn-00bd506788f9e7899, 10s elapsed)\r\naws_vpn_connection.aws_ukcloud_vpn: Destruction complete after 11s\r\naws_customer_gateway.ukcloud_vpn_gateway: Destroying... (ID: cgw-0003cbc76f58f5fa2)\r\naws_customer_gateway.ukcloud_vpn_gateway: Destruction complete after 1s\r\n\r\nDestroy complete! Resources: 9 destroyed.\r\n```",
                "Production destroy \u2705 \r\n\r\n```\r\n$ terraform destroy -var-file=production.tfvars \r\ndata.terraform_remote_state.infra_networking: Refreshing state...\r\ndata.terraform_remote_state.infra_vpc: Refreshing state...\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[0]: Refreshing state... (ID: vgw-030bbd5f7fff53bf8_rtb-0d3bbd7066ec8cbbc)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[1]: Refreshing state... (ID: vgw-030bbd5f7fff53bf8_rtb-0c443ad6946387208)\r\naws_customer_gateway.ukcloud_vpn_gateway: Refreshing state... (ID: cgw-0249f68d13cf45f5a)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[0]: Refreshing state... (ID: vgw-030bbd5f7fff53bf8_rtb-0f44b7c0c50433690)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[1]: Refreshing state... (ID: vgw-030bbd5f7fff53bf8_rtb-0f43f57bf4a287a1b)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[2]: Refreshing state... (ID: vgw-030bbd5f7fff53bf8_rtb-0d1c2e094c21e285e)\r\naws_vpn_connection.aws_ukcloud_vpn: Refreshing state... (ID: vpn-00272a60828828cdb)\r\naws_vpn_connection_route.civica_cidr: Refreshing state... (ID: 213.143.135.0/24:vpn-00272a60828828cdb)\r\n\r\nAn execution plan has been generated and is shown below.\r\nResource actions are indicated with the following symbols:\r\n  - destroy\r\n\r\nTerraform will perform the following actions:\r\n\r\n  - aws_customer_gateway.ukcloud_vpn_gateway\r\n\r\n  - aws_vpn_connection.aws_ukcloud_vpn\r\n\r\n  - aws_vpn_connection_route.civica_cidr\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation[0]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation[1]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation[2]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[0]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[1]\r\n\r\n  - aws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[2]\r\n\r\n\r\nPlan: 0 to add, 0 to change, 9 to destroy.\r\n\r\nDo you really want to destroy all resources?\r\n  Terraform will destroy all your managed infrastructure, as shown above.\r\n  There is no undo. Only 'yes' will be accepted to confirm.\r\n\r\n  Enter a value: yes\r\n\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[2]: Destroying... (ID: vgw-030bbd5f7fff53bf8_rtb-0939872e7068ded2c)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[0]: Destroying... (ID: vgw-030bbd5f7fff53bf8_rtb-0d3bbd7066ec8cbbc)\r\naws_vpn_connection_route.civica_cidr: Destroying... (ID: 213.143.135.0/24:vpn-00272a60828828cdb)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[1]: Destroying... (ID: vgw-030bbd5f7fff53bf8_rtb-0f43f57bf4a287a1b)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[2]: Destroying... (ID: vgw-030bbd5f7fff53bf8_rtb-0d1c2e094c21e285e)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[1]: Destroying... (ID: vgw-030bbd5f7fff53bf8_rtb-0c443ad6946387208)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[0]: Destroying... (ID: vgw-030bbd5f7fff53bf8_rtb-0f44b7c0c50433690)\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[0]: Destruction complete after 0s\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[1]: Destruction complete after 0s\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[1]: Destruction complete after 0s\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[2]: Destruction complete after 0s\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation_reserved_ips[0]: Destruction complete after 0s\r\naws_vpn_gateway_route_propagation.ukcloud_route_propagation[2]: Destruction complete after 0s\r\naws_vpn_connection_route.civica_cidr: Destruction complete after 1s\r\naws_vpn_connection.aws_ukcloud_vpn: Destroying... (ID: vpn-00272a60828828cdb)\r\naws_vpn_connection.aws_ukcloud_vpn: Still destroying... (ID: vpn-00272a60828828cdb, 10s elapsed)\r\naws_vpn_connection.aws_ukcloud_vpn: Destruction complete after 11s\r\naws_customer_gateway.ukcloud_vpn_gateway: Destroying... (ID: cgw-0249f68d13cf45f5a)\r\naws_customer_gateway.ukcloud_vpn_gateway: Destruction complete after 0s\r\n\r\nDestroy complete! Resources: 9 destroyed.\r\n```"
            ],
            "commits": [
                "9b54cd6e875843c3ecade45ce37e863357b6e0e9"
            ]
        },
        "codes": [
            "provider",
            "saving",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/947",
        "content": {
            "title": "Bump the search-api instance size from t2 to c5",
            "body": "- We have been seeing search-api instances run out of CPU credits. At\r\nthe moment they are manually set to be \"unlimited\".\r\n- Using c5 removes CPU credits. As we seem to be using burst mode 30-40\r\npercent of the time, this change should not increase cost.\r\n\r\nsolo: @schmie",
            "comments": [
                "\ud83d\ude80 "
            ],
            "commits": [
                "fbd513a3c74bf20ecdb67a4243d30356e8b86a01"
            ]
        },
        "codes": [
            "awareness",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1739",
        "content": {
            "title": "Replicate assets bucket from prod to non-prod envs.",
            "body": "This replaces the sync_assets Jenkins cronjob (and is cheaper, more reliable, more secure, uses less resources and works continuously instead of nightly).\r\n\r\n- govuk-assets-production replicates to staging and integration.\r\n- govuk-assets-production still replicates to govuk-assets-backup-production as before.\r\n- The non-prod replicas keep only the latest version of an object.\r\n- govuk-assets-backup-production keeps object versions indefinitely (but it's still not really a backup in the full sense; we should get Object Lock enabled on it and set a retention window, but that's for another PR).\r\n- Remove the overly broad cross-account permissions on these S3 buckets now that we're no longer running `aws s3 sync`.\r\n\r\nAlso update to AWS TF provider 5.\r\n\r\nhttps://trello.com/c/e3Rb0HFK\r\n\r\nRollout: already applied in all three accounts.",
            "comments": [
                "Thanks for the neat suggestions! \ud83d\ude47 All done and checked no diff."
            ],
            "commits": [
                "c1d29a6caabcd4f041d87d76a10f2deef06685ef"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1488",
        "content": {
            "title": "Use cheaper and faster gp3 storage for CI agent EBS volumes.",
            "body": "gp3 is 20% cheaper than gp2 and includes 3000 IOPS at any size instead of 3 IOPS/GB. This should speed up builds at least a bit.\r\n\r\nWhile we're there, define the values once instead of copy-pasting.\r\n\r\nThe volumes can be upgraded in place without downtime.",
            "comments": [
                "Force-push to fix up autogenerated docs.",
                "And terraform fmt. Sigh.",
                "Looks good, hopefully the performance gain will be \ud83d\ude80 "
            ],
            "commits": [
                "8d7d2ebe0dbe9ebf8009572d1d710c4700cf245e"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1277",
        "content": {
            "title": "Enable Enhanced Monitoring on RDS Postgres.",
            "body": "* Enable Enhanced Monitoring on all of our RDS Postgres instances.\r\n* Keep the RDS Postgres standby instance at its current size.\r\n\r\nWe recently enabled Enhanced Monitoring on the shared Postgres RDS in production. This change reflects that, and also enables it on all the other Postgres RDS instances in all environments. The cost of doing so is negligible (just a modest amount of log storage) and the benefits are significant, as it gives us per-process history of CPU usage (and therefore per-query history of CPU usage, albeit sampled).\r\n\r\nWe also recently enlarged the shared Postgres RDS in production to 12xlarge. We want to avoid applying the same change to the standby instance, which appears to be disused. We'll want to confirm that it's disused and if so, decommission it in the near future - but I'll leave that for another PR.\r\n\r\nThe `rds-monitoring-role` IAM role and policy attachment were already added in #1276.\r\n\r\nalphagov/govuk-aws-data#702 keeps the Integration standby instance the same size.",
            "comments": [
                "TF plans:\r\n\r\nStaging `app-postgresql`:\r\n\r\n```\r\nTerraform will perform the following actions:\r\n\r\n  ~ module.postgresql-primary_rds_instance.aws_db_instance.db_instance\r\n      monitoring_interval: \"0\" => \"60\"\r\n\r\n\r\nPlan: 0 to add, 1 to change, 0 to destroy.\r\n```\r\n\r\nNo diff in Prod `app-postgresql`.\r\n\r\nStaging `app-transition-postgresql`:\r\n\r\n```\r\nTerraform will perform the following actions:\r\n\r\n  ~ module.transition-postgresql-primary_rds_instance.aws_db_instance.db_instance\r\n      monitoring_interval: \"0\" => \"60\"\r\n      monitoring_role_arn: \"\" => \"arn:aws:iam::696911096973:role/rds-monitoring-role\"\r\n\r\n  ~ module.transition-postgresql-standby_rds_instance.aws_db_instance.db_instance_replica\r\n      monitoring_interval: \"0\" => \"60\"\r\n      monitoring_role_arn: \"\" => \"arn:aws:iam::696911096973:role/rds-monitoring-role\"\r\n\r\n\r\nPlan: 0 to add, 2 to change, 0 to destroy.\r\n```\r\n\r\nStaging `app-content-data-api-postgresql`:\r\n\r\n```\r\nTerraform will perform the following actions:\r\n\r\n  ~ module.content-data-api-postgresql-primary_rds_instance.aws_db_instance.db_instance\r\n      monitoring_interval: \"0\" => \"60\"\r\n      monitoring_role_arn: \"\" => \"arn:aws:iam::696911096973:role/rds-monitoring-role\"\r\n\r\n\r\nPlan: 0 to add, 1 to change, 0 to destroy.\r\n```",
                "TF plan for `app-postgresql` in Integration (it looks like an earlier change to enable slow query logging has yet to be applied there, perhaps?)\r\n\r\n```\r\nTerraform will perform the following actions:\r\n\r\n  + aws_db_parameter_group.postgresql_pg\r\n      id:                                <computed>\r\n      arn:                               <computed>\r\n      description:                       \"Managed by Terraform\"\r\n      family:                            \"postgres9.6\"\r\n      name:                              <computed>\r\n      name_prefix:                       \"postgresql-pg-\"\r\n      parameter.#:                       \"2\"\r\n      parameter.3271061621.apply_method: \"immediate\"\r\n      parameter.3271061621.name:         \"log_min_duration_statement\"\r\n      parameter.3271061621.value:        \"10000\"\r\n      parameter.418023221.apply_method:  \"immediate\"\r\n      parameter.418023221.name:          \"log_statement\"\r\n      parameter.418023221.value:         \"all\"\r\n\r\n  ~ module.postgresql-primary_rds_instance.aws_db_instance.db_instance\r\n      monitoring_interval:               \"0\" => \"60\"\r\n      monitoring_role_arn:               \"\" => \"arn:aws:iam::210287912431:role/rds-monitoring-role\"\r\n      parameter_group_name:              \"default.postgres9.6\" => \"${var.parameter_group_name}\"\r\n\r\n  ~ module.postgresql-standby_rds_instance.aws_db_instance.db_instance_replica\r\n      parameter_group_name:              \"default.postgres9.6\" => \"${var.parameter_group_name}\"\r\n\r\n\r\nPlan: 1 to add, 2 to change, 0 to destroy.\r\n```",
                "Force-push just to squash the docs commits and a minor rewording of one of the commit messages.",
                "I've also tested that the change to the `rds_instance` module results in no diff to existing clusters when the `monitoring_interval` parameter isn't set (not that we have any clusters where it isn't set, any more).",
                "> TF plan for `app-postgresql` in Integration (it looks like an earlier change to enable slow query logging has yet to be applied there, perhaps?)\r\n> \r\n> ```\r\n>       ...\r\n>       parameter.3271061621.apply_method: \"immediate\"\r\n>       parameter.3271061621.name:         \"log_min_duration_statement\"\r\n>       parameter.3271061621.value:        \"10000\"\r\n>       parameter.418023221.apply_method:  \"immediate\"\r\n>       parameter.418023221.name:          \"log_statement\"\r\n>       parameter.418023221.value:         \"all\"\r\n>       ...\r\n> ```\r\n\r\nYup that is correct!\r\n\r\n",
                "LGTM\r\n"
            ],
            "commits": [
                "29d715b4bfd6cb1d38d20fbff0b29b2896bb1d1a",
                "f7c287adb0da1a20a52cf73fab12be2e8514609a",
                "5da7363c4f3f20dcecd2bb839f3d85e33c299601"
            ]
        },
        "codes": [
            "awareness",
            "feature",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/806",
        "content": {
            "title": "Upgrade data-science-2 instance type p3.8xlarge",
            "body": "This PR upgrades the `data-science-2` EC2 instance type from `p3.2xlarge` to `p3.8xlarge`.\r\n\r\nThis instance is being used to evaulate the implementation of a GraphSAGE algorithm which will be used to generate related links for content pages across GOV.UK. To perform this evaluation, it is necessary to run the algorithm against a set of sample data.\r\n\r\nCurrently on the `p3.2xlarge` instance, it takes approximately 20 minutes to evaluate one page of the sample data (one content item) using the algorithm. By switching the instance type to `p3.8xlarge`, we roughly estimate that this time can be brought down to 5 minutes per page of the sample data.\r\n\r\nBy speeding up the evaluation process, we will be able to determine the suitability of the algorithm for the purpose of generating related links and will then productionise the process to be able to evaluate ~200K content items for the actual A/B test.\r\n\r\nIn terms of cost (at the time of writing), the `p3.8xlarge` is priced at $12.24/hr; we anticipate that we will need up to 8 hours of compute time, which would result in a total cost of $97.92. In comparison, the `p3.2xlarge` currently costs $3.06/hr - this would result in the same total cost of $97.92 as we anticipate it would take up to four times as long to completely evaluate our sample data.\r\n\r\nTo ensure maximum value from this upgraded instance, we should make it available early on Wednesday, 20th February and spin down at the end of day.",
            "comments": [],
            "commits": [
                "5d30d7d7ca658bed21677b1aa56c72a0e0cd737b"
            ]
        },
        "codes": [
            "instance",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/776",
        "content": {
            "title": "Increase PostgreSQL primary DB to next instance class",
            "body": "This commit increases the PostgreSQL primary DB instances to the next instance class to provide more CPUs and RAM. This is due to CKAN now using this database, resuting in increased load. The instances are changed from M4 to M5 since they have improved performance and are cheaper for the equivalent instances than M4.\r\n\r\nThe changes will be made during the next maintenance window, which is Monday 4-6am, since `apply_immediately` is not set and defaults to `false`.\r\n\r\nTrello: https://trello.com/c/gEzC3bPn/756-add-more-resources-to-aws-rds",
            "comments": [
                "Thanks for the clear explanation! \ud83d\udc4d "
            ],
            "commits": [
                "19d187e4a29147cbcf1cfae456cfcbfa8ad52b45"
            ]
        },
        "codes": [
            "instance",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/355",
        "content": {
            "title": "Use all of available glacier time for backups",
            "body": "Glacier charges an [early delete\r\nfee](https://aws.amazon.com/premiumsupport/knowledge-center/glacier-early-delete-fees/)\r\nfor deleting objects which are stored for less than 90 days. This\r\nappears to be calculated by charging you for 90 days of storage\r\nregardless of the length of time things are stored in glacier, and\r\ncalling this an early deletion fee. This is a footnote on the [pricing\r\npage](https://aws.amazon.com/glacier/pricing/) which reads\r\n\r\n> Glacier archives have a minimum 90 days of storage, and archives\r\n> deleted before 90 days incur a pro-rated charge equal to the storage\r\n> charge for the remaining days\r\n\r\nWe may as well make use of this\r\nadditional time as we are already paying for it through the early\r\ndeletion fee.",
            "comments": [],
            "commits": [
                "6488091456429ed61264b9cad841eeb6bf871e32"
            ]
        },
        "codes": [
            "awareness",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/1095",
        "content": {
            "title": "Add Knowledge Graph to integration",
            "body": "This PR adds a new project `app-knowledge-graph`, which contains the required resources to spin up an instance of the Neo4j Community AMI to iterate the GOV.UK knowledge graph. We will only be deploying this project to integration, which is why this is the only environment specified. Users will be connecting over HTTPS and BOLT to query the knowledge graph, with SSH being allowed only for Karl's key-pair if it's necessary to connect to the machine (we're not provisioning via Puppet and so don't have access to all SSH keys here).\r\n\r\nThis PR also adds two new security groups to `infra-security-groups` for the `app-knowledge-graph` project. These security groups are for the load balancer and for the instance itself, allowing access over SSH, HTTPS (via port 7473) and BOLT (a protocol based on TCP (https://boltprotocol.org), via port 7687).\r\n\r\nTrello: https://trello.com/c/a9GlsqW7",
            "comments": [
                "@karlbaker02 @erino  Could we have an [RFC](https://github.com/alphagov/govuk-rfcs) on the adding to this knowledge graph infrastructure to GOV.UK? We seem to be investing lots of time and resources into this work but, as I understand, most of the developer community are in the dark about what the needs behind it are. \r\n\r\nFrom my perspective I'm concerned that this is slowly heading towards us having a 3rd denormalisation of the Publishing API (after Content Store and Search API) in production which carries with it heavy spin-up and sync costs and that it introduces new and unfamiliar (to GOV.UK infrastructure) tooling to maintain. This is, of course, fine if this resolves a need, but that's another thing that's a bit unclear: what needs is this solving and can they be addressed by existing infrastructure? I feel an RFC could be beneficial to understanding why we're doing this, what we hope to get out of it, explore why alternatives are rejected and explain where this sits on a scale between data science experiment and production part of GOV.UK's infrastructure.\r\n\r\nAlso, if this is not a real part of our infrastructure (by it only being integration) should this instead be deployed to our test AWS environment?",
                "@kevindew @erino \r\n\r\nThanks very much for your comments Kevin, I can definitely see where you're coming from.\r\n\r\nAt the moment our team is looking at how the knowledge graph can help GOV.UK to better understand the data it has, including looking at relationships between data that we perhaps don't recognise and using these connections between data to start asking more detailed questions of our content.\r\n\r\nCurrently our data scientists each have their own version of the knowledge graph running on their local machines, which is problematic when it comes to iterating because we're iterating on data and the connections between it. The purpose of this particular PR is to provide the minimum necessary for our data scientists to be able to query an up-to-date version of the knowledge graph, removing the burden on them to maintain their own copy and making it easier to iterate on the graph.\r\n\r\nThe way that the graph is set-up at the moment, including the restoration of the content store from a backup of the content store as opposed to either querying it directly or using the Publishing API is necessary until we are ready to commit to productionising the knowledge graph. At the moment this work is in the discovery phase and should we move to productionise it, we will absolutely be looking at hooking it up to the Publishing API to ensure that it's data is kept up-to-date and we don't rely on the Content Store, which as you mentioned previously is a particular view of the Publishing API. It is also worth saying that the particular graph database technology we're using at the moment from the AMI that's included in this PR may not be what we roll with if we come to productionise, and that the model for hosting the technology we do use has the potential to be very different from what's in this PR.\r\n\r\nIn terms of the knowledge graph creating a third denormalisation of the Publishing API, I agree that is another place where we'll be storing content data and that we need to think more about how this might work. The knowledge graph will also contain data that the Publishing API does not and will likely never contain, such as additional information about content derived from various data science techniques and connections between data derived from the knowledge graph itself.\r\n\r\nRegarding the creation of an RFC, I'm more than happy to write one for the knowledge graph, however now might be somewhat too early as the work is still very much in flux. Once we have more of a solid understanding of how the knowledge graph will be used and a better idea of the graph database technology we'll be using, we will create an RFC, as it would be absolutely great to get thoughts and ideas from everyone on the programme. ",
                "> @kevindew @erino\r\n> \r\n> Thanks very much for your comments Kevin, I can definitely see where you're coming from.\r\n\r\nThanks for getting back to me so quickly Karl with your reasoned comments \ud83d\udc4d \r\n\r\n> At the moment our team is looking at how the knowledge graph can help GOV.UK to better understand the data it has, including looking at relationships between data that we perhaps don't recognise and using these connections between data to start asking more detailed questions of our content.\r\n\r\nThis in particular seems to prompt an early question of why we need another data store to interrogate this information. The Publishing API stores the full graph of data and there hasn't been a justification why we a new mechanism to query it. I'm sure there are challenges in doing this giving it is based on postgres and not a dedicated graph database, but it is intriguing why we are creating new things to work out if there is value in data we already have available and is queryable.\r\n\r\nAs I recall there were numerous discussions over the years about whether the Publishing API should be powered by a graph database but this was rejected for the reliability and stability of Postgres. So it would be a strange twist if we ended up with both in separate places.\r\n\r\n> Currently our data scientists each have their own version of the knowledge graph running on their local machines, which is problematic when it comes to iterating because we're iterating on data and the connections between it. The purpose of this particular PR is to provide the minimum necessary for our data scientists to be able to query an up-to-date version of the knowledge graph, removing the burden on them to maintain their own copy and making it easier to iterate on the graph.\r\n> \r\n> The way that the graph is set-up at the moment, including the restoration of the content store from a backup of the content store as opposed to either querying it directly or using the Publishing API is necessary until we are ready to commit to productionising the knowledge graph. At the moment this work is in the discovery phase and should we move to productionise it, we will absolutely be looking at hooking it up to the Publishing API to ensure that it's data is kept up-to-date and we don't rely on the Content Store, which as you mentioned previously is a particular view of the Publishing API. It is also worth saying that the particular graph database technology we're using at the moment from the AMI that's included in this PR may not be what we roll with if we come to productionise, and that the model for hosting the technology we do use has the potential to be very different from what's in this PR.\r\n\r\nI think what you've touched on here is one of the reasons I've been most keen to have wider discussion about this. It looks like we're considering \"will a graph database add value? and if so, how do we productionise it?\" this concerns me as it doesn't really consider do we need this technology to solve our problems? I don't anticipate it'll be hard to identify a use case a knowledge graph satisfies which may well mean we have to productionise it, but that may not be based on whether this was technology we need to solve the problem.\r\n\r\nIf we plan to just throw this all in the bin before any work on productionising it then that is fine, but that should be stated somewhere and be common knowledge. Otherwise we simply risk slipping this into the GOV.UK technology stack without any wider input.\r\n\r\n> In terms of the knowledge graph creating a third denormalisation of the Publishing API, I agree that is another place where we'll be storing content data and that we need to think more about how this might work. The knowledge graph will also contain data that the Publishing API does not and will likely never contain, such as additional information about content derived from various data science techniques and connections between data derived from the knowledge graph itself.\r\n\r\nThe mix of denormalised and not data should be something to approach with caution. It reminds me of what was our highest priority piece of tech debt for a couple of years: [Unsure of our ability to recover the search-api index](https://trello.com/c/a1fll8qy/65-we-do-not-have-confidence-in-our-ability-to-recover-our-rummager-search-index-after-an-incident).\r\n\r\n> Regarding the creation of an RFC, I'm more than happy to write one for the knowledge graph, however now might be somewhat too early as the work is still very much in flux. Once we have more of a solid understanding of how the knowledge graph will be used and a better idea of the graph database technology we'll be using, we will create an RFC, as it would be absolutely great to get thoughts and ideas from everyone on the programme.\r\n\r\nSure, It's cool for you to use your discretion. I think it'd be useful to have the stated intentions of what parts of infrastructure are meant to stick or be removed. There's also a whole lack of clarity as to if this is something we're setting up just for data scientists to do experiments or if we're hoping we can find something to plug it into on GOV.UK as soon as possible to prove value. If not an RFC it'd be useful to have that documented so it can be linked around to provide context.\r\n\r\nApologies to be a bit of a pain on this, it's just that adding a new database technology and/or adding a new denormalisation of Publishing API are majorly impactful things for GOV.UK and I worry we could easily sleepwalk our way into doing this or delay the key conversations until this is too far along to reasonably change any course. "
            ],
            "commits": [
                "38268729ca54708e5db253b35c42c57ef6e1754b",
                "cbca792352671a19d322ec7dff65eb86cdd7f359"
            ]
        },
        "codes": [
            "unrelated"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-aws/pull/444",
        "content": {
            "title": "Resize graphite machine type",
            "body": "Update machine type to m5.xlarge. It should be cheaper, we tried to\r\nresize it before but it didn't work because of disk labels. Trying again\r\nafter the 'Device' tag was added to the EBS volume.",
            "comments": [
                "Related PR https://github.com/alphagov/govuk-aws/pull/428",
                "Oh. I thought that was covered by Ana's comment \"Trying again\r\nafter the 'Device' tag was added to the EBS volume.\" Sorry.",
                "My fault, I was only half paying attention. Sorry. ",
                "I found the related commit: https://github.com/alphagov/govuk-aws/commit/87d07031e3b1017df1cddbee282291d22276797c - if we can include this in the commit message for context that would be good.",
                "The labels change with M5 instances, so you'll need to update Puppet if you wish to go down this route. I'll pull out the PR shortly."
            ],
            "commits": [
                "5fa5da9756f12559b490217dd5b173db48e7f2a9"
            ]
        },
        "codes": [
            "instance",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ONSdigital/eq-terraform-dynamodb/pull/14",
        "content": {
            "title": "Switch DynamoDB to On-Demand",
            "body": "Switching DynamoDB to On-Demand simplifies its implementation as we no longer need to define scaling rules.\r\nThere is also less risk of hitting limits on load spikes\r\nThe performance of Runner is also increased as requests times to the database are reduced\r\n\r\nhttps://aws.amazon.com/blogs/aws/amazon-dynamodb-on-demand-no-capacity-planning-and-pay-per-request-pricing/",
            "comments": [
                "Tested on beanstalk and ECS. Have checked all of the normal scenarios. \r\n\r\nOnly thing I haven't checked is switchover from provisioned to on-demand, assume there are no issues with this though.\r\n\r\nGreat change!",
                "Nice \ud83d\udc4c \r\nTested the transition from `Provisioned` to `On-Demand` and as discussed had an issue with terraform timing out. Re-running was successful once the update on AWS was complete, hence may need to run deploy job twice.\r\n\r\nTested in-flight data and everything seems to work as expected and able to see new on-demand scaling on AWS."
            ],
            "commits": [
                "40eb651a50d0dfd5cf047ef62c8a6259c1c66e02"
            ]
        },
        "codes": [
            "saving",
            "billing_mode"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/DoSomething/infrastructure/pull/119",
        "content": {
            "title": "Experimental/WIP: Manage Lambda functions with Terraform.",
            "body": "**This is a work-in-progress experimental branch.** I'm hoping to be able to manage AWS Lambda functions with Terraform (rather than CloudFormation as we've previously done), so that we can easily visualize & manage them alongside all of our other infrastructure.\r\n\r\nRoughly following this [Terraform guide](https://learn.hashicorp.com/terraform/aws/lambda-api-gateway).",
            "comments": [
                "Approved, but coming over IRL for a lightning-round lesson on Lambda and API Gateway.",
                "I've applied this first iteration, and confirmed we can trigger the function via the `aws` CLI:\r\n\r\n```\r\naws lambda invoke --region=us-east-1 --function-name=dosomething-graphql-dev /dev/stdout\r\n{\"statusCode\":200,\"headers\":{\"Content-Type\":\"text/html; charset=utf-8\"},\"body\":\"<p>Hello world!</p>\"}\r\n```",
                "And now we've got a deploy user w/ limited permissions to this app's deploy bucket & function code:\r\n\r\n```\r\naws s3 cp example_v2.zip s3://dosomething-graphql-dev-deploy/dosomething_graphql_dev.zip\r\naws lambda update-function-code --function-name dosomething-graphql-dev --s3-bucket dosomething-graphql-dev-deploy --s3-key dosomething_graphql_dev.zip --publish --profile graphql-deploy\r\n\r\naws lambda invoke --region=us-east-1 --function-name=dosomething-graphql-dev --profile ds /dev/stdout\r\n{\"statusCode\":200,\"headers\":{\"Content-Type\":\"text/html; charset=utf-8\"},\"body\":\"<p>Yo, v2!</p>\"}\r\n```\r\n\r\nAnd (phew), re-running a `terraform plan` after making this change does _not_ see this as \"dirty\".",
                "Alright, moving on along: configured API Gateway, so now the function can be [viewed on the web](https://1eg1xdseya.execute-api.us-east-1.amazonaws.com/development)!",
                "Ooh snaps, I can see it! \ud83d\udc40 ",
                "Alright, this is ready for some load testing! This pull request introduces a `lambda_function` module that configures a deploy bucket (seeded with a \"hello world\" example app), Lambda function, CloudWatch logs, and separate execution & deploy lambda roles.\r\n\r\nI've also swapped the cache backend from Redis to DynamoDB (using a swappable cache driver added in DoSomething/graphql#46). This is handy for two reasons:\r\n1. We don't need to move this Lambda function into a VPC (required for ElastiCache usage), which adds complexity (since we need to provision or choose subnets & security groups) and [significantly slows down \"cold\" response times](https://medium.freecodecamp.org/lambda-vpc-cold-starts-a-latency-killer-5408323278dd) (although perhaps [less so soon](https://www.nuweba.com/AWS-Lambda-in-a-VPC-will-soon-be-faster?utm_campaign=Serverless%2BDigest&utm_medium=email&utm_source=Serverless_Digest_61)).\r\n2. We only pay for as much as we use, using DynamoDB's on-demand pricing model.\r\n\r\nWe can then use the following snippet to deploy this function (using the provisioned deploy key):\r\n\r\n```\r\nzip -r - . | aws s3 cp - s3://dosomething-graphql-dev-deploy/release.zip --profile dosomething-graphql-dev-deploy && aws lambda update-function-code --function-name dosomething-graphql-dev --s3-bucket dosomething-graphql-dev-deploy --s3-key release.zip --publish --profile dosomething-graphql-dev-deploy\r\n```\r\n\r\nWe can obviously simplify that a bit (and configure it to run automatically with CI), but it's nice to see everything works as expected! And unlike Serverless, we have no fear that a deploy will unexpectedly create or destroy production infrastructure (or even could).",
                "Lambda deployment for **dosomething-graphql-dev**:\r\n\r\nhttps://plddchi7pi.execute-api.us-east-1.amazonaws.com/development/",
                "To start, I ran a quick load test on the `topic` query (since that resolver caches downstream API requests, and so is a nice way to test the GraphQL server in isolation from other systems):\r\n\r\n<details>\r\n<summary><strong>testing 40 concurrent users against the Heroku backend</strong></summary>\r\n\r\n```\r\nsiege -c40 -t60S --content-type \"application/json\" 'https://graphql-dev.dosomething.org/graphql POST {\"query\":\"{topic(id: \\\"G8LCAYO9WuGC2UW8mQi6w\\\") { name,  ...on AskYesNoBroadcastTopic {text,saidYes}}}\"}'\r\n\r\nLifting the server siege...\r\nTransactions:\t\t        3384 hits\r\nAvailability:\t\t      100.00 %\r\nElapsed time:\t\t       59.03 secs\r\nData transferred:\t        2.66 MB\r\nResponse time:\t\t        0.69 secs\r\nTransaction rate:\t       57.33 trans/sec\r\nThroughput:\t\t        0.05 MB/sec\r\nConcurrency:\t\t       39.46\r\nSuccessful transactions:        3384\r\nFailed transactions:\t           0\r\nLongest transaction:\t        6.83\r\nShortest transaction:\t        0.12\r\n```\r\n\r\n</details>\r\n\r\n<details>\r\n<summary><strong>testing 40 concurrent users against the Lambda backend</strong></summary>\r\n\r\n```\r\nsiege -c40 -t60S --content-type \"application/json\" 'https://8ag15810zh.execute-api.us-east-1.amazonaws.com/development/ POST {\"query\":\"{topic(id: \\\"G8LCAYO9WuGC2UW8mQi6w\\\") { name,  ...on AskYesNoBroadcastTopic {text,saidYes}}}\"}'\r\n\r\nLifting the server siege...\r\nTransactions:\t\t         772 hits\r\nAvailability:\t\t       92.23 %\r\nElapsed time:\t\t       59.50 secs\r\nData transferred:\t        0.61 MB\r\nResponse time:\t\t        2.82 secs\r\nTransaction rate:\t       12.97 trans/sec\r\nThroughput:\t\t        0.01 MB/sec\r\nConcurrency:\t\t       36.59\r\nSuccessful transactions:         772\r\nFailed transactions:\t          65\r\nLongest transaction:\t       29.68\r\nShortest transaction:\t        0.21\r\n```\r\n</details>\r\n<br />\r\n\r\nWell, that's funny \u2013 it mostly performed admirably, but we got 65 transactions that timed out and tanked the average response time. These stragglers are each taking around 29 seconds, way above our 15 second Lambda execution limit. (It turns out this is the [default API Gateway integration timeout](https://docs.aws.amazon.com/apigateway/latest/developerguide/limits.html). We can & should probably reduce this.)\r\n\r\nWhen I tried another query that doesn't hit the DynamoDB cache (in this case, just asking about the schema with `{__schema {queryType {name}}}`), I don't see any timeout issues \u2013 even when doubling the load-test concurrency to 80 users! So that seems to narrow down the culprit.\r\n\r\nI'm continuing to dig into why DynamoDB requests may be sporadically timing out.",
                "I was able to dig up some references to timeouts with Lambda & DynamoDB, but the suggested fixes are all for an outdated TLS issue (See [1](\r\nhttps://stackoverflow.com/questions/37466847/dynamodb-causing-lambda-timeout), [2](\r\nhttps://stackoverflow.com/questions/34411314/aws-dynamodb-gives-write-eproto), [3](\r\nhttps://aws.amazon.com/premiumsupport/knowledge-center/write-eproto-error/)). Some others ([4](\r\nhttps://github.com/aws/aws-sdk-js/issues/1086)) suggested VPC config issues (but we're not running this in a VPC) or memory woes (bumping to 512MB had no effect).\r\n\r\nI enabled CloudWatch logs on our API Gateway account to confirm there aren't any obvious errors being logged there & used [X-Ray](https://aws.amazon.com/xray/) to peek into some traces for this function. Most look like you'd expect:\r\n\r\n<img width=\"1042\" alt=\"screen shot 2019-01-25 at 5 20 41 pm\" src=\"https://user-images.githubusercontent.com/583202/51777154-e096b800-20c9-11e9-9b86-6f7debdeab16.png\">\r\n\r\nHowever, a subset of requests time out like this:\r\n\r\n<img width=\"1045\" alt=\"screen shot 2019-01-25 at 5 21 09 pm\" src=\"https://user-images.githubusercontent.com/583202/51777171-f310f180-20c9-11e9-88dd-c6ea511b29a7.png\">\r\n\r\n\u2026or like this:\r\n\r\n<img width=\"1022\" alt=\"screen shot 2019-01-25 at 5 53 05 pm\" src=\"https://user-images.githubusercontent.com/583202/51777215-15a30a80-20ca-11e9-9a23-9c6c268207c5.png\">\r\n\r\nThis suggests our function never runs at all in these cases, which is backed up by the service map:\r\n\r\n<img width=\"975\" alt=\"screen shot 2019-01-25 at 5 31 31 pm\" src=\"https://user-images.githubusercontent.com/583202/51777236-2a7f9e00-20ca-11e9-9e79-966c209cc92e.png\">\r\n\r\n\u2026anyways, that's as far as I've got! Tune back in next week. \ud83d\udcfa \ud83d\ude43 ",
                "Jumping back in to this. Re-capping and stepping through things step-by-step:\r\n\r\n- I'm seeing 502/504 timeouts for roughly 25% of requests under load.\r\n- This happens for _both_ requests that hit DynamoDB and ones that don't.\r\n- It does _not_ seem to happen when I load test the \"hello world\" example application that simply returns a success response. That makes me think that it's some sort of issue in our code, even though the above traces seemed to suggest the request was never hitting the Lambda function.\r\n- Likewise, it does _not_ happen when load-testing [an example Apollo Server](https://www.apollographql.com/docs/apollo-server/deployment/lambda.html) with the example schema and simple `{ hello }` query.\r\n- As soon as I un-comment [the `esm` hook](https://github.com/DoSomething/graphql/blob/90ff160c325b0b13fd3cb06c9c15d0ef7bb879b9/main.js#L5) in our Lambda entry point, I see the issue start to appear (even _without_ requiring any of our ES modules). That's not what I expected at all!",
                "Re-based against `master` to get latest merged changes.",
                "Just to confirm my hunch that this is at least partially due to [`esm`](\r\nhttps://github.com/standard-things/esm#readme), I've added a quick-n-dirty compile in https://github.com/DoSomething/graphql/commit/651d06fea09f2445bf60c0e599304991f18792de and re-ran load tests on the [example server](https://gist.github.com/DFurnes/316ee3fc4cc8886f8c4cff681b231555). No issues whatsoever:\r\n\r\n```\r\nsiege -c40 -t60S --content-type \"application/json\" 'https://plddchi7pi.execute-api.us-east-1.amazonaws.com/development/ POST {\"query\":\"{__schema {queryType {name}}}\"}'\r\n\r\nLifting the server siege...\r\nTransactions:\t\t        8746 hits\r\nAvailability:\t\t      100.00 %\r\nElapsed time:\t\t       59.77 secs\r\nData transferred:\t        0.44 MB\r\nResponse time:\t\t        0.27 secs\r\nTransaction rate:\t      146.33 trans/sec\r\nThroughput:\t\t        0.01 MB/sec\r\nConcurrency:\t\t       39.85\r\nSuccessful transactions:        8747\r\nFailed transactions:\t           0\r\nLongest transaction:\t       16.76\r\nShortest transaction:\t        0.05\r\n```\r\n\r\nRe-adding [our own (pre-compiled) schema/resolvers](https://gist.github.com/DFurnes/06fd0930284c7df36badffbc7f980807), however, re-introduces timeouts:\r\n\r\n```\r\nLifting the server siege...\r\nTransactions:\t\t        7303 hits\r\nAvailability:\t\t       99.65 %\r\nElapsed time:\t\t       59.10 secs\r\nData transferred:\t        0.37 MB\r\nResponse time:\t\t        0.32 secs\r\nTransaction rate:\t      123.57 trans/sec\r\nThroughput:\t\t        0.01 MB/sec\r\nConcurrency:\t\t       39.11\r\nSuccessful transactions:        7303\r\nFailed transactions:\t          26\r\nLongest transaction:\t       28.32\r\nShortest transaction:\t        0.04\r\n```\r\n\r\nTo rule out any issues caused by importing the DynamoDB module (as I had speculated above), I [made the cache class a no-op](https://gist.github.com/DFurnes/f79b67a698687a6dbda2484b8722f36f) & re-tested the same schema query. Still got sporadic timeouts:\r\n\r\n```\r\nLifting the server siege...\r\nTransactions:\t\t        9082 hits\r\nAvailability:\t\t       99.84 %\r\nElapsed time:\t\t       59.83 secs\r\nData transferred:\t        0.46 MB\r\nResponse time:\t\t        0.26 secs\r\nTransaction rate:\t      151.80 trans/sec\r\nThroughput:\t\t        0.01 MB/sec\r\nConcurrency:\t\t       39.84\r\nSuccessful transactions:        9082\r\nFailed transactions:\t          15\r\nLongest transaction:\t       28.69\r\nShortest transaction:\t        0.04\r\n```\r\n\r\nNext, I re-enabled logging on this API Gateway stage and\u2026 suddenly had no timeouts! \ud83d\udce6 \ud83d\udc08 I was so confused that I re-ran this test three times with no timeouts at all. I left for lunch, satisfied. I re-ran the test when I came back though, and we were back in timeout land!\r\n\r\nThat made me think this might actually not be a code issue, but a \"cold boot\" issue. I've run a few tests in a row now without any timeouts, and finally ran a four minute long load test against this `topic(id:\u2026)` query (with DynamoDB caching enabled) and _zero request timeouts_:\r\n\r\n```\r\nsiege -c40 -t240S --content-type \"application/json\" 'https://plddchi7pi.execute-api.us-east-1.amazonaws.com/development/ POST {\"query\":\"{topic(id: \\\"G8LCAYO9WuGC2UW8mQi6w\\\") { name,  ...on AskYesNoBroadcastTopic {text,saidYes}}}\"}'\r\n\r\nLifting the server siege...\r\nTransactions:\t\t       36631 hits\r\nAvailability:\t\t      100.00 %\r\nElapsed time:\t\t      239.10 secs\r\nData transferred:\t       28.82 MB\r\nResponse time:\t\t        0.26 secs\r\nTransaction rate:\t      153.20 trans/sec\r\nThroughput:\t\t        0.12 MB/sec\r\nConcurrency:\t\t       39.90\r\nSuccessful transactions:       36631\r\nFailed transactions:\t           0\r\nLongest transaction:\t        2.22\r\nShortest transaction:\t        0.10\r\n```",
                "\ud83c\udfc2 \ud83d\udc62 \r\n",
                "I was finally able to track this down to Lambda's \"initialization\" stage, by increasing the function's timeout far beyond API Gateway's 29 second timeout. This shows that the \"actual\" function completes in a fairly reasonable 3.1 seconds, but since it is stuck waiting for so long it's already missed the \"response\" window by the time it's even started. Gah!\r\n\r\n![screen shot 2019-01-28 at 5 05 06 pm](https://user-images.githubusercontent.com/583202/51869684-4fb91a00-231f-11e9-9c5a-63bac5b50b3d.png)\r\n\r\nI've [reached out to Amazon's support](https://console.aws.amazon.com/support/cases#/5734584801/en) to see if they can provide any suggestions. \ud83e\udd1e"
            ],
            "commits": [
                "d9de3697083d5f903625f14e4d0ddc2b14e043bc",
                "e00038eda32af99e13a93247c54b838e280f98b1",
                "81df3e920a3d52a32c5d94809115f1b84d3564c3",
                "000ac0453936f3561fb88cc16ff5be03c0b6b2f5",
                "618c8f512c5f1f5cc5bb95a3c1acad8ee804b031",
                "a783bebb1999eae4926dbf292cfc4f4f01b42601",
                "d8f101f8bbdc01c50c9b875cc35afa2c939126a1",
                "b2012b8901f0a8c9af0d106d3c194fdafdae3b86",
                "06bb9d932aef5a482417c6e93c53c719f802d78f",
                "27e5e2aabe323fd05cd08173c20b96226afcdbec",
                "e13ddb34131bc81947b14afa9e0ba90467747b7a",
                "60649ed03fa76d4fd0cb0fbe6bf3dd914df9395c",
                "5a60c2df33ff44d4796678f1c9315de2c2f27e58",
                "378f66605e475e6717c92fc9973d69e560652a31",
                "de3122006b231e014bd7219c282e7e364ceb07c1",
                "ed7f6fcfce09128d2c64d215dd650070e5e29350",
                "694753c2835c9d96fed22277745a169930e67396",
                "4137256b7b4fb789c74773ce7fa4d7fff0d55c7b",
                "714fe6935e3eca4517c8f9469acbcf472f9b62ab",
                "875ebbeeaef7fab197f636718712676442573597",
                "f9fdd19509176b19b81a8eb9e0a26877422980a7",
                "4b97ed08645c2d525ed90fbad89afe50c89cf5d2"
            ]
        },
        "codes": [
            "provider",
            "unsure, could be alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/DoSomething/infrastructure/pull/164",
        "content": {
            "title": "Updating log settings for slow queries",
            "body": "This adds log settings so that we're capturing slow queries. We may want to change `log_statement` soon after we gather our slow query info so that we're not missing log entries. This will update the following settings:\r\n`log_min_duration_statement`\r\n`log_statement`\r\n`log_duration`\r\n\r\nNote: This will remove the `random_page_cost` and `work_mem` settings we have set up in QA since those aren't committed to master yet. ",
            "comments": [
                "It's supposed to make them less noisy. I was double checking the settings and ran across this Stack Overflow that suggested turning that setting to `none`. https://stackoverflow.com/questions/8414172/cannot-get-log-min-duration-statement-to-work/8425131#8425131",
                "Sounds great! Apply and mergey merge!",
                "Only question is setting `log_statement` to `none` take anything away from the slow query log, or does it make the logs super noisy?"
            ],
            "commits": [
                "e2850c5f13f36b2c9eb055eddf63f1e13795041a"
            ]
        },
        "codes": [
            "unrelated"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/DoSomething/infrastructure/pull/153",
        "content": {
            "title": "Removing provisioned IOPS used for testing, revert to gp2.",
            "body": "This PR reverts our Quasar Prod storage from provisioned IOPS to gp2 which we tested as a potential fix for: https://www.pivotaltracker.com/story/show/163565944. ",
            "comments": [
                "Make Plan output:\r\n```\r\n~ module.quasar.aws_db_instance.quasar\r\n    iops:   \"10000\" => \"0\"\r\n```\r\n\r\nGoing to run this after hours tonight. ",
                "@sheyd Terraform changes to this resource that'd incur downtime will be queued for the next maintenance window, so no worries to apply now.",
                "\ud83c\udf1d "
            ],
            "commits": [
                "a2dbfe25699f574b5ad4540063e4208ea8b04b4e"
            ]
        },
        "codes": [
            "unrelated"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/DoSomething/infrastructure/pull/125",
        "content": {
            "title": "Increase memory limit on Lambda functions to avoid timeouts.",
            "body": "When researching our cold start woes from #119, I came across this [blog post](https://read.acloud.guru/does-coding-language-memory-or-package-size-affect-cold-starts-of-aws-lambda-a15e26d12c76) which suggested that boosting the amount of RAM allocated to each Lambda function would improve worst-case cold start boot times. I tested this on our own function & it checks out!\r\n\r\nIncreasing the memory on this function will adjust the price per 100ms from $0.000000208 to $0.000000834, which for an expected usage of 5M requests per month boosts the cost of this function from $0.80 to $2.46 per month. \ud83d\udcb0 \r\n\r\n### Methodology\r\n\r\nFor each test, I deployed a new version of our serverless function (which forces cold starts for the subsequent requests, and then ran the load test for 5 minutes with 40 concurrent \"users\").\r\n\r\n```\r\nsiege -c40 -t300S --content-type \"application/json\" 'https://plddchi7pi.execute-api.us-east-1.amazonaws.com/development/ POST {\"query\":\"{topic(id: \\\"G8LCAYO9WuGC2UW8mQi6w\\\") { name,  ...on AskYesNoBroadcastTopic {text,saidYes}}}\"}'\r\n```\r\n\r\n| RAM        | Availability | Throughput | Timeouts | Avg. Response | Worst Response |\r\n|------------|--------------|------------|----------|---------------|----------------|\r\n| **128 MB** | 99.46%       | 96.12rps   | 156      | 0.42s         | 28.59s         |\r\n| **256 MB** | 99.90%       | 89.3rps    | 28       | 0.25s         | 29.46s         |\r\n| **512 MB** | 100.0%       | 263.7rps   | 1        | 0.15s         | 9.50s          |\r\n\r\nSo, as you can see, giving the Lambda function 512MB of RAM drastically reduces the impact of cold boots and in doing so dramatically increases our effective throughput, since we don't end up with a subset of clients consistently timing out.\r\n\r\nFinally \u2013 to be sure this data wasn't a fluke, I also ran another two separate 2-minute load tests at each RAM setting & got results consistent with what's in the above table. Click in for the full nerdery:\r\n\r\n<details>\r\n<summary><strong>Full load test results for each memory setting</strong></summary>\r\n\r\n#### 128MB:\r\n\r\n##### Round 1 (2 minutes):\r\n\r\n```\r\nTransactions:\t\t        1670 hits\r\nAvailability:\t\t       93.35 %\r\nElapsed time:\t\t      119.19 secs\r\nData transferred:\t        1.32 MB\r\nResponse time:\t\t        2.46 secs\r\nTransaction rate:\t       14.01 trans/sec\r\nThroughput:\t\t        0.01 MB/sec\r\nConcurrency:\t\t       34.50\r\nSuccessful transactions:        1670\r\nFailed transactions:\t         119\r\nLongest transaction:\t       29.48\r\nShortest transaction:\t        0.14\r\n```\r\n\r\n##### Round 2 (2 minutes):\r\n\r\n```\r\nTransactions:\t\t        7834 hits\r\nAvailability:\t\t       99.00 %\r\nElapsed time:\t\t      119.59 secs\r\nData transferred:\t        6.17 MB\r\nResponse time:\t\t        0.59 secs\r\nTransaction rate:\t       65.51 trans/sec\r\nThroughput:\t\t        0.05 MB/sec\r\nConcurrency:\t\t       38.88\r\nSuccessful transactions:        7835\r\nFailed transactions:\t          79\r\nLongest transaction:\t       29.45\r\nShortest transaction:\t        0.11\r\n```\r\n\r\n##### Round 3 (5 minutes):\r\n\r\n```\r\nTransactions:\t\t       28771 hits\r\nAvailability:\t\t       99.46 %\r\nElapsed time:\t\t      299.31 secs\r\nData transferred:\t       22.64 MB\r\nResponse time:\t\t        0.42 secs\r\nTransaction rate:\t       96.12 trans/sec\r\nThroughput:\t\t        0.08 MB/sec\r\nConcurrency:\t\t       39.90\r\nSuccessful transactions:       28771\r\nFailed transactions:\t         156\r\nLongest transaction:\t       28.59\r\nShortest transaction:\t        0.10\r\n```\r\n\r\n#### 256MB:\r\n##### Round 1 (2 minutes):\r\n\r\n```\r\nTransactions:\t\t       13571 hits\r\nAvailability:\t\t       99.56 %\r\nElapsed time:\t\t      119.25 secs\r\nData transferred:\t       10.68 MB\r\nResponse time:\t\t        0.34 secs\r\nTransaction rate:\t      113.80 trans/sec\r\nThroughput:\t\t        0.09 MB/sec\r\nConcurrency:\t\t       38.99\r\nSuccessful transactions:       13571\r\nFailed transactions:\t          60\r\nLongest transaction:\t       28.70\r\nShortest transaction:\t        0.07\r\n```\r\n\r\n##### Round 2 (2 minutes):\r\n\r\n```\r\nTransactions:\t\t       17092 hits\r\nAvailability:\t\t       99.70 %\r\nElapsed time:\t\t      119.52 secs\r\nData transferred:\t       13.45 MB\r\nResponse time:\t\t        0.27 secs\r\nTransaction rate:\t      143.01 trans/sec\r\nThroughput:\t\t        0.11 MB/sec\r\nConcurrency:\t\t       38.97\r\nSuccessful transactions:       17092\r\nFailed transactions:\t          52\r\nLongest transaction:\t       28.59\r\nShortest transaction:\t        0.07\r\n```\r\n\r\n##### Round 3 (5 minutes):\r\n\r\n```\r\nTransactions:\t\t       26776 hits\r\nAvailability:\t\t       99.90 %\r\nElapsed time:\t\t      299.79 secs\r\nData transferred:\t       21.07 MB\r\nResponse time:\t\t        0.25 secs\r\nTransaction rate:\t       89.32 trans/sec\r\nThroughput:\t\t        0.07 MB/sec\r\nConcurrency:\t\t       21.91\r\nSuccessful transactions:       26776\r\nFailed transactions:\t          28\r\nLongest transaction:\t       29.46\r\nShortest transaction:\t        0.07\r\n```\r\n\r\n#### 512MB:\r\n##### Round 1 (2 minutes):\r\n\r\n```\r\nLifting the server siege...\r\nTransactions:\t\t       26578 hits\r\nAvailability:\t\t       99.95 %\r\nElapsed time:\t\t      119.07 secs\r\nData transferred:\t       20.91 MB\r\nResponse time:\t\t        0.18 secs\r\nTransaction rate:\t      223.21 trans/sec\r\nThroughput:\t\t        0.18 MB/sec\r\nConcurrency:\t\t       39.66\r\nSuccessful transactions:       26578\r\nFailed transactions:\t          12\r\nLongest transaction:\t        9.99\r\nShortest transaction:\t        0.07\r\n```\r\n\r\n##### Round 2 (2 minutes):\r\n\r\n```\r\nTransactions:\t\t       27760 hits\r\nAvailability:\t\t      100.00 %\r\nElapsed time:\t\t      119.22 secs\r\nData transferred:\t       21.84 MB\r\nResponse time:\t\t        0.17 secs\r\nTransaction rate:\t      232.85 trans/sec\r\nThroughput:\t\t        0.18 MB/sec\r\nConcurrency:\t\t       39.66\r\nSuccessful transactions:       27760\r\nFailed transactions:\t           0\r\nLongest transaction:\t        8.83\r\nShortest transaction:\t        0.07\r\n```\r\n\r\n##### Round 3 (5 minutes):\r\n\r\n```\r\nTransactions:\t\t       79015 hits\r\nAvailability:\t\t      100.00 %\r\nElapsed time:\t\t      299.64 secs\r\nData transferred:\t       62.17 MB\r\nResponse time:\t\t        0.15 secs\r\nTransaction rate:\t      263.70 trans/sec\r\nThroughput:\t\t        0.21 MB/sec\r\nConcurrency:\t\t       39.59\r\nSuccessful transactions:       79015\r\nFailed transactions:\t           1\r\nLongest transaction:\t        9.50\r\nShortest transaction:\t        0.07\r\n```\r\n\r\n</details>",
            "comments": [
                "Applied! \ud83d\ude9a "
            ],
            "commits": [
                "0b6e4723071c35f9849f9e3bfa41ce3a6fb0fc3b",
                "0f7f744b0ef082bffd87817d387e5a8fdcf0c07c",
                "f775babb8f58c2e5e1032317ecf169d8f4db0ab4"
            ]
        },
        "codes": [
            "awareness",
            "increase",
            "feature"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/DoSomething/infrastructure/pull/110",
        "content": {
            "title": "Enable versioning & backup replication on S3 buckets.",
            "body": "When re-creating buckets with Terraform, I did not carry over the same versioning and cross-region replication settings. Since this is a useful backup strategy, I'd like to get this implemented before we delete the old `ds-rogue-prod` and `ds-rogue-prod-backup` buckets.",
            "comments": [
                "First up, just enabling versioning on the Northstar buckets (which store each instance's OAuth keys).",
                "Applied b1d5b93!",
                "I've added optional support for cross-region replication in 477fdcc. It grew significantly more complicated than I'd expected, since we have to set up an IAM role/policy for replication, and we need a separate `s3_bucket` resource since the `replication_configuration` block is not optional (and so otherwise we'd need to make a replication IAM user for _every_ bucket regardless of if it's used).\r\n\r\nTo avoid having to re-build the exisiting `dosomething-rogue` bucket, I've just moved it to the new resource in state before running the plan:\r\n\r\n```\r\nterraform state mv module.dosomething.module.rogue.module.storage.aws_s3_bucket.bucket module.dosomething.module.rogue.module.storage.aws_s3_bucket.replicated_bucket\r\n```\r\n\r\nAnd here's what'll change if this is applied:\r\n\r\n```\r\n<= module.dosomething.module.rogue.module.storage.data.template_file.replication_policy\r\n    id:         \"<computed>\"\r\n    rendered:   \"<computed>\"\r\n    template:   {\r\n                  \"Statement\": [\r\n                    {\r\n                      \"Action\": [\r\n                        \"s3:GetReplicationConfiguration\",\r\n                        \"s3:ListBucket\"\r\n                      ],\r\n                      \"Effect\": \"Allow\",\r\n                      \"Resource\": [\r\n                        \"${source_bucket_arn}\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"Action\": [\r\n                        \"s3:GetObjectVersion\",\r\n                        \"s3:GetObjectVersionAcl\"\r\n                      ],\r\n                      \"Effect\": \"Allow\",\r\n                      \"Resource\": [\r\n                        \"${source_bucket_arn}/*\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"Action\": [\r\n                        \"s3:ReplicateObject\",\r\n                        \"s3:ReplicateDelete\"\r\n                      ],\r\n                      \"Effect\": \"Allow\",\r\n                      \"Resource\": \"${destination_bucket_arn}/*\"\r\n                    }\r\n                  ],\r\n                  \"Version\": \"2012-10-17\"\r\n                }\r\n    vars.%:     \"<computed>\"\r\n\r\n+ module.dosomething.module.rogue.module.storage.aws_iam_policy.replication\r\n    id:       \"<computed>\"\r\n    arn:      \"<computed>\"\r\n    name:     \"dosomething-rogue-replication-policy\"\r\n    path:     \"/\"\r\n    policy:   \"${data.template_file.replication_policy.rendered}\"\r\n\r\n+ module.dosomething.module.rogue.module.storage.aws_iam_policy_attachment.replication\r\n    id:                 \"<computed>\"\r\n    name:               \"dosomething-rogue-replication-role-attachment\"\r\n    policy_arn:         \"${aws_iam_policy.replication.arn}\"\r\n    roles.#:            \"1\"\r\n    roles.2341451140:   \"dosomething-rogue-s3-replication\"\r\n\r\n+ module.dosomething.module.rogue.module.storage.aws_iam_role.replication\r\n    id:                      \"<computed>\"\r\n    arn:                     \"<computed>\"\r\n    assume_role_policy:      {\r\n                               \"Statement\": [\r\n                                 {\r\n                                   \"Action\": \"sts:AssumeRole\",\r\n                                   \"Effect\": \"Allow\",\r\n                                   \"Principal\": {\r\n                                     \"Service\": \"s3.amazonaws.com\"\r\n                                   },\r\n                                   \"Sid\": \"\"\r\n                                 }\r\n                               ],\r\n                               \"Version\": \"2012-10-17\"\r\n                             }\r\n    create_date:             \"<computed>\"\r\n    force_detach_policies:   \"false\"\r\n    max_session_duration:    \"3600\"\r\n    name:                    \"dosomething-rogue-s3-replication\"\r\n    path:                    \"/\"\r\n    unique_id:               \"<computed>\"\r\n\r\n+ module.dosomething.module.rogue.module.storage.aws_s3_bucket.backup\r\n    id:                                                     \"<computed>\"\r\n    acceleration_status:                                    \"<computed>\"\r\n    acl:                                                    \"private\"\r\n    arn:                                                    \"<computed>\"\r\n    bucket:                                                 \"dosomething-rogue-backup\"\r\n    bucket_domain_name:                                     \"<computed>\"\r\n    bucket_regional_domain_name:                            \"<computed>\"\r\n    force_destroy:                                          \"false\"\r\n    hosted_zone_id:                                         \"<computed>\"\r\n    lifecycle_rule.#:                                       \"1\"\r\n    lifecycle_rule.0.enabled:                               \"true\"\r\n    lifecycle_rule.0.id:                                    \"${random_id.lifecycle_rules.b64_std}\"\r\n    lifecycle_rule.0.transition.#:                          \"1\"\r\n    lifecycle_rule.0.transition.1899348542.date:            \"\"\r\n    lifecycle_rule.0.transition.1899348542.days:            \"30\"\r\n    lifecycle_rule.0.transition.1899348542.storage_class:   \"GLACIER\"\r\n    region:                                                 \"us-west-1\"\r\n    request_payer:                                          \"<computed>\"\r\n    versioning.#:                                           \"1\"\r\n    versioning.0.enabled:                                   \"true\"\r\n    versioning.0.mfa_delete:                                \"false\"\r\n    website_domain:                                         \"<computed>\"\r\n    website_endpoint:                                       \"<computed>\"\r\n\r\n~ module.dosomething.module.rogue.module.storage.aws_s3_bucket.replicated_bucket\r\n    replication_configuration.#:                                                                          \"0\" => \"1\"\r\n    replication_configuration.0.role:                                                                     \"\" => \"${aws_iam_role.replication.arn}\"\r\n    replication_configuration.0.rules.#:                                                                  \"0\" => \"1\"\r\n    replication_configuration.0.rules.~1130227470.destination.#:                                          \"0\" => \"1\"\r\n    replication_configuration.0.rules.~1130227470.destination.~3368425938.bucket:                         \"\" => \"${aws_s3_bucket.backup.arn}\"\r\n    replication_configuration.0.rules.~1130227470.destination.~3368425938.storage_class:                  \"\" => \"STANDARD_IA\"\r\n    replication_configuration.0.rules.~1130227470.id:                                                     \"\" => \"${random_id.replication_rules.b64_std}\"\r\n    replication_configuration.0.rules.~1130227470.status:                                                 \"\" => \"Enabled\"\r\n    versioning.0.enabled:                                                                                 \"false\" => \"true\"\r\n\r\n+ module.dosomething.module.rogue.module.storage.random_id.lifecycle_rules\r\n    id:            \"<computed>\"\r\n    b64:           \"<computed>\"\r\n    b64_std:       \"<computed>\"\r\n    b64_url:       \"<computed>\"\r\n    byte_length:   \"32\"\r\n    dec:           \"<computed>\"\r\n    hex:           \"<computed>\"\r\n\r\n+ module.dosomething.module.rogue.module.storage.random_id.replication_rules\r\n    id:            \"<computed>\"\r\n    b64:           \"<computed>\"\r\n    b64_std:       \"<computed>\"\r\n    b64_url:       \"<computed>\"\r\n    byte_length:   \"32\"\r\n    dec:           \"<computed>\"\r\n    hex:           \"<computed>\"\r\n```",
                "Sena & I reviewed 477fdcc in person, and made two little fixes in 9c98e19 and 9c1a788.\r\n\r\nGonna give this a run! \u270c\ufe0f ",
                "Alright, we ran this and confirmed that new reportbacks are replicating into the new `dosomething-rogue-backup` bucket in the `us-west-1` region. Since replication doesn't backfill existing objects, the last task here is just to use the `s3 sync` command to get historical files into this backup bucket.",
                "Started running that backfill on `mjolnir` in a `tmux` session (will take a few hours):\r\n\r\n```\r\naws s3 sync s3://dosomething-rogue s3://dosomething-rogue-backup\r\n```"
            ],
            "commits": [
                "b1d5b935163fa43c45642c7825d3878bda1e992b",
                "477fdcc8cb5e8ce00afaf91e25ca0ce3351a7dd4",
                "9c98e19b42a4473d662ecf1f41f4b5421e818f26",
                "9c1a788dad2950c76c88fa28495d91f661f8ae5e"
            ]
        },
        "codes": [
            "unrelated"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/DoSomething/infrastructure/pull/59",
        "content": {
            "title": "Add New Relic to Footlocker & H&R Block apps.",
            "body": "This pull request adds optional New Relic support to the Longshot application module. If the `with_newrelic` argument is set, a New Relic Heroku add-on & appropriate environment variables will be set for that application.\r\n\r\nReferences #49.",
            "comments": [
                "One question in there, but otherwise \ud83d\udea2 ",
                "Going to test this out on H&R Block first in 9eea907:\r\n\r\n```\r\n+ module.longshot.module.hrblock.heroku_addon.newrelic\r\n    id:              \"<computed>\"\r\n    app:             \"longshot-hrblock\"\r\n    config_vars.#:   \"<computed>\"\r\n    name:            \"<computed>\"\r\n    plan:            \"newrelic:wayne\"\r\n    provider_id:     \"<computed>\"\r\n\r\n~ module.longshot.module.hrblock.heroku_app.app\r\n    config_vars.0.%:                       \"24\" => \"27\"\r\n    config_vars.0.NEW_RELIC_APP_NAME:      \"\" => \"longshot-hrblock\"\r\n    config_vars.0.NEW_RELIC_LICENSE_KEY:   \"\" => \"******** SECRET ********\"\r\n    config_vars.0.NEW_RELIC_LOG:           \"\" => \"stdout\"\r\n\r\n~ module.longshot.module.longshot-footlocker-internal.heroku_app.app\r\n    config_vars.0.%:                       \"24\" => \"27\"\r\n\r\n~ module.longshot.module.longshot-footlocker.heroku_app.app\r\n    config_vars.0.%:                       \"24\" => \"27\"\r\n\r\n~ module.longshot.module.longshot-qa.heroku_app.app\r\n    config_vars.0.%:                       \"24\" => \"27\"\r\n```",
                "Hmm, frustratingly the New Relic add-on doesn't install the agent until you complete a build (confirmed by running `php -i` on longshot-hrblock). I think this hasn't bitten us before since we have the New Relic agent on QA instances where we create Heroku builds, but does pose problem here if we want to avoid installing (and paying for) New Relic on QA here.\r\n\r\nOne solution is to add `ext-newrelic` to this application's `composer.json` (and that actually may be closer to what we want since it doesn't auto-provision a weird parallel Heroku New Relic account for each app), or we could always include the add-on but only set our \"real\" account on prod...",
                "I'm leaning towards using the New Relic extension (and adding it to our Homestead's via an `after.sh` step) since that doesn't create the weird parallel accounts & clobber environment variables.",
                "This Approach Approved by \r\n![download](https://user-images.githubusercontent.com/4562565/49175369-6e4a6700-f316-11e8-94bc-5c997eee7703.jpg)\r\n",
                "Alrighty, this is applied and [longshot-footlocker](https://rpm.newrelic.com/accounts/108038/applications/127570645) & [longshot-hrblock](https://rpm.newrelic.com/accounts/108038/applications/127570610) are now showing up in New Relic.",
                "YAAAAS!"
            ],
            "commits": [
                "35c6652f03367fb221669a50cb94328991102cda",
                "9eea907424a789fb59e0c771d9a60e02a2c7cb47",
                "cc4652d1f8c726cb99d40412f6e3de0b74335e76",
                "72f7ee2ecaf6fa76e64cc74ffc7c104a36ca20b5",
                "3893efaf26ab586e7b0d11f8b5fe8410fdda252d"
            ]
        },
        "codes": [
            "feature",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/hashicorp/terraform-azurerm-terraform-enterprise/pull/141",
        "content": {
            "title": "Scale down default Redis size",
            "body": "## Background\n\nThe P3 size has 26GB of cache and costs $1485.17 per month. The P1 has 6GB of cache and costs $370.96 per month. The 6GB size is more than enough for intense workloads.\n\n## How Has This Been Tested\n\nN/A\n\n### Test Configuration\n\nN/A\n\n## This PR makes me feel\n\n![optional gif describing your feelings about this pr](https://media.giphy.com/media/xUNd9KuqkEuWwgZ9u0/giphy.gif)\n",
            "comments": [
                "/test public-active-active\n### :x: Terraform Public Active/Active Test Report\n\n:link: [Action Summary Page](https://github.com/hashicorp/terraform-azurerm-terraform-enterprise/actions/runs/1693234035)\n\n- :white_check_mark: Terraform Init\n\n- :white_check_mark: Terraform Validate\n\n- :x: Terraform Apply\n\n- :x: Run k6 Smoke Test\n\n- :x: Terraform Destroy",
                "/destroy public-active-active\n### :x: Terraform Public Active/Active Destruction Report\n\n:link: [Action Summary Page](https://github.com/hashicorp/terraform-azurerm-terraform-enterprise/actions/runs/1693460476)\n\n- :white_check_mark: Terraform Init\n\n- :x: Terraform Destroy\n### :white_check_mark: Terraform Public Active/Active Destruction Report\n\n:link: [Action Summary Page](https://github.com/hashicorp/terraform-azurerm-terraform-enterprise/actions/runs/1693460476)\n\n- :white_check_mark: Terraform Init\n\n- :white_check_mark: Terraform Destroy",
                "/test public-active-active\r\n\r\nLet's try this again, _Azure_. \n### :x: Terraform Public Active/Active Test Report\n\n:link: [Action Summary Page](https://github.com/hashicorp/terraform-azurerm-terraform-enterprise/actions/runs/1693508617)\n\n- :white_check_mark: Terraform Init\n\n- :white_check_mark: Terraform Validate\n\n- :white_check_mark: Terraform Apply\n\n- :white_check_mark: Run k6 Smoke Test\n\n- :x: Terraform Destroy",
                "/destroy public-active-active\n### :white_check_mark: Terraform Public Active/Active Destruction Report\n\n:link: [Action Summary Page](https://github.com/hashicorp/terraform-azurerm-terraform-enterprise/actions/runs/1694603326)\n\n- :white_check_mark: Terraform Init\n\n- :white_check_mark: Terraform Destroy",
                "Azure is having issues but public-active-active did pass the tests!\r\n\r\nLGTM \u2b07\ufe0f "
            ],
            "commits": [
                "b2fe861f1949f5f9f5bad0b4ca4ee6b6cb65485f"
            ]
        },
        "codes": [
            "saving",
            "feature-redis",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/Geeks-Academy/terraform/pull/113",
        "content": {
            "title": "POPS-78 - AWS costs lambda",
            "body": "",
            "comments": [],
            "commits": [
                "e33c9f81e9a489a16dc97e4037e37eeff6649c10"
            ]
        },
        "codes": [
            "awareness",
            "feature-lambda"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-infrastructure/pull/492",
        "content": {
            "title": "Reduce live-1 worker node instance size",
            "body": "This changes the worker nodes from r5.2xlarge to r5.xlarge\n\nThis change should still leave plenty of extra capacity to accomodate some\ngrowth, while saving the MoJ almost $5,000/month in AWS hosting costs.\n\nNB: After merging this change, we need to do a kops update and rolling\nupdate of the cluster, before the change takes effect.",
            "comments": [],
            "commits": [
                "e5dd13d33c1e927f932971d067d8f70e9041b5f3"
            ]
        },
        "codes": [
            "instance",
            "saving",
            "cluster"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-terraform-elasticache-cluster/pull/20",
        "content": {
            "title": "Add \"namespace\" tag to created Elasticache cluster",
            "body": "For cost allocation.",
            "comments": [],
            "commits": [
                "ddcc1a8abc1d29e8e32ed3c2e92ed9755dd17014"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/openregister/deployment/pull/520",
        "content": {
            "title": "Remove terrafrom code and config for influxcloud",
            "body": "### Context\r\nWe used to use InfluxCloud to store dropwizard metrics from openregister-java when it was hosted on AWS EC2. When we moved to PaaS we never reimplemented this feed in favour of using a Reliability Engineering provided solution. Although we don't have that yet, any work we do to reimplement metrics from ORJ should be in conjunction with Reliability Engineering's tool that we use for our Ruby application. We therefore no longer need this code.\r\n\r\nWe can then stop paying for InfluxCloud subscription.\r\n\r\n### Changes proposed in this pull request\r\nRemove all influxcloud code. This is not actually being used anywhere.\r\n\r\n### Guidance to review\r\nRun `make plan -e vpc=beta` and you should see the deletion of `telegraf.conf` from S3 bucket containing beta config files. We used to use telegraf as part of our AWS solution but we no longer use it and this file isn't needed.",
            "comments": [
                "\ud83d\udc4d \ud83d\udd34 "
            ],
            "commits": [
                "6ea6c908801248a1ad1c86e4f6c93f9edac57a2c"
            ]
        },
        "codes": [
            "saving",
            "provider"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/openregister/deployment/pull/71",
        "content": {
            "title": "Tf env dedicated zones in route53",
            "body": "This merge introduces an environment-specific Route53 zones.\n\nThe intention is to reduce bloat effect on the main zone and provide better configuration clarity.\n\nThe core module will link environment's zone with master zone via dns_parent_zone_id variable. \n\nA disadvantage to this approach is an extra cost - as Amazon is charging $0.50 per hosted zone / month.\n",
            "comments": [],
            "commits": [
                "b72af9db5044fea278782657a39c01b764563f1e",
                "eb5bebda8a213a6d2f866f77f536088b03905891",
                "4f691302a0ba827dcc05a840cf3de587ae25716f"
            ]
        },
        "codes": [
            "increase",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/cisagov/cyhy_amis/pull/178",
        "content": {
            "title": "Create Management VPC",
            "body": "This PR adds a new \"management\" VPC that contains a bastion instance and a vulnscan (Nessus) instance.  A new variable called `enable_mgmt_vpc_access_to_all_vpcs` controls whether or not the management VPC is able to communicate with the other VPCs (CyHy and BOD).  Its value should be set to 1 when access is needed (e.g. during security vulnerability scans of the CyHy/BOD/Management VPCs) and set to 0 when access is not needed (all other times).\r\n\r\nThis feature was requested in CYHY-714.",
            "comments": [
                "I took a look at this back in the jurassic, and it looked good then.  I looked at the commits since then and they look good to me as well.",
                "\ud83e\udd47 Looks good",
                "Crikey.  Looks good.   Might need some docs on how we _mix in_ the correct sauce in future terraforms so that we get the proper coordination with the management VPC.  This is a lot to ingest.   Great job!",
                "One other thought that I want to put out there for comment:\r\n\r\nDoes it make more sense to have the variable (currently called `enable_mgmt_vpc_access_to_all_vpcs`) also control whether or not instances within the management VPC are actually created?  So if the variable were set to 0, the bastion and vulnscan instances in the management VPC would be destroyed, saving us some money.  The only downside I can think of is the Nessus license- it would need to be reset every time the vulnscan instance was destroyed and we can only reset each license every 10 days.",
                "I like that idea, and I assumed we were not doing that already simply because of the Nessus license issue.  At a minimum the bastion's existence could still be dependent on that variable.",
                "Sounds good- for now, I'm going to go ahead and make the bastion dependent on that variable, but not the vulnscan instance.",
                "I like the idea also. Destroying the Nessus instance is more important than the bastion if cost saving is the goal, but I don't know the frequency in which we will be using Nessus to scan. ",
                "The bastion can be easily destroyed and recreated, so we may as well save a few dollars there if we can, but I agree that the real savings is with the Nessus instance.",
                "The annoying bit is going to be making the provisioner module dynamically created, since we can't use the terraform `count` feature with modules.",
                "Right.  I guess you can do what @felddy did for the nmap and Nessus scanners, or just leave it as it is for now.",
                "I'm going to leave it as is for now and think about it a bit more.  Once the management VPC starts getting used regularly, I'm hoping we will have a better feel for what we should do here."
            ],
            "commits": [
                "12fdf16e8e7f6d3a17f5f3901068ec3b29a1aab0",
                "92727a8efa31826c8dc393ce0de6e7dc6eecdb50",
                "1a4f222e8ba7ab8cb1df26aed5ca18333be45e37",
                "1693f6754001192059d0375cb21ab10d81feba20",
                "56b6a6c1fd06a3b07a157b77ba3ad373cb134958",
                "7dbe4689cd5bb462e0e501c96cb8f3a1e00d5df3",
                "a8c8356268ce60cd336b4c0bd131b363d1e0b744",
                "9c8cc6935c86f586526a3a0c92b646c9dc6bf8a7",
                "f2fadde620009b2cf4f4260a9ee109df8216c843",
                "2b8ccf14c4f11131e8134b819b38505407db1dec",
                "f0d7704eac858c3ae8b14d059de58af256702ae4",
                "317c99fc221cb0c9cbeb218575c6b60614da4611",
                "b85f1d73a8e445f44ea3deb6683eb11d7ab4e3e3",
                "27d9b42484e84544edfb1e4c13a82ac2934a6eb9",
                "591ae8af330bc712aa83643d871bf877e5097a17",
                "09ad2d48153f77a645237b72654272e03133ef11",
                "a35451379052428560df8cdc93fe27938ca98d06",
                "fd6d760e6e32e9d1f87a55fab1433e74f69140e5",
                "f41a3e96b97b1888f781dba9aad56414b5a74718",
                "32908fc1df841e44368ac9c57244ebf33e74336a",
                "ecdd833212621729b83f99ac348ff6d36da1f942",
                "19b5b9fe94f9f8beee1e3d9059c99d1aae5b9239",
                "4b64de39e94b4cc2e1d2f35e6cee92b5ed57609e",
                "55cd894adddb35dd2c4e40ce6061e2c05acb189d",
                "300ef36ac5a173b61e835fb02154104a6fcc6398"
            ]
        },
        "codes": [
            "instance",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/cisagov/cyhy_amis/pull/346",
        "content": {
            "title": "Upgrade volumes to gp3 and io2",
            "body": "## \ud83d\udde3 Description ##\r\n\r\nThis pull request:\r\n- Upgrades volume types to from gp2 to gp3 and from io1 to io2\r\n- Removes the `delete_on_termination` line from the root volume configuration\r\n\r\n## \ud83d\udcad Motivation and context ##\r\n\r\n- gp3 is 20% cheaper, and the baseline configuration offers better performance than gp2 for volumes smaller than 2TB.  It also allows the volume size and IOPS to be configured separately, whereas the two are intertwined with gp2.\r\n- io2 offers 100x more reliability than io1 at the same cost.\r\n- `delete_on_termination = true` is the default, so there is no need to specify it.\r\n\r\n## \ud83e\uddea Testing ##\r\n\r\n@mcdonnnj did a `terraform plan` for the `terraform` directory and verified that all the volume changes would be done in place.\r\n\r\n## \u2705 Checklist ##\r\n\r\n- [x] This PR has an informative and human-readable title.\r\n- [x] Changes are limited to a single goal - _eschew scope creep!_\r\n- [x] All relevant type-of-change labels have been added.\r\n- [x] I have read the [CONTRIBUTING](../blob/develop/CONTRIBUTING.md) document.\r\n- [x] These code changes follow [cisagov code standards](https://github.com/cisagov/development-guide).\r\n- [x] All new and existing tests pass.\r\n",
            "comments": [
                "@jsf9k Is there anything keeping us from also updating the Packer configurations in `packer/` to use `gp3`?",
                "> @jsf9k Is there anything keeping us from also updating the Packer configurations in `packer/` to use `gp3`?\r\n\r\nNo.  In fact, I created cisagov/skeleton-packer#95 to make just that change elsewhere.  Do you want to go ahead and commit that change to this PR, since the Packer configs in this repo won't benefit from that cisagov/skeleton-packer PR?",
                "> \r\n> \r\n> > @jsf9k Is there anything keeping us from also updating the Packer configurations in `packer/` to use `gp3`?\r\n> \r\n> No. In fact, I created [cisagov/skeleton-packer#95](https://github.com/cisagov/skeleton-packer/pull/95) to make just that change elsewhere. Do you want to go ahead and commit that change to this PR, since the Packer configs in this repo won't benefit from that cisagov/skeleton-packer PR?\r\n\r\nPlease!",
                "> > > @jsf9k Is there anything keeping us from also updating the Packer configurations in `packer/` to use `gp3`?\r\n> > \r\n> > \r\n> > No. In fact, I created [cisagov/skeleton-packer#95](https://github.com/cisagov/skeleton-packer/pull/95) to make just that change elsewhere. Do you want to go ahead and commit that change to this PR, since the Packer configs in this repo won't benefit from that cisagov/skeleton-packer PR?\r\n> \r\n> Please!\r\n\r\nPerhaps you will enjoy commit 2f6fe4d.",
                "@mcdonnnj, are you able to review this PR next week?",
                "> Sorry for the forever delay. I got my testing environment spun up and these changes worked fine.\r\n\r\nGreat!  I just rebased.  Am I good to merge once the tests pass?",
                "> > Sorry for the forever delay. I got my testing environment spun up and these changes worked fine.\r\n> \r\n> Great! I just rebased. Am I good to merge once the tests pass?\r\n\r\nYep! Sorry again for the delay. It took some wrangling to get everything deployed (since I'm testing multiple changes).",
                "> > > Sorry for the forever delay. I got my testing environment spun up and these changes worked fine.\r\n> > \r\n> > \r\n> > Great! I just rebased. Am I good to merge once the tests pass?\r\n> \r\n> Yep! Sorry again for the delay. It took some wrangling to get everything deployed (since I'm testing multiple changes).\r\n\r\nNo worries.  Thank you for circling back to this!",
                "\ud83d\ude80 ",
                "Approval continues \ud83d\ude85 ",
                "Sorry for the forever delay. I got my testing environment spun up and these changes worked fine."
            ],
            "commits": [
                "7b8d9247a679295e0e1791b13d6c437c473e44b8",
                "32469b75d0ef1c5d1bd780d50d077de55179a048"
            ]
        },
        "codes": [
            "storage",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/cisagov/cyhy_amis/pull/20",
        "content": {
            "title": "Change code to use the cheaper r4.xlarge instance type.",
            "body": "I watched the memory consumption while running BOD scanning, and it appears to consume about 13GB.  I could probably get by with 16GB of RAM, but this is an economical option that has almost 32GB of RAM.\r\n\r\nI did a full test run with no issues.",
            "comments": [
                "This looks good to me, though I'd still like to get your thoughts on this comment: https://github.com/dhs-ncats/cyhy_amis/pull/19/files/7d511a6165ecd298e351bfa2f607a2161c68c868#r209778046"
            ],
            "commits": [
                "4e67a501bb3f5187a3e9af523921ac62b8a88469"
            ]
        },
        "codes": [
            "instance",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/terraform-google-modules/terraform-google-project-factory/pull/67",
        "content": {
            "title": "Fixup errors in test-kitchen test coverage",
            "body": "When the test-kitchen tests and fixture modules were refactored and different fixtures were broken out for minimal and full suites, some tests were broken but were hidden because those tests were optional - that is, the test groups were disabled when the relevant parameters were unset.\n\nIn addition it was assumed that `inspec` would catch some of these errors by requiring certain inspec attributes would be set, but it appears that the version of inspec doesn't error out when required attributes were missing.\n\nThis pull request corrects a number of mistakes from string keys used instead of symbols, and passing through variables into outputs so that inspec can access them.\n\nAn outstanding question with this pull request is how to test features that require setup that are particularly heavyweight and/or can't be handled by Terraform. The original approach was to make these features optional, and if the module under test had the appropriate variables defined, then we'd test them. However the test failures that this pull request fixes shows that this approach may not be viable in the long term.\n\nWe have the following dependencies that are are optional due to non-trivial setup:\n\n- A shared VPC host project\n  - Do we want to stand up a new project with a VPC every time we test the `full` suite? Projects are a somewhat limited resource, but not too limited.\n- G Suite group management\n  - Adding a group to IAM roles is easy, but managing G Suite group membership cannot be done by Terraform - a user has to manually configure the service account running the tests with domain wide delegation.\n  - Adding a group to/from IAM roles is easy, but the tests need a test fixture group to work with. We can create a group on the fly, but that'll require domain-wide delegation\n- A destination GCS bucket for GCP project usage\n  - Creating a bucket is cheap, but the bucket needs to be created within a project. Should we just stand up a fixture project for this and the shared VPC host project?\n\nThis pull request doesn't try to solve these problems; if a dependency is missing we'll just skip the respective tests - but I think we'll need to solve this for other modules.",
            "comments": [
                "Just the one issue discovered so far.",
                "Just some minor style nits.",
                "LGTM, thanks"
            ],
            "commits": [
                "619f939713f8502913586fbee7bb078bad621e83",
                "586eba7578b3e402ee8539f94cf16a7209c7d843",
                "b5c05f5e6c26904da08ff9ceced427eec83ece82"
            ]
        },
        "codes": [
            "storage",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/jkstenzel95/jks.gameservers/pull/9",
        "content": {
            "title": "Change dynamodb kv store billing mode",
            "body": null,
            "comments": [],
            "commits": [
                "411ab992ba07e698cb08b56eb4cfc9d6e001d43f"
            ]
        },
        "codes": [
            "billing_mode",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/darthfork/tf-infra/pull/10",
        "content": {
            "title": "Use infracost",
            "body": "",
            "comments": [
                "```\nAn execution plan has been generated and is shown below.\nResource actions are indicated with the following symbols:\n  + create\n\nTerraform will perform the following actions:\n\n  # aws_instance.dev will be created\n  + resource \"aws_instance\" \"dev\" {\n      + ami                          = \"ami-059f1cc52e6c85908\"\n      + arn                          = (known after apply)\n      + associate_public_ip_address  = (known after apply)\n      + availability_zone            = (known after apply)\n      + cpu_core_count               = (known after apply)\n      + cpu_threads_per_core         = (known after apply)\n      + get_password_data            = false\n      + host_id                      = (known after apply)\n      + id                           = (known after apply)\n      + instance_state               = (known after apply)\n      + instance_type                = \"t2.micro\"\n      + ipv6_address_count           = (known after apply)\n      + ipv6_addresses               = (known after apply)\n      + key_name                     = \"aws\"\n      + outpost_arn                  = (known after apply)\n      + password_data                = (known after apply)\n      + placement_group              = (known after apply)\n      + primary_network_interface_id = (known after apply)\n      + private_dns                  = (known after apply)\n      + private_ip                   = (known after apply)\n      + public_dns                   = (known after apply)\n      + public_ip                    = (known after apply)\n      + secondary_private_ips        = (known after apply)\n      + security_groups              = (known after apply)\n      + source_dest_check            = true\n      + subnet_id                    = (known after apply)\n      + tenancy                      = (known after apply)\n      + volume_tags                  = (known after apply)\n      + vpc_security_group_ids       = (known after apply)\n\n      + ebs_block_device {\n          + delete_on_termination = (known after apply)\n          + device_name           = (known after apply)\n          + encrypted             = (known after apply)\n          + iops                  = (known after apply)\n          + kms_key_id            = (known after apply)\n          + snapshot_id           = (known after apply)\n          + throughput            = (known after apply)\n          + volume_id             = (known after apply)\n          + volume_size           = (known after apply)\n          + volume_type           = (known after apply)\n        }\n\n      + enclave_options {\n          + enabled = (known after apply)\n        }\n\n      + ephemeral_block_device {\n          + device_name  = (known after apply)\n          + no_device    = (known after apply)\n          + virtual_name = (known after apply)\n        }\n\n      + metadata_options {\n          + http_endpoint               = (known after apply)\n          + http_put_response_hop_limit = (known after apply)\n          + http_tokens                 = (known after apply)\n        }\n\n      + network_interface {\n          + delete_on_termination = (known after apply)\n          + device_index          = (known after apply)\n          + network_interface_id  = (known after apply)\n        }\n\n      + root_block_device {\n          + delete_on_termination = (known after apply)\n          + device_name           = (known after apply)\n          + encrypted             = (known after apply)\n          + iops                  = (known after apply)\n          + kms_key_id            = (known after apply)\n          + throughput            = (known after apply)\n          + volume_id             = (known after apply)\n          + volume_size           = (known after apply)\n          + volume_type           = (known after apply)\n        }\n    }\n\n  # aws_security_group.main will be created\n  + resource \"aws_security_group\" \"main\" {\n      + arn                    = (known after apply)\n      + description            = \"Default SG for instances\"\n      + egress                 = [\n          + {\n              + cidr_blocks      = [\n                  + \"0.0.0.0/0\",\n                ]\n              + description      = \"\"\n              + from_port        = 0\n              + ipv6_cidr_blocks = []\n              + prefix_list_ids  = []\n              + protocol         = \"-1\"\n              + security_groups  = []\n              + self             = false\n              + to_port          = 0\n            },\n        ]\n      + id                     = (known after apply)\n      + ingress                = [\n          + {\n              + cidr_blocks      = [\n                  + \"0.0.0.0/0\",\n                ]\n              + description      = \"\"\n              + from_port        = 22\n              + ipv6_cidr_blocks = []\n              + prefix_list_ids  = []\n              + protocol         = \"tcp\"\n              + security_groups  = []\n              + self             = false\n              + to_port          = 22\n            },\n          + {\n              + cidr_blocks      = [\n                  + \"0.0.0.0/0\",\n                ]\n              + description      = \"\"\n              + from_port        = 443\n              + ipv6_cidr_blocks = []\n              + prefix_list_ids  = []\n              + protocol         = \"tcp\"\n              + security_groups  = []\n              + self             = false\n              + to_port          = 443\n            },\n        ]\n      + name                   = \"main\"\n      + owner_id               = (known after apply)\n      + revoke_rules_on_delete = false\n      + tags                   = {\n          + \"Name\" = \"main_sg\"\n        }\n      + vpc_id                 = \"vpc-63a2b319\"\n    }\n\nPlan: 2 to add, 0 to change, 0 to destroy.\n\n------------------------------------------------------------------------\n\nThis plan was saved to: CURRENTPLAN.tfplan\n\nTo perform exactly these actions, run the following command to apply:\n    terraform apply \"CURRENTPLAN.tfplan\"\n\n```"
            ],
            "commits": [
                "3d417697998d350c780cd07255d66184534cd899"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/rust-lang/simpleinfra/pull/342",
        "content": {
            "title": "Deploy Datadog integration for AWS accounts",
            "body": "Datadog provides an interagration for AWS[^1] that makes it easy to automatically monitor most resources in an account. The integration has been deployed to all accounts in our organization.\r\n\r\n[^1]: https://docs.datadoghq.com/getting_started/integrations/aws/",
            "comments": [
                "Primarily reviewed the granted permissions, which look OK."
            ],
            "commits": [
                "c89db52b056b8719aacf2dec07ec0f46bd5b47d1",
                "638991a8940fe3a68bda9bdb2ac0b2f41e619796"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/rust-lang/simpleinfra/pull/258",
        "content": {
            "title": "Compress request logs from Fastly",
            "body": "Given the volume of traffic and logs, it seems prudent to compress the logs to save on storage and bandwidth costs.",
            "comments": [
                "Typically you're not going to view logs in S3 directly, and once you're downloading the file decompressing it is easy. If we're doing any kind of analysis having everything compressed is also convenient.\r\n\r\n@jdno Is gzip the only option here? It's what CloudFront uses but if there's better options (e.g. zstd) that might be nice to use here.",
                "@Mark-Simulacrum From the [docs](https://registry.terraform.io/providers/fastly/fastly/latest/docs/resources/service_compute#compression_codec):\r\n\r\n> Valid values are zstd, snappy, and gzip.\r\n\r\nIt's also possible to tweak the compression level of gzip from 0-9, with 3 being the default. Happy to switch to zstd though if that is the preferred option here.",
                "Let's stick with gzip since that's what cloudfront is using, seems simpler. I think long-term we can reconsider if this is more of a painpoint for analysis.",
                "Does this mean logs are immediately compressed? Is it possible to compress older logs leaving newer more easily viewable when they are most likely to be needed?"
            ],
            "commits": [
                "05370cc8f9852987e20cf5c659e5249dd1f2181c"
            ]
        },
        "codes": [
            "saving",
            "storage",
            "feature-logging"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/SUSE/caps-automation/pull/86",
        "content": {
            "title": "Use Aurora DB as external database",
            "body": "That is slightly cheaper, and does the job as well.",
            "comments": [
                "LGTM"
            ],
            "commits": [
                "5675965b57d05932ae8b806bad2cd219d15fe516"
            ]
        },
        "codes": [
            "provider",
            "storage",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-terraform-provisioning/pull/67",
        "content": {
            "title": "Enable lifecycles in buckets",
            "body": "We should enable and deploy lifecycles in S3 buckets that we use for backups so that we don't keep backups forever and waste lots of money. \n\nThis adds the feature. Further details in commits. \n\n/cc @rjw1 for lifecycle lengths in https://github.com/alphagov/govuk-terraform-provisioning/commit/ac105ab0a5ae38fbf69167e072f8970a4a61c3e8\n",
            "comments": [
                "they look like numbers :)\n",
                "but are they the right numbers?!\n",
                "Merge away.\n"
            ],
            "commits": [
                "fe794f12012b61134b7948c0094c465466cc4f98",
                "c167e29c9d5867b897bd035315341d14fff84f29",
                "ac105ab0a5ae38fbf69167e072f8970a4a61c3e8"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-terraform-provisioning/pull/86",
        "content": {
            "title": "GOVUK offsite backckups",
            "body": "An s3 bucket which serves as the endpoint for datastore backups.\r\n\r\nThe lifecycle rules have not been officially defined but as they are?  \r\n\r\n* Versioning is enabled \r\n* Versions stay current for one day (because backups are taken daily) \r\n* After 30 days of being non_current versions.  Backups are transitioned to the **_STANDARD_IA_** storage class (_saves Money_).\r\n* **No data is deleted**\r\n\r\nUser, govuk-offsite-backup's keys will be generated by hand from the console.\r\n\r\nSee https://trello.com/c/y3JIRupU",
            "comments": [
                "Just some nitpicky comments about naming variables and things but apart from that this looks good to me and my limited Terraform knowledge!\r\n\r\nThe first line of the commit message has a typo, it should probably be something like \"Create bucket for offsite backups\"",
                "I think the code looks fine. Maybe we want some clarification on whether we want versioning and for how long we want to keep backups (please let me know if these things were already confirmed with The Powers That Be)? ",
                "@surminus No, you're right.  I didn't confirm with @alexmuller but will today.",
                "I think no rotation policy is ok for the time being - @djsd123 explained that we're not deleting any old backups but we're moving them to infrequent access to reduce costs. At some point we should review all of our AWS spending but we're not storing that much yet."
            ],
            "commits": [
                "2d97402212f38413a492e3d95649b441cd5a09bc"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-terraform-provisioning/pull/41",
        "content": {
            "title": "sets up S3 bucket for transition logs",
            "body": "We want the lowest-cost storage class for these logs as they will\nseldomly be accessed, such as in a DR scenario. Unfortunately\nterraform does not currently support lifecycle configuration, so\nwe will need to manage this aspect manually.\n",
            "comments": [
                "Let's set this to the newly created `private_s3_bucket` module instead.\n",
                "@surminus module changed\n"
            ],
            "commits": [
                "ed67711a54ca65473c9c7b788161d680914ef1c7"
            ]
        },
        "codes": [
            "awareness",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/hmpps-delius-core-terraform/pull/449",
        "content": {
            "title": "ALS-2957 Set default placement strategy to AZ-balanced bin-pack",
            "body": "to save on EC2 costs while maintaining service reliability/resilience.",
            "comments": [],
            "commits": [
                "6e25b2cfb1cb80fd45ab6627a04e52735bb2fb5e",
                "ff2f9e2b705c910972e34edf786473a1911df655"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/goobi-infrastructure/pull/425",
        "content": {
            "title": "Workflow s3 lifecycle standard ia",
            "body": "### What is this PR trying to achieve?\r\n\r\nIn order to reduce storage costs as described in #423 we add a lifecycle rule for older objects to move to standard_ia storage class after 30 days\r\n\r\n",
            "comments": [],
            "commits": [
                "146785e16e53fffbdf64f910ecf26855b9ff6fef",
                "e28f9130b4e876b7827f2f327685ebf579f167b8",
                "469eeca087e2f507a7c7a626c146a0800bf3dff1",
                "6ba14fe23c8a12a18a6f455a365589c97ff034e9"
            ]
        },
        "codes": [
            "storage",
            "saving",
            "policy-lifecycle"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/goobi-infrastructure/pull/415",
        "content": {
            "title": "Add circuit breaker",
            "body": "### What is this PR trying to achieve?\r\n\r\nThis PR updates the version of the ECS modules in order to enable the ECS circuit breaker.\r\n\r\n### Who is this change for?\r\n\r\nFor everyone wanting to prevent extra costs due to repeated redeployments in case of an error.\r\n\r\n",
            "comments": [],
            "commits": [
                "8bf9aa38b0d69dba23dc006480b16c30e096e431",
                "26e4cc271bb42be9e9cf029f959085e473e18c5b",
                "e4a365cc3ea049c2392b74201256f322f3df747a"
            ]
        },
        "codes": [
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/goobi-infrastructure/pull/315",
        "content": {
            "title": "Add a VPC endpoint for S3",
            "body": "The lack of any VPC endpoints is a non-trivial cost \u2013 about $400 a month in managed NAT Gateway, and that was before anybody started using Archivematica for serious work.\r\n\r\nThis change adds an S3 VPC endpoint to the workflow and workflow-stage VPC, which should dramatically cut those costs.\r\n\r\nI haven't set up other endpoints yet because I'm not sure what other services we're using; I'm guessing S3 is probably the bulk of the load.\r\n\r\nFor https://github.com/wellcomecollection/platform/issues/4325\r\n\r\n### What is this PR trying to achieve?\r\n\r\nReduce the cost of running Goobi and Archivematica.\r\n\r\n### Who is this change for?\r\n\r\nFor people who like money.\r\n",
            "comments": [
                ":+1: nice catch",
                "LGTM - @wellcomecollection/intranda-external dev should approve and roll out."
            ],
            "commits": [
                "271bf02f91bfe5e8fc7ea9f94bfe56fd49a8d8e0"
            ]
        },
        "codes": [
            "saving",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/cisagov/vulnerable-instances/pull/4",
        "content": {
            "title": "Upgrade the root volume type to gp3",
            "body": "## \ud83d\udde3 Description ##\r\n\r\nThis pull request:\r\n- Upgrades the root volume type to gp3\r\n- Removes the `delete_on_termination` line\r\n\r\n## \ud83d\udcad Motivation and context ##\r\n\r\ngp3 is 20% cheaper, and the baseline configuration offers better performance than gp2 for volumes smaller than 2TB.  It also allows the volume size and IOPS to be configured separately, whereas the two are intertwined with gp2.\r\n\r\nSince `delete_on_termination = true` is the default, so there is no need to specify it.\r\n\r\n## \ud83e\uddea Testing ##\r\n\r\nSee cisagov/cool-assessment-terraform#148 for an example of how I tested identical changes in another repository.\r\n\r\n## \u2705 Checklist ##\r\n\r\n- [x] This PR has an informative and human-readable title.\r\n- [x] Changes are limited to a single goal - _eschew scope creep!_\r\n- [x] All relevant type-of-change labels have been added.\r\n- [x] I have read the [CONTRIBUTING](../blob/develop/CONTRIBUTING.md) document.\r\n- [x] These code changes follow [cisagov code standards](https://github.com/cisagov/development-guide).\r\n- [x] All new and existing tests pass.\r\n",
            "comments": [
                "\ud83d\udc4f ",
                ":shipit: "
            ],
            "commits": [
                "f70410061b8c6b9249895571e05dfb7a142efb18"
            ]
        },
        "codes": [
            "storage",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/SamTowne/BasketballShootingInsights/pull/43",
        "content": {
            "title": "Await Athena Query Completion",
            "body": "Bucket notifications are used to continue app flow after Athena Query\r\nresults arrive. The reason for designing the application like this is to\r\nlimit Lambda Function runtime. This is done by invoking each function asynchronously.\r\n\r\n1. The user submits the google form.\r\n2. The API Gateway receives the post and triggers the collection Lambda\r\nFunction.\r\n3. The collection Lambda Function stores the post data and triggers the\r\nsetup_processing Lambda Function.\r\n4. The setup_processing Lambda Function starts execution of an Athena Query.\r\n5. The Athena Query results file creation invokes the processing Lambda Function (via bucket notification).\r\n6. The processing Lambda Function starts execution of an Athena Query.\r\n7. The Athena Query results file creation invokes the response Lambda Function (via bucket notification).\r\n8. The response Lambda Function formats the data into an email, sends\r\nit, and invokes the cleanup Lambda Function.\r\n9. The cleanup Lambda Function runs to remove temp files.\r\n10. The user receives the Shooting Insights email.\r\n\r\n- Athena query completion times can vary greatly and bucket\r\nnotifications are used to trigger lambda functions that require the\r\nquery results\r\n- New Lambda function setup_processing ensures that the Athena table is\r\ncreated before any queries are run against it\r\n- Add a processing s3 bucket\r\n- Add a temp bucket\r\n  - This bucket is used for sharing data between the lambda functions (primarilly the new event data\r\n  and athena invocation IDs)\r\n- Add bucket lifecycles to expire old data, incomplete uploads, and to\r\ntransition data to cheaper storage tiers\r\n  - The intelligent archiving option is being used\r\n  - It may be better to explicitly specify a storage type transition\r\n  after x number of days instead of using intelligent archiving\r\n- Bucket notifications\r\n  1. Processing\r\n    - Notification attached to processing s3 bucket\r\n    - Invokes processing lambda\r\n    - Awaits create table athena query completion\r\n  2. Response\r\n    - Notification attached to athena s3 bucket\r\n    - Invokes response lambda\r\n    - Awaits select query completion",
            "comments": [
                "Nice job Samuel!"
            ],
            "commits": [
                "4ec6d54e4d36ab02b0a7daf042e727717371eaec"
            ]
        },
        "codes": [
            "storage",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/prometheus-aws-configuration-beta/pull/370",
        "content": {
            "title": "Better tagging",
            "body": "This improves our tagging so that:\r\n\r\n- we can get better information in Cost Explorer by using the approved cost tags (Name, Environment, Service, Source etc)\r\n- more things have Name tags so we know what they are\r\n- things are clearly tagged `Service: observe-prometheus` or `Service: alertmanager` so we know which bits do what\r\n- tags are used more consistently\r\n- we get rid of tags like `product` that always had the same value (like `paas`).\r\n",
            "comments": [],
            "commits": [
                "3276f316223f4320d0912a4bd705d7caecd34977"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/prometheus-aws-configuration-beta/pull/59",
        "content": {
            "title": "Reduce size of dev EC2 instances",
            "body": "## What\r\n\r\nAim of this PR is to reduce the size of the instances as in dev environments it's not necessary to run instances of `m4.xlarge`.\r\n\r\nUpdated setup.sh to remove the tfvars file when doing a clean of the stack, this is to ensure that when creating new dev stacks it uses the latest variables, previously devs were able to continue using the tfvars without any new vars being added resulting in default values for vars being used. \r\n\r\nIn this case rather than using m4.xlarge use t2.small, and to pick up lower prometheus cpu and memoryReservation values for dev stacks.\r\n\r\nThe default dev stack `tfvars`, which is created by function `create_stack_configs` in the shell script, has been updated with default dev values which can be overridden by devs.\r\n\r\nThe prometheus task definition was changed in order to use the variables from tfvars for your stack if they exist otherwise default values will be used which are the default values for production and staging.\r\n\r\n## Reference \r\n\r\nhttps://trello.com/c/Gn0fdyOr/447-destroy-our-dev-stacks-overnight-to-reduce-costs",
            "comments": [
                "Nice, this will save some tax payer money :)",
                "Nice work :)",
                "Do you have a rough estimate of potential cost savings for reducing the instance size?",
                "Given that:\r\n\r\nt2.small costs - $0.025 per Hour\r\nm4.xlarge costs - $0.222 per Hour\r\n\r\nRough estimate of running costs for a week running 8 hours per day per stack x number of dev stacks, and assuming only 1 instance per stack -\r\n\r\n0.025 x 8 x 5 = $1 per day x 5 dev instances = $5 per week\r\n0.222 x 8 x 5 = $8.88 per day x 5 dev instances = $44.40 per week\r\n\r\nSavings over a year, assuming instances are only running for 48 weeks in a year due to holidays/sickness = \r\n\r\n(44.40 - 5) x 48 = rough saving of $1891.20 over a year\r\n"
            ],
            "commits": [
                "7e54316ebbce628e5073379d78cedf31199cabd0"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/prometheus-aws-configuration-beta/pull/58",
        "content": {
            "title": "Add an ASG schedule for dev stacks",
            "body": "## What\r\n\r\nThe schedule is based on UTC times, so during BST the schedule will start at 19:00 rather than 18:00, but this is probably ok for the moment.\r\n\r\nThe default list of cron schedules is based around the core hours of 9 - 18 hours, Monday to Friday.\r\n\r\nAs developers can spin up the instances outside of these core hours to ensure that the EC2 instances are terminated the scheduled EC2 termination will be scheduled for at each hour outside of the core hours.\r\n\r\nIf you have a different working pattern, you can add the `asg_dev_scaledown_schedules` variable in your tfvars files with a list of cron schedules.\r\n\r\n## Reference\r\n\r\nhttps://trello.com/c/Gn0fdyOr/447-destroy-our-dev-stacks-overnight-to-reduce-costs",
            "comments": [
                "Spins up fine for me. Nice work\r\n\r\nLeft three very minor comments which you can take or leave.\r\n\r\nOverall, trying to spin down every hour during out of hours might be overkill as opposed to just once at the beginning of out of hours but if it ever causes a problem we can iterate this solution."
            ],
            "commits": [
                "73a2e0c5838c96b87a33a42dbf3f85c9fc8de65c"
            ]
        },
        "codes": [
            "saving",
            "policy-scheduling"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/prometheus-aws-configuration-beta/pull/93",
        "content": {
            "title": "Remove multi nat-gateways in dev to save on cost",
            "body": "The dev enviroment currently creates three of every network component  based\r\non the configuration in the vpc module. I have added a small change which will\r\nprevent the dev enviroment from creating a nat gateway for each AZ. If the\r\ninstance count is 3 in dev the single nat gateway will still be enabled. This\r\nis fine since the dev enviroment is not HA enviroment. There will be extra routes\r\ncreated to route traffic through the AZ which has all the active nat-gateway.\r\n\r\nThe current production enviroment currently supports an gateway per AZ. This is for HA\r\npurposes.\r\n\r\nTicket: https://trello.com/c/UWSPjbFJ/532-add-singular-nat-gateways-to-aws-dev-environments",
            "comments": [
                "Nice one, especially since this is a very efficient way to solve our problem. Saving that taxpayer money!\r\n\r\nYou could squash your commits together if you fancy it. A rebase to master would also be useful.\r\n\r\nNote, I've seen you been caught out by the terraform formatting check a bunch. You might be interested in seeing if your code editor has a setting which will do this everytime you save the file (I know Phil's does). Alternatively there are git commit prehooks which might be useful, I know GOV.UK use them on some of their Terraform."
            ],
            "commits": [
                "0edcb1dbd7337eab4155be2f2a7683a77cc3cc6d",
                "b69c0c401ad7e9c1098dec704ddb5edc00d09b50"
            ]
        },
        "codes": [
            "saving",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/hmcts/cnp-module-api-mgmt/pull/2",
        "content": {
            "title": "Uses the Premium tier when in production",
            "body": "Please note Premium tier is very expensive but is the only non\r\nDevelopment Tier which supports VNETs\r\n\r\nMaking PR to be able to test on jenkins - please don't merge straight away",
            "comments": [
                "ok to merge now - successfully ran on AAT",
                "LGTM \ud83d\udc83 "
            ],
            "commits": [
                "038d43dc5f17870bc6681e1d8699e0a0951a859e"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/CircleCI-Archived/enterprise-setup/pull/175",
        "content": {
            "title": "[RE-270][RE-271] Add Support for GovCloud",
            "body": "- Add GovCloud Support\r\n  - Create a new flag to toggle GovCloud support.  The flag will adjust the ARN Partitions (aws/aws-gov-cloud) within the IAM policy.\r\n- Update VM Service AWS Instance Types\r\n  - GovCloud does not support t2 or m4 insatnce types.  Updated the default values to t3 and m5 types.",
            "comments": [
                "Minor: there are still references to r3 and m4 in the `terraform.tfvars.template`.\r\n\r\nOther then that LGTM  "
            ],
            "commits": [
                "063b88824fde470e6e105f3ff1b1a2b2993e755b",
                "02f2479b124ea5e60a55cd15b7d584dd4d1ed03f",
                "f8c42ed15fc935c477a213ebdd69ac55af14e932",
                "26cc5295c2bb9d8756e450712e0f5f75af440c4a"
            ]
        },
        "codes": [
            "provider"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/schramm-famm/bespin/pull/3",
        "content": {
            "title": "Add Terraform configuration for ECS cluster",
            "body": "Resolves #1 \r\n\r\nMostly based on these two examples: [Setting up ECS with Terraform](https://blog.ulysse.io/post/setting-up-ecs-with-terraform/) and [Complete ECS](https://github.com/terraform-aws-modules/terraform-aws-ecs/tree/master/examples/complete-ecs).\r\n\r\nThe `module` blocks are 3rd party Terraform modules that define the configuration for more complicated stuff like Virtual Private Clouds (VPC) and Auto Scaling Groups that require a bunch of configuration, so using the modules simplifies things.\r\n\r\nIn terms of ECS, this configuration sets up an ECS cluster with no services and EC2 instances that will join the cluster on startup. The VPC is needed as a place for the EC2 instances to live, and the Auto Scaling Group is needed so that the number of EC2 instances can grow or shrink automatically based on a given metric (like CPU usage).",
            "comments": [],
            "commits": [
                "718fa2fc2544bb87de83ce1849d7db142a179c2c",
                "cff3747c70722eba940317dec58dc9c22b3b4939"
            ]
        },
        "codes": [
            "unrelated"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/zoitech/terraform-aws-account/pull/7",
        "content": {
            "title": "New IAM_policies to prevent users causing huge costs; created  changelog.md ",
            "body": "- created IAM Policies for limitin creation of EC2, RDS and RI Instances\r\n- created changelog.md\r\n- edited Readme\r\n- beautified the code",
            "comments": [],
            "commits": [
                "2eb42357d986ad2c3d8693907df99895cee25c63",
                "0389d8e3ae73e84c493f17b7c04eff7e89e385b2",
                "02b744ded6ecf4f3d7e630d237c9b130684806bd",
                "de1705ba16e0cc7fb5ffa5ade75cb1e766d55041",
                "afb96d7985a8d167ebde08a4f0265ee1f5bc021f",
                "93acfecccf3ef7cd8d7888b6e64fdc233c144742"
            ]
        },
        "codes": [
            "policy",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/travis-ci/terraform-config/pull/619",
        "content": {
            "title": "gce: local redis in gcp to reduce network latency",
            "body": "As part of the investigation into https://github.com/travis-ci/worker/pull/564 we discovered what looks like a lot of time being spent on network latency when talking to redis.\r\n\r\nRedis is in AWS `us-east-1`, whereas the workers are in GCP `us-central1`. The goal here is to make the redis instance local to the workers to make that network negligible.\r\n\r\nThis patch introduces a local redis instance per project. They cost about 50 bucks each, which is comparable to the 120 we are paying for the heroku-based one currently.\r\n\r\nThere are still some open questions about failovers, but those questions exist with our current setup too. :)\r\n\r\nrefs https://github.com/travis-ci/reliability/issues/222",
            "comments": [
                "That's more like it:\r\n\r\n![screen shot 2018-11-28 at 17 08 21](https://user-images.githubusercontent.com/11158255/49164854-3ea85880-f330-11e8-9044-cfd7a9b1fc5b.png)\r\n",
                ":metal: :saxophone: :bear: "
            ],
            "commits": [
                "b7308af3395ee5c0b10c2f1975c125544471e143",
                "256daafbde566e31f7357b898e552ef4f3d77adb"
            ]
        },
        "codes": [
            "awareness",
            "instance",
            "feature-redis"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/travis-ci/terraform-config/pull/28",
        "content": {
            "title": "Rearranging AWS configurations",
            "body": "while running work through and comparing to current production values\n\nIncludes (surprise! :tada:) the creation of `aws-precise-staging-1` to replace the legacy jruby travis-worker stack in staging.\n- [x] combine shared, expensive resources (like NAT) into a [separate imported graph](https://www.terraform.io/docs/providers/terraform/index.html).\n- [x] ensure all graphs can be destroyed and rebuilt without conflict\n- [x] ensure bastion duo setup works\n- [x] ensure bastions are reachable via route53 hostname, which is mapped to eip\n- [ ] ensure worker networking works with the public internet\n- [x] ensure worker networking works with bastion\n",
            "comments": [
                "I don't see anything wrong, but it's also a pretty big diff so it's hard to keep track of what is going on, so I'm not too confident in my review.\n",
                "What's the difference between `aws-staging-0` and `aws-staging-1`?\n",
                "I'm not sure how to indicate this while also using the directory name parts\nas variables, but `0` is configured to run precise while `1` is running\ntrusty.  Would some README action help?\n",
                "Only the first two \"words\" are being used, though, so changing the name to something like `aws-staging-precise-1` might work OK.\n",
                "Would it make more sense to have separate VPCs for the different \"pseudo-environments\"? Is there anything that's shared between them (apart from the VPC)?\n",
                "We would need to pay for more NAT instances if we use multiple VPCs for each distro release\n",
                "> We would need to pay for more NAT instances if we use multiple VPCs for each distro release\n\nAh, yes, I forgot about the NAT instances. In that case\u2026\n",
                "Separate VPCs per pseudo environment is what is currently happening in this repo, meaning that each of these gets its own VPC and NAT \ud83d\udcb8 \n- `aws-staging-1` (NAT is c3.large)\n- `aws-staging-0` (NAT is c3.large)\n- `aws-production-1` (NAT is c3.8xlarge)\n",
                "I have a decent idea how I can combine precise and trusty workers into a single pseudo environment, fwiw.\n",
                "@henrikhodne r?\n",
                "@igorwwwwwwwwwwwwwwwwwwww r?\n",
                "@meatballhat gave me a thorough tour of what these changes mean this morning and I am positive on them. There's a lot of excellent work represented here.\n\nI had two requests/questions (which Dan and I went over in detail via video chat, documenting here for posterity)\n1. Move production to its own VPC. This VPC will initially only run the Trusty workload (means we'll be adding more public NAT IPs) and we'll plan to move the Precise workload into it (and based on the Go worker) in November\n2. Confirm the [S3 VPC Endpoint](http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpc-endpoints.html) is resulting in our pulls from Quay using the Endpoint and **not** traversing our NAT instance once the pull starts downloading from S3\n",
                "I'm hitting an issue now where the bastions are unreachable.  Bisecting to see what went wrong...\n"
            ],
            "commits": [
                "8946a6730104f8b4aa6a1d8f0d8db6118ca34683",
                "5d2aea8743bbf6a3fa20b17b4c92974ccbd41a2a",
                "364cf124ca1fd05837004ffe9c855f753c84be95",
                "f338cb30da25076ed6c7a6d0c3a12899a9842eeb",
                "6cf5d0b246d78db66fc302294a85bc38c996ee90",
                "85e68b7db95427f41263da4e7059d50a3ad3a2d9",
                "8242fd3923aeae9244503e7babb2fb91f44162cc",
                "0c828a3a19a826ae1cd1f10ee3eb0b142e57d092",
                "6032811e9ece869048e0e43444caafc6ecf76640",
                "9c027bc96c042b167efeac24e3cd82435ec77c8a",
                "85062bd35e88b316411a6dddfcccd3d3ed60ffeb",
                "8ec7dcd3f2847ecac897d412fb7627e40a562e60",
                "3c1e59932d6ad2f0db192cc0b28ed0e579893f40",
                "2b2a9964e0d9fd05db15fda62a804af853af7807",
                "12e8cbe5f62918887b3390dfa62e784b768cf5f0",
                "38729df9f29ada2ee42cdd727d49bd190affbf7c",
                "75e488c366110c2e9c037a0d3c2e7c61895a7a27",
                "4b6f60ad78b817488c5e4b72d1394240f93992d0",
                "f003f556e64fdb91e035172322f796b84eca97ec",
                "6243cefeb60f6b24aad7d53516e9a085afc7cb0f",
                "6931805dedf0ef509251e49dec0a46dec32833e5",
                "c37780d8f46f4dd17ec9195dda91bcce57fa7d7d",
                "931e1f57f02f3e6eb92379ec5a3801584de07ef2",
                "b43e8c18228786ade20f6b123cc9822242bc3c76",
                "c2596910bef960a6faec8b2010279b4d26314058",
                "5b95750a3f3c28b9790a8a40dac242845f67ad47",
                "a7330cc509dd86ca8d9aaad937556fb8e637fa41",
                "84ebe0af9c3cb89a98f9aa29af5e4c3f8bc4ad66",
                "81bee04b5a112e152fe721e30fe608c51db2a1fd",
                "fefcefd0e75675ec10b7ad3f42b57f084b31e21c"
            ]
        },
        "codes": [
            "saving",
            "networking",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/travis-ci/terraform-config/pull/464",
        "content": {
            "title": "clean up leaked vms from packer-build via gcloud-cleanup",
            "body": "## What is the problem that this PR is trying to fix?\r\n\r\nWe've been seeing leaked VMs with names such as `packer-5b153bb9-ceed-78bd-a83e-d37168b19bab`. Those VMs are launched by [packer-build](https://github.com/travis-infrastructure/packer-build).\r\n\r\nThis can happen in the case of a travis build being canceled.\r\n\r\nThose leaked VMs cost us a couple hundred bucks per month. This tweak should make sure they get cleaned up.\r\n\r\nSide-note: I also removed the `gce_project` module as it is unused. That code now lives in the `gce_worker_group` module.\r\n\r\n## What approach did you choose and why?\r\n\r\n`gcloud-cleanup` is our automation for deleting leaked job vms. It runs continuously. We can use it to clean up these packer VMs also, using the same threshold as job VMs (3 hours).\r\n\r\n## How can you test this?\r\n\r\nI manually set `GCLOUD_CLEANUP_INSTANCE_FILTERS` on `gcloud-cleanup-production-1` and it produced this log line:\r\n\r\n```\r\ntime=\"2018-06-06T17:05:37Z\" level=info msg=deleted component=\"instance_cleaner\" instance=packer-5b153bb9-ceed-78bd-a83e-d37168b19bab reason=stale  \r\n```\r\n\r\nI manually verified that the leaked packer instances were removed.\r\n\r\n## What feedback would you like, if any?\r\n",
            "comments": [
                "\ud83d\udc96 ",
                "Sorry about introducing a conflict! :scream_cat: "
            ],
            "commits": [
                "8cbb3cd66de0065f534422230669774d5672b28a",
                "effe7d1ab52ae3d3711f3066d6ee98f1f4fdbe83"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/travis-ci/terraform-config/pull/86",
        "content": {
            "title": "Docker registry pull-through cache for aws-staging-1",
            "body": "The intent here is to smooth out and generally improve the reliability of docker image pulling in AWS, as without such a layer our availability is directly affected by the Docker Hub API uptime and performance.  Added bonus: we're better Docker Hub citizens with this.\r\n\r\n#### cool tricks\r\n\r\n``` bash\r\naws s3 ls --recursive travis-shared-1-registry-images\r\n```\r\n\r\n#### net base cost changes\r\n\r\n``` diff\r\n--- a/monthly-costs\r\n+++ b/monthly-costs\r\n@@ @@\r\n- $1243.92 - 2 * c3.4xlarge, 2 * t2.small\r\n+   $59.70 - 2 * t2.small, 2 * t2.nano, 2 * t2.micro\r\n```\r\n\r\n~$1184.22/mo. savings",
            "comments": [
                "Almost was like \"are `t2.small`s sufficient?\" and then was all, \"oh right. staging.\""
            ],
            "commits": [
                "0ce81556fb91597ebce73f612a65c8b96398f279",
                "47e9c3bcde46f1f55b022a910942a0cbbeee9574",
                "bef9d1b48f394c6b8660bb1270ba99c601e607f6",
                "daee97293893de5dc358f07d4c400f5fa6b3a651",
                "4f641b162fa877aef842481631906d5bfe874781",
                "d914eb9bc53e0631d1383bc0e0876a5f0dcc1681",
                "8fb2bb6cf5c1d56e82290c0d2272d9ff2d353703",
                "dc0df36a93522ac5c23718a8462f4bfbae17d1cf",
                "81a66dfa32e6c419e8aa5793d353e7b97d813963",
                "172e64a073f8c0ff07337bc750aed3bdb4a5cb23"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/travis-ci/terraform-config/pull/388",
        "content": {
            "title": "Use a custom machine type for NAT hosts",
            "body": "## What is the problem that this PR is trying to fix?\r\n\r\nThe machine type in use for production NATs (n1-highcpu-2) is over-resourced for the workload.\r\n\r\n## What approach did you choose and why?\r\n\r\nSwitch to a custom VM type with 1 vCPU and 2G RAM per recommendation from GCE.",
            "comments": [],
            "commits": [
                "0e2fc3ca535ca4a1fe3097b336fb145e6c73cde6"
            ]
        },
        "codes": [
            "unrelated"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/byu-oit/terraform-aws-rds/pull/24",
        "content": {
            "title": "Change default rds instance to t3 family",
            "body": "Because t3 instances are cheaper and are sometimes more performant, the BYU cloud office is considering preventing t2 hardware from being launched to encourage the use of t3 instances. Regardless of the decision the cloud office makes, t3 family instances seem like a better default for cost and performance reasons.",
            "comments": [
                "## Terraform Plan for ./examples/ci-12:\nwill create 10 resources: \n  * aws_cloudwatch_log_group - db_logs \n  * aws_cloudwatch_log_group - db_logs \n  * aws_cloudwatch_log_group - db_logs \n  * aws_db_instance - database \n  * aws_db_parameter_group - parameter_group \n  * aws_security_group - db_security_group \n  * aws_ssm_parameter - master_password \n  * aws_ssm_parameter - master_username \n  * random_password - default \n  * random_string - default\n\n[see details](https://github.com/byu-oit/terraform-aws-rds/actions/runs/919370851)",
                "## Terraform Plan for ./examples/ci-13:\nwill create 10 resources: \n  * aws_cloudwatch_log_group - db_logs \n  * aws_cloudwatch_log_group - db_logs \n  * aws_cloudwatch_log_group - db_logs \n  * aws_db_instance - database \n  * aws_db_parameter_group - parameter_group \n  * aws_security_group - db_security_group \n  * aws_ssm_parameter - master_password \n  * aws_ssm_parameter - master_username \n  * random_password - default \n  * random_string - default\n\n[see details](https://github.com/byu-oit/terraform-aws-rds/actions/runs/919370851)",
                "I think we need to update/bump the module version in the README and any examples, yes?"
            ],
            "commits": [
                "86a0795540edb426c3226775d73fcd4ce807d36a",
                "be3be5f169bf2277a0b068bfdf7da12f9ab12886"
            ]
        },
        "codes": [
            "saving",
            "instance",
            "storage",
            "feature-rds"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/fecgov/fec-infrastructure/pull/81",
        "content": {
            "title": "Remove 2nd staging replica",
            "body": "Reverts fecgov/fec-infrastructure#80: Remove 2nd staging replica used for testing https://github.com/fecgov/openFEC/issues/4038",
            "comments": [
                "Circle CI build failed three times (not the regular time-out error we usually seen with infrastructure )\r\nError: DB Instance FinalSnapshotIdentifier is required when a final snapshot is required\r\nEven after a snapshot is taken.\r\nManually delete stg-replica-2 to avoid additional cost.",
                "Looks good."
            ],
            "commits": [
                "3dbdd05af1b9331d0dc1e352323129164d2db703"
            ]
        },
        "codes": [
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/Crown-Commercial-Service/digitalmarketplace-aws/pull/298",
        "content": {
            "title": "Raise log streaming lambda function timeout to 10s",
            "body": "We've seen some occasional (a few per day) timeouts on the log\r\nstreaming lambda functions likely caused by slow Elasticsearch\r\nresponses.\r\n\r\nRaising the timeout value from 5s to 10s might help reduce the number\r\nof failed runs. We don't want a very high timeout value since if\r\nElasticsearch at any point starts to respond to requests very slowly\r\nour functions will spend more time waiting which can very quickly\r\nraise the AWS Lambda costs.",
            "comments": [
                "\ud83d\udc4d "
            ],
            "commits": [
                "9928d58017829d85789bdf45f467b6d32c6354b2"
            ]
        },
        "codes": [
            "awareness",
            "feature-lambda",
            "increase"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/cookpad/terraform-aws-eks/pull/51",
        "content": {
            "title": "Cluster Envelope Encryption",
            "body": "Fixes #50 \r\n\r\n\ud83d\udd17 https://aws.amazon.com/blogs/containers/using-eks-encryption-provider-support-for-defense-in-depth/\r\n\ud83d\udd17 https://github.com/aws/containers-roadmap/issues/530\r\n\ud83d\udd17 https://github.com/terraform-providers/terraform-provider-aws/issues/12287\r\n\ud83d\udd17 https://www.terraform.io/docs/providers/aws/r/eks_cluster.html#encryption_config-1",
            "comments": [
                "LGTM",
                "LGTM",
                "#### `terraform fmt` Failed\n\n<details><summary><code>./modules/cluster/main.tf</code></summary>\n\n```diff\n }\n \n resource \"aws_kms_key\" \"cmk\" {\n-  count = length(var.kms_cmk_arn) > 0 ? 0 : 1\n+  count       = length(var.kms_cmk_arn) > 0 ? 0 : 1\n   description = \"eks secrets cmk: ${var.name}\"\n }\n```\n\n</details>\n<details><summary><code>./modules/cluster/variables.tf</code></summary>\n\n```diff\n }\n \n variable \"kms_cmk_arn\" {\n-  type = \"string\"\n-  default = \"\"\n+  type        = \"string\"\n+  default     = \"\"\n   description = \"The ARN of the KMS (CMK) customer master key, to be used for Envelope Encryption of Kubernetes secrets, if not set a key will be generated\"\n }\n```\n\n</details>\n\n*Workflow: `.github/workflows/pr.yml`, Action: `hashicorpterraform-github-actions1`, Working Directory: `.`, Workspace: `default`*\n",
                "\u2753 This feature adds some additional cost to the cluster.  A kms key costs $1 per month, plus some cost to decrypt secrets, I think I am OK with this for best practice security by default. But should we make it an option to disable this?",
                "\ud83d\udcdd I have not enabled automatic key rotation as I think the lifecycle of a particular eks cluster should be less than one year anyway! We should review this if we think that upgrading kubernetes versions in place is attractive (I currently don't)",
                "It would help to have the AWS feature documentation linked in the description.",
                "> It would help to have the AWS feature documentation linked in the description.\r\n\r\nEverything should be in the issue... but sure",
                "> > It would help to have the AWS feature documentation linked in the description.\r\n> \r\n> Everything should be in the issue... but sure\r\n\r\nDo you mean the original issue which led to this pull request. I don't see any reference to that either.",
                "> I don't see any reference to that either.\r\n\r\nSorry fixed ... it was in the commit message... but multiple commits in the PR mean't it didn't get copied to the PR description!",
                "> > I don't see any reference to that either.\r\n> \r\n> Sorry fixed ... it was in the commit message... but multiple commits in the PR mean't it didn't get copied to the PR description!\r\n\r\nThanks. I'll go through the docs first thing to familiarise myself with what's going on, and then finish the code review.",
                "What's the approach for setting the CMK ? Manually via the console and backed up via 1password ?",
                "> What's the approach for setting the CMK ? Manually via the console and backed up via 1password ?\r\n\r\nThe default here, if you don't specify the ARN is for AWS to just generate one for us https://docs.aws.amazon.com/kms/latest/developerguide/create-keys.html\r\n\r\nI think this is a good default... as we never need to store the key ourselves... and the method of generating the key seems very secure (HSM blah blah something)\r\n\r\nYou can override this and pass an ARN to whatever CMK you like (including an imported one)... so it's really up to the user to choose what they want to do."
            ],
            "commits": [
                "442bf9df3dcdff462a09f482753fdc4226e73696",
                "e5674e59f9dd65edf83f5801438daddcc7342f20"
            ]
        },
        "codes": [
            "cluster",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/torumakabe/aks-anti-dry-iac/pull/6",
        "content": {
            "title": "improve: cost reduction (test env.)",
            "body": null,
            "comments": [],
            "commits": [
                "4ba7a9dc3085ab701c85737a4f36dd57fcd7596f"
            ]
        },
        "codes": [
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/mozilla-platform-ops/devservices-aws/pull/76",
        "content": {
            "title": "Add s3 bucket to store Mercurial backups",
            "body": "We have several gigabytes of old repos sitting on an NFS volume\r\nin SCL3. It's cheaper to store them in S3. Plus, we'll soon be\r\nmigrating a bunch of data and it is easier if we have less data to\r\nmigrate.",
            "comments": [
                "`terraform plan` without these commits results in changes. Could we please get this merged?"
            ],
            "commits": [
                "f1699d9b6bd831cbb6e9cb4f970a9c97a618132a",
                "e02eec23afad3b29c8ffcff4de6142fb6782da37",
                "ebb4040f6ad47d3e41c5ddf2cdceac3b3a8abead"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/bculberson/btc2snowflake/pull/18",
        "content": {
            "title": "optimize ebs costs",
            "body": "",
            "comments": [],
            "commits": [
                "9f8227bf53ebc2b1bb0b99d0697f9f66eed7ab6d"
            ]
        },
        "codes": [
            "saving",
            "instance",
            "storage",
            "feature-ebs"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/opg-infra-costs-action/pull/14",
        "content": {
            "title": "UML-2478 - Allow lambda to assume cross account role when collecting cost data",
            "body": "# Purpose\r\n\r\nCollect cost data for all opg accounts.\r\n\r\nFixes UML-2478\r\n\r\n## Approach\r\n\r\nAssume Role\r\n- Add class for creating a cross account boto3 client\r\n- Add assume role permissions to lambda execution policy\r\n- Pass env var for cros account cost explorer role\r\n\r\nCollecting Costs\r\n- add filter to pull cost data for OPG accounts only\r\n- Increase lambda timeout\r\n\r\nOther\r\n- Fix sarif uploading\r\n- Add codeowners\r\n- Use the latest v3 of the lambda python image\r\n- Fix the lambda IAM role name for easier referencing across accounts\r\n- Set container version during local terraform dev\r\n- remove duplicate logging configuration\r\n\r\n## Learning\r\n\r\n- https://aws.amazon.com/premiumsupport/knowledge-center/lambda-function-assume-iam-role/\r\n- https://boto3.amazonaws.com/v1/documentation/api/1.20.4/reference/services/ce.html#CostExplorer.Client.get_cost_and_usage\r\n- https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sts.html#STS.Client.close\r\n- https://www.geeksforgeeks.org/with-statement-in-python/",
            "comments": [],
            "commits": [
                "2f3bf8a37fa8752fff0a121a96f2aa06d4a0c2f2",
                "dedf3144842eac6fe2b601afa2bf8916da252c32",
                "60f5bdc25d5f43d10a63f44f0b123092917be54b"
            ]
        },
        "codes": [
            "alert",
            "feature-lambda"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/opg-infra-costs-action/pull/9",
        "content": {
            "title": "UML-2030 - Create Lambda Function",
            "body": "- add module for lambda functions\n- set up logging for lambda funtions\n- ignore terraform local state bits\n- configure dev environment\n- configure terraform\n- create a lambda function to ship to costs\n- add terraform plan steps to pipeline\n",
            "comments": [],
            "commits": [
                "814b5eb1fefae64d724d7eb1f3a3eb918194cfef",
                "104fd70cf975de1b6bb3182d85c05e7d01bf688e",
                "068c1515f21bfe02a955780c41b3f9dac5918048",
                "8f68d77aab50406ff90a0815406573be77ba0ae7",
                "942ead30d65d8fa37b03d06c062e620bdafbaeda",
                "974fcd2e45ce4c08a542d8e45ac882c13da8f2c1"
            ]
        },
        "codes": [
            "alert",
            "feature-lambda"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/jg210/aws-experiments/pull/10",
        "content": {
            "title": "t3a.nano is cheaper and better than t2.nano.",
            "body": null,
            "comments": [],
            "commits": [
                "b09b668e5c3a11366551168541480b69e94c8c3a"
            ]
        },
        "codes": [
            "instance",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/jg210/aws-experiments/pull/6",
        "content": {
            "title": "t2.nano costs half as much as t2.micro.",
            "body": "",
            "comments": [],
            "commits": [
                "5ff37f12a421fdd902d8eb1e6d7491ee181fd179"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wushin/ttrpg-tools/pull/23",
        "content": {
            "title": "Add Perms for ECR and SSM",
            "body": "Build ECRs\r\nPush to ECRS\r\nSeparate modules out better\r\nImprove naming conventions\r\nRemove local files from s3\r\nRestore uses local exec\r\nCluster set-up using ec2\r\nService discovery working\r\nDockerfiles fixed to work in AWS\r\nnginx confs change to work in AWS\r\nALB set-up completely\r\nDocker containers exposing ports and volumes\r\nnginx has a default server\r\nNginx resolving container names\r\nFix submodules for https\r\nFix and Add rest of build files\r\nFix nginx build\r\nadd nfs to codebuild\r\nFix apt command\r\nFix the rest of the NFS and use ssm\r\nadd mongodb as a static service\r\nAdd s3 restore\r\nDatasync backups\r\nAllow codebuild to start a new container after successful build\r\nMake a restore that checks and maintains proper permissions\r\nAllow deploy to start new capacity",
            "comments": [],
            "commits": [
                "5b994d1a4cc3c4f5a05bb2274c885990e17e6929",
                "334dc1b4ec77127e79f6571342aa29e0c5b8dfb0",
                "843b7e990caaf245280dea0c67f459bf55e34a86",
                "9604c14a781530129e47e7a7684a90db86a7f7a0",
                "b7fa9df356741cb35dbef0c0dd1c56b913c588cd",
                "45e75cd29159d12ea4fc602cb2ba687ea1eee1fe",
                "2bc051583bb70001d303b261f0978fc48a18ab38",
                "30b083c44a220104ef648bbe5d77e4c4ed6a5ed0"
            ]
        },
        "codes": [
            "unrelated"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/gpii-ops/gpii-infra/pull/520",
        "content": {
            "title": "[GPII-3836]: Enable secrets bucket versioning",
            "body": "This PR enables secrets bucket versioning for staging and production environments and should be merged after https://github.com/gpii-ops/exekube/pull/70.\r\n\r\nDeployment does not require any special treatment.",
            "comments": [
                "Added work-in-progress label, because I still need to test recovery of a previous version of a secrets file, encrypted with disabled version of KMS key. ",
                "Tests went successfully, this is ready to be reviewed.",
                "> What is the rationale behind enabling versioning only in stg and prd\r\n\r\n@stepanstipl Dev secrets are less valuable, since our universal dev troubleshooting \"policy\" is to destroy hard and redeploy when things go weird. But at the same time, secrets versioning should not bring too much of extra cost, so I am fine enabling it for all envs for consistency in case team decides so. ",
                "> secrets versioning should not bring too much of extra cost, so I am fine enabling it for all envs for consistency in case team decides so.\r\n\r\nThanks @natarajaya, I'm in favor of enabling it everywhere for the sake of parity across envs.",
                "Thanks @natarajaya.\r\n\r\nLooks good in general. What is the rationale behind enabling versioning only in `stg` and `prd`?"
            ],
            "commits": [
                "64d29e132a0e42c56974a4921a8f10c51e3eec7f",
                "8504b98b83fda12d01d077b2b9fc9df85a79d276",
                "b43525e80543650133ed501716dfa86a9aba9c6d"
            ]
        },
        "codes": [
            "storage",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/gpii-ops/gpii-infra/pull/60",
        "content": {
            "title": "GPII-3125 Init GCP organization",
            "body": "This code covers [GPII-3125](https://issues.gpii.net/browse/GPII-3125), [GPII-3127](https://issues.gpii.net/browse/GPII-3127), [GPII-3126](https://issues.gpii.net/browse/GPII-3126) and [GPII-3128](https://issues.gpii.net/browse/GPII-3128).\r\n\r\nMore info about how to apply this code is in the [README.md](https://github.com/gpii-ops/gpii-infra/blob/35b4ba9f9657b0c25e23c0f0d488d386453c7dd6/common/README.md)\r\n\r\nThis pr includes the following changes:\r\n\r\n- Move the rakefiles to a common part shared by all the project types\r\n- Create the DNS structure for a complete organization, in AWS and GCP\r\n- The organization details are parametrized.\r\n- Make idempotent the creation of the initial resources used by each environment\r\n- Move some rake tasks to the Docker container\r\n- `rake sh` gives a shell inside the container without making changes.\r\n\r\nThis is the plan to merge this PR:\r\n\r\n1. Merge the PR :)\r\n1. Let the CI test all until `stg`. This should create the initial resources for test1.gpii.net and create/destroy a complete dev testing cluster.\r\n1. Manually import in the `prd` state file the projects already created in the organization in order to avoid naming conflicts and/or increase the projects quota.\r\n1. Import the DNS zones that match the [DNS pattern](https://github.com/gpii-ops/gpii-infra/blob/d60a61a5ee8d03cd11fb205cfceedbba817f5945/shared/rakefiles/vars.rb#L28-L36), delete others.\r\n1. Promote to `prd` to recreate all the initial resources, DNS zones left, ns registries, SA of each project, activate API services and update the TF state of the common part.\r\n1. Each individual project should refresh the TF state simply running `rake`, the CI will do automatically.\r\n1. Re-run the complete pipeline in order to check that the idempotency works as expected.",
            "comments": [
                "This looks pretty good, Alfredo! I still think the strategy is sound. Most of my feedback is naming and organization changes that I hope will help with readability.\r\n\r\nI haven't tried to run this code yet. Perhaps we should sit down together and go through it, make sure it works on my machine, make sure things that require Organization admin are idempotent, etc.",
                "Lookin' good. I suggested a couple more small things (mostly deleting code :)).\r\n\r\nThank you for using merge instead of rebase so that I can keep track of what I've already reviewed. I'm fine with Stepan's suggestion of using rebase to clean up the history before merging to master.\r\n\r\nI think the rest of your plan looks good. I'm fine with punting the stuff you punted.",
                "Thanks for helping to test this code, Stepan!\r\n\r\nThe bug fixes generally look good.",
                "I like the parameterization and the ability to do testing!\r\n\r\nIt looks like this branch does not contain my latest changes for `@serviceaccount_key_file` management. You're probably already aware and have a plan for this :).",
                "Reminder that there are a few comments from my last review (8 days ago) that remain unresolved.",
                "Some minor changes.",
                "This review contains some more significant changes.\r\n\r\nIn particular, I have questions about the CI strategy.\r\n\r\n1. Spinning up and then destroying a GCP dev cluster twice -- once as part of `gcp-dev`, once as part of `common-stg` -- is expensive and slow. As currently implemented, `common-stg` must complete successfully before `aws-stg` and `gcp-stg` can run.\r\n\r\n2. There's a strange cycle where:\r\n* Developer changes the way `common-prd` deploys dev environments.\r\n* Developer merges their changes, triggering a CI pipeline.\r\n* `gcp-dev` runs, but `common-prd` changes haven't been deployed yet.\r\n* Later, `common-prd` runs, deploying the developer's changes.\r\n* In the *next* pipeline (perhaps as much as a day later), `gcp-dev` finally runs in a world where the developer's changes have been deployed.\r\n\r\nMaybe the pipeline should have a different order?\r\n* setup\r\n* unit-test\r\n* common-stg\r\n* common-promote-to-prd [1]\r\n* common-prd\r\n* dev [2]\r\n* promote-to-stg\r\n* stg\r\n* promote-to-prd\r\n* prd\r\n\r\n[1] It's awkward to have a manual step early in the pipeline. Are we confident promoting common to prd automatically if common-stg succeeds?\r\n\r\n[2] The dev Stage, and all subsequent Stages, include `aws-` and `gcp-` Jobs.\r\n\r\nI'd like to discuss before we merge this PR.",
                "I'm wondering if this is not an overly complicated way to achieve what we want. I don't think it's a problem of this PR as such, but rather of the whole repo structure. I know some of this is enforced given the used tooling, but that would be imho another reason to consider a simpler approach.\r\n\r\nMy main concerns being:\r\n- **Many dependencies**, currently these are required (not limited to):\r\n  - Ruby \r\n  - Rake - using Rakefiles\r\n  - Terraform\r\n  - Terragrunt\r\n  - Custom fork of Exekube\r\n  - Docker-compose\r\n  - Docker (of course :))\r\n  - Python (called from Tf)\r\n  - gcloud cli\r\n \r\n- **Complicated and confusing dir structure** - `common/live/prd/infra/development/` for example, each of these containing a significant amount of duplicated code (abusing DRY)\r\n\r\nI think the complexity of this will backfire in future. In general, I'm a fan of Occam's razor principle & keep it simple.\r\n\r\nAs an alternative I would propose using pure Terraform with a Makefile, all packaged in Docker container, gcloud would still have to be there. I think the code for our purpose could then simply look something like:\r\n\r\n```tf\r\n...\r\nmodule \"dev-tyler\" {\r\n  source  = \"modules/gcp-project\"\r\n\r\n  name    = \"dev-tyler\"\r\n  owner   = \"tyler@raisingthefloor.org\"\r\n}\r\n\r\nmodule \"dev-stepan\" {\r\n  source  = \"module/gcp-project\"\r\n\r\n  name    = \"dev-stepan\"\r\n  owner   = \"stepan@raisingthefloor.org\"\r\n}\r\n...\r\n```\r\n\r\nThis would make this piece of code more maintainable with fewer dependencies.\r\n\r\nWe can also create the DNS zone per project here together with corresponding DNS records. For example the subdomains for the above code would be `.dev-tyler.gcp.gpii.net` and `.dev-stepan.gcp.gpii.net` and then the code for actual K8s infrastructure could create any records underneath.\r\n\r\n(Probably, at least initially, I would also suggest leaving out the AWS DNS zone mgmt., and simply create one subdomain that would be \"manually\" delegated to GCP, as I assume we will want to get rid of AWS in future.)",
                "@amatas I know it took me so long to review this! My overall impression is good, I replied on some comments in discussions started by Tyler. I did not go into Ruby code yet.\r\n\r\nMain of my points here:\r\n* Shared rakefiles / docker-compose configs\r\n* Live directory structure (https://github.com/gpii-ops/gpii-infra/pull/60#discussion_r205665333)\r\n* Use Terraform native functions instead of Python (https://github.com/gpii-ops/gpii-infra/pull/60#discussion_r205667215)\r\n* How to re-use dns zone created in dev project (https://github.com/gpii-ops/gpii-infra/pull/60/files#r205671169)\r\n \r\nAnother question \u2013 how are we going to test this if we can not delete our existing projects and let this code recreate everything from scratch? :)",
                "@amatas \r\n\r\nHave you tested running the TF part of code under the newly created ci account? Specifically for project removal? I'm suspecting the account might not have permissions to modify or delete projects, as we give it only `resourcemanager.projectCreator`.\r\n\r\nDNS - do we need different DNS structure for the dev projects? This would make sense if we would be delegating management of that zone to uses, but since we're creating all the records here, I would prefer to be consistent: `dev-alfredo.gcp.gpii.net` vs `alfredo.dev.gcp.gpii.net`. The first version would be consistent for all projects like `prd` or `stg`.\r\n\r\n",
                "@stepanstipl:\r\n\r\n> DNS - do we need different DNS structure for the dev projects?\r\n\r\nOne motivation for creating a dedicated `dev` zone was indeed to be able to give it different permissions (e.g. allowing subzones to be managed by non-admin users) from the `stg` and `prd` zones. This is needed under the current AWS model, but not under the current GCP model.\r\n\r\nAnother advantage of a dedicated `dev` zone is that it allows use of a wildcard SSL certificate (other than `*.gpii.net`). This might have been nice for using Amazon Certificate Manager with dev clusters. It may still be nice if/when we get to TLS encryption for internal network communications.\r\n\r\nHowever, I don't know if these factors warrant the extra handling needed to distinguish between \"tyler.dev.gpii.net\" and \"prd.gpii.net\" -- it's certainly a question worth asking. What does the team think?",
                "Note for @amatas (and @mrtyler ;)): I have replied to all the comments that I had replies for. I'm waiting to review code until things settle down a bit (otherwise it's hard for me to keep track of what has/hasn't been addressed). Please add a comment when you've taken at least a first pass at everything.",
                "OK team, I think that this is ready for a second round of review if you all believe that it's needed. @natarajaya @mrtyler @seg10 @stepanstipl , thanks for your thoughts and code suggestions, feel also free to review the code and add any comments.\r\n\r\nI've applied and tested almost all the corrections suggested. I've tested parts of the code using my personal account, but it was not possible for me to test all together due to the dependency of cloud providers and accounts involved.\r\n\r\nThe split or the reorganization of the rake files I think that could be addressed in a separate ticket, as is not critical for this work and I wouldn't like to grow the size of this PR. The same to the READMEs organization.\r\n\r\nThis time I have used the merge instead of rebasing the code. I read that using this method the history of the changes makes sense as you can see the original code that a commit patches, meanwhile using the rebase method you lost that original code. Also it seems that Github manages better the comments in the code of the PR.\r\n\r\n@stepanstipl @mrtyler I'd vote for using what we have now, developers domains hanging from a `dev` zone. I think that is an advantage the dedicated permissions of that non critical zone. But as always, we can see how it goes. I think that a swap to the other model is not so difficult.\r\n\r\n@stepanstipl This PR doesn't address the deleting of the projects. This is a good feature for a new task (which I'll create as well as others commented in this PR), but as I said before I'd like to merge this code by now and stop adding features to this PR.\r\n\r\nMy plan for applying this code in the running environments is this:\r\n\r\n1. Merge the gcp/rakefiles/entrypoint.rake as it is the only file that has conflicts with the actual master.\r\n1. Merge the PR\r\n1. Checkout the code in a live session with other team members.\r\n1. Import the resources that are already created in GCP and match the patterns used in this code:\r\n   1. Projects\r\n   1. Service accounts\r\n   1. User accounts permissions\r\n   1. Buckets\r\n   1. DNS zones\r\n   1. DNS registries\r\n1. Check the `plan` output and see that it doesn't break or delete current resources.\r\n1. Run `rake infra_init`\r\n1. Check the resources updated and created\r\n1. Run `rake project_init`\r\n1. Run `rake apply_projects`\r\n1. Check the resources created, paying attention to the DNS zones structure and the NS registries.\r\n\r\n",
                "thanks @amatas \r\n\r\n- I like to merge while you're discussing the issues & do final rebase & squash to sensible commit chunks once approved and before you actually merge to master. Reason being, as you pointed out, keeping a history of changes and comments while working on the issue, but at the same time prevent all the \"wip\" commits getting into master.\r\n\r\n- Importing resources already created - are we planning to import manually? That sounds like quite a tedious and error-prone process. Or is there s code to do this? Or re-use/merge current state file?",
                "@mrtyler I added some commits to address your suggestions. Please check that everything is fine.",
                "LGTM!\r\n\r\nLet's talk tomorrow about how to deploy this branch!",
                "Rake will fail with following error when running `rake auth`:\r\n```\r\nrake aborted!\r\nErrno::ENOENT: No such file or directory @ rb_sysopen - ../../.config/prd/compose.env\r\n/Users/stepan/Projects/gpii/gpii-test/gcp/rakefiles/entrypoint.rake:48:in `initialize'\r\n/Users/stepan/Projects/gpii/gpii-test/gcp/rakefiles/entrypoint.rake:48:in `open'\r\n/Users/stepan/Projects/gpii/gpii-test/gcp/rakefiles/entrypoint.rake:48:in `block in <top (required)>'\r\nTasks: TOP => auth => set_vars\r\n(See full trace by running task with --trace)\r\n```\r\n\r\nIt's expecting `compose.env` that has not been created.\r\n\r\nSteps to reproduce:\r\n- Clone repo to a fresh new location\r\n- Follow `common/README.md` steps \"Creating the initial infrastructure\"\r\n",
                "Looks like readme is referring to `../aws#configure-cloud-provider-credentials` for AWS creds setup, and that mentions 2 options - `aws configure` or manually putting creds in `~/.aws`. Exekube, on the other hand, seems to expect credentials in `./.config/${ENV}/aws`, which is used as docker-compose mount `/root/.aws`. Readme should be updated to reflect correct method of configuring credentials.",
                "thanks @stepanstipl I fixed both issues in https://github.com/gpii-ops/gpii-infra/pull/60/commits/f7c2d222ecdf13acf37c4e304d38f02bc74a4aff and https://github.com/gpii-ops/gpii-infra/pull/60/commits/514e66525c0d271cb46d233d369c3c7b8148fe43",
                "@amatas is there a way to test the AWS DNS part? The zone `Z26C1YEN96KOGI` seems to be hardcoded.",
                "`project_init` rake task fails with insufficient permissions:\r\n\r\n```\r\nmodule.gcp_zone.google_dns_managed_zone.main: Creating...\r\n  description:    \"\" => \"gcp DNS zone\"\r\n  dns_name:       \"\" => \"gcp.stgca02.stipl.net.\"\r\n  name:           \"\" => \"gcp-gpii-net\"\r\n  name_servers.#: \"\" => \"<computed>\"\r\n  project:        \"\" => \"<computed>\"\r\nReleasing state lock. This may take a few moments...\r\n\r\nError: Error applying plan:\r\n\r\n1 error(s) occurred:\r\n\r\n* module.gcp_zone.google_dns_managed_zone.main: 1 error(s) occurred:\r\n\r\n* google_dns_managed_zone.main: Error creating DNS ManagedZone: googleapi: Error 403: Forbidden, forbidden\r\n\r\nTerraform does not automatically rollback in the face of errors.\r\nInstead, your Terraform state file has been partially updated with\r\nany resources that successfully completed. Please address the error\r\nabove and apply again to incrementally change your infrastructure.\r\n```\r\nI assume it's because the `projectowner@gpii2-common-prd.iam.gserviceaccount.com` service account has only `Storage Admin` and `Viewer` permissions and therefore is unable to create the DNS zone.\r\n\r\nUpdate: yes, adding `DNS Administrator` to the service account fixes the problem.",
                "Terraform is checking and downloading provides every time it's being run:\r\n```\r\nInitializing provider plugins...\r\n- Checking for available provider plugins on https://releases.hashicorp.com...\r\n- Downloading plugin for provider \"google\" (1.16.2)...\r\n```\r\n\r\nThis is slow and can mean a loss of consistent environment - if a new version is found, it will be downloaded.\r\n\r\nWe should\r\na) Specify versions of providers to lock these down\r\nb) Predownload providers when we build the docker image and prevent any further downloads\r\n\r\nI realised I'm not sure it's a good place for this, like in scope of this PR, maybe this should be separate issue?",
                "While running `rake apply_projects` I get following credentials error:\r\n```\r\n[terragrunt] [/project/live/prd/infra/prd/zone] 2018/08/14 16:34:39 Running command: terraform apply -auto-approve -input=false -auto-approve\r\nAcquiring state lock. This may take a few moments...\r\nReleasing state lock. This may take a few moments...\r\n\r\nError: Error running plan: 1 error(s) occurred:\r\n\r\n* provider.google: google: could not find default credentials. See https://developers.google.com/accounts/docs/application-default-credentials for more information.\r\n\r\n\r\n[terragrunt] [/project/live/prd/infra/prd/zone] 2018/08/14 16:34:42 Module /project/live/prd/infra/prd/zone has finished with an error: Hit multiple errors:\r\nexit status 1\r\n[terragrunt] 2018/08/14 16:34:42 Encountered the following errors:\r\nHit multiple errors:\r\nexit status 1\r\nFATA[0083] exit status 1\r\nrake aborted!\r\n```\r\n... atm. looking into why is this happening",
                "Hi @stepanstipl ,\r\n\r\n1. DNS Route53 zone harcoded:\r\nI changed the hardcoded value by a variable, so you can now set that value using TF_VAR environment variables and [the rake code should inject it in to the container](https://github.com/gpii-ops/gpii-infra/blob/fd32dc5c0f851138159ff4f2ae8850f6397d3e81/gcp/rakefiles/entrypoint.rake#L44-L51) and pass it to the terraform code.\r\n\r\n1. DNS privileges in common project\r\nI added the code to set the admin role to the SA\r\n\r\n1. Terraform providers downloaded on every execution.\r\nI don't know why this happens, it should save the files in the `.config` path. Anyway, your idea to save execution time could be a good improvement, I would file a jira for that.\r\n\r\n1. Default credentials\r\nI also saw that problem in my tests, I solved running `rake auth` again. And I wasn't able to figure out what happened before that raised that error. Perhaps a lack of correct permissions on the `credentials.db` file?\r\n\r\nThanks again for your comments and testing.",
                "@amatas Cool, thanks Alfredo\r\n\r\nI think the problem might be with using just `gcloud auth`, I think correct one should be `gcloud auth application-default login`. See https://www.terraform.io/docs/providers/google/index.html. Unfortunately, in my case, the problem is not fixed by running `rake auth` again.\r\n\r\nBut it's a bit strange, as the first part, when it's actually modifying `google_dns_managed_zone.main`, therefore it needs to have GCP credentials, works fine, and only when it's running `[terragrunt] [/project/live/prd/infra/prd/zone]` it fails.",
                "I think I've figured it out:\r\n\r\nThe first module `/project/live/prd/infra/dns-root` which is pointing to `/project/modules//aws-gcp-dns` and works fine has following provider declaration:\r\n```\r\nprovider \"google\" {\r\n  credentials = \"${var.serviceaccount_key}\"\r\n  project     = \"${var.project_id}\"\r\n  region      = \"us-central1\"\r\n}\r\n```\r\n\r\nThe second, failing one, `/project/live/prd/infra/prd/zone` which is pointing to `/project/modules//gcp-project` does not have any such provider declaration.\r\n\r\nThe first one, therefore, uses explicitly defined credentials, while the second one is trying to use default ones as described at https://www.terraform.io/docs/providers/google/index.html.",
                "Good catch @stepanstipl ! I've added such provider to gcp-project module on https://github.com/gpii-ops/gpii-infra/pull/60/commits/c09bd448064dbd92e010d46c300de270c4cdbdde",
                "I have hit another issue, when the service account for actual projects `serviceAccount:projectowner@gpii-common-prd.iam.gserviceaccount.com` in `modules/gcp-project/main.tf` is hard-coded and does not respect the actual \"common\" project name.  I would also prefer to have the other members parametrised (`group:ops@raisingthefloor.org`), instead of hardcoded in the module.",
                "Atm. running `rake apply_project` always ends up in following error: \r\n```\r\n[terragrunt] [/project/live/prd/infra/prd/zone] 2018/08/15 15:50:08 Running command: terraform apply -auto-approve -input=false -auto-approve\r\ngoogle_project.project: Refreshing state... (ID: gpii-gcp-prd2)\r\n\r\nError: Error refreshing state: 1 error(s) occurred:\r\n\r\n* google_project.project: 1 error(s) occurred:\r\n\r\n* google_project.project: google_project.project: Error retrieving App Engine application \"gpii-gcp-prd2\": Get https://appengine.googleapis.com/v1/apps/gpii-gcp-prd2?alt=json: dial tcp [2a00:1450:4009:80f::200a]:443$\r\n connect: cannot assign requested address\r\n\r\n\r\n[terragrunt] [/project/live/prd/infra/prd/zone] 2018/08/15 15:50:15 Module /project/live/prd/infra/prd/zone has finished with an error: Hit multiple errors:\r\nexit status 1\r\n[terragrunt] 2018/08/15 15:50:15 Encountered the following errors:\r\nHit multiple errors:\r\nexit status 1\r\nFATA[0021] exit status 1\r\nrake aborted!\r\n```\r\n... investigating why",
                "I think these issues seem to be related to missing permissions.\r\n\r\nOne of the errors I get is:\r\n```\r\n* google_storage_bucket.project-tfstate: google_storage_bucket.project-tfstate: Error reading Storage Bucket \"gpii-gcp-prd2-tfstate\": googleapi: Error 403: projectowner@gpii-common-prd.iam.gserviceaccount.com does n\r\not have storage.buckets.get access to gpii-gcp-prd2-tfstate., forbidden\r\n```\r\nThe code is trying to access storage bucket of the individual project under the `projectowner@gpii-common-prd.iam.gserviceaccount.com` account but does not have permissions to do so. Adding smth like `Storage Admin` fixes the problem.\r\n\r\nIn general it might be good idea to add the permissions for the common account on Organization level, as they would get inherited?\r\n\r\n",
                "Creating DNS zones fails with project named `prd2`. It's trying to create zone `prd.gcp.gpii.net.2` and that is not valid zone name. \r\n\r\nI guess the problem comes from the `/([a-z]+)-([a-z]+)-([a-z]+)-?([a-z]+)?/` regexp, which does not allow numbers in individual parts of the name.\r\n\r\n```\r\ngoogle_dns_managed_zone.project: Creating...\r\n  description:    \"\" => \"gpii-gcp-prd2 DNS zone\"\r\n  dns_name:       \"\" => \"prd.gcp.gpii.net.2\"\r\n  name:           \"\" => \"gpii-gcp-prd2-zone\"\r\n  name_servers.#: \"\" => \"<computed>\"\r\n  project:        \"\" => \"gpii-gcp-prd2\"\r\n```",
                "Hi @stepanstipl \r\n\r\n1. the projectowner should have owner permissions in each project: https://github.com/gpii-ops/gpii-infra/blob/65a8f02d1e2f6dc99c704c45271a988f4944a841/common/modules/gcp-project/main.tf#L64-L73\r\nand also it has permissions on the common-prd project https://github.com/gpii-ops/gpii-infra/blob/65a8f02d1e2f6dc99c704c45271a988f4944a841/common/rakefiles/entrypoint-common.rake#L46-L48\r\nI don't understand where it needs more privileges.\r\n1. Changed the regular expression to allow digits in https://github.com/gpii-ops/gpii-infra/pull/60/commits/65a8f02d1e2f6dc99c704c45271a988f4944a841\r\n",
                "@amatas thanks, but looks like the last commit introduced an error:\r\n```\r\n[terragrunt] [/project/live/prd/infra/prd/zone] 2018/08/16 15:08:30 Running command: terraform apply -auto-approve -input=false -auto-approve\r\n\r\nError: Error parsing /root/.terragrunt/QwL5tE0zt_C6_1_1Ybv6FwtLII4/exDWDCWoRRnBaZ-HQfLUjTVcEno/gcp-project/main.tf: At 32:47: illegal char escape\r\n```\r\n\r\nRe. the storage permission - I think it's probably related to the previous one, when the service account name does not respect the project name - even if the main project is named `gpii2-common-prd`, as you can't have 2 projects with same names on GCP, the service account is still hadrcoded to  `projectowner@gpii-common-prd.iam.gserviceaccount.com`. So ignore that, it'll get fixed once the svc account name matches the project name.",
                "Hi @stepanstipl ,\r\n\r\nI've parametrized the name and the main domain of the organization in the tf code. I also need to change this in the rake tasks. Perhaps this can help us on the further testing. https://github.com/gpii-ops/gpii-infra/pull/60/commits/903daeaac11641c6ea121eb0bf2038fb98db96a4\r\n\r\nAlso I fixed the regular expression.",
                "cool @amatas, looks good. I started creating GCP org we can use for testing and will look into creating a GitLab task, I think this we'll also need to coordinate with work Tyler is doing with docker volumes #92 ",
                "@amatas I'm trying to run stg, under the new shared test org, with some minor code changes - see https://github.com/stepanstipl/gpii-infra/tree/gpii-3125-stg - and following env variables set:\r\n```\r\nTF_VAR_aws_zone_id=Z1OFSNK98Q5PP7\r\nTF_VAR_organization_domain=test1.gpii.net\r\nTF_VAR_organization_id=327626828918\r\nTF_VAR_organization_name=gpii2test\r\nORGANIZATION_ID=327626828918\r\n```\r\n(aws zone is mine test zone, didn't want to mess up our aws)\r\n\r\nand I'm hitting following error, when rake is trying to create service account key, without creating the service account first - that part is getting skipped:\r\n```\r\nrake infra_init\r\n(in /Users/stepan/Projects/gpii/gpii-infra/common/live/stg)\r\n\r\ndocker-compose run --rm --service-ports xk sh -c 'gcloud iam service-accounts keys create $TF_VAR_serviceaccount_key       --iam-account projectowner@$T$\r\n_VAR_project_id.iam.gserviceaccount.com'\r\nERROR: (gcloud.iam.service-accounts.keys.create) PERMISSION_DENIED: Permission iam.serviceAccountKeys.create is required to perform this operation on service\r\n account projects/-/serviceAccounts/projectowner@gpii2test-common-stg.iam.gserviceaccount.com.\r\nFATA[0001] exit status 1\r\nrake aborted!\r\nCommand failed with status (1): [\r\n    docker-compose run --rm --service-por...]\r\n/Users/stepan/Projects/gpii/gpii-infra/gcp/rakefiles/entrypoint.rake:108:in `block in <top (required)>'\r\n/Users/stepan/Projects/gpii/gpii-infra/common/rakefiles/entrypoint-common.rake:25:in `block in <top (required)>'\r\nTasks: TOP => set_current_project => secrets/kube-system/owner.json\r\n(See full trace by running task with --trace)\r\n```\r\n\r\nThe permission error is misleading, problem is that the service account does not exist (and does not get created), the user has permission to create both service account and a new key.\r\n\r\nThe account is not there:\r\n```\r\ngcloud iam service-accounts list --project gpii2test-common-stg\r\nListed 0 items.`\r\n```\r\n\r\n",
                "I have one issue I'm hitting when running `rake apply_projects`:\r\n```\r\n* google_project_iam_binding.project: Error applying IAM policy for project \"gpii2test-gcp-stg\": Error setting IAM policy for project \"gpii2test-gcp-stg\": go\r\nogleapi: Error 400: Request contains an invalid argument., badRequest\r\n```\r\n\r\nThe issue is when trying to set `ops@raisingthefloor.org` as `roles/owner` in IAM policy. Owner role can only be taken by service account or user (see https://cloud.google.com/resource-manager/reference/rest/v1/projects/setIamPolicy).\r\n\r\nA solution is to remove `group:ops@raisingthefloor.org` from `modules/gcp-project/main.tf`, this kind of permission should be inherited from org anyway, so not needed.",
                "Another error I hit is `Error 403: Permission denied` when creating the NS record for the project. The error output is following:\r\n```\r\n* google_dns_record_set.ns-root: 1 error(s) occurred:\r\n\r\n* google_dns_record_set.ns-root: Error retrieving record sets for \"gcp-test1-gpii-net\": googleapi: Error 403: Permission denied on resource project gpii2test-gcp-common-stg., forbidden\r\n\r\nTerraform does not automatically rollback in the face of errors.\r\nInstead, your Terraform state file has been partially updated with\r\nany resources that successfully completed. Please address the error\r\nabove and apply again to incrementally change your infrastructure.\r\n\r\n\r\n[terragrunt] [/project/live/stg/infra/stg/zone] 2018/08/23 16:20:58 Module /project/live/stg/infra/stg/zone has finished with an error: Hit multiple errors:\r\nexit status 1\r\n[terragrunt] 2018/08/23 16:20:58 Encountered the following errors:\r\nHit multiple errors:\r\nexit status 1\r\nFATA[0021] exit status 1\r\nrake aborted!\r\nCommand failed with status (1): [docker-compose run --rm --service-ports xk...]\r\n```\r\n\r\nStrangely when impersonating the `projectowner@gpii2test-common-stg.iam.gserviceaccount.com` service account, via `gcloud auth activate-service-account` and creating the DNS record manually, everything works as expected.\r\n\r\n",
                "I still do get the \"Error retrieving App Engine application\" error mentioned above.\r\n\r\nAlso I see some flapping of services being enabled/disabled on subsequent runs:\r\n```\r\ngoogle_project_services.project: Modifying... (ID: gpii2test-gcp-stg)\r\n  services.#:          \"8\" => \"6\"\r\n  services.1568433289: \"oslogin.googleapis.com\" => \"oslogin.googleapis.com\"\r\n  services.1633256984: \"appengine.googleapis.com\" => \"appengine.googleapis.com\"\r\n  services.1954675454: \"serviceusage.googleapis.com\" => \"\"\r\n  services.2240314979: \"compute.googleapis.com\" => \"compute.googleapis.com\"\r\n  services.2928564140: \"dns.googleapis.com\" => \"dns.googleapis.com\"\r\n  services.3237295688: \"monitoring.googleapis.com\" => \"monitoring.googleapis.com\"\r\n  services.3355193353: \"logging.googleapis.com\" => \"logging.googleapis.com\"\r\n  services.3875785048: \"storage-api.googleapis.com\" => \"\"\r\n```\r\n\r\nAlso this will fight with services required for Kubernetes cluster, as when actual GKE cluster is created, it will enable several additional services and when this code is run, it'll try to disable those again.\r\n\r\nPreviously I ended up requiring all these services to be enabled on projects for GKE to work:\r\n```\r\n  services = [\r\n    \"compute.googleapis.com\",\r\n    \"container.googleapis.com\",\r\n    \"cloudbilling.googleapis.com\",\r\n    \"cloudresourcemanager.googleapis.com\",\r\n    \"dns.googleapis.com\",\r\n    \"iam.googleapis.com\",\r\n    \"serviceusage.googleapis.com\",\r\n    \"storage-api.googleapis.com\",\r\n    \"oslogin.googleapis.com\",\r\n    \"bigquery-json.googleapis.com\",\r\n    \"containerregistry.googleapis.com\",\r\n    \"pubsub.googleapis.com\",\r\n    \"deploymentmanager.googleapis.com\",\r\n    \"replicapool.googleapis.com\",\r\n    \"replicapoolupdater.googleapis.com\",\r\n    \"resourceviews.googleapis.com\",\r\n  ]\r\n``` ",
                "\ud83d\udc4d Looks good, I was able to run it without any errors this time. Yeey!\r\n\r\nTwo questions/concerns:\r\n- How should we behave when deleting environment? Currently, after I created a new project (folder in `common/live/stg/infra/dev/`), ran `rake apply_infra`, and deleted the project afterwards, the automation just stops caring about it when you run `rake apply_infra` again, and all the resources are left hanging there.\r\n\r\n- Is this expected to work with current gcp code that actually creates the cluster? (I haven't tried that yet)",
                "All looks good, after importing the DNS zone via `terragrunt import module.gke_network.google_dns_managed_zone.dns_zones dev-gcp-test1-gpii-net` I was able to successfully create cluster. \ud83d\udc4d ",
                "I keep hitting (even after retrying) following error with the latest version of the code:\r\n\r\n```\r\nError: Error refreshing state: 1 error(s) occurred:\r\n\r\n* google_dns_managed_zone.project: 1 error(s) occurred:\r\n\r\n* google_dns_managed_zone.project: google_dns_managed_zone.project: Error reading DNS Managed Zone \"dev-gcp-test1-gpii-net\": googleapi: Error 403: Google Cloud DNS API has not been used in project 170800538300 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/dns.googleapis.com/overview?project=170800538300 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry., accessNotConfigured\r\n\r\n\r\n[terragrunt] [/project/live/stg/infra/dev/billy] 2018/09/03 11:54:35 Module /project/live/stg/infra/dev/billy has finished with an error: Hit multiple errors:\r\nexit status 1\r\n```\r\n\r\nand it looks like that at this stage the DNS api is indeed not enabled on the porject:\r\n```\r\n$ gcloud --project gpii2test-gcp-dev-joe services list\r\nNAME                          TITLE\r\nbigquery-json.googleapis.com\r\ncloudbilling.googleapis.com\r\ncompute.googleapis.com\r\noslogin.googleapis.com\r\npubsub.googleapis.com\r\nserviceusage.googleapis.com\r\nstorage-api.googleapis.com\r\n```",
                "@stepanstipl the task `destroy_infra` disables the DNS API. That was the error that I got if I try to destroy the infrastructure before I deploy all the stuff. As we discussed in our previous meeting: the task `destroy_infra` is broken. Use only the task `destroy` (which doesn't touch the access to the APIs) to remove the most expensive resources of GCP, and leaving the DNS registries and the APIs enabled among other things.\r\n\r\nYou can workaround your issue going to the url that is indicated in the error message. It will enable the DNS API again.",
                "Oh sorry if this wasn't clear, this happens when running the `rake apply_infra` of the common part.",
                "Looks good (after enabling the DNS api), but now the latest version of code fails on:\r\n\r\n```\r\n$ rake apply_infra                                                                                                                                                                                     \r\nrake aborted!\r\nLoadError: cannot load such file -- /Users/stepan/Projects/gpii/gpii-infra/shared/rakefiles/test.rake\r\n\r\n(See full trace by running task with --trace)\r\n```",
                "@stepanstipl I left behind the test.rake file in the last merge",
                "\ud83d\udc4d last version seems to run ok!",
                "Github won't let me reply to [this thread](https://github.com/gpii-ops/gpii-infra/pull/60#discussion_r214666740).\r\n\r\nIn https://github.com/gpii-ops/gpii-infra/pull/60#discussion_r213119778 I suggested deleting `Vars. create_directory_if_not_exists` since nothing calls it.\r\n\r\nMy comment in https://github.com/gpii-ops/gpii-infra/pull/60#discussion_r214666740 was suggesting to also delete the test for `Vars. create_directory_if_not_exists`.\r\n\r\nI hope this clears things up.",
                "Github won't let me reply to [this thread](https://github.com/gpii-ops/gpii-infra/pull/60#discussion_r214666689).\r\n\r\n> the file xk.rake is the only rake file used inside the Docker container, the task :configure_current_project is defined in the entrypoint.rake. Do you think that is worth to merge these two files?.\r\n\r\nNot merged, but you could follow the [existing pattern](https://github.com/gpii-ops/gpii-infra/blob/master/gcp/rakefiles/entrypoint.rake#L75).",
                "Latest version works fine for me. I still have the question re. deleting projects - any thoughts on how this should work? (check one of my previous comments for details)",
                "I've noticed a lot of errors like the one below on the cluster created in the project created by this code:\r\n\r\n```\r\nE0906 14:33:27.288832       1 stackdriver.go:58] Error while sending request to Stackdriver googleapi: Error 403: Stackdriver Monitoring API has not been used in project 170800538300 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/monitoring.googleapis.com/overview?project=170800538300 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry., accessNotConfigured\r\n```\r\n\r\nLooks like we're missing Stackdriver API. The errors are from `prometheus-to-sd-exporter`.",
                "Again, first 2 times I run `apply_infra` I got the old error:\r\n```\r\n[terragrunt] [/project/live/stg/infra/dev/billy] 2018/09/10 15:24:56 Module /project/live/stg/infra/dev/billy has finished with an error: Cannot process module Module /project$\r\nlive/stg/infra/dev/billy (dependencies: [/project/live/stg/infra/dev/zone]) because one of its dependencies, Module /project/live/stg/infra/dev/zone (dependencies: [/project/li\r\nve/stg/infra/dns-root]), finished with an error: Hit multiple errors:\r\nexit status 1\r\n\r\nError: Error refreshing state: 1 error(s) occurred:\r\n\r\n* google_project_services.project: 1 error(s) occurred:\r\n\r\n* google_project_services.project: google_project_services.project: failed to list services: Get https://serviceusage.googleapis.com/v1beta1/projects/gpii2test-gcp-prd/services\r\n?alt=json&fields=services%2Fname%2CnextPageToken&filter=state%3AENABLED: dial tcp [2a00:1450:4009:801::200a]:443: connect: cannot assign requested address\r\n```\r\n\r\nand after that it works fine :) and I'm unable to reproduce the error in any way. Otherwise looks good.",
                "Since we agreed to try to merge and deploy this PR tomorrow (Tuesday) at 1000 MDT, I propose:\r\n\r\n1. @amatas, please address as many of my review comments as you can by 0800 MDT tomorrow.\r\n2. I'll get online by 0800 MDT to review these changes.\r\n3. Once we get those out of the way, we can discuss anything remaining from the \"more significant changes\" pile.\r\n4. Based on that discussion, we can make a go/no-go decision (\"Alfredo already made all the needed changes and/or we can make them together real quick and/or we decided they weren't needed\" vs \"Alfredo needs more time to implement the new CI strategy we worked out\") by 0900 MDT when we have a meeting unrelated to this deployment.\r\n5a. If we reach a \"go\" decision, we start deploying after the 0900 meeting, hopefully around 1000 MDT.\r\n5b. If we reach a \"no-go\" decision, re-schedule deployment for Wednesday or Thursday.",
                "LGTM!!",
                "@amatas This looks very close to being merged! Please check my last bunch of comments!",
                "Related to Sergey's comments (and more in Slack), I've hit an issue with `rake sh` behaving differently (not setting up secrets mgmt) in this branch, compared to the master.",
                "@stepanstipl @natarajaya about the `rake sh` and the secrets mgmt, I just wanted a way to get a shell inside the container without running too much stuff at the invocation. I'm open to any other alternative to get this.\r\nWhat if you run `rake sh[bash]`? I think that the entry command will run all the rake stuff that you need as it is implemented on master."
            ],
            "commits": [
                "641c00698244ef82a493e4c2b6b85cd30708d3be",
                "72fe31278e7e05c81f8446e60f7e7c1490fe4042",
                "323370ed85746b864e4a277f544530f334c5f2ba",
                "5b6e9ffffa7ddd7e148eeb78c64a9f0b02c2cb68",
                "e39981dcf045868828c39636091797e48fbd1bf3",
                "aa67c704f5b2a549eab7e9017a40eff3a6997fbc",
                "fb640b488699d222502ac8cdd5e75b2847f13cbd",
                "cbfc1616aeae656d27ccbbb6ae10d3d543518046",
                "2d13556d4825bcb515cfbbb889e9f18aae938137",
                "50e55d74bb9aebd365ad879aab21cb4cabc7a8c0",
                "4b25c2181ef7594277dcede98952bc09bac2fc1e",
                "75629562dc52c70b83bdcab93e50bd8a53cdcd3e",
                "bf9bebb12840f2f65ceafb0338e065e7e65e8aca",
                "7f777cfdd8cb3822afb466731810a4190d4a3686",
                "2324cf9fa1ad47f7fbee48cdf0188fc801698ae7",
                "39216be757cb30777065d5f64970d27200a5786b",
                "dbecd2cd57fc2312e795a4174605004c05d3aee6",
                "d932986af0d7b2c948661c148790074568dec339",
                "7c9fa2b30d117b79cc315db02e841287c390b21b",
                "4e886fd12280369f57f7c7218d35f4f31d1740ec",
                "f55f81aa61b515a37ecff4113829739ed54eaa01",
                "dfd93b1c84670d920f688ce0dba70aefecd44b00",
                "c09bd448064dbd92e010d46c300de270c4cdbdde",
                "52de7f7cdea67d15b46da72d7a9f7aeece7c1d92",
                "65a8f02d1e2f6dc99c704c45271a988f4944a841",
                "a1e9ba46ea164696ea051887b7ae9a0e58ed2447",
                "903daeaac11641c6ea121eb0bf2038fb98db96a4",
                "85e20a214c020ae7d173d30ca4a86d1c81765671",
                "570ecb65687c5006d2cfb2304e71f5c6d304eb08",
                "b15ee47133a236909c7c3e974d46b7f738391ab3",
                "c9d8c0c3f5be669d82c98d3ff88f10be9601742e",
                "9e62a085486ffe49f47629c683965d750c153577",
                "4578d7f217ba98394e751f5e83e3dce74fd32411",
                "d9b726573ba12304c6aa2921a289ea4745af1b5a",
                "568c307cc34c85d7186130db4b2a5098a131e12e",
                "df3e2279610cecb72ae2b83a46dc992d444ab889",
                "e31a42b2390ed9e04e96e987360f72520c8c22bc",
                "6e047f070969ebeab9a15d3e23a342b758c2f007",
                "b3392466123f23074d19e390d03591e49c1e3540",
                "fff1ca87194cc07a9f09afc3c00502a4ce88cc6a"
            ]
        },
        "codes": [
            "awareness",
            "cluster"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/gpii-ops/gpii-infra/pull/429",
        "content": {
            "title": "[GPII-3868]: Fixes for Stackdriver Trace",
            "body": "This solution fixes Stackdriver Trace by providing SA credentials for `cloud-trace-nodejs` plugin for `universal`.\r\nIt does not require legacy metadata API to retrieve tokens, but stores SA credentials as K8s secret to mount into GPII containers instead.\r\n\r\nThere are couple things that can be improved here:\r\n* SA key rotation \u2013 does not seem like TF's [google_service_account_key](https://www.terraform.io/docs/providers/google/r/google_service_account_key.html) resource is capable of this. There are couple validity attributes, but that functionality is unclear and needs to be tested.\r\n* Duplicating Istio's VirtualService and ServiceEntry resources for egress traffic in every chart. But the only way to apply them outside of Helm I can think of is with raw `kubectl` commands, so I don't think thats better.",
            "comments": [
                "I think we discussed pros and cons. I think it's good as a \"temporary\" solution.\r\n\r\nI would still propose creating dedicated GCP svc accounts for each of the workloads (preferences & flowmanager), then the code managing the service keys could live in corresponding `gpii-*` module and module `gpii-istio` can stay as it is. Apart from code organisation perspective, this would also make sense from a security perspective, as flowmanager is directly accessed from the internet, while preferences are not.",
                "LGTM\r\n\r\nWe discussed in standup today but to summarize a few points:\r\n* I think this is good as a temporary fix. Let's get tracing working again, then figure out what else to do.\r\n* Ideally, Google would fix the bug in the nodejs tracing library and/or the metadata API and/or the metadata proxy and/or whatever other contributing system. If they fix their systems, we can remove all these workarounds, and would prefer to have invested the least amount of effort in the workarounds.\r\n* However, we don't know when Google will fix this issue, and introducing static credentials into our infrastructure in this way is not awesome, as Stepan points out. So Sergey will continue investigating other options (TF-level key rotation, Stepan's CronJob secret rotation proposal) for a bit.",
                "I think this looks quite good, the part I'm not happy about is static credentials being generated and stored across various places in the system.\r\n\r\nWhat about a slight variation on this: as we already have a mechanism to assign individual GCP service accounts to pods (via annotations), it should be possible to only generate the `/etc/credentials/credentials.json` on the fly, for example with init container. Once the pod would start, init container would use `gcloud iam service-accounts keys create` to generate a new key and save it to in-memory volume.",
                "@stepanstipl I have the same concern about static credentials, however, I can think of relatively low-cost solution to seamlessly rotate them with TF's `null_resource` and `gcloud`.\r\n\r\n> Once the pod would start, init container would use gcloud iam service-accounts keys create to generate a new key\r\n\r\nBut `gcloud` itself needs credentials to run \u2013 am I missing something here?",
                "> But gcloud itself needs credentials to run \u2013 am I missing something here?\r\n\r\nBut `gcloud` can handle metadata correctly. So once you add the `traffic.sidecar.istio.io/excludeOutboundIPRanges` annotation to allow traffic to metadata, `gcloud` has credentials available:\r\n\r\n```\r\n$ gcloud auth list\r\n                           Credentialed Accounts\r\nACTIVE  ACCOUNT\r\n*       gke-cluster-pod-default@gpii-gcp-dev-stepan.iam.gserviceaccount.com\r\n\r\nTo set the active account, run:\r\n    $ gcloud config set account `ACCOUNT`\r\n\r\n$ gcloud projects list\r\nPROJECT_ID           NAME                 PROJECT_NUMBER\r\ngpii-gcp-dev-stepan  gpii-gcp-dev-stepan  374774757640\r\n```\r\n\r\nAnd we even have the mechanism to assign specific service account to pods - via the `accounts.google.com/service-account` annotation.\r\n\r\n-> So no static credentials.\r\n\r\nSo perhaps creating dedicated svc. account with extra permissions to generate keys for itself might work.",
                "> And we even have the mechanism to assign specific service account to pods - via the accounts.google.com/service-account annotation. So no static credentials.\r\n\r\n@stepanstipl But there would still be static credentials, your proposal just handles them on K8s level instead of TF level.\r\n\r\n> I would still propose creating dedicated GCP svc accounts for each of the workloads (preferences & flowmanager), then the code managing the service keys could live in corresponding gpii-* module and module gpii-istio can stay as it is\r\n\r\nAgreed and agreed. Another complication of renaming module that contains K8s resources \u2013 TF not always can handle this gracefully. In this case TF would try to recreate `kubernetes_namespace` declared in `gpii-istio` and fail unless it is manually imported into new module's TF state. So I am more than happy to leave `gpii-istio` as it is.\r\n",
                "OK, thanks @natarajaya. Looks good to me \ud83d\udc4d \r\n\r\nPlease try to avoid using \"force-push\" once the code is in PR and has been reviewed -> this breaks most of the GitHub review functionality (like view changes since the last review) and makes it much harder for the reviewers to track the evolution of code.",
                "LGTM, \r\nI reviewed your comments and the log of the pad of yesterday. How can we track Google's fixing of the tracing library, a ticket? a comment in this code?",
                "Thanks for all the reviews!\r\n\r\n* This is ready to be merged as a straightforward solution to get tracing working while metadata issue is still affecting GKE. \r\n* I tried Stepan's proposal to handle SA credentials on K8s level, but since `trace-agent` is incapable of handling credentials rotation on the fly, this does not seem to be feasible, so we don't have an alternative atm.\r\n* I think we can keep this long-term (worst case scenario in case it takes a long time for Google to address metadata issues) if we implement a way to rotate SA credentials used by deployments (proposed in #435).\r\n\r\n> Please try to avoid using \"force-push\" once the code is in PR and has been reviewed -> this breaks most of the GitHub review functionality (like view changes since the last review)\r\n\r\n@stepanstipl No worries, I am well aware of that \u2013 accidentally pushed bunch of commits into wrong branch late at night. I don't think it affects this PR in any way since it is ready to be merged.\r\n\r\n> How can we track Google's fixing of the tracing library, a ticket? a comment in this code?\r\n\r\n@amatas It is in the ticket and in the PR with metadata issues (#430).\r\n",
                "> - I tried Stepan's proposal to handle SA credentials on K8s level, but since trace-agent is incapable of handling credentials rotation on the fly, this does not seem to be feasible, so we don't have an alternative atm.\r\n> - I think we can keep this long-term (worst case scenario in case it takes a long time for Google to address metadata issues) if we implement a way to rotate SA credentials used by deployments (proposed in #435).\r\n\r\nSo these are two separate issues:\r\n- Where to handle the issuance of the credentials - in or outside of the kube cluster\r\n- And the credentials rotation\r\n\r\nAs it turned out the predicate our previous conversation was based on, that the app will notice the change of credentials without restart, is not true. \r\n\r\nThis means that should we want to rotate the credentials we have to restart the pods - yet this can still be done in or outside of the cluster. I think this further emphasizes that trying to work around this on higher-level instead of fixing the underlying problem is not a sustainable approach (more about that in #435).\r\n",
                "@natarajaya one thing that occurred to me, as you tracked this down to be http header issue - have you tried how this behaves with the new GKE Workload Identity? https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity",
                "@stepanstipl This duplicates conversation from #435, let's keep it there.",
                "I did try to enable GKE Workload Identity on 1.12 cluster and tracing seems to work out of the box. Please see #435 for details and my proposal on how to go on about this.",
                "@stepanstipl I was able to finally track down the real reason of metadata issues to `service-account-assigner`! More details [here](https://github.com/gpii-ops/gpii-infra/pull/435#issuecomment-508883780).",
                "Update: I was able to fix `service-account-assigner` to always add `Metadata-Flavor` header to its responses and now have trace working in my dev cluster without SA credentials!",
                "Ok, so what remains from the changes proposed in this PR:\r\n* Istio service entries to allow egress to trace API for flowmanager and preferences.\r\n* Annotations for flowmanager and preferences deployments to enable off-mesh egress to metadata.\r\n* Reformatted flowmanager and preferences chart READMEs.\r\n\r\nMaybe I should've cherry-picked them to new branch and opened separate PR? But at the same time they are not hard to review from scratch and history may still be useful...\r\n\r\nWhat is still missing:\r\n* Versions file needs to be updated with new `service-account-assigner` tag once https://github.com/gpii-ops/k8s-gke-service-account-assigner/pull/2 and `docker-image-service-account-assigner` PRs are merged.",
                "So currently there seems to be issue with the `ServiceEntry` breaking egress traffic - see https://issues.gpii.net/browse/GPII-4015 for details.\r\n\r\nOtherwise looks good, pity you didn't keep the dedicated SVC accounts around at least on Kube level - I thought that was still a good imrpovement.",
                "@stepanstipl With VirtualServices added to preferences and flowmanager charts, I am still able to reproduce Locust issues from GPII-4015.\r\n\r\nHowever, it took me 4 consecutive `rake destroy && rake && rake test_flowmanager` runs, and on 5th run tests went smoothly again.\r\n\r\nSo I propose to merge this as it is, in case we see Locust issues in CI \u2013 we have plan B, upgrade to 1.13 with Istio 1.1 (#450).\r\n",
                "> So I propose to merge this as it is, in case we see Locust issues in CI \u2013 we have plan B, upgrade to 1.13 with Istio 1.1 (#450).\r\n\r\nThanks @natarajaya. Sounds good. I agree with the plan, the VS definitions look correct."
            ],
            "commits": [
                "cab245db9ff8f08d62ed04426c48611305984963",
                "5a4683f90c5856b8f9b5592b25647fdddb82fadd",
                "e9e47dee9b6a8e9802aa4879e969828818d8dd6c",
                "81cd7fd2aabe5d22b8cd4bed065a77ae74331808",
                "2efdc4cf111546e88e833901ef264b0a0d976388",
                "9bb988024cec9fe6e4ad97750fff7efa5be20cfc",
                "ec65c180d4b1b1ec506082acba9aabb667ad0390",
                "b37878688b99dc5bf17aabdcfc6f9b3878f0e86f",
                "07e96beda302e1e7993d8b40127bc838b7e80a02",
                "125590b735e01c56dd6e3ff44a45bb0543da58a5",
                "674b83490e2629ce04f779146b6f718249520dd2",
                "5ffc297fc930fb8ec8b3dc18ef2cb0fd278f3faf"
            ]
        },
        "codes": [
            "unsure",
            "latest"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/gpii-ops/gpii-infra/pull/329",
        "content": {
            "title": "GPII-3707: Move keyring from global to infra_region",
            "body": "**Rendered docs: https://github.com/mrtyler/gpii-infra/blob/gpii-3707-regionalism/gcp/README.md**\r\n\r\nRequires https://github.com/gpii-ops/exekube/pull/49, which can be safely merged on its own.\r\n- [x] Merged and deployed\r\n\r\nI'm finalizing documentation and the rollout plan but I think I'm done with the implementation, hence no WIP label.\r\n\r\n### Changes\r\nI tried to make targeted commits but there was a hard-to-remove detour where I thought I needed to change the Keyring name based on Region. Anyway, the main themes, ordered roughly by batches of commits:\r\n\r\n1. Small cleanups, including removing Stepan's hack for GPII-3568. I think Stepan is removing that in one of his in-flight branches, but it was causing me trouble so I removed it here as well.\r\n2. Refactor secrets.rb and its call sites in rake land. Use Keyrings in `infra_region` instead of `global`. Add some basic unit tests. I'm not a huge fan of classes but:\r\n   * This is a classic use case for a class: data bundled with methods for working with that data\r\n   * Dealing with environment variables in unit tests is kind of annoying (see vars_spec.rb).\r\n   * I think instance variables (set via constructer parameters) are a more natural fit than environment variables, and they declutter the rake file a bit compared with passing things like `project_id` in every time.\r\n3. Add some helpers to facilitate migration from the global keyring, and for moving between regions.\r\n\r\n### Alternative approach\r\nMy main goal was to enable us to run GPII Cloud environments in any region. I have been able to do that in my tests, but the current approach has some downsides:\r\n* It requires some extra `terraform import` steps because KMS Keyrings are indestructible and Keys have an unusual lifecycle\r\n   * I think moving from region to region will be rare in practice\r\n   * I've added some rudimentary automation for this, `rake import_keyring`\r\n* Each environment has a single tfstate bucket in Multi-Region `US`, no matter in which Region the environment really runs\r\n\r\nI have considered, but not yet tested, an alternative approach with a tfstate bucket in each region where we might wish to run an environment. This avoids the `terraform import` steps because tfstate in us-east1 can always point to the keyring in us-east1. I haven't pursued this avenue because:\r\n* We need to migrate off of `global` Keyrings regardless, so something like this PR and its rollout plan will be necessary\r\n* tfstate buckets are managed by common, so we'd need to create them ahead of time for each environment X region we want to have available\r\n* Multiple tfstate buckets would allow (in fact, require) `apply_infra` resources (e.g. VPCs, public IPs) in each Region. This is a small waste and a small amount of extra clutter\r\n* Multiple tfstate buckets would allow users to accidentally run two environments at once (e.g. one in us-east1, one in us-central1)\r\n* DNS is still a singleton. The default behavior with multiple tfstate buckets would be \"last one wins\", which is not so bad but nonetheless adds a potential source of confusion.\r\n\r\n### Exported logs\r\nWe have a decision to make about existing exported logs for stg and prd:\r\n1. Delete them - how much value do they have?\r\n1. Leave them alone - it is theoretically possible to decrypt and read the logs later as long as we are careful not to destroy the global Key used to write them\r\n1. Re-encrypt them in place - this is the safest, but most expensive option\r\n   * I think we can use a modified version of `rotate_tfstate_key` to accomplish this, but I haven't tested it yet.\r\n- [x] Decided to keep prd logs\r\n\r\n### Rollback plan\r\nThe basic idea is to undo the rollout by re-importing the `global` Keyring and Keys and re-encrypting data using the Old Keys. The steps here are for pointing the environment back to the Old Keyring. Other steps may be needed as well, depending on when the rollout was abandoned.\r\n\r\n1. Revert this PR (i.e. go back to Old version of code)\r\n   * The associated Exekube PR and resulting image may remain\r\n1. Update gpii-infra to Old version\r\n1. `cd gpii-infra/gcp/live/dev`\r\n1. `rake sh`\r\n1. `unset GOOGLE_ENCRYPTION_KEY`\r\n1. `cd /project/live/$ENV/secret-mgmt`\r\n1. Replace the New Keyring and Keys with the Old Keyring and Keys:\r\n```\r\nterragrunt state rm module.gcp-secret-mgmt.google_kms_key_ring.key_ring\r\nterragrunt import module.gcp-secret-mgmt.google_kms_key_ring.key_ring projects/$TF_VAR_project_id/locations/global/keyRings/keyring\r\nterragrunt state rm module.gcp-secret-mgmt.google_kms_crypto_key.encryption_keys[0]\r\nterragrunt import module.gcp-secret-mgmt.google_kms_crypto_key.encryption_keys[0] projects/$TF_VAR_project_id/locations/global/keyRings/keyring/cryptoKeys/default\r\nterragrunt state rm module.gcp-secret-mgmt.google_kms_crypto_key.encryption_keys[1]\r\nterragrunt import module.gcp-secret-mgmt.google_kms_crypto_key.encryption_keys[1] projects/$TF_VAR_project_id/locations/global/keyRings/keyring/cryptoKeys/gcp-stackdriver-export\r\n```\r\n\r\n### Rollout plan\r\n- [x] Complete migration steps (below) for dev-doe (skipping some steps since dev-doe is an ephemeral cluster), which will be deployed into a new region (us-east4) as a test case\r\n- [x] Notify cloud-developers of required actions (see below)\r\n- [x] Merge this PR, which will eventually run CI for dev-doe.\r\n- [x] Verify everything looks correct. In particular, look out for changes to Keyrings and changes to the tfstate bucket as part of common-stg\r\n- [x] Complete migration steps (below) for stg\r\n- [x] Promote common-prd\r\n- [x] Verify everything looks correct in stg\r\n   * plan-all in prd will fail, because migration steps haven't run there yet\r\n- [x] Complete migration steps (below) for prd\r\n- [x] Re-run plan-all in prd. Verify everything looks correct\r\n- [x] Promote prd\r\n- [x] Re-encrypt prd's exported logs (see below)\r\n\r\n#### Migration steps\r\n\r\n\"Old\" refers to the tip of master / the latest deployed infrastructure from before this PR (i.e. with Keyrings and Keys in the \"global\" Region). \"New\" refers to code / infrastructure after this PR is merged.\r\n\r\n1. Update to latest version of gpii-infra\r\n1. `cd gpii-infra/gcp/live/dev`\r\n1. `rake update_exekube`\r\n1. Replace the Old Keyring and Keys with the New Keyring and Keys:\r\n   * `TF_VAR_decrypt_with_key_from_region=global rake import_keyring`\r\n   * EDIT: This didn't work in stg (and won't in prd) because there is no Keyring to import from us-central1. So we must create it.\r\n      * Manually run `terragrunt state rm` commands to prevent globaly Kerying and Keys from being destroyed\r\n      * Use the `terragrunt plan` steps below to verify that ONLY new Keyring and Keys are CREATED (no Old buckets or Keys destroyed)\r\n      * Run `terragrunt apply`\r\n1. Verify that `terragrunt plan` doesn't want to make any changes\r\n   * `TF_VAR_decrypt_with_key_from_region=global rake sh` and then inside shell:\r\n   * `unset GOOGLE_ENCRYPTION_KEY`\r\n   * `cd /project/live/$ENV/secret-mgmt`\r\n   * `terragrunt plan`\r\n   * Exit shell\r\n1. `TF_VAR_decrypt_with_key_from_region=global rake rotate_secrets_key`\r\n1. `rake rotate_secrets_key\"[gcp-stackdriver-export]\"`\r\n1. `rake` (perhaps via CI)\r\n   * Should be mostly a no-op.\r\n1. Fix encryption for exported logs bucket (see below)\r\n1. Verify logs exported both before and after the migration are readable\r\n   * [Go to bucket](https://console.cloud.google.com/storage/browser/gpii-gcp-prd-exported-logs?project=gpii-gcp-prd&authuser=1&organizationId=247149361674)\r\n   * Navigate to some Old logs. Verify that you can view them (no KMS error)\r\n   * Navigate to some New logs -- you may have to wait up to an hour for new logs to be exported. Verify that you can view them (no KMS error)\r\n1. Disable (do *NOT* destroy!) Keys in `global` Keyring\r\n\r\n#### Email to cloud-developers\r\n```\r\nSubject: New regions available for dev envs (action required)\r\n\r\n\r\nHi cloud developers,\r\n\r\nGood news: It is now possible to create a dev environment in any Google Cloud region![1][2] Instructions are here:\r\nhttps://github.com/gpii-ops/gpii-infra/blob/master/gcp/README.md#i-want-to-spin-up-my-dev-environment-in-a-different-region\r\n\r\nBad news: You must take action -- even if you are happy to stay in your current region -- to keep your cluster up-to-date. (Please do this migration separately, before trying out a new region. :))\r\n\r\nIf you are able to destroy your environment, the process is pretty standard:\r\n* `cd gpii-infra/gcp/live/dev`\r\n* `rake destroy`\r\n* Update gpii-infra to latest master\r\n* `rake update_exekube`\r\n* `rake destroy_hard`[3]\r\n* `rake`\r\n\r\nIf you are not able to destroy your environment, you can safely migrate an existing environment. It's a little more complex, so you may want to consult Ops before pursuing this route:\r\n* See \"Rollout plan: Migration steps\" in https://github.com/gpii-ops/gpii-infra/pull/329.\r\n\r\nPlease ping us in #ops if you have questions or any trouble!\r\n\r\nThanks,\r\nthe ops team\r\n\r\n\r\n[1] I haven't tested anything outside of the US. Who will spin up the first GPII Cloud in Europe??\r\n\r\n[2] Some infrastructure (the GCS Bucket where Terraform keeps its state) remains in the `US` multi-region.\r\n\r\n[3] `destroy_hard` is a new helper command for destroying even more stuff related to your environment, like Terraform state and secrets.\r\n```\r\n\r\n#### Re-encrypt exported logs\r\n1. After the migration step `rake rotate_secrets_key\"[gcp-stackdriver-export]\"`, New exported logs will be readable, but Old exported logs will not. This is because Terraform deletes the IAM binding that allows GS to access the Old Key when adding the IAM binding for the New Key.\r\n1. Manually add a binding for the Old Key:\r\n   * `rake sh`\r\n   * Get the appropriate Serviceaccount user and Role from the New Key:\r\n      * `gcloud kms keys get-iam-policy --location $TF_VAR_infra_region --keyring keyring gcp-stackdriver-export`\r\n   * Use this info to add the same binding to the Old Key:\r\n      * `gcloud kms keys add-iam-policy-binding gcp-stackdriver-export --location global --keyring $TF_VAR_keyring_name --member serviceAccount:service-111111111111@gs-project-accounts.iam.gserviceaccount.com --role roles/cloudkms.cryptoKeyEncrypterDecrypter`\r\n1. Rewrite everything in the exported logs bucket using the New Key:\r\n   * `gsutil -m rewrite -r -k gs://${TF_VAR_project_id}-exported-logs`\r\n1. Remove manually added binding\r\n   * `gcloud kms keys remove-iam-policy-binding gcp-stackdriver-export --location global --keyring $TF_VAR_keyring_name --member serviceAccount:service-111111111111@gs-project-accounts.iam.gserviceaccount.com --role roles/cloudkms.cryptoKeyEncrypterDecrypter`",
            "comments": [
                "Looks good, kudos for the tests & like like the refactor.\r\n\r\n> I'd like to move forward with the current design. No matter what we do with the tfstate bucket, we will do it in a separate PR as I think this PR already has enough moving parts.\r\n\r\nMakes sense. I would still consider unique names for keyrings (I think it'll make our lives easier).",
                "Thanks for thorough description \ud83d\udc4d, it helps ;). I'm commenting on the text of PR only so far:\r\n\r\n> an alternative approach with a tfstate bucket in each region where we might wish to run an environment\r\n\r\nWhat about creating the bucket in only the desired region (this would be parametrized in the common code) and then creating the cluster and all the resources in the corresponding region? (info about the region can be retrieved for example by using TF `remote_state`) That would avoid having unused resources and solve most/all the issues mentioned.\r\n\r\nIn general I would definitely prefer to have tfstate bucket in the same region as the rest of resources.\r\n\r\n> We have a decision to make about existing exported logs for stg and prd:\r\n\r\nAs discussed, I'm ok to loose log in non-prod env. For production I would try to preserve those - i think it should be achieveavble using `gsutil` - unless the old key material is destroyed. gsutil shoul be able to read those logs and by running `cp` save & reencrypt them with the new key/keyring (`gsutil cp` between 2 GCS buckets should work directly without actually pulling/pushing data via the node running the command).",
                "Stepan, I'm afraid I don't understand your suggestion:\r\n\r\n> What about creating the bucket in only the desired region (this would be parametrized in the common code) \r\n\r\nThere is no single \"desired region\". The goal of this feature is to make it possible to run infrastructure in any region. So AFAICT we must either \"migrate\" back and forth, updating tfstate each time, or we must have dedicated tfstate in each region.\r\n\r\n> and then creating the cluster and all the resources in the corresponding region? (info about the region can be retrieved for example by using TF remote_state) \r\n\r\nWe do (with this PR) create the cluster and all resources in the specified region (i.e. the value of `TF_VAR_infra_region`. The only thing that is hardcoded to us-central1 is the tfstate bucket itself.\r\n\r\n> That would avoid having unused resources and solve most/all the issues mentioned.\r\n\r\nI don't see how.",
                "Re: exported logs:\r\n\r\nDue to [an incident](https://pad.gpii.net/mypads/?/mypads/group/gpii-infrastructure-standups-lix4njm/pad/view/postmortems-but4nne#L255), we have already destroyed the exported stg logs.\r\n\r\nFor prd logs, we agreed to rewrite them and keep them. I am figuring out how best to do this.",
                "> There is no single \"desired region\". The goal of this feature is to make it possible to run infrastructure in any region. So AFAICT we must either \"migrate\" back and forth, updating tfstate each time, or we must have dedicated tfstate in each region.\r\n\r\nSo where I was going was that the tfstate region, and therefore the region for the cluster, would be specified in common code. That way you can create the bucket in the region where the cluster will land.\r\n\r\nSo you would still be able to have cluster in any region, but should you would want to change the region, you would have to rerun common.",
                "Passing the desired region to all the places that need it is not the problem. The problem is keeping tfstate files in sync with cloud resources. I also don't like forcing developers to ask for help if they want to change regions.\r\n\r\nI'd like to move forward with the current design. No matter what we do with the tfstate bucket, we will do it in a separate PR as I think this PR already has enough moving parts.",
                "LGTM, for now. \r\n\r\nI can not see very clear the advantages of having a bucket per region, and I can see some pain every time that we need to move from one to other. I would leave this PR as is, and see how we go. New approaches can be implemented in the future if we need them.",
                "> I would still consider unique names for keyrings (I think it'll make our lives easier).\r\n\r\nThis would avoid the need to import existing Keyrings when starting fresh. But Keyrings are indestructible, so we would accrue many discarded Keyrings over time. I think Sergey and I discussed this option and abandoned it for that reason.",
                "Ok, I've done more testing, fixed a couple bugs, and updated the docs and rollout plan. My plan is to deploy this tomorrow morning unless there are objections.\r\n\r\nThe last bit I need to work out is re-encrypting the exported logs. I don't think it will be a big deal, but I keep forgetting to test it before deleting my environment and all the exported logs in it :). This step is not in the critical path, so it can be delayed a bit while I get the rest of the changes out.",
                "Latest changes LGTM"
            ],
            "commits": [
                "7a46c9fe81fa8f5b3fe67961d64f3d7e866df6a4",
                "90199825fb5febbc170398e8a367344ea270547c",
                "a06a73d8b2a0ac72d3f935bd550d8180bd345e94",
                "8827fda2027d69831a8bbfea06956fd698920a8c"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/gpii-ops/gpii-infra/pull/39",
        "content": {
            "title": "GPII-2960: Fix for couchdb module to execute finish_cluster action after chart install",
            "body": "We are also missing persistent volumes, will create separate PR for that.",
            "comments": [
                "This looks pretty good. I'm pleased to see that you're doing the work at the exekube level, as close as possible to the problem.\r\n\r\nIs there a way to do all this directly with helm? That might be better -- helm is even closer to the problem than the exekube/terraform code -- but I'm not sure helm can handle this kind of thing.\r\n\r\nMy biggest question is around scaling the couchdb cluster dynamically. One of the main advantages of the (admittedly more complex) couchdiscover-based solution is that it could handle adding a new node to  the cluster dynamically. It doesn't look to me like this code could handle that scenario. Maybe @amatas has more thoughts on this.\r\n\r\nIIRC, couchdiscover can handle scaling **up** but not scaling **down**. (@amatas is my recollection correct?) If so, this is something to consider while comparing the two strategies.",
                "Re: timeouts: That's a bummer. And just to confirm, generic Terraform timeouts don't work? https://www.terraform.io/docs/configuration/resources.html#timeouts\r\n\r\nRe: assigning Pods to Nodes: my experience so far has been that Kubernetes is smart about spreading Pods amongst Nodes / amongst AZs. Maybe it will be different when we have more Nodes and/or more couchdb Pods than AZs.",
                "couchdiscover, add the nodes to the cluster and also \"finishes\" the couchdb cluster. Also it rebalances all the data along the nodes when a new node joins to the cluster. It also sets the Erlang cookie needed to the internal communication of the cluster.\r\n\r\nhttps://github.com/amatas/couchdiscover/blob/master/couchdiscover/couch.py#L469-L497\r\n\r\nThe [Couchdb Statefulset Assembler](https://github.com/kocolosk/couchdb-statefulset-assembler) seems to don't do the above. It only \"add\" the nodes to the cluster, it doesn't finish the cluster and neither rebalance the shards. It seems to me that it doesn't complete the [steps to create a cluster](http://docs.couchdb.org/en/latest/cluster/setup.html#the-cluster-setup-api). But perhaps this is not needed anymore with the latest version of the CouchDB Docker container.\r\n\r\nI'd do the following test:\r\n\r\n1. Create a cluster of at least 3 nodes.\r\n1. Load data into it, if it's possible while some of the node containers are in the \"starting\" state and the cluster is not finished. (The dataloader can start sending the data even if the cluster is not finished)\r\n1. Remove (or kill) random nodes and try to retrieve the same data from the rest of alive nodes.",
                "The scaling down using couchdiscover is not covered. If a node vanishes it won't be used until the next time that comes alive (the data, and the config is stored in the PV), the data will be also propagated and it will become online after that. The cluster reliability won't be affected while all the data is spread along the live nodes.",
                "@amatas @mrtyler Current `couchdb` Helm chart installs CouchDB 2.1.1 (latest) and uses [CouchDB StatefulSet Assembler](https://github.com/kocolosk/couchdb-statefulset-assembler/blob/master/mem3_helper.py) as sidecar.\r\n\r\nI performed a number of tests and found the following:\r\n- Immediately after pods become \"Running\" cluster enters `cluster_enabled` [state](http://docs.couchdb.org/en/2.1.0/api/server/common.html#cluster-setup). Which means that nodes are already in cluster and only system databases are missing.\r\n- If I keep cluster in this state and let `gpii-dataloder` to do its job, all docs of `gpii` database would be available from any of 2 nodes of the cluster.\r\n- It scales cluster up pretty well, new nodes appear as `cluster_nodes` in the output of [_membership](http://docs.couchdb.org/en/2.1.0/api/server/common.html#membership) query. All docs of `gpii` database become available from any node of the cluster after scaling. It does NOT rebalance shards (so it probably makes sense to have one replica of stateful set per node?).\r\n- Scaling cluster down not covered.\r\n\r\nSo looks like the only differences between `couchdiscover` solution is that `couchdisover` rebalances shards after scaling the cluster (though I was not able to find that functionality in their docs).\r\n\r\nI could think of moving this fix from Terraform level to Helm level, as a Kubernetes `Job`. But there is no straightforward way to get statuses of other pods from inside of a pod, to determine if couchdb cluster nodes are ready. Of course we could just run `finish_cluster` action with `curl` in a loop until we get a desired result, I may try this to check if it looks better (and again, maybe contribute to upstream chart later?).",
                "@amatas Alfredo, I have small update \u2013 I tried to install CouchDB using current Helm chart, but with `gpii/couchdiscover` as sidecar. Unfortunately it did not work :( Couchdiscover fails with the following error:\r\n```Traceback (most recent call last):\r\n  File \"/usr/local/bin/couchdiscover\", line 11, in <module>\r\n    load_entry_point('couchdiscover', 'console_scripts', 'couchdiscover')()\r\n  File \"/package/couchdiscover/entrypoints.py\", line 19, in main\r\n    man = manage.ClusterManager(env=config.ENVIRONMENT)\r\n  File \"/package/couchdiscover/manage.py\", line 115, in __init__\r\n    self.env = ContainerEnvironment(env, host)\r\n  File \"/package/couchdiscover/manage.py\", line 31, in __init__\r\n    self._setup_environment(host)\r\n  File \"/package/couchdiscover/manage.py\", line 51, in _setup_environment\r\n    self.host = self._get_host(host)\r\n  File \"/package/couchdiscover/manage.py\", line 40, in _get_host\r\n    return kube.KubeHostname(host)\r\n  File \"/package/couchdiscover/kube.py\", line 28, in __init__\r\n    self._init_from_fqdn(fqdn)\r\n  File \"/package/couchdiscover/kube.py\", line 87, in _init_from_fqdn\r\n    statefulset, index = self._split_node(node)\r\n  File \"/package/couchdiscover/kube.py\", line 81, in _split_node\r\n    statefulset, index = node.split('-')\r\nValueError: too many values to unpack (expected 2)```\r\n",
                "@natarajaya it tries to get the index of the node based on the fqdn of the pod. for some reason the fqdn or the name has more than a \"-\" giving more than 2 values. The only way to figure out why the fqdn is not valid is debugging your manifests and the deployment.",
                "Sergey,\r\n\r\nYour fixes for my comments look good, except I can't find the timeout (I commented above in the thread).\r\n\r\nCan you elaborate on what you're proposing here?:\r\n> one replica of stateful set per node?\r\n",
                "This code LGTM. It sounds like we're still figuring out some questions about sharding and scaling so there is more work to do, but this should be better than what we have today so please merge it if it simplifies your commit management.\r\n\r\n(We may want to continue the discussion in this PR even after merging, to keep the discussion in one place.)",
                "@mrtyler Unfortunately, custom timeouts are not supported by `null_resource`. I implemented timeout logic in sh code, please check my latest commit, I would prefer to merge this one if it looks good.\r\n\r\n> one replica of stateful set per node?\r\n\r\nWe currently have `n=3` [set](http://docs.couchdb.org/en/2.1.1/cluster/theory.html) in our cluster config. This allows us to lose up to 2 StatefulSet Pods, while still keeping data integrity in cluster. However,  I feel like it make sense to [assign](https://kubernetes.io/docs/concepts/configuration/assign-pod-node/) not more than 1 Pod per Node, to minimize our expenses in case we lose a Node. It is a good topic for another discussion, as well as non-existent couchdb tooling that we will surely need if project reaches production, sharding issues, etc.",
                "Those changes look good. Just waiting for an answer on my last question about timeouts.",
                "@mrtyler Generic timeouts does not work:\r\n```Error: Error running plan: 1 error(s) occurred:\r\n\r\n* null_resource.couchdb_finish_cluster: 1 error(s) occurred:\r\n\r\n* null_resource.couchdb_finish_cluster: [ERR] Error decoding timeout: Timeout Key (create) is not supported```",
                "That sucks.\r\n\r\nAnyway, LGTM! Merge at your lesiure.",
                "@mrtyler It sucks indeed! Thanks again for review, I agree we should keep conversation going here even after this is merged.\r\ncc @amatas "
            ],
            "commits": [
                "71177ece0d65e2fd5e835cf86fdcc95044141852",
                "d7779a2eb3838d00998a33b88339f19486d06ba1",
                "196f551207fb20c5fe4cc4b5740621d9a269af07",
                "a849a97015102d4314c723a5893d09893beb955b",
                "f427e12f733cae7d6cc104bd3e2f3215a6cf16cd",
                "3432439b67707ab276c62521888ffe11519c6022"
            ]
        },
        "codes": [
            "awareness",
            "cluster"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/gpii-ops/gpii-infra/pull/158",
        "content": {
            "title": "[GPII-3418]: Tune resource requests one more time",
            "body": "This is the long-term solution I promised.\r\n\r\nFor dev clusters I had to keep requests lowered in order to stay on cheaper `n1-standard-2` nodes.\r\n\r\nFor staging / prod clusters:\r\n* To have \"more predictable\" scheduling with requests = limits\r\n* To also have more replicas of preferences, flowmanager and couchdb (similarly to AWS setup)\r\n* And finally, to have enough room for rolling updates with `maxUnavailable: 0`\r\n\r\nI suggest to use `n1-highcpu-4` instances. They are a bit cheaper than `n1-standard-4` and have significantly less RAM (4GB vs 15GB), but since we are very far away from hitting RAM limit, it seems like the most optimal choice in our situation.\r\n\r\nChanging node type will most likely cause Terraform to attempt to recreate the cluster. I am not sure if there is a way around this issue for staging and prod, I am open to suggestions!\r\n\r\nUsing container_node_pool should improve this situation:\r\nhttps://issues.gpii.net/browse/GPII-3419",
            "comments": [
                "LGTM",
                "LGTM",
                "> value passed down as a parameter from each environment\r\n\r\n+1",
                "@stepanstipl @mrtyler Good point! Unfortunately, getting rid of env-based interpolations in modules requires adding more plumbing in order to pass variables from Terragrunt to Terraform and then into templates. But I also believe that it results in a bit more clear module code and more flexible per-environment configs.\r\n\r\nPlease review updated version!\r\n\r\n",
                "LGTM\r\n\r\nThanks for re-plumbing those templated variables. I think the new form is easier to understand and more consistent with the Exekube/Terraform module model.",
                "Thanks Sergey, I like the effort to make limits & requests same value \ud83d\udc4d \r\n\r\nBut I think the logic should not be hardcoded in this module, but rather the value passed down as a parameter from each environment -> that way we would avoid the hardcoded logic completely and have a bit more flexibility I believe.\r\n\r\nAgree with the choice of instance size."
            ],
            "commits": [
                "6f9cfe6a39f4f63507a86162d028cdcfb7edad29",
                "92f2eb44a55a61f72e6a2a6eebfb32087dc121e9",
                "98a54e39296efb8e15bec3dc0974e72ab6f41ea6"
            ]
        },
        "codes": [
            "instance",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/gpii-ops/gpii-infra/pull/306",
        "content": {
            "title": "[GPII-2782] - 1 - High-Level Task: Secure Backups",
            "body": "This is the first PR of the implementation of exporting backups task. This PR cover this 3 parts:\r\n\r\n1. Backup exporter Service account and de permissions needed at the common level to allow cloudbuild to perform the operations. (The command `gcloud compute image export` creates a Cloudbuild job that makes all the work using a VM)\r\n1. Backup exporter Helm Chart\r\n1. Backup exporter GCP module.\r\n\r\nThis PR only affects to the common part as it will enable the APIs involved and create the backup-exporter service account. This PR can be promoted safely to prd.\r\n\r\nIf the common part is merge it will help me with the implementation of the rest of the task, because I wouldn't need to redeploy my cluster every time that the pipeline is executed.\r\n\r\nThis is the Terragrunt definition I'm using for testing, just in case someone wants to give a try:\r\n```\r\n# gcp/live/dev/k8s/kube-system/backup-exporter/terraform.tfvars \r\n# \u2193 Module metadata\r\n\r\nterragrunt = {\r\n  terraform {\r\n    source = \"/project/modules//backup-exporter\"\r\n  }\r\n\r\n  dependencies {\r\n    paths = [\r\n      \"../k8s-snapshots\",\r\n    ]\r\n  }\r\n\r\n  include = {\r\n    path = \"${find_in_parent_folders()}\"\r\n  }\r\n}\r\n\r\n# \u2193 Module configuration (empty means all default)\r\n\r\ndestination_bucket = \"gs://gpii-backup-dev-alfredo\"\r\nreplica_count      = 2\r\nschedule           = \"*/10 * * * *\"\r\n```\r\nTasks left for the next PRs:\r\n- A way to create the destination bucket. A little bit tricky, because I need to give permissions (first part of the pipeline) to this bucket and I need the SA created first (which is created in later steps).\r\n- Add the module in the Terragrunt definition of prd (is it needed in stg and dev clusters?)\r\n- Document how to restore the cluster using the exported snapshots\r\n- Alert when a backup fails",
            "comments": [
                "Thanks for sharing this early in the process. I have some high-level questions.\r\n\r\n0. You may have said this once during standup but: have you successfully restored from a backup created using this strategy?\r\n\r\n1. How often will the backup task run? How often does the Instance get created and destroyed?\r\n\r\n2. How will we expire backups?\r\n\r\n3. Why is ssh access needed? Maybe temporary for development/debugging?\r\n\r\n4. Brendan's original specification calls for \"cross-account, cross-region\". That's sort of AWS specific, but I think the idea is to both improve resilience (cross-region in case one region goes down) and to make it harder for automation or human error to delete or modify the backups (cross-account so that \"delete all the Snapshots\" cannot delete both the primary Snapshots and the backups). Maybe storing the backups in a GCS bucket (or whatever) in a different Project is the appropriate metaphor for GCP?\r\n\r\nWhat does the team think of this requirement?",
                "Thanks Alfredo for this. I'll not go into details of this solution at this stage, but I'm a bit concerned about the overall approach. I'm thinking that spinning up a VM to do this, mounting disks etc.... might be unnecessary and opens a lot of questions, not only about security and data encryption.\r\n\r\nWhat if we can do this VMless? And using `gcloud` native tools?\r\n\r\nI would consider following:\r\n- Export the disk images to GCS Bucket, this would involve:\r\n  - `gcloud compute images create` which creates an image from a persistent disk or a snapshot\r\n  -  `gcloud compute images export` which exports an image to GCS Bucket (see https://cloud.google.com/compute/docs/images/export-image for details)\r\n(if we want to use TF, I would check - it might have corresponding resources).\r\n\r\nAt this stage, we have backups in GCS and we can do pretty much anything we want with those. If this would stay within GCP, I would use `gsutil cp` that can copy data between buckets, even across different projects, without actually ever downloading them. `gsutil` seems to be even able to handle transfers from GCS to S3 (although in this case the data are pushed through the machine running the command).\r\n\r\nI think all this can be run either on Kubernetes (maybe `CronJob`), or maybe even better as part of some CI build (perhaps CloudBuild?). In general, I would a) try to avoid pulling data to the client machine if possible (ie. do direct transfers between buckets) b) if not leverage fast connectivity inside the cloud (ie. don't run this on Gitlab if we have to pull data)\r\n\r\nAnd I would try to avoid having to spin-up, manage and monitor new infrastructure, unless really necessary.\r\n\r\nI believe this would allow us to simplify things a lot, leverage GCP data encryption and authz/n mechanisms, speed up and be less error-prone and easier to maintain.\r\n\r\n> What does the team think of this requirement?\r\n\r\nI would probably relax this to use GCS under different Project, and maybe Organization even. I would use perhaps multi-regional buckets, and Nearline/Coldline to reduce costs. And I would use GCS native Lifecycle Mgmt. to manage downgrade of the storage classes and deletion of objects (see. https://cloud.google.com/storage/docs/lifecycle).",
                "Cool Alfredo, I like this way more \ud83d\udc4d seems pretty neat.\r\n\r\nDo you have any plans on monitring that the backups are happening?",
                "> it's the number of couchdb replicas, which should be the same as the number of snapshots made at the same time.\r\n\r\nOk, looking at this again based on your previous answer I see one issue:\r\n\r\n```\r\nSNAPSHOTS=$(gcloud compute snapshots list --sort-by=~creationTimestamp,STATUS --limit={{ .Values.replicaCount }} --format=\"value[separator=';'](name,status)\" | cut -f1 -d\\;)\r\n```\r\n\r\nIf the `replicaCount` is used to match number of replicas, we're not guaranteed to get consistent backup. Due to how snapshots happen, they don't happend atomically from all the instances at the same time. So imagine state of snapshots being smth like this (ordered by timestamp desc):\r\n\r\n```\r\nReplicaA - 4pm snapshot\r\nReplicaB - 3pm snapshot\r\nReplicaA - 3pm snapshot\r\n```\r\n\r\nAbove code with the `replicaCount` of two would backup snapshot from 4pm from replicaA and snapshot from 3pm from replicaB.\r\n\r\nOr even worse, imagine:\r\n```\r\nReplicaA - 4pm snapshot\r\nReplicaA - 3pm snapshot\r\nReplicaB - 3pm snapshot\r\n```\r\n\r\nThe code would back up two snapshots from replica A, but not from replica B.\r\n\r\nI'm not sure if the first example is an issue, but the second I think definitely is.\r\n\r\nMaybe we can leverage predictable replicas/snapshot naming to always select the latest snapshot of each replica?",
                "LGTM for the purposes of merging the permissions changes so you don't have to manually re-create them all the time.\r\n\r\nI think it will be helpful to link/copy the outstanding items from this PR into the new PR, since you are picking up the work there.",
                "@amatas I like new approach much better than one that involved VMs!\r\n\r\nBeside things from inline comments, I have one more question: when `backup-exporter` module is deployed, it will start populating GS bucket with exported snapshots, which is great, but what is the next part of the plan?\r\n\r\nI thought our goal here is to move backups outside of current project, and ideally, outside of the organization, so we can restore even if it is destroyed and everything is lost (though it is hard to imagine such scenario, because there is [30-day recovery period](https://cloud.google.com/resource-manager/docs/creating-managing-projects#restoring_a_project) for projects, and it is [not so easy](https://cloud.google.com/resource-manager/docs/creating-managing-organization#deleting_an_organization_resource) to accidentally destroy organization)...\r\n",
                ">Beside things from inline comments, I have one more question: when backup-exporter module is deployed, it will start populating GS bucket with exported snapshots, which is great, but what is the next part of the plan?\r\n>\r\n>I thought our goal here is to move backups outside of current project, and ideally, outside of the organization, so we can restore even if it is destroyed and everything is lost\r\n\r\nIndeed that's the goal :)\r\n\r\nThe destination bucket can be a bucket set outside of the organization, even an S3 bucket. That can be defined in the `destination_bucket` parameter.\r\n\r\nThe bucket that I'm using for my tests is `gs://gpii-backup-dev-alfredo` which is in [the project `gpii2test-gcp-prd` in the testing organization](https://console.cloud.google.com/storage/browser/gpii-backup-dev-alfredo?project=gpii2test-gcp-prd).",
                "> The destination bucket can be a bucket set outside of the organization, even an S3 bucket. That can be defined in the destination_bucket parameter.\r\n\r\n> The bucket that I'm using for my tests is gs://gpii-backup-dev-alfredo which is in the project gpii2test-gcp-prd in the testing organization.\r\n\r\nHow do you handle permissions on destination bucket? ",
                "\r\n> How do you handle permissions on destination bucket?\r\n\r\nWith this module in the common part: https://github.com/gpii-ops/gpii-infra/pull/349/commits/3fc22bc49bdf925f3be05c01645183de7e4a33f1",
                "This PR is ready for review. The actual implementation works, there is no definition in any environment so the promote of the pipeline should be safe. I'd like to move forward as I have to recreate my whole cluster every time the common part destroys the backup SA. I'll continue working on https://github.com/gpii-ops/gpii-infra/pull/349",
                "@stepanstipl I can not reply a couple of your suggestions in place, so I'm doing here:\r\n\r\n> Maybe roles/compute.instanceAdmin then? It's a bit narrower set of permissions, which should still allow what you mentioned.\r\n\r\nTested and it doesn't work, an exception is raised by the gcloud command.\r\n\r\nAlso the command that gets the snapshot list now asks for the last snapshot of each statefulset member."
            ],
            "commits": [
                "200315a44fae29f4fca80b924d20e0e5c33b6468",
                "e7fc5af85dcd4d02193db0c481da3e8d49cfed25",
                "954c3e90b4e70374d97e5cb69e8819d175e2c4ba",
                "d354b01def4b4718f596903b3f048c130417798e",
                "24ba2b8366d054f82c2b0344c39b2ba0bb07fa2b",
                "ff1d1fb4456c77d184c8a18ae315e48d5fd6dec5",
                "e36f1898cd7a569734c5d7bf82dd9f94a641fd91",
                "ce752792beabfd90b89751a87c9ce90bf7f26586",
                "451e1a3367d255ecad8971d87e3812600d147d2a",
                "345105c78c16e95c0ca470f3fe2c41aeaae40b26",
                "b1f4d90b1b253f59cb303c1af9f0586862b991c8",
                "5cc40fe92306077156ea8d38ba4ef36ed7cef21c",
                "0b2a3d1157e2007f2f6f33fa9f1999f1c6d76ee7",
                "d65e4c10c84b33046849d8369438366ca85b29b0",
                "782b54834c4251061e7735e34b71e1243b0edcb2",
                "9aab07c3168924a13bbe838dba60db3d82eff8fe",
                "43dc8b4deb1296b3426192289238ef285902cb89",
                "52d730eacc549775b264a2781c87d48982ea4574",
                "6e04f58e27d5f9c64d4f54688bc4940a4daf39a8"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/gpii-ops/gpii-infra/pull/175",
        "content": {
            "title": "GPII-3397- Enable log exclusion for the CouchDB HTTP checks",
            "body": "The log severity configured in the CouchDB containers is `info`, and this causes that the CouchDB logs every request from the health checks:\r\n```\r\n[notice] 2018-10-11T18:11:14.179590Z couchdb@couchdb-couchdb-1.couchdb-couchdb.gpii.svc.cluster.local <0.17722.0> 66cbd57ff5 localhost:5984 127.0.0.1 a99c4851ccfb586fa58727bcbb869a30 GET /_up 200 ok 2\r\n```\r\nThis PR decreases the log level to `warn`.\r\nhttp://docs.couchdb.org/en/stable/config/logging.html#log/level\r\nwhich is less noisy.",
            "comments": [
                "Looks good. Personally I would decrease the log level and test if we can increase it without disrupting ops should we need to debug something.",
                "The logs that spam the stackdriver has the level of [notice], `warn` is the immediate next level.",
                "Having full request logs for DB layer is essential for audit purposes. I think we should keep current log level, and if those health checks are really noisy, configure exclusion instead.",
                "I don't think it's correct to change the log level *or* to exclude this log message. My understanding is the cause of this message is a misconfigured liveness check. If so, I'd say the solution is to fix the liveness check. Silencing a log that revealed a real error seems counterproductive. Am I missing anything?",
                "@mrtyler but this is not an error, right? this is just a record that something queried the `/_up` endpoint\r\n\r\nPersonally, I don't think there's a need to *fix* anything. It's about deciding whether we want to keep this detailed level of logging for database access.\r\n\r\n@natarajaya I agree this might useful/required from audit logging perspective, and if so we should keep it. I don't think we should have this level of logging from an operational perspective - from that point of view, I tend to log only things with higher severity (warning and above) that you can take some actions on.",
                "Let me summarize what we have.\r\n\r\nIf you go to your own dev cluster, at the log viewer and enter this filter (change your user in the project name):\r\n```\r\nresource.labels.cluster_name=\"k8s-cluster\"\r\nlogName=\"projects/gpii-gcp-dev-<your_user>/logs/stderr\"\r\nresource.labels.container_name=\"couchdb\"\r\n```\r\nyou will see a lot of messages like this:\r\n```\r\n{\r\n insertId: \"10crbmbg3hsmbrg\"  \r\n logName: \"projects/gpii-gcp-dev-alfredo/logs/stderr\"  \r\n metadata: {\u2026}  \r\n receiveTimestamp: \"2018-10-16T17:51:51.412688468Z\"  \r\n resource: {\u2026}  \r\n severity: \"ERROR\"  \r\n textPayload: \"[notice] 2018-10-16T17:51:47.560829Z couchdb@couchdb-couchdb-0.couchdb-couchdb.gpii.svc.cluster.local <0.31436.2> a0b399088c localhost:5984 127.0.0.1 629a540acb21d93a0f242baf2498b5d9 GET /_up 200 ok 2\r\n\"  \r\n timestamp: \"2018-10-16T17:51:47Z\"  \r\n}\r\n```\r\nIt you see at the end of the payload, it is a common request that returns a 200. It's an OK for the liveness and the readyness.\r\n\r\nThe problem here, IMHO, is that the CouchDB logs [every request to stderr](http://docs.couchdb.org/en/stable/config/logging.html#log/writer) and the [Stackdriver understands that the severity is \"ERROR\"](https://cloud.google.com/kubernetes-engine/docs/how-to/logging#best_practices) for all the logs that the CouchDB throws, making very difficult to select only a type of log later on. So we have that all the logs of the CouchDB are marked as ERROR from the same source, without any other tags that help us to discriminate between a \"real error\" and a \"200 request\".\r\n\r\nI feel that I'm out of ideas. These are my proposes:\r\n1. Leave as it is now. We will have a lot of 200 messages, but we would also collect the real errors.\r\n1. Increase the [severity of the logs in the CouchDB](http://docs.couchdb.org/en/stable/config/logging.html#log/level). We will get rid of the `200 ok` logs and we would collect only other kind of messages.\r\n1. Set an exclusion in Stackdriver. But since we don't have more fields to discriminate from one type of errors from others this could be hard to find out. The most accurate filter that I tried is:\r\n```\r\nresource.labels.cluster_name=\"k8s-cluster\"\r\nlogName=\"projects/gpii-gcp-dev-<your_user>/logs/stderr\"\r\nresource.labels.container_name=\"couchdb\"\r\n```",
                "> The problem here, IMHO, is that the CouchDB logs every request to stderr\r\n\r\n@amatas I think this can be solved by configuring CouchDB to write logs into file:\r\nhttp://docs.couchdb.org/en/stable/config/logging.html#log/writer\r\nAnd then using sidecar container to stream them, similarly to this example:\r\nhttps://kubernetes.io/docs/concepts/cluster-administration/logging/#streaming-sidecar-container\r\n\r\nProbably worth trying. It would've been nice if we can have CouchDB logs with adequate severity. Not sure if it is required to configure health check requests exclusion though. This filter works for me (I know exact matches are faster, but since we don't have this option in our case):\r\n```\r\nresource.type=\"k8s_container\"\r\nresource.labels.container_name=\"couchdb\"\r\ntextPayload : \"GET / 200 ok 2\"\r\n```",
                "@stepanstipl \r\nAh, I mistook the log message in this PR for the log message in the associated ticket -- the subtly but significantly different `undefined GET / 200 ok 1`.\r\n\r\n@amatas \r\nThank you for the summary and explanation. I agree with @natarajaya that it seems the root cause is the disagreement between CouchDB and Stackdriver about what it means to write a message to stderr. However, I think a solution involving a sidecar is not worth the effort at this time.\r\n\r\nAn exclusion is cheap and addresses my main concern (keeping clutter out of the logs to make debugging easier) and my secondary concern (minimizing the amount and therefore cost of the logs we archive). I think an exclusion is the right move.\r\n\r\nSergey's filter looks good. I would add a space before `GET` because I'm always paranoid about false positives.\r\n\r\nOne thing that is unfortunate about this solution is the high coupling / low cohesion between this filter and the liveness check in the couchdb chart (especially with a lack of automated testing to tell us when we've changed one without changing the other). I can think of some solutions (make liveness check URL a rake variable and pass it to various terraform modules; couchdb module includes its own instance of gcp-stackdriver-exclude to manage this exclusion) but I don't think any of them are worth the trouble now.",
                "@amatas thanks for the explanation. Can't we make CouchDB write logs to stdout? Otherwise this will be an issue with every single event - everything will be logged  with `severity: \"ERROR\"`, right?\r\n\r\nI would prefer to fix this at the source (as opposed to fixing by exclusion). Also this will be an issue with log exports, the exclusions do not apply there, right?",
                "> @amatas thanks for the explanation. Can't we make CouchDB write logs to stdout? Otherwise this will be an issue with every single event - everything will be logged with `severity: \"ERROR\"`, right?\r\n\r\nI guess that we will have the same amount of logs but with the severity field with other value. That wouldn't decrease the amount of logs received.\r\n\r\n> I would prefer to fix this at the source (as opposed to fixing by exclusion). Also this will be an issue with log exports, the exclusions do not apply there, right?\r\n\r\nI agree with you @stepanstipl , but the CouchDB doesn't allow to set which logs goes to what severity. Perhaps putting an application in the middle that digests the logs and send them properly to the stackdriver would help. But it also adds some complexity. As @mrtyler and @natarajaya said before, perhaps we can improve this in the future.",
                "LGTM",
                "LGTM!\r\n\r\nCan you please update this PR's title so we know it is about logging exclusions and not severity?",
                "@stepanstipl @amatas I created separate ticket for CouchDB log severity issue:\r\nhttps://issues.gpii.net/browse/GPII-3463"
            ],
            "commits": [
                "3e0e5739184468bb2a0d5c7f0d23565355cc3aae",
                "6949a2eab645da32135f4ff9802135b8c0ff5ad0"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/platform-infrastructure/pull/418",
        "content": {
            "title": "Adds WAF for IIIF apis (test/count only for now)",
            "body": "## What's changing and why?\r\n\r\nFollows https://github.com/wellcomecollection/wellcomecollection.org/pull/10533. Attempt to reduce IIIF API costs by reducing bad bot traffic.\r\n\r\nThis change initially only counts traffic matched in order to identify the scale of the issue and the impact of this change.\r\n\r\n> [!WARNING]\r\n> This is applied and superseded by https://github.com/wellcomecollection/platform-infrastructure/pull/420, which has also been applied.\r\n\r\n## `terraform plan` diff\r\n```console\r\n# module.iiif-waf-test.aws_wafv2_web_acl.acl will be created\r\n  + resource \"aws_wafv2_web_acl\" \"acl\" {\r\n      + arn         = (known after apply)\r\n      + capacity    = (known after apply)\r\n      + description = \"Access control for the wellcomecollection.org CloudFront distributions\"\r\n      + id          = (known after apply)\r\n      + lock_token  = (known after apply)\r\n      + name        = \"iiif-cloudfront-acl-test\"\r\n      + scope       = \"CLOUDFRONT\"\r\n      + tags_all    = (known after apply)\r\n\r\n      + default_action {\r\n          + allow {\r\n            }\r\n        }\r\n\r\n      + rule {\r\n          + name     = \"bot-control-rule-group\"\r\n          + priority = 4\r\n\r\n          + override_action {\r\n              + count {}\r\n            }\r\n\r\n          + statement {\r\n              + managed_rule_group_statement {\r\n                  + name        = \"AWSManagedRulesBotControlRuleSet\"\r\n                  + vendor_name = \"AWS\"\r\n\r\n                  + managed_rule_group_configs {\r\n                      + aws_managed_rules_bot_control_rule_set {\r\n                          + inspection_level = \"COMMON\"\r\n                        }\r\n                    }\r\n\r\n                  + rule_action_override {\r\n                      + name = \"CategoryAdvertising\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"CategoryArchiver\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"CategoryContentFetcher\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"CategoryEmailClient\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"CategoryHttpLibrary\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"CategoryLinkChecker\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"CategoryMiscellaneous\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"CategoryMonitoring\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"CategoryScrapingFramework\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"CategorySearchEngine\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"CategorySecurity\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"CategorySocialMedia\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"CategoryAI\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"SignalAutomatedBrowser\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"SignalKnownBotDataCenter\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                  + rule_action_override {\r\n                      + name = \"SignalNonBrowserUserAgent\"\r\n\r\n                      + action_to_use {\r\n                          + count {\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n          + visibility_config {\r\n              + cloudwatch_metrics_enabled = true\r\n              + metric_name                = \"iiif-cloudfront-acl-bot-control-test\"\r\n              + sampled_requests_enabled   = true\r\n            }\r\n        }\r\n      + rule {\r\n          + name     = \"core-rule-group\"\r\n          + priority = 1\r\n\r\n          + override_action {\r\n              + count {}\r\n            }\r\n\r\n          + statement {\r\n              + managed_rule_group_statement {\r\n                  + name        = \"AWSManagedRulesCommonRuleSet\"\r\n                  + vendor_name = \"AWS\"\r\n                }\r\n            }\r\n\r\n          + visibility_config {\r\n              + cloudwatch_metrics_enabled = true\r\n              + metric_name                = \"iiif-cloudfront-acl-core-test\"\r\n              + sampled_requests_enabled   = true\r\n            }\r\n        }\r\n      + rule {\r\n          + name     = \"known-bad-inputs-rule-group\"\r\n          + priority = 3\r\n\r\n          + override_action {\r\n              + count {}\r\n            }\r\n\r\n          + statement {\r\n              + managed_rule_group_statement {\r\n                  + name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\r\n                  + vendor_name = \"AWS\"\r\n                }\r\n            }\r\n\r\n          + visibility_config {\r\n              + cloudwatch_metrics_enabled = true\r\n              + metric_name                = \"iiif-cloudfront-acl-known-bad-inputs-test\"\r\n              + sampled_requests_enabled   = true\r\n            }\r\n        }\r\n      + rule {\r\n          + name     = \"managed-ip-blocking\"\r\n          + priority = 0\r\n\r\n          + override_action {\r\n              + count {}\r\n            }\r\n\r\n          + statement {\r\n              + managed_rule_group_statement {\r\n                  + name        = \"AWSManagedRulesAmazonIpReputationList\"\r\n                  + vendor_name = \"AWS\"\r\n                }\r\n            }\r\n\r\n          + visibility_config {\r\n              + cloudwatch_metrics_enabled = true\r\n              + metric_name                = \"iiif-cloudfront-acl-ip-block-test\"\r\n              + sampled_requests_enabled   = true\r\n            }\r\n        }\r\n      + rule {\r\n          + name     = \"sqli-rule-group\"\r\n          + priority = 2\r\n\r\n          + override_action {\r\n              + count {}\r\n            }\r\n\r\n          + statement {\r\n              + managed_rule_group_statement {\r\n                  + name        = \"AWSManagedRulesSQLiRuleSet\"\r\n                  + vendor_name = \"AWS\"\r\n                }\r\n            }\r\n\r\n          + visibility_config {\r\n              + cloudwatch_metrics_enabled = true\r\n              + metric_name                = \"iiif-cloudfront-acl-sqli-test\"\r\n              + sampled_requests_enabled   = true\r\n            }\r\n        }\r\n\r\n      + visibility_config {\r\n          + cloudwatch_metrics_enabled = true\r\n          + metric_name                = \"iiif-cloudfront-acl-metric-test\"\r\n          + sampled_requests_enabled   = true\r\n        }\r\n    }\r\n\r\nPlan: 1 to add, 4 to change, 0 to destroy.\r\n```\r\n\r\n\r\n",
            "comments": [],
            "commits": [
                "62b96f19bdc0e4819ca8fa6b2b89562c0121d6c2",
                "b05ba588ac51f4e0be5c9c89d848f9e9ee377caf",
                "5f9fdd8933b4d895470e53a9c7edca191ce07790"
            ]
        },
        "codes": [
            "saving",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/platform-infrastructure/pull/257",
        "content": {
            "title": "Cycle objects in the digitisation buckets to Standard-IA",
            "body": "## What's changing and why?\r\n\r\nAdd a bucket policy that cycles all these objects to Standard-IA, which should roughly halve the cost of storing a bunch of large objects in the digitisation account.\r\n\r\nThere's no difference from Ashley/Harkiran's perspective, but they're cheaper to store.\r\n\r\n## `terraform plan` diff\r\n\r\n```\r\nTerraform will perform the following actions:\r\n\r\n  # data.aws_iam_policy_document.client_transfer_pre_2020_readonly will be read during apply\r\n  # (config refers to values not yet known)\r\n <= data \"aws_iam_policy_document\" \"client_transfer_pre_2020_readonly\"  {\r\n      ~ id      = \"3569410101\" -> (known after apply)\r\n      ~ json    = jsonencode(\r\n            {\r\n              - Statement = [\r\n                  - {\r\n                      - Action    = [\r\n                          - \"s3:List*\",\r\n                          - \"s3:Get*\",\r\n                        ]\r\n                      - Effect    = \"Allow\"\r\n                      - Principal = {\r\n                          - AWS = \"299497370133\"\r\n                        }\r\n                      - Resource  = [\r\n                          - \"arn:aws:s3:::wellcomecollection-client-transfer-pre2020/*\",\r\n                          - \"arn:aws:s3:::wellcomecollection-client-transfer-pre2020\",\r\n                        ]\r\n                      - Sid       = \"\"\r\n                    },\r\n                ]\r\n              - Version   = \"2012-10-17\"\r\n            }\r\n        ) -> (known after apply)\r\n      - version = \"2012-10-17\" -> null\r\n\r\n      ~ statement {\r\n          - effect        = \"Allow\" -> null\r\n          - not_actions   = [] -> null\r\n          - not_resources = [] -> null\r\n            # (2 unchanged attributes hidden)\r\n\r\n            # (1 unchanged block hidden)\r\n        }\r\n    }\r\n\r\n  # data.aws_iam_policy_document.client_transfer_read_write will be read during apply\r\n  # (config refers to values not yet known)\r\n <= data \"aws_iam_policy_document\" \"client_transfer_read_write\"  {\r\n      ~ id      = \"321902348\" -> (known after apply)\r\n      ~ json    = jsonencode(\r\n            {\r\n              - Statement = [\r\n                  - {\r\n                      - Action    = [\r\n                          - \"s3:Put*\",\r\n                          - \"s3:List*\",\r\n                          - \"s3:Get*\",\r\n                          - \"s3:Delete*\",\r\n                        ]\r\n                      - Effect    = \"Allow\"\r\n                      - Principal = {\r\n                          - AWS = \"arn:aws:iam::404315009621:role/digitisation-developer\"\r\n                        }\r\n                      - Resource  = [\r\n                          - \"arn:aws:s3:::wellcomecollection-client-transfer/*\",\r\n                          - \"arn:aws:s3:::wellcomecollection-client-transfer\",\r\n                        ]\r\n                      - Sid       = \"\"\r\n                    },\r\n                ]\r\n              - Version   = \"2012-10-17\"\r\n            }\r\n        ) -> (known after apply)\r\n      - version = \"2012-10-17\" -> null\r\n\r\n      ~ statement {\r\n          - effect        = \"Allow\" -> null\r\n          - not_actions   = [] -> null\r\n          - not_resources = [] -> null\r\n            # (2 unchanged attributes hidden)\r\n\r\n            # (1 unchanged block hidden)\r\n        }\r\n    }\r\n\r\n  # aws_s3_bucket.client_transfer_bucket will be updated in-place\r\n  ~ resource \"aws_s3_bucket\" \"client_transfer_bucket\" {\r\n        id                          = \"wellcomecollection-client-transfer\"\r\n        tags                        = {}\r\n        # (9 unchanged attributes hidden)\r\n\r\n      + lifecycle_rule {\r\n          + enabled = true\r\n          + id      = \"Transition to Infrequent Access\"\r\n\r\n          + transition {\r\n              + days          = 30\r\n              + storage_class = \"STANDARD_IA\"\r\n            }\r\n        }\r\n\r\n        # (1 unchanged block hidden)\r\n    }\r\n\r\n  # aws_s3_bucket.client_transfer_pre_2020 will be updated in-place\r\n  ~ resource \"aws_s3_bucket\" \"client_transfer_pre_2020\" {\r\n        id                          = \"wellcomecollection-client-transfer-pre2020\"\r\n        tags                        = {}\r\n        # (9 unchanged attributes hidden)\r\n\r\n      + lifecycle_rule {\r\n          + enabled = true\r\n          + id      = \"Transition to Infrequent Access\"\r\n\r\n          + transition {\r\n              + days          = 30\r\n              + storage_class = \"STANDARD_IA\"\r\n            }\r\n        }\r\n\r\n        # (1 unchanged block hidden)\r\n    }\r\n\r\n  # aws_s3_bucket.digitisation_transfer will be updated in-place\r\n  ~ resource \"aws_s3_bucket\" \"digitisation_transfer\" {\r\n        id                          = \"wellcomecollection-digitisation-transfer\"\r\n        tags                        = {}\r\n        # (9 unchanged attributes hidden)\r\n\r\n      + lifecycle_rule {\r\n          + enabled = true\r\n          + id      = \"Transition to Infrequent Access\"\r\n\r\n          + transition {\r\n              + days          = 30\r\n              + storage_class = \"STANDARD_IA\"\r\n            }\r\n        }\r\n\r\n        # (1 unchanged block hidden)\r\n    }\r\n\r\n  # aws_s3_bucket_policy.client_transfer_pre_2020 will be updated in-place\r\n  ~ resource \"aws_s3_bucket_policy\" \"client_transfer_pre_2020\" {\r\n        id     = \"wellcomecollection-client-transfer-pre2020\"\r\n      ~ policy = jsonencode(\r\n            {\r\n              - Statement = [\r\n                  - {\r\n                      - Action    = [\r\n                          - \"s3:List*\",\r\n                          - \"s3:Get*\",\r\n                        ]\r\n                      - Effect    = \"Allow\"\r\n                      - Principal = {\r\n                          - AWS = \"arn:aws:iam::299497370133:root\"\r\n                        }\r\n                      - Resource  = [\r\n                          - \"arn:aws:s3:::wellcomecollection-client-transfer-pre2020/*\",\r\n                          - \"arn:aws:s3:::wellcomecollection-client-transfer-pre2020\",\r\n                        ]\r\n                      - Sid       = \"\"\r\n                    },\r\n                ]\r\n              - Version   = \"2012-10-17\"\r\n            }\r\n        ) -> (known after apply)\r\n        # (1 unchanged attribute hidden)\r\n    }\r\n\r\n  # aws_s3_bucket_policy.client_transfer_read_write will be updated in-place\r\n  ~ resource \"aws_s3_bucket_policy\" \"client_transfer_read_write\" {\r\n        id     = \"wellcomecollection-client-transfer\"\r\n      ~ policy = jsonencode(\r\n            {\r\n              - Statement = [\r\n                  - {\r\n                      - Action    = [\r\n                          - \"s3:Put*\",\r\n                          - \"s3:List*\",\r\n                          - \"s3:Get*\",\r\n                          - \"s3:Delete*\",\r\n                        ]\r\n                      - Effect    = \"Allow\"\r\n                      - Principal = {\r\n                          - AWS = \"arn:aws:iam::404315009621:role/digitisation-developer\"\r\n                        }\r\n                      - Resource  = [\r\n                          - \"arn:aws:s3:::wellcomecollection-client-transfer/*\",\r\n                          - \"arn:aws:s3:::wellcomecollection-client-transfer\",\r\n                        ]\r\n                      - Sid       = \"\"\r\n                    },\r\n                ]\r\n              - Version   = \"2012-10-17\"\r\n            }\r\n        ) -> (known after apply)\r\n        # (1 unchanged attribute hidden)\r\n    }\r\n\r\n  # module.digitisation_account.module.ci_role_policy.aws_iam_role_policy.ci_permissions will be updated in-place\r\n  ~ resource \"aws_iam_role_policy\" \"ci_permissions\" {\r\n        id     = \"digitisation-ci:terraform-20200713113726131400000001\"\r\n        name   = \"terraform-20200713113726131400000001\"\r\n      ~ policy = jsonencode(\r\n          ~ {\r\n              ~ Statement = [\r\n                    # (7 unchanged elements hidden)\r\n                    {\r\n                        Action   = \"sns:Publish*\"\r\n                        Effect   = \"Allow\"\r\n                        Resource = \"*\"\r\n                        Sid      = \"\"\r\n                    },\r\n                  + {\r\n                      + Action   = \"sts:AssumeRole\"\r\n                      + Effect   = \"Allow\"\r\n                      + Resource = \"arn:aws:iam::404315009621:role/digitisation-ci\"\r\n                      + Sid      = \"\"\r\n                    },\r\n                ]\r\n                # (1 unchanged element hidden)\r\n            }\r\n        )\r\n        # (1 unchanged attribute hidden)\r\n    }\r\n\r\nPlan: 0 to add, 6 to change, 0 to destroy.\r\n```\r\n",
            "comments": [],
            "commits": [
                "6b67d507a3fd0e45c7df750a95a31712bd6c2406"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/platform-infrastructure/pull/156",
        "content": {
            "title": "Move the unhandled Miro images to Glacier Deep Archive",
            "body": "## What's changing and why?\r\n\r\nWe have ~8TB of unhandled Miro images in `wellcomecollection-assets-workingstorage`.\r\n\r\n* We can\u2019t delete them indiscriminately \u2013 we'd be deleting the only copy of some images\r\n* We can't compare them to the backups in `wellcomecollection-editorial-photography` \u2013 all those backups are lifecycled to Glacier, plus we'd need to spend way more time on this problem\r\n\r\nSee my comment on https://github.com/wellcomecollection/platform/issues/4885#issuecomment-816703253 for more explanation.\r\n\r\nSo for now, we'll push all these images off into Glacier Deep Archive \u2013 and restore them when we come back to put Editorial Photography images in the storage service. (Which is on the roadmap, but not the immediate one.)\r\n\r\nThe storage cost of Deep Archive is ~$100/year rather than $1250/year for Standard-IA. Retrieving them from Deep Archive will cost ~$200, so we'll definitely make a saving here (and emphasise that these images aren't in active use).\r\n\r\nI haven't applied this change yet, pending discussion.\r\n\r\n<details><summary><code>terraform plan</code> diff</summary>\r\n\r\n```\r\nTerraform will perform the following actions:\r\n\r\n  # data.aws_iam_policy_document.working_storage will be read during apply\r\n  # (config refers to values not yet known)\r\n <= data \"aws_iam_policy_document\" \"working_storage\"  {\r\n      ~ id      = \"4276359186\" -> (known after apply)\r\n      ~ json    = jsonencode(\r\n            {\r\n              - Statement = [\r\n                  - {\r\n                      - Action    = \"s3:List*\"\r\n                      - Effect    = \"Allow\"\r\n                      - Principal = {\r\n                          - AWS = [\r\n                              - \"arn:aws:iam::975596993436:root\",\r\n                              - \"arn:aws:iam::404315009621:root\",\r\n                              - \"arn:aws:iam::299497370133:root\",\r\n                            ]\r\n                        }\r\n                      - Resource  = \"arn:aws:s3:::wellcomecollection-assets-workingstorage\"\r\n                      - Sid       = \"\"\r\n                    },\r\n                  - {\r\n                      - Action    = \"s3:Get*\"\r\n                      - Effect    = \"Allow\"\r\n                      - Principal = {\r\n                          - AWS = [\r\n                              - \"arn:aws:iam::975596993436:root\",\r\n                              - \"arn:aws:iam::404315009621:root\",\r\n                              - \"arn:aws:iam::299497370133:root\",\r\n                            ]\r\n                        }\r\n                      - Resource  = [\r\n                          - \"arn:aws:s3:::wellcomecollection-assets-workingstorage/proquest/*\",\r\n                          - \"arn:aws:s3:::wellcomecollection-assets-workingstorage/preservica/*\",\r\n                        ]\r\n                      - Sid       = \"\"\r\n                    },\r\n                ]\r\n              - Version   = \"2012-10-17\"\r\n            }\r\n        ) -> (known after apply)\r\n      - version = \"2012-10-17\" -> null\r\n\r\n      ~ statement {\r\n          - effect        = \"Allow\" -> null\r\n          - not_actions   = [] -> null\r\n          - not_resources = [] -> null\r\n            # (2 unchanged attributes hidden)\r\n\r\n            # (1 unchanged block hidden)\r\n        }\r\n      ~ statement {\r\n          - effect        = \"Allow\" -> null\r\n          - not_actions   = [] -> null\r\n          - not_resources = [] -> null\r\n            # (2 unchanged attributes hidden)\r\n\r\n            # (1 unchanged block hidden)\r\n        }\r\n    }\r\n\r\n  # aws_s3_bucket.working_storage will be updated in-place\r\n  ~ resource \"aws_s3_bucket\" \"working_storage\" {\r\n        id                          = \"wellcomecollection-assets-workingstorage\"\r\n        tags                        = {\r\n            \"TerraformConfigurationURL\" = \"https://github.com/wellcomecollection/platform-infrastructure/tree/master/assets\"\r\n        }\r\n        # (9 unchanged attributes hidden)\r\n\r\n      + lifecycle_rule {\r\n          + enabled = true\r\n          + id      = \"transition_miro_to_glacier\"\r\n          + prefix  = \"miro/\"\r\n\r\n          + transition {\r\n              + days          = 90\r\n              + storage_class = \"DEEP_ARCHIVE\"\r\n            }\r\n        }\r\n\r\n        # (3 unchanged blocks hidden)\r\n    }\r\n\r\n  # aws_s3_bucket_policy.working_storage will be updated in-place\r\n  ~ resource \"aws_s3_bucket_policy\" \"working_storage\" {\r\n        id     = \"wellcomecollection-assets-workingstorage\"\r\n      ~ policy = jsonencode(\r\n            {\r\n              - Statement = [\r\n                  - {\r\n                      - Action    = \"s3:List*\"\r\n                      - Effect    = \"Allow\"\r\n                      - Principal = {\r\n                          - AWS = [\r\n                              - \"arn:aws:iam::404315009621:root\",\r\n                              - \"arn:aws:iam::975596993436:root\",\r\n                              - \"arn:aws:iam::299497370133:root\",\r\n                            ]\r\n                        }\r\n                      - Resource  = \"arn:aws:s3:::wellcomecollection-assets-workingstorage\"\r\n                      - Sid       = \"\"\r\n                    },\r\n                  - {\r\n                      - Action    = \"s3:Get*\"\r\n                      - Effect    = \"Allow\"\r\n                      - Principal = {\r\n                          - AWS = [\r\n                              - \"arn:aws:iam::404315009621:root\",\r\n                              - \"arn:aws:iam::975596993436:root\",\r\n                              - \"arn:aws:iam::299497370133:root\",\r\n                            ]\r\n                        }\r\n                      - Resource  = [\r\n                          - \"arn:aws:s3:::wellcomecollection-assets-workingstorage/proquest/*\",\r\n                          - \"arn:aws:s3:::wellcomecollection-assets-workingstorage/preservica/*\",\r\n                        ]\r\n                      - Sid       = \"\"\r\n                    },\r\n                ]\r\n              - Version   = \"2012-10-17\"\r\n            }\r\n        ) -> (known after apply)\r\n        # (1 unchanged attribute hidden)\r\n    }\r\n\r\nPlan: 0 to add, 2 to change, 0 to destroy.\r\n```\r\n</details>\r\n\r\n\r\n",
            "comments": [],
            "commits": [
                "3bb07d039326e2f42c5d02b37a4cc7c603d7bfdc"
            ]
        },
        "codes": [
            "storage",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/platform-infrastructure/pull/123",
        "content": {
            "title": "Manage the logging cluster in Terraform; connect to it using a VPC endpoint",
            "body": "For https://github.com/wellcomecollection/platform/issues/5002\r\n\r\nI didn't mean this to be quite so disruptive, but in for a penny, in for a pound.\r\n\r\nThis pull request adds a new Elasticsearch cluster for logging (`ec_deployment.logging`). It also adds traffic filters that allow it to receive traffic from every VPC into which we copy our shared logging secrets. These traffic filters are connected to VPC endpoints, which means logs can be sent cheaper than going over a managed NAT Gateway. It's a big diff, but a lot of it is repetition.\r\n\r\nNext steps:\r\n\r\n- [x] Get this cluster working with OIDC\r\n- [x] Put this cluster behind logging.wellcomecollection.org\r\n- [x] Set up index expiry for these logs, so we don't fill up the cluster's disk",
            "comments": [
                "Phew! This is a big change - you've got it out neatly and v.quick too."
            ],
            "commits": [
                "7995927bdd150c75cc4513fbbd644e51fe042b63",
                "638ee708987cba12cc27c2fcc7c5f2ac1258fe6d",
                "ab45cc540e60052f4fa6f56910f39e9ccc1edad8",
                "d61700b248973e715c696ff9c38d5c31e594b878",
                "c3f2e650696676fc18f2bfd8fd4554d073a586b7",
                "218035902e0d71621278ade2498e068b155c36f0"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/platform-infrastructure/pull/132",
        "content": {
            "title": "Use VPC endpoints to talk to ECR in CI",
            "body": "We spent ~$250/mo in NAT Gateway costs for CI; see [Cost Explorer](https://console.aws.amazon.com/cost-management/home?#/custom?excludeRIRecurringCharges=false&startDate=2021-02-20&excludeTax=false&excludeSupportCharges=false&endDate=2021-03-22&timeRangeOption=Custom&hasAmortized=false&excludeRIUpfrontFees=false&filter=%5B%7B%22dimension%22:%22Operation%22,%22values%22:%5B%22NatGateway%22%5D,%22include%22:true,%22children%22:null%7D%5D&isTemplate=true&groupBy=TagKeyValue:Name&forecastTimeRangeOption=None&excludeCredit=false&excludeTaggedResources=false&reportType=CostUsage&chartStyle=Line&granularity=Daily&excludeOtherSubscriptionCosts=false&hasBlended=false&excludeRefund=false&reportName=Daily%20API%20operation%20costs&excludeDiscounts=true&usageAs=usageQuantity&excludeCategorizedResources=false&excludeForecast=false)\r\n\r\nA substantial part of this is likely to be sending Docker images to/from ECR \u2013 at $0.045/GB and ~200MB/application image, it stacks up. I'm hoping this bends the curve down a bit.\r\n\r\nTentatively closes https://github.com/wellcomecollection/platform/issues/4920",
            "comments": [
                "\ud83d\udc4f "
            ],
            "commits": [
                "95eb2c5bbc821697d1fc7ce51a3a88d53f3581e8",
                "ab43205db0bd36970b13ebc5ccd081aad180d375",
                "200d2c17c3afda84472d4af43df35138ff0407d9"
            ]
        },
        "codes": [
            "saving",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/platform-infrastructure/pull/252",
        "content": {
            "title": "Double the number of Buildkite instances at peak; reduce disk usage",
            "body": "Last month we spent ~$75 on r5.large instances and ~$100 on gp2 volumes. Our BuildKite setup is also imbalanced:\r\n\r\n* It's possible to max out our 30 workers. At peak build times, you can be waiting 20m+ for your build to start. Slow!\r\n* 150GB is massive, a quick spin through our current worker pool suggests they have ~144GB or so free with a warm cache (this is logged as part of our pre-job hook). Wasteful!\r\n\r\nThis change tries to rebalance that spending: take some of the money we're spending on gp2 volumes, and spend it on running more workers instead. I don't expect it to impact the bill much, but it should avoid our builds getting throttled because too many people are building at once.",
            "comments": [],
            "commits": [
                "29ad0e871094c4c94cde1365344c08e121adea78"
            ]
        },
        "codes": [
            "awareness",
            "instance",
            "feature"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/platform-infrastructure/pull/192",
        "content": {
            "title": "Tweak our BuildKite setup",
            "body": "This change is already applied.\r\n\r\nCurrently nothing is running in CI because the spot price of the r5.large instances we use has just passed $0.04:\r\n\r\n> Launching a new EC2 instance. Status Reason: Your Spot request price of 0.04 is lower than the minimum required Spot request fulfillment price of 0.0411. Launching EC2 instance failed.\r\n\r\nSince this is only a small part of our bill ($72/mo), we can safely increase the spot bid without breaking the bank.\r\n\r\nWe also spent $126 last month on gp2 EBS volumes, most of which will be our BuildKite runners. I'm reasonably confident that we don't actually need 250GB per instance, so I've reduced it and added a check that will help us spot if a job failed due to low disk space.",
            "comments": [],
            "commits": [
                "9f46404f6374fb0666cd8da8a4fd4a0f87477f27",
                "821da68e55e06945d1193d6d889331395b160d33"
            ]
        },
        "codes": [
            "awareness",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/platform-infrastructure/pull/241",
        "content": {
            "title": "Add a monthly report for costs data in Slack",
            "body": "For https://github.com/wellcomecollection/platform/issues/5281\r\n\r\nThis adds a monthly report that tells us how much we're spending. It should fire on the second Tuesday of every month (i.e., next Tuesday, and then every month after that).\r\n\r\nYou probably want to start with the explanation in the README (https://github.com/wellcomecollection/platform-infrastructure/tree/costs-report/costs_report), then get to the code.",
            "comments": [
                "\ud83d\udc4c "
            ],
            "commits": [
                "1c4dfe6e42933e9116f3e5de8638c7395c251a51",
                "978701714f5588715bab6402806e0bef1febc673",
                "5e8e710ff8a50c9b75935bd2a721795e933d6298",
                "516b18246ed8e892fdfb5e98ed56abb9e7d0b466",
                "80e2922bf049b2bf40d901f9c8dcc51ac228ee8f"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/platform-infrastructure/pull/99",
        "content": {
            "title": "Add some VPC endpoints for connecting to ECR",
            "body": "For https://github.com/wellcomecollection/platform/issues/4920 and https://github.com/wellcomecollection/platform/issues/4926\r\n\r\nWe spend ~$300/mo on NAT Gateway in the CI VPC, when almost everything it does is talking within AWS. We should be able to make this cost less spiky.\r\n\r\nAlso add the Name tags to as many endpoints as can be done from this repo, both for ease of working in the console and cost allocation purposes.",
            "comments": [],
            "commits": [
                "7a7f08573e0ff049555760ad51876b74acc942a1"
            ]
        },
        "codes": [
            "awareness",
            "networking",
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/combinator-ml/terraform-google-kubernetes/pull/1",
        "content": {
            "title": "feat: initial cheap gke cluster",
            "body": "",
            "comments": [],
            "commits": [
                "703ef359dbe7d4d2f2bbf9c0bbd31f5b4bc30e68"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/combinator-ml/terraform-google-kubernetes/pull/4",
        "content": {
            "title": "feat: add cheap(est) cpu autoscaling example",
            "body": "",
            "comments": [],
            "commits": [
                "27deaade65fd58e978b0a604c6c3fcd6683306bb"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/hmpps-env-configs/pull/534",
        "content": {
            "title": "Dam 515",
            "body": "maded mpx and \"all in one\" host as per UKcloud, as a means to getting around the cert issue and also to save costs.",
            "comments": [
                "Paul says it's alright"
            ],
            "commits": [
                "3b7936b565989d2c7217aa3f9042c0a393209928",
                "7da1adaeecd7402ab0b9a0d1a8d1e4052ff6affd",
                "6cbdac0a6821a5bed8541b1d94b073ab003d0f9e"
            ]
        },
        "codes": [
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/hmpps-env-configs/pull/1353",
        "content": {
            "title": "ALS-2057 - Added configuration for LDAP EFS + reduced specs for root EBS volume",
            "body": "Provisioned IOPS is no longer required for the root volume, as the LDAP data is now hosted on EFS. This should result in an EBS cost reduction.",
            "comments": [
                "LGTM"
            ],
            "commits": [
                "0328838420ac0d3754cf772a7d2f5bb1612193ed"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/hmpps-env-configs/pull/1711",
        "content": {
            "title": "Reduce DFI Instances size for identified cost savings",
            "body": null,
            "comments": [],
            "commits": [
                "954dda617d47007a8a1ff5780d3174e900e95be1"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/hmpps-env-configs/pull/1381",
        "content": {
            "title": "ALS-1712 Set ActiveMQ EFS throughput to 16MiB/s",
            "body": "Following performance test results, and risk/cost evaluation here: [ALS-1712](https://jira.engineering-dev.probation.hmpps.dsd.io/browse/ALS-1712)",
            "comments": [],
            "commits": [
                "28e80387490ac5303782b4762f1d42cac394464c"
            ]
        },
        "codes": [
            "unrelated",
            "note"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/tlc-pack/ci-terraform/pull/32",
        "content": {
            "title": "Add ARM-SMALL instance type",
            "body": "Same as in #24 this adds `r6g.large` instances under the\r\n`ARM-SMALL` label so we can start testing and using those in CI (5x\r\ncheaper than `m6g.4xlarge`). If that works well we can convert some\r\nusages over, and if not we can remove this autoscaling group.\r\n\r\ncc @konturn @areusch ",
            "comments": [
                "lgtm--we'll have to run jenkins workflow in ci repo for the fleet change to be propagated of course.",
                "<!-- dflook/terraform-github-actions {\"workspace\":\"tvm-ci-prod\",\"backend\":\"9b44da39ee9487233c81f1fd2e2699f3e76f280541db408bdc9a182f9fa7d326\",\"backend_type\":\"s3\"} -->\nTerraform plan in __.__ in the __tvm-ci-prod__ workspace\nWith var files: `vars/tvm-ci-prod.auto.tfvars\n`\n<details>\n<summary>Plan: 2 to add, 1 to change, 0 to destroy. Changes to Outputs.</summary>\n\n```hcl\nTerraform used the selected providers to generate the following execution\nplan. Resource actions are indicated with the following symbols:\n  + create\n  ~ update in-place\n\nTerraform will perform the following actions:\n\n  # aws_s3_bucket.artifacts-bucket will be updated in-place\n  ~ resource \"aws_s3_bucket\" \"artifacts-bucket\" {\n      + acl                         = \"private\"\n      + force_destroy               = false\n        id                          = \"tvm-jenkins-artifacts-prod\"\n      ~ tags                        = {\n          + \"Name\" = \"tvm-jenkins-artifacts-prod\"\n        }\n      ~ tags_all                    = {\n          + \"Name\" = \"tvm-jenkins-artifacts-prod\"\n        }\n        # (7 unchanged attributes hidden)\n\n      + lifecycle_rule {\n          + enabled = true\n          + id      = \"weekly_retention\"\n\n          + expiration {\n              + days = 7\n            }\n        }\n\n        # (1 unchanged block hidden)\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-ARM-Small\"].aws_autoscaling_group.agents will be created\n  + resource \"aws_autoscaling_group\" \"agents\" {\n      + arn                       = (known after apply)\n      + availability_zones        = (known after apply)\n      + default_cooldown          = (known after apply)\n      + desired_capacity          = (known after apply)\n      + force_delete              = false\n      + force_delete_warm_pool    = false\n      + health_check_grace_period = 300\n      + health_check_type         = (known after apply)\n      + id                        = (known after apply)\n      + max_size                  = 90\n      + metrics_granularity       = \"1Minute\"\n      + min_size                  = 0\n      + name                      = \"Prod-Autoscaler-Jenkins-ARM-Small\"\n      + name_prefix               = (known after apply)\n      + protect_from_scale_in     = false\n      + service_linked_role_arn   = (known after apply)\n      + vpc_zone_identifier       = [\n          + \"subnet-0548976da0eb119b8\",\n          + \"subnet-0ab37ff3dbeb0e52b\",\n          + \"subnet-0fa03daf38e6b72a8\",\n        ]\n      + wait_for_capacity_timeout = \"10m\"\n\n      + mixed_instances_policy {\n          + instances_distribution {\n              + on_demand_allocation_strategy            = (known after apply)\n              + on_demand_base_capacity                  = 0\n              + on_demand_percentage_above_base_capacity = 100\n              + spot_allocation_strategy                 = \"capacity-optimized\"\n              + spot_instance_pools                      = (known after apply)\n            }\n\n          + launch_template {\n              + launch_template_specification {\n                  + launch_template_id   = (known after apply)\n                  + launch_template_name = (known after apply)\n                  + version              = (known after apply)\n                }\n            }\n        }\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-ARM-Small\"].aws_launch_template.autoscaler will be created\n  + resource \"aws_launch_template\" \"autoscaler\" {\n      + arn                    = (known after apply)\n      + default_version        = (known after apply)\n      + id                     = (known after apply)\n      + image_id               = \"*********************\"\n      + instance_type          = \"r6g.large\"\n      + key_name               = \"tvm_ci_creds\"\n      + latest_version         = (known after apply)\n      + name                   = (known after apply)\n      + name_prefix            = \"Prod-Autoscaler-Jenkins-ARM-Small\"\n      + tags_all               = (known after apply)\n      + user_data              = \"IyEgL3Vzci9iaW4vZW52IGJhc2gKbWtkaXIgLXAgL2hvbWUvamVua2lucy8uc3NoCnRvdWNoIC9ob21lL2plbmtpbnMvLnByb2ZpbGUKZWNobyAiQ0lfTlVNX0VYRUNVVE9SUz0xIiA+PiAvaG9tZS9qZW5raW5zLy5zc2gvZW52aXJvbm1lbnQKY2htb2QgNzAwIC9ob21lL2plbmtpbnMvLnNzaC9lbnZpcm9ubWVudAplY2hvIHNzaC1lZDI1NTE5IEFBQUFDM056YUMxbFpESTFOVEU1QUFBQUlCWnZHbXlzcHo1eWFaMm4wSDJVMlhHOHhVTG0yR1lvVDhGbzNxZWJJMzR2ID4+IC9ob21lL2plbmtpbnMvLnNzaC9hdXRob3JpemVkX2tleXMKY2hvd24gLVIgamVua2luczpqZW5raW5zIC9ob21lL2plbmtpbnMKZWNobyAic3NoLWVkMjU1MTkgQUFBQUMzTnphQzFsWkRJMU5URTVBQUFBSUJBc0FhWENESkJJU09RaDh2ZHJVWHlPU29RMnBmUXVMNTc5NzRPa3VHYlcKc3NoLWVkMjU1MTkgQUFBQUMzTnphQzFsWkRJMU5URTVBQUFBSUJGWnRJU1FXMk1TS1ZqNndpYms4bkI0UkJmNFp1b2x1SnRCV21lV1BvZWUKc3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFDQVFEOGR6NTUyNm53emZWQ2lRdnFLQ3JIM28xclVxN0hEODRtbE9POS96c1h1WVk3aXdjRi94M2FlRTI0TUluNVhmUFpJeWU2aXllK2lFc04xckpRb2RhbU5DVUE0M0cwVFhTNlhqN1QzZkxBdFU5M2V5Y2VRSWV1RWpoRGZTc0ZXZUtwa1pUUkUwZGVsb0s5aW9aczVvQ0k0TnRqeG53WmRrM2dVUTBjK2YxS0FZdlg1dzl1T1FYeW5Na3VRY3NDQTY3NDBlVFZFcjhvaHA2VHRhZm5WdGhVQUsxYWN3K2xETVhOU1dDNkZwckZlalRPRnR3TCtVUVMyV2pVQXhpamgweDdmVTRWa05PcWdmVG52VTBEVDg2U1laM3RNK1FBdktRU1hQV3VLa1JnVEMzcm1qUUJsdjhFNzliVXdPMU1wNHNML1ZKais4UmNBQzhDOEYwZHVJSENOa1ljWFBCVkR6UDZGRlpYdC9TV3pDODlVMjN1dzVJMW40eDFZV1FPbDhNejIvVWFPU2NaMnZvUnZNYytiazdlTWdkc1BIS0YwYW8zdTBaUmJnRHdnK3JmMVIwOEVkMlBuWkUyQTNWTHpIMXB0U2lJbWk3NEdlbW1qT1o5bldwZVExVXJWRkhETnVSSWVZOVZVc3Z3emd4eHEvSzNtZ0lnczEybGZWeGtHc09SdmJjQUJMTFZLYWlNNHJidEhMUTlTS3F3azVPQ1NTdnIzUlVZU0dyeDVZOW5RdlYwY0IxbmY2QTdRRTZkc0Y1dmgxYUpMd0k4OUV1M0ZpL241M3VaamdqMXVGMC9WK0ZqYVE4dVk4YnhtMXNXclNGVnJKOGF1Z2lmM0tMNXZ0OW1PcHRiSkwvMEF6OUdaenZvTGYrVStiVUpVSlI3WDM1dGVDOG8wdTVJQVE9PQpzc2gtZWQyNTUxOSBBQUFBQzNOemFDMWxaREkxTlRFNUFBQUFJR2FRZUdSTlVSNFAySUVLZDF4K05pcWpmeTFPakVqZ3dUUWRYRmUwblA3Sgpzc2gtcnNhIEFBQUFCM056YUMxeWMyRUFBQUFEQVFBQkFBQUNBUUQ4ZHo1NTI2bnd6ZlZDaVF2cUtDckgzbzFyVXE3SEQ4NG1sT085L3pzWHVZWTdpd2NGL3gzYWVFMjRNSW41WGZQWkl5ZTZpeWUraUVzTjFySlFvZGFtTkNVQTQzRzBUWFM2WGo3VDNmTEF0VTkzZXljZVFJZXVFamhEZlNzRldlS3BrWlRSRTBkZWxvSzlpb1pzNW9DSTROdGp4bndaZGszZ1VRMGMrZjFLQVl2WDV3OXVPUVh5bk1rdVFjc0NBNjc0MGVUVkVyOG9ocDZUdGFmblZ0aFVBSzFhY3crbERNWE5TV0M2RnByRmVqVE9GdHdMK1VRUzJXalVBeGlqaDB4N2ZVNFZrTk9xZ2ZUbnZVMERUODZTWVozdE0rUUF2S1FTWFBXdUtrUmdUQzNybWpRQmx2OEU3OWJVd08xTXA0c0wvVkpqKzhSY0FDOEM4RjBkdUlIQ05rWWNYUEJWRHpQNkZGWlh0L1NXekM4OVUyM3V3NUkxbjR4MVlXUU9sOE16Mi9VYU9TY1oydm9Sdk1jK2JrN2VNZ2RzUEhLRjBhbzN1MFpSYmdEd2crcmYxUjA4RWQyUG5aRTJBM1ZMekgxcHRTaUltaTc0R2VtbWpPWjluV3BlUTFVclZGSEROdVJJZVk5VlVzdnd6Z3h4cS9LM21nSWdzMTJsZlZ4a0dzT1J2YmNBQkxMVkthaU00cmJ0SExROVNLcXdrNU9DU1N2cjNSVVlTR3J4NVk5blF2VjBjQjFuZjZBN1FFNmRzRjV2aDFhSkx3STg5RXUzRmkvbjUzdVpqZ2oxdUYwL1YrRmphUTh1WThieG0xc1dyU0ZWcko4YXVnaWYzS0w1dnQ5bU9wdGJKTC8wQXo5R1p6dm9MZitVK2JVSlVKUjdYMzV0ZUM4bzB1NUlBUT09CnNzaC1yc2EgQUFBQUIzTnphQzF5YzJFQUFBQURBUUFCQUFBQkFRREovNXJzU0hiZXZhengzSkpuQVZRbE9aZFJnNWwxUHVSOUppRmVhMmdvNU5xTWZWNHFyUzFQbndrTlRwL1l6akxxMWRiRnc4NFFyS3JNdkFsR0RIQU9waHIyQ0ErL0ZUTXFyeGxaeU93VkVZZzJSbmEzQUJldENrVCtZdUd1ZXRQMzBVREVHaUxTWGc4djIveXZQN0tqZVE4UUpneDJSd0k0QzVaaHJ6L2JaK25UNU9rZ05PcHVCcEI3bjIwWUZwQmZqczk2cTAyL3JYZ0VJeCtVWHlpamNNVGg4Si8xNno2MHB4dkgwNUVwMEtUc1pTZTIzV0lXN0NBbDZRbkx1Q0tZV0VBZlROZWN1UEJ1UW1LRHBqWXp4SkJUalRvL2dFUjZNYlpqaE00d0h5Zml0TktWdnYzcFNHVXdvZUNIY0tmL0JmQmRGRSs4S05OSDNqMGVJZlVMCnNzaC1lZDI1NTE5IEFBQUFDM056YUMxbFpESTFOVEU1QUFBQUlEbnpyV1JVaW5RTzJWT3YwcUNKRjJRZXdBNHljVWlwV0g1M3cvdk1XTzZWIGRyaWF6YXRpCiIgPj4gL3Jvb3QvLnNzaC9hdXRob3JpemVkX2tleXMKZWNobyAiUGVybWl0VXNlckVudmlyb25tZW50IHllcyIgPj4gL2V0Yy9zc2gvc3NoZF9jb25maWcKc3lzdGVtY3RsIHJlc3RhcnQgc3NoZAo=\"\n      + vpc_security_group_ids = [\n          + \"sg-03e5a485a8fd23223\",\n          + \"sg-0a7cd8e7e7707c124\",\n        ]\n\n      + block_device_mappings {\n          + device_name = \"/dev/sda1\"\n\n          + ebs {\n              + iops        = (known after apply)\n              + throughput  = (known after apply)\n              + volume_size = 250\n              + volume_type = (known after apply)\n            }\n        }\n\n      + iam_instance_profile {\n          + name = \"autoscalers_instance_profile\"\n        }\n\n      + metadata_options {\n          + http_endpoint               = (known after apply)\n          + http_protocol_ipv6          = (known after apply)\n          + http_put_response_hop_limit = (known after apply)\n          + http_tokens                 = (known after apply)\n          + instance_metadata_tags      = (known after apply)\n        }\n    }\n\nPlan: 2 to add, 1 to change, 0 to destroy.\n\nChanges to Outputs:\n  ~ fleet_config = <<-EOT\n        jenkins:\n          clouds: \n          \n          - ec2Fleet:\n              addNodeOnlyIfRunning: false\n              alwaysReconnect: false\n              cloudStatusIntervalSec: 10\n              computerConnector:\n                sSHConnector:\n                  credentialsId: \"jenkins\"\n                  launchTimeoutSeconds: 60\n                  maxNumRetries: 10\n                  port: 22\n                  retryWaitTime: 15\n                  sshHostKeyVerificationStrategy: \"nonVerifyingKeyVerificationStrategy\"\n              disableTaskResubmit: false\n              fleet: Prod-Autoscaler-Jenkins-ARM\n              idleMinutes: 5\n              initOnlineCheckIntervalSec: 15\n              initOnlineTimeoutSec: 180\n              labelString: \"ARM\"\n              maxSize: 90\n              maxTotalUses: -1\n              minSize: 2\n              name: \"Prod-Autoscaler-Jenkins-ARM\"\n              noDelayProvision: true\n              numExecutors: 1\n              oldId: \"803939ae-c6f8-4c7a-8386-0d1a9af631ad\"\n              privateIpUsed: true\n              region: \"us-west-2\"\n              restrictUsage: false\n              scaleExecutorsByWeight: false\n          \n          - ec2Fleet:\n              addNodeOnlyIfRunning: false\n              alwaysReconnect: false\n              cloudStatusIntervalSec: 10\n              computerConnector:\n                sSHConnector:\n                  credentialsId: \"jenkins\"\n                  launchTimeoutSeconds: 60\n                  maxNumRetries: 10\n                  port: 22\n                  retryWaitTime: 15\n                  sshHostKeyVerificationStrategy: \"nonVerifyingKeyVerificationStrategy\"\n              disableTaskResubmit: false\n      +       fleet: Prod-Autoscaler-Jenkins-ARM-Small\n      +       idleMinutes: 5\n      +       initOnlineCheckIntervalSec: 15\n      +       initOnlineTimeoutSec: 180\n      +       labelString: \"ARM-SMALL\"\n      +       maxSize: 90\n      +       maxTotalUses: -1\n      +       minSize: 0\n      +       name: \"Prod-Autoscaler-Jenkins-ARM-Small\"\n      +       noDelayProvision: true\n      +       numExecutors: 1\n      +       oldId: \"803939ae-c6f8-4c7a-8386-0d1a9af631ad\"\n      +       privateIpUsed: true\n      +       region: \"us-west-2\"\n      +       restrictUsage: false\n      +       scaleExecutorsByWeight: false\n      +   \n      +   - ec2Fleet:\n      +       addNodeOnlyIfRunning: false\n      +       alwaysReconnect: false\n      +       cloudStatusIntervalSec: 10\n      +       computerConnector:\n      +         sSHConnector:\n      +           credentialsId: \"jenkins\"\n      +           launchTimeoutSeconds: 60\n      +           maxNumRetries: 10\n      +           port: 22\n      +           retryWaitTime: 15\n      +           sshHostKeyVerificationStrategy: \"nonVerifyingKeyVerificationStrategy\"\n      +       disableTaskResubmit: false\n              fleet: Prod-Autoscaler-Jenkins-CPU\n              idleMinutes: 5\n              initOnlineCheckIntervalSec: 15\n              initOnlineTimeoutSec: 180\n              labelString: \"CPU\"\n              maxSize: 90\n              maxTotalUses: -1\n              minSize: 6\n              name: \"Prod-Autoscaler-Jenkins-CPU\"\n              noDelayProvision: true\n              numExecutors: 1\n              oldId: \"803939ae-c6f8-4c7a-8386-0d1a9af631ad\"\n              privateIpUsed: true\n              region: \"us-west-2\"\n              restrictUsage: false\n              scaleExecutorsByWeight: false\n          \n          - ec2Fleet:\n              addNodeOnlyIfRunning: false\n              alwaysReconnect: false\n              cloudStatusIntervalSec: 10\n              computerConnector:\n                sSHConnector:\n                  credentialsId: \"jenkins\"\n                  launchTimeoutSeconds: 60\n                  maxNumRetries: 10\n                  port: 22\n                  retryWaitTime: 15\n                  sshHostKeyVerificationStrategy: \"nonVerifyingKeyVerificationStrategy\"\n              disableTaskResubmit: false\n              fleet: Prod-Autoscaler-Jenkins-CPU-Small\n              idleMinutes: 5\n              initOnlineCheckIntervalSec: 15\n              initOnlineTimeoutSec: 180\n              labelString: \"CPU-SMALL\"\n              maxSize: 100\n              maxTotalUses: -1\n              minSize: 0\n              name: \"Prod-Autoscaler-Jenkins-CPU-Small\"\n              noDelayProvision: true\n              numExecutors: 1\n              oldId: \"803939ae-c6f8-4c7a-8386-0d1a9af631ad\"\n              privateIpUsed: true\n              region: \"us-west-2\"\n              restrictUsage: false\n              scaleExecutorsByWeight: false\n          \n          - ec2Fleet:\n              addNodeOnlyIfRunning: false\n              alwaysReconnect: false\n              cloudStatusIntervalSec: 10\n              computerConnector:\n                sSHConnector:\n                  credentialsId: \"jenkins\"\n                  launchTimeoutSeconds: 60\n                  maxNumRetries: 10\n                  port: 22\n                  retryWaitTime: 15\n                  sshHostKeyVerificationStrategy: \"nonVerifyingKeyVerificationStrategy\"\n              disableTaskResubmit: false\n              fleet: Prod-Autoscaler-Jenkins-GPU\n              idleMinutes: 5\n              initOnlineCheckIntervalSec: 15\n              initOnlineTimeoutSec: 180\n              labelString: \"GPU\"\n              maxSize: 90\n              maxTotalUses: -1\n              minSize: 8\n              name: \"Prod-Autoscaler-Jenkins-GPU\"\n              noDelayProvision: true\n              numExecutors: 1\n              oldId: \"803939ae-c6f8-4c7a-8386-0d1a9af631ad\"\n              privateIpUsed: true\n              region: \"us-west-2\"\n              restrictUsage: false\n              scaleExecutorsByWeight: false\n          \n          - ec2Fleet:\n              addNodeOnlyIfRunning: false\n              alwaysReconnect: false\n              cloudStatusIntervalSec: 10\n              computerConnector:\n                sSHConnector:\n                  credentialsId: \"jenkins\"\n                  launchTimeoutSeconds: 60\n                  maxNumRetries: 10\n                  port: 22\n                  retryWaitTime: 15\n                  sshHostKeyVerificationStrategy: \"nonVerifyingKeyVerificationStrategy\"\n              disableTaskResubmit: false\n              fleet: Prod-Autoscaler-Jenkins-GPU-4x\n              idleMinutes: 5\n              initOnlineCheckIntervalSec: 15\n              initOnlineTimeoutSec: 180\n              labelString: \"GPU\"\n              maxSize: 2\n              maxTotalUses: -1\n              minSize: 2\n              name: \"Prod-Autoscaler-Jenkins-GPU-4x\"\n              noDelayProvision: true\n              numExecutors: 1\n              oldId: \"803939ae-c6f8-4c7a-8386-0d1a9af631ad\"\n              privateIpUsed: true\n              region: \"us-west-2\"\n              restrictUsage: false\n              scaleExecutorsByWeight: false\n          \n    EOT\n```\n</details>\n\n:x: Plan not applied in [terraform #8](https://github.com/tlc-pack/ci-terraform/actions/runs/2373421896) (Plan has changed)"
            ],
            "commits": [
                "af285dd17beb9c35ea6339b3b9f43d6b166b5411"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/tlc-pack/ci-terraform/pull/40",
        "content": {
            "title": "Shuffle parameters for autoscaled nodes",
            "body": "These couple changes should help get the job queue under control now\r\nthat we're using a lot more node-level parallelism. EBS costs are also up since every node is getting 250 GB which is more than it needs (spot checked a bunch of nodes, never saw more than 65 GB in use). Queue got pretty backed up yesterday\r\n\r\n![image](https://user-images.githubusercontent.com/9407960/170364243-17e8335b-19b9-4d7a-9bf7-24149201f5a7.png)\r\n\r\n",
            "comments": [
                "<!-- dflook/terraform-github-actions {\"workspace\":\"tvm-ci-prod\",\"backend\":\"a45a75f944b796a241e630640bb0a85bffbf5a9d4cd356a2ba5f1bc279d309da\",\"backend_type\":\"s3\"} -->\nTerraform plan in __.__ in the __tvm-ci-prod__ workspace\nWith var files: `vars/tvm-ci-prod.auto.tfvars\n`\n<details>\n<summary>Plan: 0 to add, 12 to change, 0 to destroy. Changes to Outputs.</summary>\n\n```hcl\nTerraform used the selected providers to generate the following execution\nplan. Resource actions are indicated with the following symbols:\n  ~ update in-place\n\nTerraform will perform the following actions:\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-ARM\"].aws_autoscaling_group.agents will be updated in-place\n  ~ resource \"aws_autoscaling_group\" \"agents\" {\n        id                        = \"Prod-Autoscaler-Jenkins-ARM\"\n        name                      = \"Prod-Autoscaler-Jenkins-ARM\"\n        # (22 unchanged attributes hidden)\n\n      ~ mixed_instances_policy {\n\n          ~ launch_template {\n              ~ launch_template_specification {\n                  ~ version              = \"10\" -> (known after apply)\n                    # (2 unchanged attributes hidden)\n                }\n            }\n            # (1 unchanged block hidden)\n        }\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-ARM\"].aws_launch_template.autoscaler will be updated in-place\n  ~ resource \"aws_launch_template\" \"autoscaler\" {\n        id                      = \"lt-0307dda3ecfec7907\"\n      ~ latest_version          = 10 -> (known after apply)\n        name                    = \"Prod-Autoscaler-Jenkins-ARM20220125202831343700000004\"\n        tags                    = {}\n        # (11 unchanged attributes hidden)\n\n      ~ block_device_mappings {\n            # (1 unchanged attribute hidden)\n\n          ~ ebs {\n              ~ volume_size = 250 -> 80\n                # (2 unchanged attributes hidden)\n            }\n        }\n\n        # (1 unchanged block hidden)\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-ARM-Small\"].aws_autoscaling_group.agents will be updated in-place\n  ~ resource \"aws_autoscaling_group\" \"agents\" {\n        id                        = \"Prod-Autoscaler-Jenkins-ARM-Small\"\n        name                      = \"Prod-Autoscaler-Jenkins-ARM-Small\"\n        # (22 unchanged attributes hidden)\n\n      ~ mixed_instances_policy {\n\n          ~ launch_template {\n              ~ launch_template_specification {\n                  ~ version              = \"1\" -> (known after apply)\n                    # (2 unchanged attributes hidden)\n                }\n            }\n            # (1 unchanged block hidden)\n        }\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-ARM-Small\"].aws_launch_template.autoscaler will be updated in-place\n  ~ resource \"aws_launch_template\" \"autoscaler\" {\n        id                      = \"lt-0eb9ed056278d5a50\"\n      ~ latest_version          = 1 -> (known after apply)\n        name                    = \"Prod-Autoscaler-Jenkins-ARM-Small20220524173817984800000001\"\n        tags                    = {}\n        # (11 unchanged attributes hidden)\n\n      ~ block_device_mappings {\n            # (1 unchanged attribute hidden)\n\n          ~ ebs {\n              ~ volume_size = 250 -> 80\n                # (2 unchanged attributes hidden)\n            }\n        }\n\n        # (1 unchanged block hidden)\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-CPU\"].aws_autoscaling_group.agents will be updated in-place\n  ~ resource \"aws_autoscaling_group\" \"agents\" {\n        id                        = \"Prod-Autoscaler-Jenkins-CPU\"\n        name                      = \"Prod-Autoscaler-Jenkins-CPU\"\n        # (22 unchanged attributes hidden)\n\n      ~ mixed_instances_policy {\n\n          ~ launch_template {\n              ~ launch_template_specification {\n                  ~ version              = \"11\" -> (known after apply)\n                    # (2 unchanged attributes hidden)\n                }\n            }\n            # (1 unchanged block hidden)\n        }\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-CPU\"].aws_launch_template.autoscaler will be updated in-place\n  ~ resource \"aws_launch_template\" \"autoscaler\" {\n        id                      = \"lt-084b74d77c2ee9ba2\"\n      ~ latest_version          = 11 -> (known after apply)\n        name                    = \"Prod-Autoscaler-Jenkins-CPU20220125202831342000000001\"\n        tags                    = {}\n        # (11 unchanged attributes hidden)\n\n      ~ block_device_mappings {\n            # (1 unchanged attribute hidden)\n\n          ~ ebs {\n              ~ volume_size = 250 -> 80\n                # (2 unchanged attributes hidden)\n            }\n        }\n\n        # (1 unchanged block hidden)\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-CPU-Small\"].aws_autoscaling_group.agents will be updated in-place\n  ~ resource \"aws_autoscaling_group\" \"agents\" {\n        id                        = \"Prod-Autoscaler-Jenkins-CPU-Small\"\n        name                      = \"Prod-Autoscaler-Jenkins-CPU-Small\"\n        # (22 unchanged attributes hidden)\n\n      - launch_template {\n          - id      = \"lt-02518d53b22a85dd8\" -> null\n          - name    = \"Prod-Autoscaler-Jenkins-CPU-Small20220425184607394500000002\" -> null\n          - version = \"4\" -> null\n        }\n\n      + mixed_instances_policy {\n          + instances_distribution {\n              + on_demand_base_capacity                  = 0\n              + on_demand_percentage_above_base_capacity = 100\n              + spot_allocation_strategy                 = \"capacity-optimized\"\n            }\n\n          + launch_template {\n              + launch_template_specification {\n                  + launch_template_id = \"********************\"\n                  + version            = (known after apply)\n                }\n            }\n        }\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-CPU-Small\"].aws_launch_template.autoscaler will be updated in-place\n  ~ resource \"aws_launch_template\" \"autoscaler\" {\n        id                      = \"lt-02518d53b22a85dd8\"\n      ~ latest_version          = 4 -> (known after apply)\n        name                    = \"Prod-Autoscaler-Jenkins-CPU-Small20220425184607394500000002\"\n        tags                    = {}\n        # (11 unchanged attributes hidden)\n\n      ~ block_device_mappings {\n            # (1 unchanged attribute hidden)\n\n          ~ ebs {\n              ~ volume_size = 250 -> 80\n                # (2 unchanged attributes hidden)\n            }\n        }\n\n        # (1 unchanged block hidden)\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-GPU\"].aws_autoscaling_group.agents will be updated in-place\n  ~ resource \"aws_autoscaling_group\" \"agents\" {\n        id                        = \"Prod-Autoscaler-Jenkins-GPU\"\n        name                      = \"Prod-Autoscaler-Jenkins-GPU\"\n        # (22 unchanged attributes hidden)\n\n      ~ mixed_instances_policy {\n\n          ~ launch_template {\n              ~ launch_template_specification {\n                  ~ version              = \"8\" -> (known after apply)\n                    # (2 unchanged attributes hidden)\n                }\n            }\n            # (1 unchanged block hidden)\n        }\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-GPU\"].aws_launch_template.autoscaler will be updated in-place\n  ~ resource \"aws_launch_template\" \"autoscaler\" {\n        id                      = \"lt-0f6765aeec1cbbc77\"\n      ~ latest_version          = 8 -> (known after apply)\n        name                    = \"Prod-Autoscaler-Jenkins-GPU20220125202831343600000003\"\n        tags                    = {}\n        # (11 unchanged attributes hidden)\n\n      ~ block_device_mappings {\n            # (1 unchanged attribute hidden)\n\n          ~ ebs {\n              ~ volume_size = 250 -> 80\n                # (2 unchanged attributes hidden)\n            }\n        }\n\n        # (1 unchanged block hidden)\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-GPU-4x\"].aws_autoscaling_group.agents will be updated in-place\n  ~ resource \"aws_autoscaling_group\" \"agents\" {\n        id                        = \"Prod-Autoscaler-Jenkins-GPU-4x\"\n        name                      = \"Prod-Autoscaler-Jenkins-GPU-4x\"\n        # (22 unchanged attributes hidden)\n\n      ~ mixed_instances_policy {\n\n          ~ launch_template {\n              ~ launch_template_specification {\n                  ~ version              = \"2\" -> (known after apply)\n                    # (2 unchanged attributes hidden)\n                }\n            }\n            # (1 unchanged block hidden)\n        }\n    }\n\n  # module.Jenkins-Autoscalers[\"Prod-Autoscaler-Jenkins-GPU-4x\"].aws_launch_template.autoscaler will be updated in-place\n  ~ resource \"aws_launch_template\" \"autoscaler\" {\n        id                      = \"lt-01418a418e22d6974\"\n      ~ latest_version          = 2 -> (known after apply)\n        name                    = \"Prod-Autoscaler-Jenkins-GPU-4x20220425184607393700000001\"\n        tags                    = {}\n        # (11 unchanged attributes hidden)\n\n      ~ block_device_mappings {\n            # (1 unchanged attribute hidden)\n\n          ~ ebs {\n              ~ volume_size = 250 -> 80\n                # (2 unchanged attributes hidden)\n            }\n        }\n\n        # (1 unchanged block hidden)\n    }\n\nPlan: 0 to add, 12 to change, 0 to destroy.\n\nChanges to Outputs:\n  ~ fleet_config = <<-EOT\n        jenkins:\n          clouds: \n          \n          - ec2Fleet:\n              addNodeOnlyIfRunning: false\n              alwaysReconnect: false\n              cloudStatusIntervalSec: 10\n              computerConnector:\n                sSHConnector:\n                  credentialsId: \"jenkins\"\n                  launchTimeoutSeconds: 60\n                  maxNumRetries: 10\n                  port: 22\n                  retryWaitTime: 15\n                  sshHostKeyVerificationStrategy: \"nonVerifyingKeyVerificationStrategy\"\n              disableTaskResubmit: false\n              fleet: Prod-Autoscaler-Jenkins-ARM\n      -       idleMinutes: 5\n      +       idleMinutes: 1\n              initOnlineCheckIntervalSec: 15\n              initOnlineTimeoutSec: 180\n              labelString: \"ARM\"\n              maxSize: 90\n              maxTotalUses: -1\n              minSize: 2\n              name: \"Prod-Autoscaler-Jenkins-ARM\"\n              noDelayProvision: true\n              numExecutors: 1\n              oldId: \"803939ae-c6f8-4c7a-8386-0d1a9af631ad\"\n              privateIpUsed: true\n              region: \"us-west-2\"\n              restrictUsage: false\n              scaleExecutorsByWeight: false\n          \n          - ec2Fleet:\n              addNodeOnlyIfRunning: false\n              alwaysReconnect: false\n              cloudStatusIntervalSec: 10\n              computerConnector:\n                sSHConnector:\n                  credentialsId: \"jenkins\"\n                  launchTimeoutSeconds: 60\n                  maxNumRetries: 10\n                  port: 22\n                  retryWaitTime: 15\n                  sshHostKeyVerificationStrategy: \"nonVerifyingKeyVerificationStrategy\"\n              disableTaskResubmit: false\n              fleet: Prod-Autoscaler-Jenkins-ARM-Small\n      -       idleMinutes: 5\n      +       idleMinutes: 1\n              initOnlineCheckIntervalSec: 15\n              initOnlineTimeoutSec: 180\n              labelString: \"ARM-SMALL\"\n              maxSize: 90\n              maxTotalUses: -1\n              minSize: 0\n              name: \"Prod-Autoscaler-Jenkins-ARM-Small\"\n              noDelayProvision: true\n              numExecutors: 1\n              oldId: \"803939ae-c6f8-4c7a-8386-0d1a9af631ad\"\n              privateIpUsed: true\n              region: \"us-west-2\"\n              restrictUsage: false\n              scaleExecutorsByWeight: false\n          \n          - ec2Fleet:\n              addNodeOnlyIfRunning: false\n              alwaysReconnect: false\n              cloudStatusIntervalSec: 10\n              computerConnector:\n                sSHConnector:\n                  credentialsId: \"jenkins\"\n                  launchTimeoutSeconds: 60\n                  maxNumRetries: 10\n                  port: 22\n                  retryWaitTime: 15\n                  sshHostKeyVerificationStrategy: \"nonVerifyingKeyVerificationStrategy\"\n              disableTaskResubmit: false\n              fleet: Prod-Autoscaler-Jenkins-CPU\n      -       idleMinutes: 5\n      +       idleMinutes: 1\n              initOnlineCheckIntervalSec: 15\n              initOnlineTimeoutSec: 180\n              labelString: \"CPU\"\n              maxSize: 90\n              maxTotalUses: -1\n              minSize: 6\n              name: \"Prod-Autoscaler-Jenkins-CPU\"\n              noDelayProvision: true\n              numExecutors: 1\n              oldId: \"803939ae-c6f8-4c7a-8386-0d1a9af631ad\"\n              privateIpUsed: true\n              region: \"us-west-2\"\n              restrictUsage: false\n              scaleExecutorsByWeight: false\n          \n          - ec2Fleet:\n              addNodeOnlyIfRunning: false\n              alwaysReconnect: false\n              cloudStatusIntervalSec: 10\n              computerConnector:\n                sSHConnector:\n                  credentialsId: \"jenkins\"\n                  launchTimeoutSeconds: 60\n                  maxNumRetries: 10\n                  port: 22\n                  retryWaitTime: 15\n                  sshHostKeyVerificationStrategy: \"nonVerifyingKeyVerificationStrategy\"\n              disableTaskResubmit: false\n              fleet: Prod-Autoscaler-Jenkins-CPU-Small\n      -       idleMinutes: 5\n      +       idleMinutes: 1\n              initOnlineCheckIntervalSec: 15\n              initOnlineTimeoutSec: 180\n              labelString: \"CPU-SMALL\"\n      -       maxSize: 100\n      +       maxSize: 200\n              maxTotalUses: -1\n              minSize: 0\n              name: \"Prod-Autoscaler-Jenkins-CPU-Small\"\n              noDelayProvision: true\n              numExecutors: 1\n              oldId: \"803939ae-c6f8-4c7a-8386-0d1a9af631ad\"\n              privateIpUsed: true\n              region: \"us-west-2\"\n              restrictUsage: false\n              scaleExecutorsByWeight: false\n          \n          - ec2Fleet:\n              addNodeOnlyIfRunning: false\n              alwaysReconnect: false\n              cloudStatusIntervalSec: 10\n              computerConnector:\n                sSHConnector:\n                  credentialsId: \"jenkins\"\n                  launchTimeoutSeconds: 60\n                  maxNumRetries: 10\n                  port: 22\n                  retryWaitTime: 15\n                  sshHostKeyVerificationStrategy: \"nonVerifyingKeyVerificationStrategy\"\n              disableTaskResubmit: false\n              fleet: Prod-Autoscaler-Jenkins-GPU\n      -       idleMinutes: 5\n      +       idleMinutes: 1\n              initOnlineCheckIntervalSec: 15\n              initOnlineTimeoutSec: 180\n              labelString: \"GPU\"\n              maxSize: 90\n              maxTotalUses: -1\n              minSize: 8\n              name: \"Prod-Autoscaler-Jenkins-GPU\"\n              noDelayProvision: true\n              numExecutors: 1\n              oldId: \"803939ae-c6f8-4c7a-8386-0d1a9af631ad\"\n              privateIpUsed: true\n              region: \"us-west-2\"\n              restrictUsage: false\n              scaleExecutorsByWeight: false\n          \n          - ec2Fleet:\n              addNodeOnlyIfRunning: false\n              alwaysReconnect: false\n              cloudStatusIntervalSec: 10\n              computerConnector:\n                sSHConnector:\n                  credentialsId: \"jenkins\"\n                  launchTimeoutSeconds: 60\n                  maxNumRetries: 10\n                  port: 22\n                  retryWaitTime: 15\n                  sshHostKeyVerificationStrategy: \"nonVerifyingKeyVerificationStrategy\"\n              disableTaskResubmit: false\n              fleet: Prod-Autoscaler-Jenkins-GPU-4x\n      -       idleMinutes: 5\n      +       idleMinutes: 1\n              initOnlineCheckIntervalSec: 15\n              initOnlineTimeoutSec: 180\n              labelString: \"GPU\"\n              maxSize: 2\n              maxTotalUses: -1\n              minSize: 2\n              name: \"Prod-Autoscaler-Jenkins-GPU-4x\"\n              noDelayProvision: true\n              numExecutors: 1\n              oldId: \"803939ae-c6f8-4c7a-8386-0d1a9af631ad\"\n              privateIpUsed: true\n              region: \"us-west-2\"\n              restrictUsage: false\n              scaleExecutorsByWeight: false\n          \n    EOT\n```\n</details>\n\n:white_check_mark: Plan applied in [terraform #9](https://github.com/tlc-pack/ci-terraform/actions/runs/2387239095)"
            ],
            "commits": [
                "3cf93681a073f0c548b934cc624d356e54ee71c5"
            ]
        },
        "codes": [
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/tlc-pack/ci-terraform/pull/24",
        "content": {
            "title": "Add CPU-SMALL instances",
            "body": "This adds a class of CPU instances that are far [cheaper](https://instances.vantage.sh/?compare_on=true&selected=c4.4xlarge,r5.large) than the current `CPU` instances that we can use for certain tasks that don't require big instances, I'm thinking for linting and builds (since those are mostly cached anyways). We could also potentially move certain test steps to these instances such as the unit tests but reliability.\r\n\r\ncc @areusch @konturn ",
            "comments": [
                "@konturn thoughts?",
                "This looks good--once we switch the relevant jobs over to this tag we can start profiling average usage and then get convertible RI's for this instance series."
            ],
            "commits": [
                "aae09ea0dc9f394bd83e640ae003ba336a28a2b5"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ONSdigital/eq-terraform/pull/157",
        "content": {
            "title": "Switch to on-demand billing for DynamoDB",
            "body": "### What is the context of this PR?\r\nTests https://github.com/ONSdigital/eq-terraform-dynamodb/pull/14\r\n\r\n### How to review\r\nRun it and see if it works\r\n",
            "comments": [
                "Matches the changes I made when running the other module. Not tested in this instance though."
            ],
            "commits": [
                "6eaf697bf9f111214a6d74ee3094e5784a57d1bb"
            ]
        },
        "codes": [
            "billing_mode"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ONSdigital/eq-terraform/pull/145",
        "content": {
            "title": "User t3 instances for ECS",
            "body": " - They are cheaper and faster\r\n - Removed the max limits on DynamoDB\r\n\r\n### How to review\r\nRun it and see that it continues to work as expected.",
            "comments": [],
            "commits": [
                "79845fe095cd87287346f40d2adce9b28a32ef35",
                "dc4efb272f7f9f1bf3a9af5467624d5b1e2488ed"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ONSdigital/eq-terraform/pull/37",
        "content": {
            "title": "EQ-376 Author Infrastructure",
            "body": "**_What**_\n1. Create a VPC for the author application\n2. Create Subnets for the application and database\n3. Create the Elastic beanstalk application for the author to deploy into\n4. Create a Postgres database for the application\n5. Create security group to whitelist IP to the ONS range.\n\nI've also restructured the Survey Runner terraform files so that they all exist inside a survey-runner folder\n\n**_How to test**_\n1. Check out this branch\n2. cd into author\n3. Update the terraform.tfvars with the correct values for your environment\n4. run `terraform apply`\n5. Check you can hit the example application in elastic beanstalk.\n\n**_Who can review**_\nAnyone apart from @warrenbailey\n",
            "comments": [
                "The one issue I can see with the IAM role support we're making use of here for S3 access, is that it's a bit of Amazon specific magic that we can't port to another PaaS provider easily; we'll need to rewrite the connection logic. It's not a massive issue and I think this approach is the correct one for AWS, I just think we need to be aware of that issue so we know the cost of changing provider. At first pass looks all good, just deploying now.\n",
                "\ud83d\udc4d LGTM\n"
            ],
            "commits": [
                "9bd3ca4256fada54e92a07a1e4465bb4d29845b4",
                "4c5c21dcb04c89f9ddc02a140263684665f1bbba",
                "233bc7ed82692ce8ecafcfbee430b067cd17a658",
                "03243ebba980aff5f0b5332518a829120ad017a6",
                "f116ce53bbf3d89f376d47a7a43a581a5df8626b",
                "b411475dd4de20774ed1f113b761b87fc7fb84ae"
            ]
        },
        "codes": [
            "provider"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ONSdigital/eq-terraform/pull/87",
        "content": {
            "title": "Developer environment optimisations",
            "body": "### What is the context of this PR?\r\nI have optimised the instance sizes and behaviour of the developer defaults to save money by not running excessively sized servers and to not retail data for long periods.\r\n\r\nAll instances are running at their smaller sizes.\r\nI have run the functional tests and manually gone through surveys and i can't notice any performance impact.\r\n\r\n### How to review\r\nValidate that the developer environment still works as expected for you.",
            "comments": [
                "Looks good. The commit message should be updated to reflect that it's also adding production defaults and removing unused variables."
            ],
            "commits": [
                "a252266af60f5ab828ad9b81b17bb7b16a2fc52f"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/kinvolk-archives/lokomotive-kubernetes/pull/102",
        "content": {
            "title": "ci: Add Packet ARM cluster",
            "body": "The cluster configuration is the same as for the existing\r\nPacket cluster. The only difference is the server type\r\n`c2.large.arm` (controller) and `c1.large.arm` (worker), the added variables `os_arch`/`os_channel`/`ipxe_script_url`,\r\nand the worker count set to 1 instead of 2.",
            "comments": [
                "Updated the iPXE URL and changed the worker type to `c1.large.arm` to save costs.",
                "Nice! Looks good to me.",
                "OK"
            ],
            "commits": [
                "89063ce7557afb2cd1ad6fd7ee4cb245ea20d8b6"
            ]
        },
        "codes": [
            "cluster",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/9387",
        "content": {
            "title": "Adding RDS auto start stop for VCMS dev db",
            "body": "Reducing cost by allowing auto stop/start for this VCMS dev DB.",
            "comments": [],
            "commits": [
                "1423b0193c89fb5e32c99b0b5e6c8d03668ad320"
            ]
        },
        "codes": [
            "saving",
            "billing_mode"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/3626",
        "content": {
            "title": "Upgrade elasticache module in prod namespaces",
            "body": "This version adds the \"namespace\" tag for cost allocation\n",
            "comments": [
                "This PR affects multiple namespaces\n   * c100-application-production\n  * cccd-production\n  * contact-moj-production\n  * digital-prison-services-prod\n  * formbuilder-platform-live-production\n  * formbuilder-platform-test-production\n  * formbuilder-publisher-live\n  * hmpps-book-secure-move-api-production\n  * hmpps-book-secure-move-frontend-production\n  * laa-apply-for-legalaid-production\n  * laa-cla-backend-production\n  * laa-court-data-adaptor-prod\n  * laa-court-data-ui-production\n  * laa-legal-adviser-api-production\n  * manage-hmpps-auth-accounts-prod\n  * manage-key-workers-prod\n  * manage-soc-cases-prod\n  * offender-categorisation-prod\n  * offender-management-production\n  * pathfinder-prod\n  * prison-visits-booking-production\n  * token-verification-api-prod\n  * track-a-query-production\n  * use-of-force-prod\n Please submit a separate PR for each namespace.\n\n"
            ],
            "commits": [
                "0ed71d20fb223bcdff5801341359be5c29958f92"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/12459",
        "content": {
            "title": "CAS dev upgrade redis instance",
            "body": "Upgrade redis type to cache.t4g.micro\r\n\r\nNow that we've updated to Redis 7 we can change to a new instance type that should be more cost effective https://user-guide.cloud-platform.service.justice.gov.uk/documentation/deploying-an-app/redis/create.html#table-of-instance-types",
            "comments": [
                " Your PR is applying in the build: https://concourse.cloud-platform.service.justice.gov.uk/teams/main/pipelines/environments-live/jobs/apply-namespace-changes-live/builds/5145"
            ],
            "commits": [
                "aa07f2d9772cc376589bec2cbb42f9ba849927db"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/9056",
        "content": {
            "title": "Upgrade redis node type in incentives `dev` environment",
            "body": "\u2026to a newer/cheaper/faster instance.\r\nSee also #9054",
            "comments": [],
            "commits": [
                "8e834bd132964652f29a978701cbdb34787e35b5"
            ]
        },
        "codes": [
            "instance",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/3625",
        "content": {
            "title": "Upgrade elasticache module in non-prod namespaces",
            "body": "This version (4.2) adds the \"namespace\" tag, for cost allocation.\n",
            "comments": [
                "This PR affects multiple namespaces\n   * c100-application-staging\n  * cccd-api-sandbox\n  * cccd-dev-lgfs\n  * cccd-staging\n  * contact-moj-development\n  * contact-moj-staging\n  * cts-prototype-dev-poc\n  * digital-prison-services-dev\n  * digital-prison-services-preprod\n  * formbuilder-platform-live-dev\n  * formbuilder-platform-test-dev\n  * formbuilder-publisher-test\n  * hmpps-book-secure-move-api-dev\n  * hmpps-book-secure-move-api-preprod\n  * hmpps-book-secure-move-api-staging\n  * hmpps-book-secure-move-api-uat\n  * hmpps-book-secure-move-frontend-preprod\n  * hmpps-book-secure-move-frontend-staging\n  * hmpps-book-secure-move-frontend-uat\n  * hmpps-book-video-link-dev\n  * hmpps-pin-phone-monitor-dev\n  * hmpps-submit-information-report-dev\n  * laa-apply-for-legalaid-staging\n  * laa-apply-for-legalaid-uat\n  * laa-cla-backend-staging\n  * laa-cla-backend-training\n  * laa-court-data-adaptor-dev\n  * laa-court-data-adaptor-stage\n  * laa-court-data-adaptor-test\n  * laa-court-data-adaptor-uat\n Please submit a separate PR for each namespace.\n\n"
            ],
            "commits": [
                "47d263ce5d5d322acde42951e2aa610eee021a3f",
                "06193209424ca377e1ee80773b165e3cd75cda46",
                "5f1143e3347b411ab70f38022e71e5d37b0c9024"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/3605",
        "content": {
            "title": "Add namespace tag to replica database",
            "body": "The replica RDS instance does not have a value for \"namespace\", so its\ncosts are not being allocated correctly.\n",
            "comments": [],
            "commits": [
                "5199e517f5e08b8bed3f96334b102814b3e99200"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/20958",
        "content": {
            "title": "clean up testing redis to save cost and revert team name for test ns",
            "body": null,
            "comments": [
                " Your PR is applying in the build: https://concourse.cloud-platform.service.justice.gov.uk/teams/main/pipelines/environments-live/jobs/apply-namespace-changes-live/builds/2318"
            ],
            "commits": [
                "d1b215a95b022200162bbf5b74d339f2c06cf066"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/13123",
        "content": {
            "title": "LEP-119 Switch off cfe-p Production instances",
            "body": "Now CCQ has ported to cfe-civil, cfe-partner instances (staging, uat, production) are unused and cost money. So we need to switch them off",
            "comments": [
                " Your PR is applying in the build: https://concourse.cloud-platform.service.justice.gov.uk/teams/main/pipelines/environments-live/jobs/apply-namespace-changes-live/builds/5801"
            ],
            "commits": [
                "760b966a91522695d7a2914e2c4bcc7ccfdb62a8"
            ]
        },
        "codes": [
            "instance",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/8345",
        "content": {
            "title": "Change prisoner money test DB instance type",
            "body": "\u2026from `t2` to `t4g`, which is cheaper and more performant/energy-efficient. Apparently, cross-architecture migrations are possible (`t4g` is an AWS Graviton2 / ARM type) but this is a test DB so doesn't matter if it is destroyed.",
            "comments": [],
            "commits": [
                "ce502048eb3cd95e708f4575efefaf8dc60d7722"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/13122",
        "content": {
            "title": "LEP-119 Switch off cfe-p Staging instances",
            "body": "Now CCQ has ported to cfe-civil, cfe-partner instances (staging, uat, production) are unused and cost money. So we need to switch them off",
            "comments": [
                " Your PR is applying in the build: https://concourse.cloud-platform.service.justice.gov.uk/teams/main/pipelines/environments-live/jobs/apply-namespace-changes-live/builds/5800"
            ],
            "commits": [
                "3bb8fa47e87e97406af19ec9b4efdea40d51d426"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/4883",
        "content": {
            "title": "Delete the test SQL Server databases",
            "body": "They're not needed just yet and they're pretty expensive to leave just\r\nsitting there...",
            "comments": [],
            "commits": [
                "cca186a0f7165b361f372c87524011e91b28f41a"
            ]
        },
        "codes": [
            "instance",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/5152",
        "content": {
            "title": "IC-2096: Upgrade to a generic purpose DB instance class on interventions/prod ",
            "body": "_Description added 25 April 2022_\r\n\r\nWe have decided on `db.m5.large` as the T3 instance class is burstable and we wanted consistency\r\n\r\nAdditionally, the m5.large has 2 cpu, 8 GB RAM as well as the t3.large but more bandwidth and better network performance in exchange for about 25% increase in cost\r\n\r\ndb.t3.large\t$0.164\r\ndb.m5.large\t$0.206\r\n\r\nFor the load around July 2021, we had quite a lot of data going back and forth for dashboard queries, so we wanted consistent load and bandwidth guarantees.",
            "comments": [
                "\u267b\ufe0f rebased to have a new commit and trigger concourse",
                "Thank you \ud83d\ude47\u200d\u2642\ufe0f \ud83c\udfa9 ",
                "\u23f3 holding off merge until suitable timeslot"
            ],
            "commits": [
                "582e6493969dc175e1320e849eb0c24c461ebd22"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/556",
        "content": {
            "title": "Re-create live-1 MTP resources in AWS eu-west-2",
            "body": "\u2026excluding prod RDS which is expensive and not yet needed",
            "comments": [
                "LGTM"
            ],
            "commits": [
                "d7afb9018e20ef85f1fbee2300dbf5c5cdf3cb0e"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/13120",
        "content": {
            "title": "LEP-119 Switch off cfe-p UAT instances",
            "body": "Now CCQ has ported to cfe-civil, cfe-partner instances (staging, uat, production) are unused and cost money. So we need to switch them off",
            "comments": [
                " Your PR is applying in the build: https://concourse.cloud-platform.service.justice.gov.uk/teams/main/pipelines/environments-live/jobs/apply-namespace-changes-live/builds/5786"
            ],
            "commits": [
                "c5785abcf6924ebe3608de11f0a4dcf7a4788873"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/8282",
        "content": {
            "title": "Prisoner content hub - prod - Upgrade RDS to t3.xlarge",
            "body": "This is to increase the resources for RDS to `xlarge`, as we are seeing errors in RDS related to max_connections.  E.g. \r\n```\r\n2022-07-22 13:11:39 0 [Warning] Aborted connection 0 to db: 'unconnected' user: 'unauthenticated' host: 'connecting host' (Too many connections)\r\n```\r\n\r\nThe max_connections configuration is tied to the db instance size.\r\n\r\nNote we are **not** increasing the dev and staging environments, as these do not require such a large instance and would be an unnecessary cost.\r\n\r\nRelated Trello card: https://trello.com/c/EjfBYww7/1315-downtime-post-mortem\r\n",
            "comments": [],
            "commits": [
                "fc15317307c863b438727ec088bfa1bfd420ff90",
                "dc9c73ceeb74467cb8ab2d35e5e46e1c99f6d26a",
                "59843d534300228ab75bbd0dac0ad799aa0d2f93"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/3689",
        "content": {
            "title": "Tag dynamodb resource with namespace name - non prod",
            "body": "Why:\r\nTag all AWS resources with namespace name#2348\r\nThis version (4.5) adds the \"namespace\" tag, for cost allocation",
            "comments": [
                "This PR affects multiple namespaces\n   * court-probation-preprod\n  * hmpps-submit-information-report-dev\n  * how-out-of-date-are-we\n  * prison-to-probation-update-dev\n  * prison-to-probation-update-preprod\n Please submit a separate PR for each namespace.\n\n"
            ],
            "commits": [
                "33ced849b0ffd5d457704f2a549387f7b49ac03e",
                "39937bb64e693b064480e63dde774c7f5602f94b"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/8509",
        "content": {
            "title": "Remove aws resources in abundant namespace",
            "body": "This is for cost saving, and can be added back when testing modules",
            "comments": [],
            "commits": [
                "e7237276b72926d4a38ff099bc2f6260ef6e5675"
            ]
        },
        "codes": [
            "saving",
            "unsure"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/9368",
        "content": {
            "title": "Change billing mode in our dynamodb table",
            "body": null,
            "comments": [],
            "commits": [
                "0c1b4028575aeaabf7543c7357c4e26d610677c3"
            ]
        },
        "codes": [
            "billing_mode"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-environments/pull/3637",
        "content": {
            "title": "Upgrade s3-bucket module in non-prod namespaces",
            "body": "Why:\r\n[Tag all AWS resources with namespace name#2348](https://app.zenhub.com/workspaces/cloud-platform-team-5ccb0b8a81f66118c983c189/issues/ministryofjustice/cloud-platform/2348)\r\nThis version (4.5) adds the \"namespace\" tag, for cost allocation",
            "comments": [
                "Hi @digitalronin David-\r\nSorry missed a couple of references to the module in the cla namespace (resources/s3.tf)",
                "Sorry David @digitalronin one last time for review please (your going to hate me!)",
                "This PR affects multiple namespaces\n   * calculate-journey-variable-payments-dev\n  * calculate-journey-variable-payments-preprod\n  * cccd-api-sandbox\n  * cccd-dev\n  * cccd-dev-lgfs\n  * cccd-staging\n  * claim-criminal-injuries-compensation-dev\n  * claim-criminal-injuries-compensation-uat\n  * cts-prototype-dev-poc\n  * formbuilder-platform-live-dev\n  * formbuilder-platform-test-dev\n  * hmpps-book-secure-move-api-dev\n  * hmpps-book-secure-move-api-preprod\n  * hmpps-book-secure-move-api-staging\n  * hmpps-book-secure-move-api-uat\n  * hmpps-pin-phone-monitor-dev\n  * hmpps-submit-information-report-dev\n  * laa-apply-for-legalaid-staging\n  * laa-apply-for-legalaid-uat\n  * laa-cla-backend-staging\n  * laa-cla-backend-training\n  * laa-cla-backend-uat\n  * laa-cla-public-staging\n  * laa-fala-staging\n Please submit a separate PR for each namespace.\n\n"
            ],
            "commits": [
                "50a810104107b6c8b8e236d9f03d67c83445deb3",
                "0dbdc19e7847f8ade0d19891c84055f841811119",
                "2d30aaa4d5670bad60d8a892e1464352df87e656",
                "4615faa1db990a6206dc4b1f57df09e3b6102f6e",
                "dbff9fca273679acbfd72d3dbaf2fe997352ae18"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govwifi-terraform/pull/778",
        "content": {
            "title": "remove legacy frontend ECS cluster and EC2 instances",
            "body": "### What\r\nRemove the legacy ECS cluster for frontend in London & Ireland\r\nRemove associated EC2 instances in London & Ireland\r\n\r\n### Why\r\nThe taxpayer is funding this legacy infrastructure which is no longer required.\r\nThe current solution is working well (ECS Fargate cluster)\r\n\r\n### Testing\r\nRun terraform and / or execute environment smoke tests.\r\n\r\n### Link to Trello card (if applicable): \r\nhttps://technologyprogramme.atlassian.net/jira/software/projects/GW/boards/251?selectedIssue=GW-607\r\n",
            "comments": [],
            "commits": [
                "4ff1ec365cd5b0b55801c97ea4960f61c4be2176"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govwifi-terraform/pull/488",
        "content": {
            "title": "Update low CPU alarm on ECS tasks",
            "body": "### What\r\n\r\n* Reduce low CPU alarm threshold to 0.3% on staging Auth API and Logging API ECS task alarms.\r\n* Toggle CPU threshold value to adjust for different CPU averages between staging and production.\r\n* Update alarm name and description for clarity\r\n\r\n### Why\r\n\r\n* The average CPU for both staging ECS tasks is always below 1% (even the max CPU rarely exceeds 1%) therefore these alerts will always go off. The minimum low CPU hovers around 0.3%, in which case we do want to downscale the number of ECS tasks for efficiency and cost savings.\r\n* Production is slightly different. The CPU average rarely dips below 1% so it's sensible to keep the threshold for production at 1%.\r\n\r\n[Link to Trello card](https://trello.com/c/XowCI6x0/298-address-cloudwatch-alerts-in-alarm-state).\r\n",
            "comments": [],
            "commits": [
                "1c1f0fcc33f3c056babde7e8b1e79161d3fbb087",
                "de8d64920febda94d03242826eaf20ad37abd86f",
                "abff408bfe03eb78c55608cd9b4064cbf93a5d54"
            ]
        },
        "codes": [
            "cluster",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govwifi-terraform/pull/787",
        "content": {
            "title": "Add Automatic Snapshot Volume Backups for Prometheus and Grafana",
            "body": "### What\r\n\r\nAdd Automatic Snapshot Volume Backups for Prometheus and Grafana. This enables the data for Prometheus, and the Grafana configuration to be recovered if the volumes or instances are deleted. The snapshots are created and managed using Amazon Data Lifecycle Manager, which incurs no extra cost (https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/snapshot-lifecycle.html).\r\n\r\n### Why\r\n\r\nIt is best practice to have a backup of our data\r\n\r\nLink to Jira card (if applicable): \r\nhttps://technologyprogramme.atlassian.net/jira/software/projects/GW/boards/251?selectedIssue=GW-858",
            "comments": [
                "LGTM and much needed bit of tech debt, thank you"
            ],
            "commits": [
                "971ea5a81ca8325e9c91ab98ed2c799598c41fad"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govwifi-terraform/pull/15",
        "content": {
            "title": "Separate read replica and master instance type",
            "body": "So the database instance types can be set independently. This is useful for staging setup or in case we'd like to consider saving on the read replica cost.",
            "comments": [],
            "commits": [
                "ff6f15245cf0b69b2f263ff9e2206c1acb963bf7"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/digio/terraform-google-gitlab-runner/pull/2",
        "content": {
            "title": "Merge changes from MehrCurry",
            "body": "@MehrCurry has some nice changes in his/her repository.\r\n\r\n- Allow to set `ci_runner_instance_name`\r\n- increase disk size\r\n- Use VM type `e2-micro`, which is more powerful and a bit cheaper",
            "comments": [
                "The changes look great!  Thanks for the PR.",
                "Thanks! You can find interesting changes in the [Network graph](https://github.com/digio/terraform-google-gitlab-runner/network)",
                "Sorry, i forgot to re-contribute my changes. Glad @tmaier took over. Thanks for the great work so far.",
                "Agree, @tmaier.  The [Network graph](https://github.com/digio/terraform-google-gitlab-runner/network) does look interesting.  I'm hoping to trawl through them at some point.  It just hasn't made it to the top of the list yet :-)"
            ],
            "commits": [
                "f0e116570f15d7c0a5db32953451c23589547835",
                "059fc37d06442296d902b6daf7a5b7b63bd585cc",
                "b56eb6bb7ef77f36e36da3160bb635fa89d114d4",
                "69a8cb8173dae0df0d3f9cf1d1be556e922d3ea7",
                "5ad103646de2da9d2ae9777de0011b79e697337d",
                "2c8ec16e784887b023624646e00bd305cf79bf31",
                "b05031a2407dd515916aac25afb6952d46b6cf86",
                "069c378764611fec46b047316384cb3753da1870",
                "5478a52d14fd0087c4ce0374a126c362bc59ab44",
                "e831b1b300ad74076375bdf08e7e76e5b31eeaa1"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/digio/terraform-google-gitlab-runner/pull/5",
        "content": {
            "title": "Miscellaneous Contributions",
            "body": "This is an amalgamation of various improvements sourced from the GitHub network graph.",
            "comments": [],
            "commits": [
                "6a0655c0c1a4a1174d1999923e5427e3d3206f45",
                "610d2d0fe7cedbdb9b0ec100da0b37bd69b6686c",
                "8921c6d2aadd0b0f62db01b28511132a831a1e3b",
                "43451816cdbd8c7b99331aa822cebf9029f3ed6b",
                "4bb14d72d09db5b1ec42c8d0ae4f44612e97888c",
                "330b2aef072ff4bffb39757a009640ce5b59d994",
                "07f8279fe65a35c0e595f3171f3d75791e49a9ae",
                "6f15fcbe0f5438298187d98b79c705316d1b3ca5",
                "09e1ef680b6fd9c25526440c3facec10d739706b",
                "85e8ef21bc7d5f3864f773c462456445467c4189",
                "1f2780066582acb22e683066a964957ab424b829",
                "d10b56d625267cd41d803a8e4649afc4e84381a8",
                "0bf5804e1ab5ad3545221782b51ce8b5ae38ac9b"
            ]
        },
        "codes": [
            "unrelated",
            "note: bad example of pr"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/jharley/azure-basic-demo/pull/10",
        "content": {
            "title": "OPS-7237 - switch machine type to DS1",
            "body": "Cost savings project",
            "comments": [],
            "commits": [
                "7cd3d202d8723c565704f23c143cae3b1e1d6d2b"
            ]
        },
        "codes": [
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/pangeo-data/terraform-deploy/pull/20",
        "content": {
            "title": "Use less expensive nodes for kubernetes by default",
            "body": "\n\ufeffWe are still testing, tearing things up and down - cheaper\nis better.\n",
            "comments": [],
            "commits": [
                "7244eed07a1008675f45cc4349bf68141bb29edc"
            ]
        },
        "codes": [
            "cluster",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/coremaker/terraform-google-nucleus/pull/69",
        "content": {
            "title": "add per project billing alerts",
            "body": null,
            "comments": [],
            "commits": [
                "11234f631f7370dd80ee5fbc5dd7bdbc12dcbf49",
                "1baccfcc145c34e659b9f4e2a50930549a9ed81d",
                "6e37a1acb21ce7ea713afeaa7048911d150e0c76",
                "1aa250169bf0ae9ffec81cc86ef3b2d8e26566b4",
                "4649a203f9156aea91abbec4088b897ac8f7736c",
                "2d7e6985646dec073d0ba24dfd2e8a3db0220cc7",
                "8db406b41092c550a6e9ec741cf6a2e904125dd1",
                "a9f99c94157e689eaf19120dba83afdd0708db07",
                "d2b1cde4f82803ef1538e075c6e5a99d7c416e46"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/nationalarchives/tdr-terraform-environments/pull/304",
        "content": {
            "title": "Increase the lambda timeout to 60s.",
            "body": "We had a timeout with it set to 15 seconds. This may need a bit of\ntweaking but this should be enough for now.\n\nAny longer and it takes too long to fail and it costs us more.\n",
            "comments": [],
            "commits": [
                "30fe6243dd0d1f42beb56c4df72fd8c82d155faf"
            ]
        },
        "codes": [
            "increase"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/mdn/infra/pull/505",
        "content": {
            "title": "[SE-2281] postgres import",
            "body": "This PR imports our Postgres databases and replica which were created manually in the AWS console. This is phase 1 of this move. Phase 2 is @escattone will be shutting down mysql. I will remove those things from terraform and allow terraform to do the destroy. In Phase 3 I will change the name of this module from `module.mysql` to `module.rds` and do a `terraform state mv`. \r\n\r\n```bash\r\nAn execution plan has been generated and is shown below.\r\nResource actions are indicated with the following symbols:\r\n  ~ update in-place\r\n\r\nTerraform will perform the following actions:\r\n\r\n  # module.mysql-eu-central-1-replica-prod.aws_db_instance.postgres_replica[0] will be updated in-place\r\n  ~ resource \"aws_db_instance\" \"postgres_replica\" {\r\n      + apply_immediately                     = true\r\n        id                                    = \"mdn-prod-postgres-replica\"\r\n      ~ multi_az                              = false -> true\r\n        name                                  = \"developer_mozilla_org\"\r\n      ~ tags                                  = {\r\n          + \"Environment\" = \"prod\"\r\n          + \"Name\"        = \"mdn-prod-postgres-replica\"\r\n          + \"Region\"      = \"eu-central-1\"\r\n          + \"Service\"     = \"MDN\"\r\n          + \"Terraform\"   = \"true\"\r\n        }\r\n      ~ tags_all                              = {\r\n          + \"Environment\" = \"prod\"\r\n          + \"Name\"        = \"mdn-prod-postgres-replica\"\r\n          + \"Region\"      = \"eu-central-1\"\r\n          + \"Service\"     = \"MDN\"\r\n          + \"Terraform\"   = \"true\"\r\n        }\r\n        # (44 unchanged attributes hidden)\r\n\r\n        # (1 unchanged block hidden)\r\n    }\r\n\r\n  # module.mysql-us-west-2.aws_db_instance.mdn_postgres[0] will be updated in-place\r\n  ~ resource \"aws_db_instance\" \"mdn_postgres\" {\r\n      + allow_major_version_upgrade           = false\r\n      + final_snapshot_identifier             = \"mdn-prod-postgres-final\"\r\n        id                                    = \"mdn-stage-postgres\"\r\n      ~ multi_az                              = false -> true\r\n        name                                  = \"developer_allizom_org\"\r\n      + password                              = (sensitive value)\r\n      ~ skip_final_snapshot                   = true -> false\r\n      ~ tags                                  = {\r\n          + \"Environment\" = \"stage\"\r\n          + \"Name\"        = \"MDN-stage-postgres\"\r\n          + \"Region\"      = \"us-west-2\"\r\n          + \"Service\"     = \"MDN\"\r\n          + \"Terraform\"   = \"true\"\r\n        }\r\n      ~ tags_all                              = {\r\n          + \"Environment\" = \"stage\"\r\n          + \"Name\"        = \"MDN-stage-postgres\"\r\n          + \"Region\"      = \"us-west-2\"\r\n          + \"Service\"     = \"MDN\"\r\n          + \"Terraform\"   = \"true\"\r\n        }\r\n        # (43 unchanged attributes hidden)\r\n\r\n        # (1 unchanged block hidden)\r\n    }\r\n\r\n  # module.mysql-us-west-2-prod.aws_db_instance.mdn_postgres[0] will be updated in-place\r\n  ~ resource \"aws_db_instance\" \"mdn_postgres\" {\r\n      + allow_major_version_upgrade           = false\r\n      - deletion_protection                   = true -> null\r\n      + final_snapshot_identifier             = \"mdn-prod-postgres-final\"\r\n        id                                    = \"mdn-prod-postgres\"\r\n        name                                  = \"developer_mozilla_org\"\r\n      + password                              = (sensitive value)\r\n      ~ skip_final_snapshot                   = true -> false\r\n      ~ tags                                  = {\r\n          + \"Environment\" = \"prod\"\r\n          + \"Name\"        = \"MDN-prod-postgres\"\r\n          + \"Region\"      = \"us-west-2\"\r\n          + \"Service\"     = \"MDN\"\r\n          + \"Terraform\"   = \"true\"\r\n        }\r\n      ~ tags_all                              = {\r\n          + \"Environment\" = \"prod\"\r\n          + \"Name\"        = \"MDN-prod-postgres\"\r\n          + \"Region\"      = \"us-west-2\"\r\n          + \"Service\"     = \"MDN\"\r\n          + \"Terraform\"   = \"true\"\r\n        }\r\n        # (43 unchanged attributes hidden)\r\n\r\n        # (1 unchanged block hidden)\r\n    }\r\n```\r\n",
            "comments": [
                "generally looks good, one small comment on snapshot naming, but not a big deal either way.",
                "Everything looks good to me except for the following (based on the Terraform plan in the introduction):\r\n1. Both `mdn-stage-postgres` and `mdn-prod-postgres-replica` do **not** need `multi-az` to be true, only because it feels like a waste of money.\r\n2. `mdn-prod-postgres` should have `deletion_protection` set to `true`.",
                "Thanks @bkochendorfer!",
                "@escattone updated the `delete_protection` option. I'd feel more comfortable with `multi-az` set to true as it helps with our availability story. You are correct that it does cost a little bit more but is the same setting we have for mysql so the cost should be the same. "
            ],
            "commits": [
                "7986d7b00cb5f82bc7f6b9c002005d2bd6739021",
                "dd2cbf1ea1eb73d2a463d8c847ae60832c78b0bf",
                "a3803cc6023cbbfb34d13c0a82f46ce65ffbc50a",
                "167047f31c8d394c61e6823a409b9a52509c0425"
            ]
        },
        "codes": [
            "awareness",
            "increase"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/archivematica-infrastructure/pull/144",
        "content": {
            "title": "Increase the memory available to the transfer_monitor_lambda",
            "body": "## What does this change?\r\n\r\nWe've noticed this lambda failing through timeouts. Upon investigation it appears the lambda has been consistently using its entire allocation of 128MB which suggested that it was insufficiently resourced resulting in it locking up and timing out.\r\n\r\nAfter experimentation is seems that 512MB is sufficient to cause the transfer lambda to succeed. \r\n\r\nSee:\r\n<img width=\"1375\" alt=\"Screenshot 2024-01-09 at 12 50 48\" src=\"https://github.com/wellcomecollection/archivematica-infrastructure/assets/953792/4e2f5a1c-8291-4e65-b51b-f82aab4ea860\">\r\n\r\n> [!NOTE] \r\n> This has been applied in production to resolve the existing issue as part of testing.\r\n\r\n## How to test\r\n\r\n- [x] Manual testing to ensure that this resource allocation allows the lambda to suceed.\r\n- [ ] Deploy to production, do we continue to see failures?\r\n\r\n## How can we measure success?\r\n\r\nThis lambda continues to function and report task failures, as well as clearing up the source bucket controlling costs.\r\n\r\n## Have we considered potential risks?\r\n\r\nThis change will result in some increased cost but as this lambda runs quite infrequently the cost change is negligible.\r\n",
            "comments": [],
            "commits": [
                "7acf12dce8c0a1117ec7a3003ca36afa3af9523f",
                "a06f39be1ed8827bb7a1950f5d76cec824c806f1"
            ]
        },
        "codes": [
            "increase",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/archivematica-infrastructure/pull/129",
        "content": {
            "title": "Various improvements to our deployment around resource usage",
            "body": "Closes https://github.com/wellcomecollection/archivematica-infrastructure/issues/128\r\n\r\n* Add instructions to the bootstrapping doc on configuring the filesystem space to avoid the issue we just had, and instructions on formatting a newly-created EBS volume\r\n* Reduce storage leaks in the storage service code: once a file has been uploaded to the Wellcome storage service, it can be deleted from the Archivematica disks\r\n* Reduce the size of the EBS volume, RDS databases, and ClamAV tasks \u2013 we're underutilising them. This will save ~$300/month, or about ~5% of the workflow account bill.",
            "comments": [],
            "commits": [
                "66ea2e401be43f7f2d69fe31dcea5cf560223e0e",
                "06b9427cdc0cd343ece38a3faebbe020e5761791",
                "d2fc39dcbf96b963f80005d0cc6c5d5eb6c14dac",
                "da54dd9a24e5dd043750848f2dcf9677e0afb32f",
                "a7efe96d8c9039bb381cc35e1ab1641fbabf89dc",
                "086ea8448b78b33b540c1dfd82cec33b0b2f2aa7",
                "dd8b902b9ff336784cf3c73bd39f9061a32561ed"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/archivematica-infrastructure/pull/76",
        "content": {
            "title": "Use gp3 for our persistent EBS volumes",
            "body": "It's ~20% cheaper and the 3000 IOPS we previously got as burst are now available as sustained, for free.\r\n\r\nI migrated these volumes manually on Friday, and nobody noticed. XD\r\n\r\nCloses https://github.com/wellcomecollection/platform/issues/4906",
            "comments": [],
            "commits": [
                "ce576be106257496e20d946d6eab5f8783dada92"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/archivematica-infrastructure/pull/140",
        "content": {
            "title": "Bump the resources available to the clamav service",
            "body": "## What does this change\r\n\r\nThis change increases the CPU and memory resources available to the clamav archivematica service. We've seen repeated failures in this service, with metrics indicating CPU usage is capping out at 100% on occasion.\r\n\r\nFailures:\r\n<img width=\"722\" alt=\"Screenshot 2024-01-05 at 14 55 15\" src=\"https://github.com/wellcomecollection/archivematica-infrastructure/assets/953792/bdeaff36-7a35-49d2-aab3-99fc4c38c930\">\r\n\r\nMetrics:\r\n<img width=\"617\" alt=\"Screenshot 2024-01-05 at 15 11 16\" src=\"https://github.com/wellcomecollection/archivematica-infrastructure/assets/953792/e1597468-d18a-4c0a-b55a-c2d73dd8fd2e\">\r\n\r\nWe hope to mitigate this issue by naively increasing resources to see if it has an impact. Increase to Fargate resources need to meet some [size requirements](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/fargate-tasks-services.html#fargate-tasks-size), and have [associated costs](https://aws.amazon.com/fargate/pricing/).\r\n\r\n> [!NOTE]\r\n> This change will result in a cost increase.\r\n> Presuming 720 hours in a month, the calculation is ((hours * cost of 1vCPU * num vCPUs) + (hours * cost of 1GB memory * number of GB)) * number of tasks.\r\n> Before: \r\n> ((720 * 0.04048 *1) + (720 * 0.004445 * 3) * 2) = $48.35\r\n> After:\r\n> ((720 * 0.04048 *2) + (720 * 0.004445 * 4) * 2) = $83.89\r\n\r\n## Who is this change for?\r\n\r\nThis change hopefully reduces manual work for folk working with Archivematica attempting to get things ingested to the storage service.\r\n",
            "comments": [],
            "commits": [
                "3392145b83a83c9c09ed6b91f4ab4b18e4569007"
            ]
        },
        "codes": [
            "increase"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/archivematica-infrastructure/pull/82",
        "content": {
            "title": "Only run a single RDS instance for Archivematica",
            "body": "We don't put much load on the database, and each db.r5.large costs ~$170/mo.",
            "comments": [],
            "commits": [
                "4b495fef39e68590aea98af324340adafadfb334"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/archivematica-infrastructure/pull/40",
        "content": {
            "title": "Mount the shared filesystem in sync",
            "body": "For https://github.com/wellcometrust/platform/issues/3548\r\n\r\nCost wise, this means paying for three t2.xlarge instances ($0.6048/hr) rather than a single c5.4xlarge ($0.768/hr). And we have more scope to shave some off that cost/scale it up more gradually if we want.",
            "comments": [],
            "commits": [
                "82356950a30c6f4dc89f7b4b3a0872793bc714f7",
                "6018e63bf90213a8a9cbe5cfbf835cff31030594",
                "659f2751809c4f256d81e3894074b388e921012c"
            ]
        },
        "codes": [
            "increase"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/binbashar/le-tf-infra-aws/pull/18",
        "content": {
            "title": "Jenkins temp delete",
            "body": "`shared/7_jenkins-vault` was temporally destroyed to save costs.\r\n\r\nNOTE: Some minor fixes in place.",
            "comments": [],
            "commits": [
                "2afa0c4652393014778f9b2fefcf975d6ca22ae2"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/binbashar/le-tf-infra-aws/pull/7",
        "content": {
            "title": "Bbl 33 billing review",
            "body": "## Updating <img src=\"https://avatars1.githubusercontent.com/u/31255874?s=280&v=4\" alt=\"binbash\" width=\"40\"/> devops-tf-infra-aws repo:\r\n\r\n<div align=\"middle\">\r\n  <img src=\"http://automationtoolsbootcamp.com/images/terraform.png\" alt=\"terraform\" width=\"150\"/>\r\n  <img src=\"https://pbs.twimg.com/profile_images/907881675304181760/_ftIQb3v_400x400.jpg\" alt=\"aws\" width=\"150\"/>\r\n</div>\r\n\r\n###  :notebook: Summary \r\n1. Standarizing `Makefiles` cross tf stack. \r\n2. `terraform-aws-provider` req fixed to it's latest stable version.\r\n3. @diego-ojeda-binbash gpg key updated.\r\n\r\n### :man_technologist:  New Commits \r\n- BBL-33 pre-steps updating every Makefile to be selfdoc and support make diff cmd\r\n- BBL-33 pre-step updating tf aws provider dep to 2.10 & readme.md\r\n- BBL-33 updating vault ansible role to it latest stable from galaxy\r\n- BBL-33 diego.ojeda gpg key updated for binbash-sec account iam user.\r\n- BBL-33 nat gateway disable in binbash-dev account for cost saving purposes\r\n\r\n### :triangular_flag_on_post:  Post Tasks\r\n- Keep moving forward with: https://trello.com/c/ViQxRsGM/33-cloud-aws-dev-account-daily-clean-up-automation-aws-billing-review-alerts-reserved-ec2s",
            "comments": [],
            "commits": [
                "c2972f21a44ef41f579fc58a5a59a941d97790b0",
                "a873443bd618ac9c14d12210ed4d12a11cc1f733"
            ]
        },
        "codes": [
            "saving",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/binbashar/le-tf-infra-aws/pull/380",
        "content": {
            "title": "Feature/ infracost to CI + minor improvements",
            "body": "## What?\r\n\r\n### Commits on May 28, 2022\r\n\r\n- [removing deprecated build.env vars and upgrading docker image to terraform 1.1.9](https://github.com/binbashar/le-tf-infra-aws/commit/85a23ebe2bd6058c025c2ad43dbe5bba6de60eb3) - @[exequielrafaela](https://github.com/binbashar/le-tf-infra-aws/commits?author=exequielrafaela)\r\n- [removing github pages related file not in use](https://github.com/binbashar/le-tf-infra-aws/commit/cf745744094766dadea7775fb0a9bb36fffd90ce) - @[exequielrafaela](https://github.com/binbashar/le-tf-infra-aws/commits?author=exequielrafaela)\r\n- [/shared/us-east-1/base-network nat-gw must be set to true since we have the active pritunl vpn-server ec2](https://github.com/binbashar/le-tf-infra-aws/commit/f8ea9c594f04bec6d6ec7dbe504bd268c0a80e49)  - @[exequielrafaela](https://github.com/binbashar/le-tf-infra-aws/commits?author=exequielrafaela)\r\n- [adding infracost github action worflow](https://github.com/binbashar/le-tf-infra-aws/commit/50b7b36b35b10491c6edf385c854f2828e008de3) - @[exequielrafaela](https://github.com/binbashar/le-tf-infra-aws/commits?author=exequielrafaela)\r\n\r\n## Why?\r\n\r\n- Keeping the Ref Arch up to date\r\n- Improving cost mgmt governance",
            "comments": [],
            "commits": [
                "f237898951527b666a5e0dbf0569063a310c207c",
                "1a8fe8f9c5e307eaf1627d5a507f7332af3df880",
                "954420076bbfe3579854dcc65ee8e58232be3a22",
                "f8ea9c594f04bec6d6ec7dbe504bd268c0a80e49"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/binbashar/le-tf-infra-aws/pull/368",
        "content": {
            "title": "Feature/ renaming /root by /management + cost-mgmt layer with encrypted SNS",
            "body": "## What?\r\n\r\n### Commits on Apr 19, 2022\r\n\r\n- [renaming /root by /management following the updated leverage ref arch convention](https://github.com/binbashar/le-tf-infra-aws/commit/7221035e88e23e2633e76343a250c61ef2597697)[](https://github.com/exequielrafaela) \r\n- [Adding kms permissions for SNS encrypted topic + std cost-management alerts in proper topic](https://github.com/binbashar/le-tf-infra-aws/commit/89fd3ebb3ba1ccc9a9019ad250b93a336d4bc03e)[](https://github.com/exequielrafaela) \r\n\r\n## Why?\r\n\r\n- Follow AWS & Leverage Reference Architecture latest account naming convention\r\n- Update costs topic to use the CMK key of the management account in order to allow AWS Budgets to use such key for publishing messages to the aforementioned topic\r\n- Testing and pointing cost-management notif to the cost topic (SMS + Email + Slack)",
            "comments": [],
            "commits": [
                "7221035e88e23e2633e76343a250c61ef2597697",
                "89fd3ebb3ba1ccc9a9019ad250b93a336d4bc03e"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/binbashar/le-tf-infra-aws/pull/16",
        "content": {
            "title": "BBL-33 - Cost Optimization -> Lambda nuke dev acct (automated clean-up)",
            "body": "BBL-33 - Cost Optimization -> Lambda nuke dev acct (automated clean-up)\r\n- exequielrafaela - BBL-33 addding lambda nuke for dev account - a60be8b\r\n- exequielrafaela - Merge branch 'master' into BBL-33-lambda-nuke-dev-acct - e412c40\r\n- exequielrafaela - lambda nuke implemented except for vpc,s3 and dynamodb - b34db23\r\n\r\n**NOTE-1:** https://github.com/diodonfrost/terraform-aws-lambda-nuke/issues/1\r\n\r\n#### Tests and validations\r\n```\r\n\u256d\u2500delivery at delivery-I7567 in ~/Binbash/repos/BB-AWS-Org/bb-devops-tf-infra-aws/dev/6_cloud-nuke on BBL-33-lambda-nuke-dev-acct\u2714 using \u2039\u203a 19-11-05 - 19:32:17\r\n\u2570\u2500\u25cb make format \r\ndocker run --rm -v /home/delivery/Binbash/repos/BB-AWS-Org/bb-devops-tf-infra-aws/dev/6_cloud-nuke:\"/go/src/project/\":rw -v /home/delivery/Binbash/repos/BB-AWS-Org/bb-devops-tf-infra-aws/dev/config:/config -v ~/.ssh:/root/.ssh -v ~/.gitconfig:/etc/gitconfig -v ~/.aws:/root/.aws --entrypoint=/usr/local/go/bin/terraform -it binbash/terraform-resources:0.12.13 fmt \"/go/src/project/\"\r\n\u256d\u2500delivery at delivery-I7567 in ~/Binbash/repos/BB-AWS-Org/bb-devops-tf-infra-aws/dev/6_cloud-nuke on BBL-33-lambda-nuke-dev-acct\u2714 using \u2039\u203a 19-11-05 - 19:32:23\r\n\u2570\u2500\u25cb terraform validate\r\nSuccess! The configuration is valid.\r\n\r\n\u256d\u2500delivery at delivery-I7567 in ~/Binbash/repos/BB-AWS-Org/bb-devops-tf-infra-aws/dev/6_cloud-nuke on BBL-33-lambda-nuke-dev-acct\u2714 using \u2039\u203a 19-11-05 - 19:32:35\r\n\u2570\u2500\u25cb make validate-tf-layout \r\n../../@scripts/validate-terraform-layout.sh\r\n[INFO] CWD=/home/delivery/Binbash/repos/BB-AWS-Org/bb-devops-tf-infra-aws/dev/6_cloud-nuke\r\n[INFO] REPO_DIR=/home/delivery/Binbash/repos/BB-AWS-Org/bb-devops-tf-infra-aws\r\n[INFO] ACCOUNT_NAME: dev\r\n[INFO] CATEGORY_NAME: cloud-nuke\r\n\r\n[INFO] Checking if backend key starts with dev ...\r\n[INFO]  -> OK\r\n[INFO] Checking if backend key starts with dev and follows with cloud-nuke ...\r\n[INFO]  -> OK\r\n[INFO] Checking if backend.config profile contains dev ...\r\n[INFO]  -> OK\r\n[INFO] Checking if backend.config bucket contains dev ...\r\n[INFO]  -> OK\r\n[INFO] Checking if backend.config dynamodb_table contains dev ...\r\n[INFO]  -> OK\r\n[INFO] Checking if base.config  contains dev ...\r\n[ERROR]  -> FAILED\r\n```\r\n\r\n- **NOTE-2:** Couldn't implement `base.config` and `extra.config` segregation since other `dev` terraform layer depends on the old `main.config` file ",
            "comments": [],
            "commits": [
                "a60be8b0a6270e07b6b97d944180c47abf3e90be",
                "b34db23c9af3622cbaebb946a907fcd609788cf7"
            ]
        },
        "codes": [
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/binbashar/le-tf-infra-aws/pull/373",
        "content": {
            "title": "Feature/ Add EKS SPOT example w/ node groups variables",
            "body": "## What?\r\n* Add default variables for EKS node groups\r\n* Add SPOT instances as the default value for EKS clusters\r\n\r\n## Why?\r\n* In order to improve Cost Optimization in EKS cluster for `devstg`\r\n",
            "comments": [
                "@lgallard As we've discussed let's fully test this implementation before merging. Thanks!",
                "Terraform plan (SPOT instances snippet:\r\n```\r\n\r\n  # module.eks.module.node_groups.aws_eks_node_group.workers[\"main\"] will be created\r\n  + resource \"aws_eks_node_group\" \"workers\" {\r\n      + ami_type               = \"AL2_x86_64\"\r\n      + arn                    = (known after apply)\r\n      + capacity_type          = \"SPOT\"\r\n      + cluster_name           = \"bb-apps-devstg-eks-primary\"\r\n      + disk_size              = 50\r\n      + id                     = (known after apply)\r\n      + instance_types         = [\r\n          + \"t2.medium\",\r\n        ]\r\n      + labels                 = {\r\n          + \"Environment\" = \"apps-devstg\"\r\n          + \"Project\"     = \"bb\"\r\n          + \"Terraform\"   = \"true\"\r\n        }\r\n      + node_group_name        = (known after apply)\r\n      + node_group_name_prefix = \"bb-apps-devstg-eks-primary-main\"\r\n      + node_role_arn          = (known after apply)\r\n      + release_version        = (known after apply)\r\n      + resources              = (known after apply)\r\n      + status                 = (known after apply)\r\n      + subnet_ids             = [\r\n          + \"subnet-068e5b9251ea34807\",\r\n          + \"subnet-0be067bd4060487c6\",\r\n          + \"subnet-0dc755acaf92c60cb\",\r\n        ]\r\n      + tags                   = {\r\n          + \"Environment\"                                          = \"apps-devstg\"\r\n          + \"Project\"                                              = \"bb\"\r\n          + \"Terraform\"                                            = \"true\"\r\n          + \"k8s.io/cluster-autoscaler/bb-apps-devstg-eks-primary\" = \"owned\"\r\n          + \"k8s.io/cluster-autoscaler/enabled\"                    = \"TRUE\"\r\n        }\r\n      + tags_all               = {\r\n          + \"Environment\"                                          = \"apps-devstg\"\r\n          + \"Project\"                                              = \"bb\"\r\n          + \"Terraform\"                                            = \"true\"\r\n          + \"k8s.io/cluster-autoscaler/bb-apps-devstg-eks-primary\" = \"owned\"\r\n          + \"k8s.io/cluster-autoscaler/enabled\"                    = \"TRUE\"\r\n        }\r\n      + version                = (known after apply)\r\n\r\n      + scaling_config {\r\n          + desired_size = 1\r\n          + max_size     = 3\r\n          + min_size     = 1\r\n        }\r\n\r\n      + timeouts {}\r\n\r\n      + update_config {\r\n          + max_unavailable            = (known after apply)\r\n          + max_unavailable_percentage = (known after apply)\r\n        }\r\n    }\r\n```",
                "@lgallard So were you able to deploy the cluster using spot instances and testing the demo-apps on it?\r\n\r\nCC: @diego-ojeda-binbash ",
                "@lgallard Approved, let's propagate this improvement for k8s-eks-demoapps in another PR. Thanks!"
            ],
            "commits": [
                "4f3654a87668d804d0f9c65efc5717c5d61b7e32",
                "c0293a25e45025de4c3400357c9667f3a1c0b8d9",
                "1201907216872b8e54ef7ecb4f2691705df9364e",
                "a787449d46799495bb238ad73fd242483304df0f",
                "78ba925ad4c1496ad5bc0b88de7fd3645ac74b11",
                "ac2ab2a9096af5c285681bcb0cb0c0d01a867077",
                "8cf5fba475962d23cbafa5e540d2870e8e91c597"
            ]
        },
        "codes": [
            "saving",
            "cluster"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/binbashar/le-tf-infra-aws/pull/350",
        "content": {
            "title": "Feature/bin 43 costs email notification",
            "body": "## What?\r\nIt adds the capability of adding a list of email addresses as subscribers to monitoring costs SNS topic\r\n\r\n## Why?\r\nAdding another communication way on SNS events\r\n\r\n",
            "comments": [],
            "commits": [
                "a23b4bdee7ec821d77d5acba9f4320800c6c6b95",
                "ed1d317959b02fe80d4e161d44bace2ba4b0c050",
                "975a90c3a9e6b639ae456b2594c407a271b0647c"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/binbashar/le-tf-infra-aws/pull/317",
        "content": {
            "title": "Feature/sms budget billing notifications",
            "body": "## what\r\n* Add SNS topic for SMS, using cost & billing module \r\n\r\n## why\r\n* To have SMS notifications for budget and billing alarms\r\n",
            "comments": [
                "@lgallard Luis, so are both SMS and Slack billing and budget notifications in place right?\r\n\r\nCC: @diego-ojeda-binbash @angelofenoglio @mpagnucco ",
                "@exequielrafaela Slack and SMS subscriptions are created into a SNS Topic for Costs and alarms for Budget and Billing as well. Messages are sent to the topic and the notifications are shown in Slack but it seems there's a issue with the lambda function that probably is preventing to continue sending the messages to SMS."
            ],
            "commits": [
                "c842f7a63ade60b10da3a70930227aca5f780b1b",
                "36f3e038be08853cb577b876e0d27f0da52b7240",
                "f67f75c993fbf19c7ce97830f952678f185a9784",
                "69769eaa694aa1c42a0f2d2729365234aa74494f",
                "c4ddf1d94710ff3f23956c9a13f35e2b87e0cda5",
                "97539d183c4ca217a36de9142ad7577d88b992f0",
                "4d8d9cb6f210aea91c28440a0b1f72d90aa25861",
                "0662f7e1bfc70e21d8229e142b98b6c303addbc3",
                "b53918528afd3756af69944ddf46b8b9bc064cda"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/paas-alpha-tsuru-terraform/pull/27",
        "content": {
            "title": "[#92502564] GCE: Add NAT+Gandalf public IPs to web firewall",
            "body": "It seems that `source_tags` and `target_tags` don't have an effect when\ntraffic routes via public IPs. The result of this was:\n- Gandalf was unable to make a callback to the API when deploying an\n  application\n- The application container was unable to make a callback to the API when an\n  application was started during deployment\n\nSo we've had to add machines that have ephemeral addresses to the\n`source_ranges` list in order to make this work.\n",
            "comments": [
                "I guess this is the only way until (if ever) GCE supports internal load balancers...\n",
                "It pains me but it does seem that way :crying_cat_face:\n",
                "yea, it's really not ideal to have that sort of traffic going out to the internet and then coming back in, both for cost and security reasons...\n",
                "Related discussion, for future reference: https://groups.google.com/forum/#!topic/gce-discussion/Dv6289i4_rg/discussion\n"
            ],
            "commits": [
                "32da75ef00af6c5962d007ad74aec05cae9bd720"
            ]
        },
        "codes": [
            "awareness",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/paas-alpha-tsuru-terraform/pull/57",
        "content": {
            "title": "[#95612064] aws/gce: Combine sslproxy and router roles",
            "body": "Combine the Nginx which does TLS termination and reverse-proxying for the\nrouters onto the same machines as the routers. The separate `sslproxy`\nmachines and their associated resources are no longer needed. This means\nthat:\n- the address of the upstream doesn't change like DNS records for ELBs do\n- we're not subject to extra network latency/partitions for reverse proxying\n- we have a simpler architecture\n\nI've had to FIXME some resources which can't be deleted in a single\nTerraform run. We'll need to remove these later after this has been deployed\nto any existing environments like CI.\n\nThere will be an accompanying PR to alphagov/tsuru-ansible which will need\nto be merged at the same time.\n\n---\n\naws: Remove router-int load balancer\n\nThis was used by Ansible on AWS to configure the Nginx sslproxy machines to\nreverse-proxy to the routers. The hostname was referenced in the variable\n`hipache_host_internal_lb`. We no longer need this since moving Nginx to the\nsame machines as the router.\n\nAlthough we might want to revisit this again later when we test one\napplication talking to another application through the router - which we\nwouldn't want to pay external traffic for.\n\n---\n\nI've tested this with a new environment and rolling forwards an existing environment on both AWS and GCE. Depends on alphagov/tsuru-ansible#69 !\n",
            "comments": [],
            "commits": [
                "c609b9c67aeb8818821c0e560b56858ea693f554",
                "ee3621ece142ce57c50395d7d4711e7c30c475e7",
                "6085ce34a95fbc4a8d651a3f6a0405811952af93"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/CodeForPoznan/infrastructure/pull/87",
        "content": {
            "title": "convert bastion to NAT GW, change type to cheapest one avaiable",
            "body": "Closes #86 \r\n\r\nI already applied this diff (in order to work on it :) so there's no action needed except the approval.",
            "comments": [],
            "commits": [
                "2709680d633653ca9bd68a023981a75427daaa7a",
                "3fce403013e1507e1c41675f9e304b2fd57e71f7"
            ]
        },
        "codes": [
            "saving",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/Civil-Service-Human-Resources/lpg-terraform-paas/pull/373",
        "content": {
            "title": "LC 2042 redis config",
            "body": "- Scaled redis down as the P tiers are far more expensive\r\n- Removed configuration option that was causing a bug\r\n- Correct state",
            "comments": [],
            "commits": [
                "05328b001621d631332564f9685c7d8de372d8b3",
                "384db8e54c1e77155c7d8ac99b391b3b58cd122f"
            ]
        },
        "codes": [
            "instance",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ibm-cloud-architecture/iks_vpc_lab/pull/4",
        "content": {
            "title": "change cluster flavor bx2.2x8",
            "body": "to save cost for long running architecture infra",
            "comments": [
                "Make sure that the IKS usage will be okay?. The previous value was the default in the console."
            ],
            "commits": [
                "629819ce0c440760be155874cb42ab497f0304bd"
            ]
        },
        "codes": [
            "cluster",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/env0/templates/pull/141",
        "content": {
            "title": "Template for AWS Costs Role & Policy",
            "body": "This template creates the IAM role and policy as described in the [How to Setup AWS Costs with env0](https://docs.env0.com/docs/aws-costs) documentation.\r\nThe outputs include the role ARN and External Id for use in configuring the credential in env0.",
            "comments": [
                "Looks great. Please move the constants values of the s3 backend to a variables file so when integrating with env0 it will be able to override them",
                "thank you for the contribution! \ud83d\ude80 "
            ],
            "commits": [
                "39d21b0ba098f47f6fe65ffc7a54d3b417dc93a1"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/gravicore/terraform-gravicore-modules/pull/60",
        "content": {
            "title": "GRVDEV-58 Create AWS Billing Module",
            "body": "",
            "comments": [],
            "commits": [
                "34034a329c00f8770d630842602078739e8910b2",
                "f3fdbafe9cec293a15ad235d4bcc833ea9a6d554",
                "13dca27ee81a6c152b221b002d576a763e9ab925",
                "ee48aa4214b87bfe87d3b9eae0f8f8d162406277"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/gravicore/terraform-gravicore-modules/pull/354",
        "content": {
            "title": "GDEV-342 azure application insights",
            "body": "New application insights module for application monitoring\r\nNew Azure monitor module to get notifications in case of alarms happen\r\nNew consumption module to monitor budget and consumptions\r\nAdd prevent_destroy to db resources to avoid unintended deletions\r\nFix long term retention policy typo in sql",
            "comments": [],
            "commits": [
                "ae0165400e5d02e15c6b1a55a70500abb767162c",
                "915512d6b04079db499b9329be49a75166c8a3fa",
                "e6be6ee07423f9f731893e067acc4dffbb421fc7",
                "18805a1c4fbd96f2a5688fc2b0f7e9869579d674",
                "2890651c5a1d37c6e55697c6d7e967454d5cffb7",
                "1b040d3d483fe41aa09ed906cb66a4eb556cf9a5",
                "a888087b4dcb2b79ff0374942e29eadceb8da2f2",
                "5b7d4bee4d9e116646c814600f8ecc7692d18b38",
                "d8871d47960ee56f4eea7d10a74085041aa9ce22",
                "ab7d0103d71d7ea46735e360eb7a6ec90834480b",
                "666d0d2793d0d9d6ef476423d621234c25364f90",
                "2bed3b72c28f5ffdd3b2acaa2c7ee1e1c1671f51",
                "5f981d83e209b8cdb5d42654eb54df6bfe44a48e",
                "872aed308b7cc84cef9ecb3a863e696591a21c55",
                "7fe1239c9907dd0976bb766e31831567660371f7",
                "ec7a9862e97ebc594a0bd388bea7107fa1d0d288",
                "7385d702c13c6ec849b92d404e854962c7767d9a",
                "5b8d7a9afb29d6bb5f77be80df085627d0bd085a",
                "0880a701ede3fa2c2f95a77f8edfafd73fbeebc7",
                "a0bf1b3f36ca05e0619374f65a54c78758365edd",
                "505c4ad364d695163e968e0dadf7302bbb4d7509",
                "a912dd93af9f8f07f61041c0f7fddf63b4159d34",
                "6ef760b664fc4534e872d721299716750a5e2b4a",
                "b30c3909839a0d5379a12fa1be1b07e6bf18953e",
                "15441c1f09f8e8919e45537296e72bda9f385755",
                "cb0389decd3fa1f3d001eb66d49211a82cdfc0c5",
                "55448c2c9e69c0d6ac663d735c70e506aa3fc6cf",
                "71c2b00bd62a425461c59d1fa826b5fef09412cc",
                "2a9045f5caca2824fbe4035020ffaf72d724d179",
                "b4da4358ca14543843f90fa7801a0e519a52ae41",
                "b9dbab8aae4083f660aca9a759179be7cdf41d66"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/staff-device-dns-dhcp-infrastructure/pull/288",
        "content": {
            "title": "Added conditional SSM vpc endpoints",
            "body": "We currently have a switch to be able to turn on or off the load testing EC2. We decide it was inefficient to have VPC endpoints being deployed and not being used when the load testing bastion is off. Thus we have added a condition for this. We have also refactored the naming of the module to be more reflective of the load testing use case.\r\n\r\n\r\n",
            "comments": [
                "LGTM"
            ],
            "commits": [
                "e4b99b095fdaaddd6752035975bf260913c8afc6",
                "83b17bd469853b070adff274474eac7fd8108e1f"
            ]
        },
        "codes": [
            "saving",
            "cluster"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/telia-oss/terraform-aws-terraform-init/pull/6",
        "content": {
            "title": "Change DynamoDB billing mode to On-Demand",
            "body": "Change DynamoDB billing mode to On-Demand since the usage of Terraform is generally small and varying.",
            "comments": [
                "LGTM"
            ],
            "commits": [
                "e8c7b2eb22d08ddd1a1bb375cb6efa4165c9098f"
            ]
        },
        "codes": [
            "billing_mode"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/cisagov/cool-sharedservices-nessus/pull/26",
        "content": {
            "title": "Upgrade the root volume type to gp3",
            "body": "## \ud83d\udde3 Description ##\r\n\r\nThis pull request upgrades the root volume type from gp2 to gp3.\r\n\r\n## \ud83d\udcad Motivation and context ##\r\n\r\ngp3 is 20% cheaper, and the baseline configuration offers better performance than gp2 for volumes smaller than 2TB.  It also allows the volume size and IOPS to be configured separately, whereas the two are codependent with gp2.\r\n\r\n## \ud83e\uddea Testing ##\r\n\r\nSee cisagov/cool-assessment-terraform#148 for an example of how I tested identical changes in another repository.\r\n\r\n## \u2705 Checklist ##\r\n\r\n- [x] This PR has an informative and human-readable title.\r\n- [x] Changes are limited to a single goal - _eschew scope creep!_\r\n- [x] All relevant type-of-change labels have been added.\r\n- [x] I have read the [CONTRIBUTING](../blob/develop/CONTRIBUTING.md) document.\r\n- [x] These code changes follow [cisagov code standards](https://github.com/cisagov/development-guide).\r\n- [x] All new and existing tests pass.\r\n",
            "comments": [],
            "commits": [
                "5403a8978053a1299b0afe8d7fc59e914fc5e354",
                "89ba93b689c7bf838dc7b8fab8e5c71e8159033e",
                "152aad131b8497cbbfc0e25fbc19ecd0cc433836"
            ]
        },
        "codes": [
            "storage",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/dmcgowandmc/minifoundations/pull/51",
        "content": {
            "title": "Removing ssm endpoints due to costs. Enabling dynamodb endpoints",
            "body": "",
            "comments": [],
            "commits": [
                "941e316bcd70779e868311253f663f8acd5ef155"
            ]
        },
        "codes": [
            "saving",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/verify-infrastructure/pull/572",
        "content": {
            "title": "HUB-748 Remove hosted instance of Sentry BUT NOT YET",
            "body": "DO NOT MERGE until all the ducks are lined up.\r\n\r\nNow that we use the cloud version of Sentry we don't need to host our own version.  Sending `staging` events to the cloud version is more cost effective than running an ec2 instance and database etc.\r\n\r\nThis should remove anything that is used solely by the hosted instance.  Variables remain for use by with the cloud instance.",
            "comments": [],
            "commits": [
                "70a31f9b9a167e5025bb4099cc584044c47e699b"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/verify-infrastructure/pull/66",
        "content": {
            "title": "Make network consistent in all environments",
            "body": "We shouldn't have different network topologies, what affects cost is the\nnumber of boxes/apps, the additional subnet/nat gateway is not expensive\n\nNetwork load balancers have weird config which cannot change which\nforces us to have 3 IPs but we cannot have two IPs in the same subnet.\n\nThis makes the network consistent in all environments, and is\nterraformed everywhere\n\n---\n\nIn non-prodlike environments we will have 2 boxes and 2 apps instead of 3, but\nrunning across 3 AZs.",
            "comments": [],
            "commits": [
                "d34dcd505074546f77367786f5362891050c3440"
            ]
        },
        "codes": [
            "networking",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/modernisation-platform-environments/pull/517",
        "content": {
            "title": "Remove/Disable the `ppud-data-transfer` EC2 instance.",
            "body": "Now we've imported the current PPUD snapshot, spin everything down so\r\nthat we're not incurring unnecessary costs.",
            "comments": [
                "#### `TFSEC Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nTFSEC will check the following folders:\nterraform/environments/ppud\n\n*****************************\n\nRunning TFSEC in terraform/environments/ppud\nExcluding the following checks: AWS095\n  timings\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  disk i/o             108.4\u00b5s\n  parsing              2.297716ms\n  adaptation           71.101\u00b5s\n  checks               16.324315ms\n  total                18.801532ms\n\n  counts\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  modules downloaded   0\n  modules processed    1\n  blocks processed     13\n  files read           7\n\n  results\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  passed               0\n  ignored              0\n  critical             0\n  high                 0\n  medium               0\n  low                  0\n\n\nNo problems detected!\n\ntfsec_exitcode=0\n```\n\n</details>\n\n#### `Checkov Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nCheckov will check the following folders:\nterraform/environments/ppud\n\n*****************************\n\nRunning Checkov in terraform/environments/ppud\nterraform scan results:\n\nPassed checks: 5, Failed checks: 0, Skipped checks: 0\n\n\ncheckov_exitcode=0\n```\n\n</details>\n\n#### `CTFLint Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nSetting default tflint config...\nRunning tflint --init...\nInstalling `aws` plugin...\nInstalled `aws` (source: github.com/terraform-linters/tflint-ruleset-aws, version: 0.13.1)\ntflint will check the following folders:\nterraform/environments/ppud\n\n*****************************\n\nRunning tflint in terraform/environments/ppud\ntflint_exitcode=0\n```\n\n</details>\n",
                "\ud83d\udc4d  thanks for this"
            ],
            "commits": [
                "ec5ec7bac99558a4e95e95788f846eb618edb861"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/modernisation-platform-environments/pull/2767",
        "content": {
            "title": "DPR-586: Optimize DataHubJob",
            "body": "This change speeds up the DataHubJob by setting the `batchDurationSeconds` to 60 seconds.\r\nAlso, the Spark history logs is turned off for cost reasons.",
            "comments": [
                "#### `TFSEC Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nTFSEC will check the following folders:\n```\n\n</details>\n\n#### `Checkov Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nCheckov will check the following folders:\n```\n\n</details>\n\n#### `CTFLint Scan` Success\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nSetting default tflint config...\nRunning tflint --init...\nInstalling `terraform` plugin...\nInstalled `terraform` (source: github.com/terraform-linters/tflint-ruleset-terraform, version: 0.2.1)\ntflint will check the following folders:\n```\n\n</details>\n",
                "LGTM"
            ],
            "commits": [
                "ec402aa37245cb5b0bf544712c8dc2eb83ff53ac"
            ]
        },
        "codes": [
            "saving",
            "feature"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/modernisation-platform-environments/pull/778",
        "content": {
            "title": "New Script to remove non-AWS Backup managed items",
            "body": "We create backups of just the root disk for our disaster recovery process, via a timed lambda.\r\n\r\nThe issue with this is it is not managed by AWS backup, and will just sit in the environment, costing us more and more.\r\n\r\nBy adding this script, it should delete anything over 122 days (it won't yet as I've enabled the dry_run flag) and remove those resources we no longer need. ",
            "comments": [
                "#### `TFSEC Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nTFSEC will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning TFSEC in terraform/environments/xhibit-portal\nExcluding the following checks: AWS095\n\nResult #1 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   19  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #2 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:20\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   20  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #3 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:29\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   29  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #4 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:30\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   30  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResults #5-8 CRITICAL Security group rule allows ingress from public internet. (4 similar results)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:26-34\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   18    resource \"aws_security_group_rule\" \"ingestion_lb_allow_web_users\" {\n   ..  \n   26  \u250c   cidr_blocks = [\n   27  \u2502     \"10.182.60.51/32\",  # NLE CGI proxy \n   28  \u2502     \"195.59.75.151/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   29  \u2502     \"195.59.75.152/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   30  \u2502     \"194.33.192.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   31  \u2502     \"194.33.196.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   32  \u2514     \"194.33.248.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  Individual Causes\n  - ingestion-load-balancer.tf:18-38 (aws_security_group_rule.ingestion_lb_allow_web_users) 4 instances\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #9 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #10 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:123\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #11 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:187\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #12 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:188\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #13 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:199\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  191    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv4\" {\n  192      depends_on        = [aws_security_group.sms_server]\n  193      security_group_id = aws_security_group.sms_server.id\n  194      type              = \"egress\"\n  195      description       = \"allow all ipv4\"\n  196      from_port         = 0\n  197      to_port           = 0\n  198      protocol          = \"-1\"\n  199  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  200    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #14 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:210\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  202    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv6\" {\n  203      depends_on        = [aws_security_group.sms_server]\n  204      security_group_id = aws_security_group.sms_server.id\n  205      type              = \"egress\"\n  206      description       = \"allow all ipv6\"\n  207      from_port         = 0\n  208      to_port           = 0\n  209      protocol          = \"-1\"\n  210  [   ipv6_cidr_blocks  = [\"::/0\"]\n  211    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #15 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:276\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #16 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:277\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #17 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:288\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #18 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:289\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #19 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:82\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   73    resource \"aws_lb_listener\" \"prtg_lb_listener\" {\n   ..  \n   82  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n   ..  \n   90    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #20 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:99\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   90    resource \"aws_lb_listener\" \"waf_lb_listener\" {\n   ..  \n   99  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n  ...  \n  107    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #21 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #22 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #23 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #24 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #25 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:57\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50    resource \"aws_elb\" \"ingestion_lb\" {\n   ..  \n   57  [   internal        = false (false)\n   ..  \n   95    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #26 HIGH IAM policy document uses sensitive action 'ec2:DeregisterImage' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:114\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  104    resource \"aws_iam_role\" \"delete_snapshot_lambda\" {\n  ...  \n  114  [       Version = \"2012-10-17\"\n  ...  \n  137    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #27 HIGH IAM policy document uses sensitive action 'ec2:CreateTags' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:22\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_iam_role\" \"snapshot_lambda\" {\n   ..  \n   22  [       Version = \"2012-10-17\"\n   ..  \n   45    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #28 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:12-37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12  \u250c resource \"aws_lb\" \"prtg_lb\" {\n   13  \u2502 \n   14  \u2502   depends_on = [\n   15  \u2502     aws_security_group.prtg_lb,\n   16  \u2502   ]\n   17  \u2502 \n   18  \u2502   name                       = \"prtg-lb-${var.networking[0].application}\"\n   19  \u2502   internal                   = false\n   20  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #29 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_lb\" \"prtg_lb\" {\n   ..  \n   19  [   internal                   = false (false)\n   ..  \n   37    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #30 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #31 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #32 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #33 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #34 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:30-55\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30  \u250c resource \"aws_lb\" \"waf_lb\" {\n   31  \u2502 \n   32  \u2502   depends_on = [\n   33  \u2502     aws_security_group.waf_lb,\n   34  \u2502   ]\n   35  \u2502 \n   36  \u2502   name                       = \"waf-lb-${var.networking[0].application}\"\n   37  \u2502   internal                   = false\n   38  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #35 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #36 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #37 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #38 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #39 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30    resource \"aws_lb\" \"waf_lb\" {\n   ..  \n   37  [   internal                   = false (false)\n   ..  \n   55    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #40 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #41 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #42 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #43 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #44 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #45 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #46 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #47 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #48 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  build-server.tf:46-60\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   46  \u250c resource \"aws_ebs_volume\" \"build-disk1\" {\n   47  \u2502   depends_on        = [aws_instance.build-server]\n   48  \u2502   availability_zone = \"${local.region}a\"\n   49  \u2502   type              = \"gp2\"\n   50  \u2502   encrypted         = true\n   51  \u2502 \n   52  \u2502   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n   53  \u2502 \n   54  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #49 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjim-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjim-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjim-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #50 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjip-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjip-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjip-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #51 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:102-116\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102  \u250c resource \"aws_ebs_volume\" \"database-disk3\" {\n  103  \u2502   depends_on        = [aws_instance.database-server]\n  104  \u2502   availability_zone = \"${local.region}a\"\n  105  \u2502   type              = \"gp2\"\n  106  \u2502   encrypted         = true\n  107  \u2502 \n  108  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n  109  \u2502 \n  110  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #52 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:126-140\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  126  \u250c resource \"aws_ebs_volume\" \"database-disk4\" {\n  127  \u2502   depends_on        = [aws_instance.database-server]\n  128  \u2502   availability_zone = \"${local.region}a\"\n  129  \u2502   type              = \"gp2\"\n  130  \u2502   encrypted         = true\n  131  \u2502 \n  132  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n  133  \u2502 \n  134  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #53 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:150-164\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  150  \u250c resource \"aws_ebs_volume\" \"database-disk5\" {\n  151  \u2502   depends_on        = [aws_instance.database-server]\n  152  \u2502   availability_zone = \"${local.region}a\"\n  153  \u2502   type              = \"gp2\"\n  154  \u2502   encrypted         = true\n  155  \u2502 \n  156  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n  157  \u2502 \n  158  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #54 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:175-191\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  175  \u250c resource \"aws_ebs_volume\" \"database-disk6\" {\n  176  \u2502   depends_on        = [aws_instance.database-server]\n  177  \u2502   availability_zone = \"${local.region}a\"\n  178  \u2502   type              = \"gp2\"\n  179  \u2502   encrypted         = true\n  180  \u2502 \n  181  \u2502   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n  182  \u2502 \n  183  \u2514   size = 300\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #55 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:201-215\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  201  \u250c resource \"aws_ebs_volume\" \"database-disk7\" {\n  202  \u2502   depends_on        = [aws_instance.database-server]\n  203  \u2502   availability_zone = \"${local.region}a\"\n  204  \u2502   type              = \"gp2\"\n  205  \u2502   encrypted         = true\n  206  \u2502 \n  207  \u2502   size = 300\n  208  \u2502 \n  209  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #56 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:50-64\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50  \u250c resource \"aws_ebs_volume\" \"database-disk1\" {\n   51  \u2502   depends_on        = [aws_instance.database-server]\n   52  \u2502   availability_zone = \"${local.region}a\"\n   53  \u2502   type              = \"gp2\"\n   54  \u2502   encrypted         = true\n   55  \u2502 \n   56  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n   57  \u2502 \n   58  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #57 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:77-91\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   77  \u250c resource \"aws_ebs_volume\" \"database-disk2\" {\n   78  \u2502   depends_on        = [aws_instance.database-server]\n   79  \u2502   availability_zone = \"${local.region}a\"\n   80  \u2502   type              = \"gp2\"\n   81  \u2502   encrypted         = true\n   82  \u2502 \n   83  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n   84  \u2502 \n   85  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #58 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  domain-controllers.tf:146-159\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  146  \u250c resource \"aws_ebs_volume\" \"infra1-disk1\" {\n  147  \u2502   availability_zone = \"${local.region}a\"\n  148  \u2502   type              = \"gp2\"\n  149  \u2502   encrypted         = true\n  150  \u2502 \n  151  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n  152  \u2502 \n  153  \u2502   tags = merge(\n  154  \u2514     local.tags,\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #59 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:53-67\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   53  \u250c resource \"aws_ebs_volume\" \"exchange-disk1\" {\n   54  \u2502   depends_on        = [aws_instance.exchange-server]\n   55  \u2502   availability_zone = \"${local.region}a\"\n   56  \u2502   type              = \"gp2\"\n   57  \u2502   encrypted         = true\n   58  \u2502 \n   59  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n   60  \u2502 \n   61  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #60 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:80-94\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   80  \u250c resource \"aws_ebs_volume\" \"exchange-disk2\" {\n   81  \u2502   depends_on        = [aws_instance.exchange-server]\n   82  \u2502   availability_zone = \"${local.region}a\"\n   83  \u2502   type              = \"gp2\"\n   84  \u2502   encrypted         = true\n   85  \u2502 \n   86  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n   87  \u2502 \n   88  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #61 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:91-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   91  \u250c resource \"aws_ebs_volume\" \"disk_xvdf\" {\n   92  \u2502   depends_on        = [aws_instance.importmachine]\n   93  \u2502   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n   94  \u2502   availability_zone = \"${local.region}a\"\n   95  \u2502   type              = \"gp2\"\n   96  \u2502   encrypted         = true\n   97  \u2502   size              = 6000\n   98  \u2502 \n   99  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #62 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #63 LOW Security group rule does not have a description. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:148-155\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  148    resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n  149      from_port                = 3389\n  150      protocol                 = \"TCP\"\n  151      security_group_id        = aws_security_group.sms_server.id\n  152      to_port                  = 3389\n  153      type                     = \"ingress\"\n  154      source_security_group_id = module.bastion_linux.bastion_security_group\n  155    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-add-description-to-security-group-rule\n      Impact Descriptions provide context for the firewall rule reasons\n  Resolution Add descriptions for all security groups rules\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #64 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #65 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #66 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\n  timings\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  disk i/o             6.472369ms\n  parsing              2.708452805s\n  adaptation           6.234667ms\n  checks               42.039883ms\n  total                2.763199724s\n\n  counts\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  modules downloaded   3\n  modules processed    5\n  blocks processed     356\n  files read           43\n\n  results\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  passed               248\n  ignored              58\n  critical             20\n  high                 23\n  medium               4\n  low                  19\n\n  248 passed, 58 ignored, 66 potential problem(s) detected.\n\ntfsec_exitcode=1\n```\n\n</details>\n\n#### `Checkov Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nCheckov will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning Checkov in terraform/environments/xhibit-portal\n2022-08-04 14:23:35,765 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import:None (for external modules, the --download-external-modules flag is required)\n2022-08-04 14:23:35,765 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-bastion-linux?ref=v3.0.4:None (for external modules, the --download-external-modules flag is required)\nterraform scan results:\n\nPassed checks: 400, Failed checks: 45, Skipped checks: 6\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.build-disk1\n\tFile: /build-server.tf:46-60\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t46 | resource \"aws_ebs_volume\" \"build-disk1\" {\n\t\t47 |   depends_on        = [aws_instance.build-server]\n\t\t48 |   availability_zone = \"${local.region}a\"\n\t\t49 |   type              = \"gp2\"\n\t\t50 |   encrypted         = true\n\t\t51 | \n\t\t52 |   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n\t\t53 | \n\t\t54 |   tags = merge(\n\t\t55 |     local.tags,\n\t\t56 |     {\n\t\t57 |       Name = \"build-disk1-${local.application_name}\"\n\t\t58 |     }\n\t\t59 |   )\n\t\t60 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjim-disk1\n\tFile: /cjim-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjim-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjim-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjim-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjip-disk1\n\tFile: /cjip-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjip-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjip-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjip-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-baremetal-disk1\n\tFile: /database-server-baremetal.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"database-baremetal-disk1\" {\n\t\t54 |   count             = local.only_in_production\n\t\t55 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t56 |   availability_zone = \"${local.region}a\"\n\t\t57 |   type              = \"gp2\"\n\t\t58 |   encrypted         = true\n\t\t59 |   size              = 4000\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"database-baremetal-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.app-baremetal-disk2\n\tFile: /database-server-baremetal.tf:98-112\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t98  | resource \"aws_ebs_volume\" \"app-baremetal-disk2\" {\n\t\t99  |   count             = local.only_in_production\n\t\t100 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t101 |   availability_zone = \"${local.region}a\"\n\t\t102 |   type              = \"gp2\"\n\t\t103 |   encrypted         = true\n\t\t104 |   size              = 2000\n\t\t105 | \n\t\t106 |   tags = merge(\n\t\t107 |     local.tags,\n\t\t108 |     {\n\t\t109 |       Name = \"app-baremetal-disk2-${local.application_name}\"\n\t\t110 |     }\n\t\t111 |   )\n\t\t112 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk1\n\tFile: /database-server.tf:50-64\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t50 | resource \"aws_ebs_volume\" \"database-disk1\" {\n\t\t51 |   depends_on        = [aws_instance.database-server]\n\t\t52 |   availability_zone = \"${local.region}a\"\n\t\t53 |   type              = \"gp2\"\n\t\t54 |   encrypted         = true\n\t\t55 | \n\t\t56 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n\t\t57 | \n\t\t58 |   tags = merge(\n\t\t59 |     local.tags,\n\t\t60 |     {\n\t\t61 |       Name = \"database-disk1-${local.application_name}\"\n\t\t62 |     }\n\t\t63 |   )\n\t\t64 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk2\n\tFile: /database-server.tf:77-91\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t77 | resource \"aws_ebs_volume\" \"database-disk2\" {\n\t\t78 |   depends_on        = [aws_instance.database-server]\n\t\t79 |   availability_zone = \"${local.region}a\"\n\t\t80 |   type              = \"gp2\"\n\t\t81 |   encrypted         = true\n\t\t82 | \n\t\t83 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n\t\t84 | \n\t\t85 |   tags = merge(\n\t\t86 |     local.tags,\n\t\t87 |     {\n\t\t88 |       Name = \"database-disk2-${local.application_name}\"\n\t\t89 |     }\n\t\t90 |   )\n\t\t91 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk3\n\tFile: /database-server.tf:102-116\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t102 | resource \"aws_ebs_volume\" \"database-disk3\" {\n\t\t103 |   depends_on        = [aws_instance.database-server]\n\t\t104 |   availability_zone = \"${local.region}a\"\n\t\t105 |   type              = \"gp2\"\n\t\t106 |   encrypted         = true\n\t\t107 | \n\t\t108 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n\t\t109 | \n\t\t110 |   tags = merge(\n\t\t111 |     local.tags,\n\t\t112 |     {\n\t\t113 |       Name = \"database-disk3-${local.application_name}\"\n\t\t114 |     }\n\t\t115 |   )\n\t\t116 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk4\n\tFile: /database-server.tf:126-140\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t126 | resource \"aws_ebs_volume\" \"database-disk4\" {\n\t\t127 |   depends_on        = [aws_instance.database-server]\n\t\t128 |   availability_zone = \"${local.region}a\"\n\t\t129 |   type              = \"gp2\"\n\t\t130 |   encrypted         = true\n\t\t131 | \n\t\t132 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n\t\t133 | \n\t\t134 |   tags = merge(\n\t\t135 |     local.tags,\n\t\t136 |     {\n\t\t137 |       Name = \"database-disk4-${local.application_name}\"\n\t\t138 |     }\n\t\t139 |   )\n\t\t140 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk5\n\tFile: /database-server.tf:150-164\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t150 | resource \"aws_ebs_volume\" \"database-disk5\" {\n\t\t151 |   depends_on        = [aws_instance.database-server]\n\t\t152 |   availability_zone = \"${local.region}a\"\n\t\t153 |   type              = \"gp2\"\n\t\t154 |   encrypted         = true\n\t\t155 | \n\t\t156 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n\t\t157 | \n\t\t158 |   tags = merge(\n\t\t159 |     local.tags,\n\t\t160 |     {\n\t\t161 |       Name = \"database-disk5-${local.application_name}\"\n\t\t162 |     }\n\t\t163 |   )\n\t\t164 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk6\n\tFile: /database-server.tf:175-191\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t175 | resource \"aws_ebs_volume\" \"database-disk6\" {\n\t\t176 |   depends_on        = [aws_instance.database-server]\n\t\t177 |   availability_zone = \"${local.region}a\"\n\t\t178 |   type              = \"gp2\"\n\t\t179 |   encrypted         = true\n\t\t180 | \n\t\t181 |   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n\t\t182 | \n\t\t183 |   size = 300\n\t\t184 | \n\t\t185 |   tags = merge(\n\t\t186 |     local.tags,\n\t\t187 |     {\n\t\t188 |       Name = \"database-disk6-${local.application_name}\"\n\t\t189 |     }\n\t\t190 |   )\n\t\t191 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk7\n\tFile: /database-server.tf:201-215\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t201 | resource \"aws_ebs_volume\" \"database-disk7\" {\n\t\t202 |   depends_on        = [aws_instance.database-server]\n\t\t203 |   availability_zone = \"${local.region}a\"\n\t\t204 |   type              = \"gp2\"\n\t\t205 |   encrypted         = true\n\t\t206 | \n\t\t207 |   size = 300\n\t\t208 | \n\t\t209 |   tags = merge(\n\t\t210 |     local.tags,\n\t\t211 |     {\n\t\t212 |       Name = \"database-disk7-${local.application_name}\"\n\t\t213 |     }\n\t\t214 |   )\n\t\t215 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.infra1-disk1\n\tFile: /domain-controllers.tf:146-159\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t146 | resource \"aws_ebs_volume\" \"infra1-disk1\" {\n\t\t147 |   availability_zone = \"${local.region}a\"\n\t\t148 |   type              = \"gp2\"\n\t\t149 |   encrypted         = true\n\t\t150 | \n\t\t151 |   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n\t\t152 | \n\t\t153 |   tags = merge(\n\t\t154 |     local.tags,\n\t\t155 |     {\n\t\t156 |       Name = \"infra1-disk1-${local.application_name}\"\n\t\t157 |     }\n\t\t158 |   )\n\t\t159 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk1\n\tFile: /exchange-server.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"exchange-disk1\" {\n\t\t54 |   depends_on        = [aws_instance.exchange-server]\n\t\t55 |   availability_zone = \"${local.region}a\"\n\t\t56 |   type              = \"gp2\"\n\t\t57 |   encrypted         = true\n\t\t58 | \n\t\t59 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"exchange-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk2\n\tFile: /exchange-server.tf:80-94\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t80 | resource \"aws_ebs_volume\" \"exchange-disk2\" {\n\t\t81 |   depends_on        = [aws_instance.exchange-server]\n\t\t82 |   availability_zone = \"${local.region}a\"\n\t\t83 |   type              = \"gp2\"\n\t\t84 |   encrypted         = true\n\t\t85 | \n\t\t86 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n\t\t87 | \n\t\t88 |   tags = merge(\n\t\t89 |     local.tags,\n\t\t90 |     {\n\t\t91 |       Name = \"exchange-disk2-${local.application_name}\"\n\t\t92 |     }\n\t\t93 |   )\n\t\t94 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.disk_xvdf\n\tFile: /importmachine.tf:91-105\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t91  | resource \"aws_ebs_volume\" \"disk_xvdf\" {\n\t\t92  |   depends_on        = [aws_instance.importmachine]\n\t\t93  |   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n\t\t94  |   availability_zone = \"${local.region}a\"\n\t\t95  |   type              = \"gp2\"\n\t\t96  |   encrypted         = true\n\t\t97  |   size              = 6000\n\t\t98  | \n\t\t99  |   tags = merge(\n\t\t100 |     local.tags,\n\t\t101 |     {\n\t\t102 |       Name = \"importmachine-${local.application_name}-disk\"\n\t\t103 |     }\n\t\t104 |   )\n\t\t105 | }\n\nCheck: CKV_AWS_23: \"Ensure every security groups rule has a description\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-bastion\n\tFile: /network-infrastructure.tf:148-155\n\tGuide: https://docs.bridgecrew.io/docs/networking_31\n\n\t\t148 | resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n\t\t149 |   from_port                = 3389\n\t\t150 |   protocol                 = \"TCP\"\n\t\t151 |   security_group_id        = aws_security_group.sms_server.id\n\t\t152 |   to_port                  = 3389\n\t\t153 |   type                     = \"ingress\"\n\t\t154 |   source_security_group_id = module.bastion_linux.bastion_security_group\n\t\t155 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.prtg_acl\n\tFile: /prtg-load-balancer.tf:139-204\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.waf_acl\n\tFile: /waf-load-balancer.tf:242-307\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\n\ncheckov_exitcode=1\n```\n\n</details>\n\n#### `CTFLint Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nSetting default tflint config...\nRunning tflint --init...\nInstalling `aws` plugin...\nInstalled `aws` (source: github.com/terraform-linters/tflint-ruleset-aws, version: 0.15.0)\ntflint will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning tflint in terraform/environments/xhibit-portal\n17 issue(s) found:\n\nWarning: Module source \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\" is not pinned (terraform_module_pinned_source)\n\n  on /github/workspace/terraform/environments/xhibit-portal/importrole.tf line 3:\n   3:   source = \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_module_pinned_source.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 138:\n 138:       \"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 188:\n 188:     resources = [\"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 98:\n  98:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 232:\n 232:   log_destination_configs = [\"${aws_s3_bucket.prtg_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 251:\n 251:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 290:\n 290:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 315:\n 315:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 322:\n 322:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 202:\n 202:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 350:\n 350:       \"${aws_s3_bucket.loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 400:\n 400:     resources = [\"${aws_s3_bucket.loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 430:\n 430:   log_destination_configs = [\"${aws_s3_bucket.waf_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 449:\n 449:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 488:\n 488:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 513:\n 513:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 520:\n 520:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\ntflint_exitcode=2\n```\n\n</details>\n",
                "#### `TFSEC Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nTFSEC will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning TFSEC in terraform/environments/xhibit-portal\nExcluding the following checks: AWS095\n\nResult #1 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   19  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #2 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:20\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   20  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #3 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:29\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   29  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #4 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:30\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   30  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResults #5-8 CRITICAL Security group rule allows ingress from public internet. (4 similar results)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:26-34\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   18    resource \"aws_security_group_rule\" \"ingestion_lb_allow_web_users\" {\n   ..  \n   26  \u250c   cidr_blocks = [\n   27  \u2502     \"10.182.60.51/32\",  # NLE CGI proxy \n   28  \u2502     \"195.59.75.151/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   29  \u2502     \"195.59.75.152/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   30  \u2502     \"194.33.192.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   31  \u2502     \"194.33.196.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   32  \u2514     \"194.33.248.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  Individual Causes\n  - ingestion-load-balancer.tf:18-38 (aws_security_group_rule.ingestion_lb_allow_web_users) 4 instances\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #9 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #10 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:123\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #11 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:187\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #12 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:188\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #13 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:199\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  191    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv4\" {\n  192      depends_on        = [aws_security_group.sms_server]\n  193      security_group_id = aws_security_group.sms_server.id\n  194      type              = \"egress\"\n  195      description       = \"allow all ipv4\"\n  196      from_port         = 0\n  197      to_port           = 0\n  198      protocol          = \"-1\"\n  199  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  200    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #14 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:210\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  202    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv6\" {\n  203      depends_on        = [aws_security_group.sms_server]\n  204      security_group_id = aws_security_group.sms_server.id\n  205      type              = \"egress\"\n  206      description       = \"allow all ipv6\"\n  207      from_port         = 0\n  208      to_port           = 0\n  209      protocol          = \"-1\"\n  210  [   ipv6_cidr_blocks  = [\"::/0\"]\n  211    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #15 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:276\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #16 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:277\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #17 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:288\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #18 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:289\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #19 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:82\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   73    resource \"aws_lb_listener\" \"prtg_lb_listener\" {\n   ..  \n   82  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n   ..  \n   90    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #20 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:99\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   90    resource \"aws_lb_listener\" \"waf_lb_listener\" {\n   ..  \n   99  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n  ...  \n  107    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #21 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #22 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #23 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #24 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #25 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:57\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50    resource \"aws_elb\" \"ingestion_lb\" {\n   ..  \n   57  [   internal        = false (false)\n   ..  \n   95    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #26 HIGH IAM policy document uses sensitive action 'ec2:DeregisterImage' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:114\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  104    resource \"aws_iam_role\" \"delete_snapshot_lambda\" {\n  ...  \n  114  [       Version = \"2012-10-17\"\n  ...  \n  137    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #27 HIGH IAM policy document uses sensitive action 'ec2:CreateTags' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:22\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_iam_role\" \"snapshot_lambda\" {\n   ..  \n   22  [       Version = \"2012-10-17\"\n   ..  \n   45    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #28 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:12-37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12  \u250c resource \"aws_lb\" \"prtg_lb\" {\n   13  \u2502 \n   14  \u2502   depends_on = [\n   15  \u2502     aws_security_group.prtg_lb,\n   16  \u2502   ]\n   17  \u2502 \n   18  \u2502   name                       = \"prtg-lb-${var.networking[0].application}\"\n   19  \u2502   internal                   = false\n   20  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #29 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_lb\" \"prtg_lb\" {\n   ..  \n   19  [   internal                   = false (false)\n   ..  \n   37    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #30 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #31 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #32 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #33 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #34 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:30-55\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30  \u250c resource \"aws_lb\" \"waf_lb\" {\n   31  \u2502 \n   32  \u2502   depends_on = [\n   33  \u2502     aws_security_group.waf_lb,\n   34  \u2502   ]\n   35  \u2502 \n   36  \u2502   name                       = \"waf-lb-${var.networking[0].application}\"\n   37  \u2502   internal                   = false\n   38  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #35 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #36 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #37 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #38 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #39 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30    resource \"aws_lb\" \"waf_lb\" {\n   ..  \n   37  [   internal                   = false (false)\n   ..  \n   55    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #40 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #41 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #42 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #43 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #44 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #45 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #46 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #47 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #48 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  build-server.tf:46-60\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   46  \u250c resource \"aws_ebs_volume\" \"build-disk1\" {\n   47  \u2502   depends_on        = [aws_instance.build-server]\n   48  \u2502   availability_zone = \"${local.region}a\"\n   49  \u2502   type              = \"gp2\"\n   50  \u2502   encrypted         = true\n   51  \u2502 \n   52  \u2502   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n   53  \u2502 \n   54  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #49 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjim-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjim-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjim-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #50 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjip-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjip-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjip-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #51 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:102-116\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102  \u250c resource \"aws_ebs_volume\" \"database-disk3\" {\n  103  \u2502   depends_on        = [aws_instance.database-server]\n  104  \u2502   availability_zone = \"${local.region}a\"\n  105  \u2502   type              = \"gp2\"\n  106  \u2502   encrypted         = true\n  107  \u2502 \n  108  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n  109  \u2502 \n  110  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #52 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:126-140\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  126  \u250c resource \"aws_ebs_volume\" \"database-disk4\" {\n  127  \u2502   depends_on        = [aws_instance.database-server]\n  128  \u2502   availability_zone = \"${local.region}a\"\n  129  \u2502   type              = \"gp2\"\n  130  \u2502   encrypted         = true\n  131  \u2502 \n  132  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n  133  \u2502 \n  134  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #53 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:150-164\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  150  \u250c resource \"aws_ebs_volume\" \"database-disk5\" {\n  151  \u2502   depends_on        = [aws_instance.database-server]\n  152  \u2502   availability_zone = \"${local.region}a\"\n  153  \u2502   type              = \"gp2\"\n  154  \u2502   encrypted         = true\n  155  \u2502 \n  156  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n  157  \u2502 \n  158  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #54 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:175-191\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  175  \u250c resource \"aws_ebs_volume\" \"database-disk6\" {\n  176  \u2502   depends_on        = [aws_instance.database-server]\n  177  \u2502   availability_zone = \"${local.region}a\"\n  178  \u2502   type              = \"gp2\"\n  179  \u2502   encrypted         = true\n  180  \u2502 \n  181  \u2502   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n  182  \u2502 \n  183  \u2514   size = 300\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #55 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:201-215\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  201  \u250c resource \"aws_ebs_volume\" \"database-disk7\" {\n  202  \u2502   depends_on        = [aws_instance.database-server]\n  203  \u2502   availability_zone = \"${local.region}a\"\n  204  \u2502   type              = \"gp2\"\n  205  \u2502   encrypted         = true\n  206  \u2502 \n  207  \u2502   size = 300\n  208  \u2502 \n  209  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #56 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:50-64\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50  \u250c resource \"aws_ebs_volume\" \"database-disk1\" {\n   51  \u2502   depends_on        = [aws_instance.database-server]\n   52  \u2502   availability_zone = \"${local.region}a\"\n   53  \u2502   type              = \"gp2\"\n   54  \u2502   encrypted         = true\n   55  \u2502 \n   56  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n   57  \u2502 \n   58  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #57 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:77-91\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   77  \u250c resource \"aws_ebs_volume\" \"database-disk2\" {\n   78  \u2502   depends_on        = [aws_instance.database-server]\n   79  \u2502   availability_zone = \"${local.region}a\"\n   80  \u2502   type              = \"gp2\"\n   81  \u2502   encrypted         = true\n   82  \u2502 \n   83  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n   84  \u2502 \n   85  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #58 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  domain-controllers.tf:146-159\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  146  \u250c resource \"aws_ebs_volume\" \"infra1-disk1\" {\n  147  \u2502   availability_zone = \"${local.region}a\"\n  148  \u2502   type              = \"gp2\"\n  149  \u2502   encrypted         = true\n  150  \u2502 \n  151  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n  152  \u2502 \n  153  \u2502   tags = merge(\n  154  \u2514     local.tags,\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #59 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:53-67\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   53  \u250c resource \"aws_ebs_volume\" \"exchange-disk1\" {\n   54  \u2502   depends_on        = [aws_instance.exchange-server]\n   55  \u2502   availability_zone = \"${local.region}a\"\n   56  \u2502   type              = \"gp2\"\n   57  \u2502   encrypted         = true\n   58  \u2502 \n   59  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n   60  \u2502 \n   61  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #60 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:80-94\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   80  \u250c resource \"aws_ebs_volume\" \"exchange-disk2\" {\n   81  \u2502   depends_on        = [aws_instance.exchange-server]\n   82  \u2502   availability_zone = \"${local.region}a\"\n   83  \u2502   type              = \"gp2\"\n   84  \u2502   encrypted         = true\n   85  \u2502 \n   86  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n   87  \u2502 \n   88  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #61 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:91-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   91  \u250c resource \"aws_ebs_volume\" \"disk_xvdf\" {\n   92  \u2502   depends_on        = [aws_instance.importmachine]\n   93  \u2502   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n   94  \u2502   availability_zone = \"${local.region}a\"\n   95  \u2502   type              = \"gp2\"\n   96  \u2502   encrypted         = true\n   97  \u2502   size              = 6000\n   98  \u2502 \n   99  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #62 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #63 LOW Security group rule does not have a description. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:148-155\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  148    resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n  149      from_port                = 3389\n  150      protocol                 = \"TCP\"\n  151      security_group_id        = aws_security_group.sms_server.id\n  152      to_port                  = 3389\n  153      type                     = \"ingress\"\n  154      source_security_group_id = module.bastion_linux.bastion_security_group\n  155    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-add-description-to-security-group-rule\n      Impact Descriptions provide context for the firewall rule reasons\n  Resolution Add descriptions for all security groups rules\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #64 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #65 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #66 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\n  timings\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  disk i/o             1.336788ms\n  parsing              2.848827794s\n  adaptation           24.332754ms\n  checks               58.912764ms\n  total                2.9334101s\n\n  counts\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  modules downloaded   3\n  modules processed    5\n  blocks processed     356\n  files read           43\n\n  results\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  passed               248\n  ignored              58\n  critical             20\n  high                 23\n  medium               4\n  low                  19\n\n  248 passed, 58 ignored, 66 potential problem(s) detected.\n\ntfsec_exitcode=1\n```\n\n</details>\n\n#### `Checkov Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nCheckov will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning Checkov in terraform/environments/xhibit-portal\n2022-08-04 14:30:20,174 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import:None (for external modules, the --download-external-modules flag is required)\n2022-08-04 14:30:20,175 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-bastion-linux?ref=v3.0.4:None (for external modules, the --download-external-modules flag is required)\nterraform scan results:\n\nPassed checks: 400, Failed checks: 45, Skipped checks: 6\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.build-disk1\n\tFile: /build-server.tf:46-60\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t46 | resource \"aws_ebs_volume\" \"build-disk1\" {\n\t\t47 |   depends_on        = [aws_instance.build-server]\n\t\t48 |   availability_zone = \"${local.region}a\"\n\t\t49 |   type              = \"gp2\"\n\t\t50 |   encrypted         = true\n\t\t51 | \n\t\t52 |   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n\t\t53 | \n\t\t54 |   tags = merge(\n\t\t55 |     local.tags,\n\t\t56 |     {\n\t\t57 |       Name = \"build-disk1-${local.application_name}\"\n\t\t58 |     }\n\t\t59 |   )\n\t\t60 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjim-disk1\n\tFile: /cjim-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjim-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjim-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjim-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjip-disk1\n\tFile: /cjip-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjip-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjip-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjip-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-baremetal-disk1\n\tFile: /database-server-baremetal.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"database-baremetal-disk1\" {\n\t\t54 |   count             = local.only_in_production\n\t\t55 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t56 |   availability_zone = \"${local.region}a\"\n\t\t57 |   type              = \"gp2\"\n\t\t58 |   encrypted         = true\n\t\t59 |   size              = 4000\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"database-baremetal-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.app-baremetal-disk2\n\tFile: /database-server-baremetal.tf:98-112\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t98  | resource \"aws_ebs_volume\" \"app-baremetal-disk2\" {\n\t\t99  |   count             = local.only_in_production\n\t\t100 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t101 |   availability_zone = \"${local.region}a\"\n\t\t102 |   type              = \"gp2\"\n\t\t103 |   encrypted         = true\n\t\t104 |   size              = 2000\n\t\t105 | \n\t\t106 |   tags = merge(\n\t\t107 |     local.tags,\n\t\t108 |     {\n\t\t109 |       Name = \"app-baremetal-disk2-${local.application_name}\"\n\t\t110 |     }\n\t\t111 |   )\n\t\t112 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk1\n\tFile: /database-server.tf:50-64\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t50 | resource \"aws_ebs_volume\" \"database-disk1\" {\n\t\t51 |   depends_on        = [aws_instance.database-server]\n\t\t52 |   availability_zone = \"${local.region}a\"\n\t\t53 |   type              = \"gp2\"\n\t\t54 |   encrypted         = true\n\t\t55 | \n\t\t56 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n\t\t57 | \n\t\t58 |   tags = merge(\n\t\t59 |     local.tags,\n\t\t60 |     {\n\t\t61 |       Name = \"database-disk1-${local.application_name}\"\n\t\t62 |     }\n\t\t63 |   )\n\t\t64 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk2\n\tFile: /database-server.tf:77-91\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t77 | resource \"aws_ebs_volume\" \"database-disk2\" {\n\t\t78 |   depends_on        = [aws_instance.database-server]\n\t\t79 |   availability_zone = \"${local.region}a\"\n\t\t80 |   type              = \"gp2\"\n\t\t81 |   encrypted         = true\n\t\t82 | \n\t\t83 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n\t\t84 | \n\t\t85 |   tags = merge(\n\t\t86 |     local.tags,\n\t\t87 |     {\n\t\t88 |       Name = \"database-disk2-${local.application_name}\"\n\t\t89 |     }\n\t\t90 |   )\n\t\t91 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk3\n\tFile: /database-server.tf:102-116\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t102 | resource \"aws_ebs_volume\" \"database-disk3\" {\n\t\t103 |   depends_on        = [aws_instance.database-server]\n\t\t104 |   availability_zone = \"${local.region}a\"\n\t\t105 |   type              = \"gp2\"\n\t\t106 |   encrypted         = true\n\t\t107 | \n\t\t108 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n\t\t109 | \n\t\t110 |   tags = merge(\n\t\t111 |     local.tags,\n\t\t112 |     {\n\t\t113 |       Name = \"database-disk3-${local.application_name}\"\n\t\t114 |     }\n\t\t115 |   )\n\t\t116 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk4\n\tFile: /database-server.tf:126-140\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t126 | resource \"aws_ebs_volume\" \"database-disk4\" {\n\t\t127 |   depends_on        = [aws_instance.database-server]\n\t\t128 |   availability_zone = \"${local.region}a\"\n\t\t129 |   type              = \"gp2\"\n\t\t130 |   encrypted         = true\n\t\t131 | \n\t\t132 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n\t\t133 | \n\t\t134 |   tags = merge(\n\t\t135 |     local.tags,\n\t\t136 |     {\n\t\t137 |       Name = \"database-disk4-${local.application_name}\"\n\t\t138 |     }\n\t\t139 |   )\n\t\t140 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk5\n\tFile: /database-server.tf:150-164\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t150 | resource \"aws_ebs_volume\" \"database-disk5\" {\n\t\t151 |   depends_on        = [aws_instance.database-server]\n\t\t152 |   availability_zone = \"${local.region}a\"\n\t\t153 |   type              = \"gp2\"\n\t\t154 |   encrypted         = true\n\t\t155 | \n\t\t156 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n\t\t157 | \n\t\t158 |   tags = merge(\n\t\t159 |     local.tags,\n\t\t160 |     {\n\t\t161 |       Name = \"database-disk5-${local.application_name}\"\n\t\t162 |     }\n\t\t163 |   )\n\t\t164 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk6\n\tFile: /database-server.tf:175-191\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t175 | resource \"aws_ebs_volume\" \"database-disk6\" {\n\t\t176 |   depends_on        = [aws_instance.database-server]\n\t\t177 |   availability_zone = \"${local.region}a\"\n\t\t178 |   type              = \"gp2\"\n\t\t179 |   encrypted         = true\n\t\t180 | \n\t\t181 |   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n\t\t182 | \n\t\t183 |   size = 300\n\t\t184 | \n\t\t185 |   tags = merge(\n\t\t186 |     local.tags,\n\t\t187 |     {\n\t\t188 |       Name = \"database-disk6-${local.application_name}\"\n\t\t189 |     }\n\t\t190 |   )\n\t\t191 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk7\n\tFile: /database-server.tf:201-215\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t201 | resource \"aws_ebs_volume\" \"database-disk7\" {\n\t\t202 |   depends_on        = [aws_instance.database-server]\n\t\t203 |   availability_zone = \"${local.region}a\"\n\t\t204 |   type              = \"gp2\"\n\t\t205 |   encrypted         = true\n\t\t206 | \n\t\t207 |   size = 300\n\t\t208 | \n\t\t209 |   tags = merge(\n\t\t210 |     local.tags,\n\t\t211 |     {\n\t\t212 |       Name = \"database-disk7-${local.application_name}\"\n\t\t213 |     }\n\t\t214 |   )\n\t\t215 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.infra1-disk1\n\tFile: /domain-controllers.tf:146-159\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t146 | resource \"aws_ebs_volume\" \"infra1-disk1\" {\n\t\t147 |   availability_zone = \"${local.region}a\"\n\t\t148 |   type              = \"gp2\"\n\t\t149 |   encrypted         = true\n\t\t150 | \n\t\t151 |   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n\t\t152 | \n\t\t153 |   tags = merge(\n\t\t154 |     local.tags,\n\t\t155 |     {\n\t\t156 |       Name = \"infra1-disk1-${local.application_name}\"\n\t\t157 |     }\n\t\t158 |   )\n\t\t159 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk1\n\tFile: /exchange-server.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"exchange-disk1\" {\n\t\t54 |   depends_on        = [aws_instance.exchange-server]\n\t\t55 |   availability_zone = \"${local.region}a\"\n\t\t56 |   type              = \"gp2\"\n\t\t57 |   encrypted         = true\n\t\t58 | \n\t\t59 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"exchange-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk2\n\tFile: /exchange-server.tf:80-94\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t80 | resource \"aws_ebs_volume\" \"exchange-disk2\" {\n\t\t81 |   depends_on        = [aws_instance.exchange-server]\n\t\t82 |   availability_zone = \"${local.region}a\"\n\t\t83 |   type              = \"gp2\"\n\t\t84 |   encrypted         = true\n\t\t85 | \n\t\t86 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n\t\t87 | \n\t\t88 |   tags = merge(\n\t\t89 |     local.tags,\n\t\t90 |     {\n\t\t91 |       Name = \"exchange-disk2-${local.application_name}\"\n\t\t92 |     }\n\t\t93 |   )\n\t\t94 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.disk_xvdf\n\tFile: /importmachine.tf:91-105\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t91  | resource \"aws_ebs_volume\" \"disk_xvdf\" {\n\t\t92  |   depends_on        = [aws_instance.importmachine]\n\t\t93  |   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n\t\t94  |   availability_zone = \"${local.region}a\"\n\t\t95  |   type              = \"gp2\"\n\t\t96  |   encrypted         = true\n\t\t97  |   size              = 6000\n\t\t98  | \n\t\t99  |   tags = merge(\n\t\t100 |     local.tags,\n\t\t101 |     {\n\t\t102 |       Name = \"importmachine-${local.application_name}-disk\"\n\t\t103 |     }\n\t\t104 |   )\n\t\t105 | }\n\nCheck: CKV_AWS_23: \"Ensure every security groups rule has a description\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-bastion\n\tFile: /network-infrastructure.tf:148-155\n\tGuide: https://docs.bridgecrew.io/docs/networking_31\n\n\t\t148 | resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n\t\t149 |   from_port                = 3389\n\t\t150 |   protocol                 = \"TCP\"\n\t\t151 |   security_group_id        = aws_security_group.sms_server.id\n\t\t152 |   to_port                  = 3389\n\t\t153 |   type                     = \"ingress\"\n\t\t154 |   source_security_group_id = module.bastion_linux.bastion_security_group\n\t\t155 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.prtg_acl\n\tFile: /prtg-load-balancer.tf:139-204\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.waf_acl\n\tFile: /waf-load-balancer.tf:242-307\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\n\ncheckov_exitcode=1\n```\n\n</details>\n\n#### `CTFLint Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nSetting default tflint config...\nRunning tflint --init...\nInstalling `aws` plugin...\nInstalled `aws` (source: github.com/terraform-linters/tflint-ruleset-aws, version: 0.15.0)\ntflint will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning tflint in terraform/environments/xhibit-portal\n17 issue(s) found:\n\nWarning: Module source \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\" is not pinned (terraform_module_pinned_source)\n\n  on /github/workspace/terraform/environments/xhibit-portal/importrole.tf line 3:\n   3:   source = \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_module_pinned_source.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 138:\n 138:       \"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 188:\n 188:     resources = [\"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 98:\n  98:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 232:\n 232:   log_destination_configs = [\"${aws_s3_bucket.prtg_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 251:\n 251:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 290:\n 290:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 315:\n 315:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 322:\n 322:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 202:\n 202:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 350:\n 350:       \"${aws_s3_bucket.loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 400:\n 400:     resources = [\"${aws_s3_bucket.loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 430:\n 430:   log_destination_configs = [\"${aws_s3_bucket.waf_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 449:\n 449:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 488:\n 488:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 513:\n 513:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 520:\n 520:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\ntflint_exitcode=2\n```\n\n</details>\n",
                "#### `TFSEC Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nTFSEC will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning TFSEC in terraform/environments/xhibit-portal\nExcluding the following checks: AWS095\n\nResult #1 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   19  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #2 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:20\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   20  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #3 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:29\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   29  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #4 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:30\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   30  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResults #5-8 CRITICAL Security group rule allows ingress from public internet. (4 similar results)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:26-34\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   18    resource \"aws_security_group_rule\" \"ingestion_lb_allow_web_users\" {\n   ..  \n   26  \u250c   cidr_blocks = [\n   27  \u2502     \"10.182.60.51/32\",  # NLE CGI proxy \n   28  \u2502     \"195.59.75.151/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   29  \u2502     \"195.59.75.152/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   30  \u2502     \"194.33.192.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   31  \u2502     \"194.33.196.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   32  \u2514     \"194.33.248.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  Individual Causes\n  - ingestion-load-balancer.tf:18-38 (aws_security_group_rule.ingestion_lb_allow_web_users) 4 instances\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #9 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #10 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:123\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #11 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:187\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #12 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:188\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #13 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:199\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  191    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv4\" {\n  192      depends_on        = [aws_security_group.sms_server]\n  193      security_group_id = aws_security_group.sms_server.id\n  194      type              = \"egress\"\n  195      description       = \"allow all ipv4\"\n  196      from_port         = 0\n  197      to_port           = 0\n  198      protocol          = \"-1\"\n  199  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  200    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #14 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:210\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  202    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv6\" {\n  203      depends_on        = [aws_security_group.sms_server]\n  204      security_group_id = aws_security_group.sms_server.id\n  205      type              = \"egress\"\n  206      description       = \"allow all ipv6\"\n  207      from_port         = 0\n  208      to_port           = 0\n  209      protocol          = \"-1\"\n  210  [   ipv6_cidr_blocks  = [\"::/0\"]\n  211    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #15 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:276\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #16 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:277\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #17 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:288\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #18 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:289\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #19 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:82\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   73    resource \"aws_lb_listener\" \"prtg_lb_listener\" {\n   ..  \n   82  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n   ..  \n   90    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #20 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:99\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   90    resource \"aws_lb_listener\" \"waf_lb_listener\" {\n   ..  \n   99  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n  ...  \n  107    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #21 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #22 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #23 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #24 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #25 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:57\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50    resource \"aws_elb\" \"ingestion_lb\" {\n   ..  \n   57  [   internal        = false (false)\n   ..  \n   95    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #26 HIGH IAM policy document uses sensitive action 'ec2:DeregisterImage' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:114\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  104    resource \"aws_iam_role\" \"delete_snapshot_lambda\" {\n  ...  \n  114  [       Version = \"2012-10-17\"\n  ...  \n  137    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #27 HIGH IAM policy document uses sensitive action 'ec2:CreateTags' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:22\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_iam_role\" \"snapshot_lambda\" {\n   ..  \n   22  [       Version = \"2012-10-17\"\n   ..  \n   45    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #28 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:12-37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12  \u250c resource \"aws_lb\" \"prtg_lb\" {\n   13  \u2502 \n   14  \u2502   depends_on = [\n   15  \u2502     aws_security_group.prtg_lb,\n   16  \u2502   ]\n   17  \u2502 \n   18  \u2502   name                       = \"prtg-lb-${var.networking[0].application}\"\n   19  \u2502   internal                   = false\n   20  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #29 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_lb\" \"prtg_lb\" {\n   ..  \n   19  [   internal                   = false (false)\n   ..  \n   37    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #30 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #31 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #32 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #33 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #34 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:30-55\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30  \u250c resource \"aws_lb\" \"waf_lb\" {\n   31  \u2502 \n   32  \u2502   depends_on = [\n   33  \u2502     aws_security_group.waf_lb,\n   34  \u2502   ]\n   35  \u2502 \n   36  \u2502   name                       = \"waf-lb-${var.networking[0].application}\"\n   37  \u2502   internal                   = false\n   38  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #35 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #36 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #37 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #38 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #39 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30    resource \"aws_lb\" \"waf_lb\" {\n   ..  \n   37  [   internal                   = false (false)\n   ..  \n   55    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #40 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #41 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #42 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #43 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #44 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #45 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #46 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #47 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #48 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  build-server.tf:46-60\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   46  \u250c resource \"aws_ebs_volume\" \"build-disk1\" {\n   47  \u2502   depends_on        = [aws_instance.build-server]\n   48  \u2502   availability_zone = \"${local.region}a\"\n   49  \u2502   type              = \"gp2\"\n   50  \u2502   encrypted         = true\n   51  \u2502 \n   52  \u2502   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n   53  \u2502 \n   54  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #49 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjim-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjim-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjim-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #50 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjip-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjip-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjip-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #51 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:102-116\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102  \u250c resource \"aws_ebs_volume\" \"database-disk3\" {\n  103  \u2502   depends_on        = [aws_instance.database-server]\n  104  \u2502   availability_zone = \"${local.region}a\"\n  105  \u2502   type              = \"gp2\"\n  106  \u2502   encrypted         = true\n  107  \u2502 \n  108  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n  109  \u2502 \n  110  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #52 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:126-140\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  126  \u250c resource \"aws_ebs_volume\" \"database-disk4\" {\n  127  \u2502   depends_on        = [aws_instance.database-server]\n  128  \u2502   availability_zone = \"${local.region}a\"\n  129  \u2502   type              = \"gp2\"\n  130  \u2502   encrypted         = true\n  131  \u2502 \n  132  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n  133  \u2502 \n  134  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #53 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:150-164\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  150  \u250c resource \"aws_ebs_volume\" \"database-disk5\" {\n  151  \u2502   depends_on        = [aws_instance.database-server]\n  152  \u2502   availability_zone = \"${local.region}a\"\n  153  \u2502   type              = \"gp2\"\n  154  \u2502   encrypted         = true\n  155  \u2502 \n  156  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n  157  \u2502 \n  158  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #54 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:175-191\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  175  \u250c resource \"aws_ebs_volume\" \"database-disk6\" {\n  176  \u2502   depends_on        = [aws_instance.database-server]\n  177  \u2502   availability_zone = \"${local.region}a\"\n  178  \u2502   type              = \"gp2\"\n  179  \u2502   encrypted         = true\n  180  \u2502 \n  181  \u2502   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n  182  \u2502 \n  183  \u2514   size = 300\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #55 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:201-215\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  201  \u250c resource \"aws_ebs_volume\" \"database-disk7\" {\n  202  \u2502   depends_on        = [aws_instance.database-server]\n  203  \u2502   availability_zone = \"${local.region}a\"\n  204  \u2502   type              = \"gp2\"\n  205  \u2502   encrypted         = true\n  206  \u2502 \n  207  \u2502   size = 300\n  208  \u2502 \n  209  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #56 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:50-64\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50  \u250c resource \"aws_ebs_volume\" \"database-disk1\" {\n   51  \u2502   depends_on        = [aws_instance.database-server]\n   52  \u2502   availability_zone = \"${local.region}a\"\n   53  \u2502   type              = \"gp2\"\n   54  \u2502   encrypted         = true\n   55  \u2502 \n   56  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n   57  \u2502 \n   58  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #57 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:77-91\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   77  \u250c resource \"aws_ebs_volume\" \"database-disk2\" {\n   78  \u2502   depends_on        = [aws_instance.database-server]\n   79  \u2502   availability_zone = \"${local.region}a\"\n   80  \u2502   type              = \"gp2\"\n   81  \u2502   encrypted         = true\n   82  \u2502 \n   83  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n   84  \u2502 \n   85  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #58 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  domain-controllers.tf:146-159\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  146  \u250c resource \"aws_ebs_volume\" \"infra1-disk1\" {\n  147  \u2502   availability_zone = \"${local.region}a\"\n  148  \u2502   type              = \"gp2\"\n  149  \u2502   encrypted         = true\n  150  \u2502 \n  151  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n  152  \u2502 \n  153  \u2502   tags = merge(\n  154  \u2514     local.tags,\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #59 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:53-67\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   53  \u250c resource \"aws_ebs_volume\" \"exchange-disk1\" {\n   54  \u2502   depends_on        = [aws_instance.exchange-server]\n   55  \u2502   availability_zone = \"${local.region}a\"\n   56  \u2502   type              = \"gp2\"\n   57  \u2502   encrypted         = true\n   58  \u2502 \n   59  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n   60  \u2502 \n   61  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #60 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:80-94\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   80  \u250c resource \"aws_ebs_volume\" \"exchange-disk2\" {\n   81  \u2502   depends_on        = [aws_instance.exchange-server]\n   82  \u2502   availability_zone = \"${local.region}a\"\n   83  \u2502   type              = \"gp2\"\n   84  \u2502   encrypted         = true\n   85  \u2502 \n   86  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n   87  \u2502 \n   88  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #61 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:91-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   91  \u250c resource \"aws_ebs_volume\" \"disk_xvdf\" {\n   92  \u2502   depends_on        = [aws_instance.importmachine]\n   93  \u2502   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n   94  \u2502   availability_zone = \"${local.region}a\"\n   95  \u2502   type              = \"gp2\"\n   96  \u2502   encrypted         = true\n   97  \u2502   size              = 6000\n   98  \u2502 \n   99  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #62 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #63 LOW Security group rule does not have a description. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:148-155\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  148    resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n  149      from_port                = 3389\n  150      protocol                 = \"TCP\"\n  151      security_group_id        = aws_security_group.sms_server.id\n  152      to_port                  = 3389\n  153      type                     = \"ingress\"\n  154      source_security_group_id = module.bastion_linux.bastion_security_group\n  155    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-add-description-to-security-group-rule\n      Impact Descriptions provide context for the firewall rule reasons\n  Resolution Add descriptions for all security groups rules\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #64 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #65 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #66 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\n  timings\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  disk i/o             1.128526ms\n  parsing              2.581516412s\n  adaptation           7.039773ms\n  checks               46.426838ms\n  total                2.636111549s\n\n  counts\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  modules downloaded   3\n  modules processed    5\n  blocks processed     356\n  files read           43\n\n  results\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  passed               248\n  ignored              58\n  critical             20\n  high                 23\n  medium               4\n  low                  19\n\n  248 passed, 58 ignored, 66 potential problem(s) detected.\n\ntfsec_exitcode=1\n```\n\n</details>\n\n#### `Checkov Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nCheckov will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning Checkov in terraform/environments/xhibit-portal\n2022-08-04 14:43:32,396 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import:None (for external modules, the --download-external-modules flag is required)\n2022-08-04 14:43:32,396 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-bastion-linux?ref=v3.0.4:None (for external modules, the --download-external-modules flag is required)\nterraform scan results:\n\nPassed checks: 400, Failed checks: 45, Skipped checks: 6\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.build-disk1\n\tFile: /build-server.tf:46-60\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t46 | resource \"aws_ebs_volume\" \"build-disk1\" {\n\t\t47 |   depends_on        = [aws_instance.build-server]\n\t\t48 |   availability_zone = \"${local.region}a\"\n\t\t49 |   type              = \"gp2\"\n\t\t50 |   encrypted         = true\n\t\t51 | \n\t\t52 |   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n\t\t53 | \n\t\t54 |   tags = merge(\n\t\t55 |     local.tags,\n\t\t56 |     {\n\t\t57 |       Name = \"build-disk1-${local.application_name}\"\n\t\t58 |     }\n\t\t59 |   )\n\t\t60 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjim-disk1\n\tFile: /cjim-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjim-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjim-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjim-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjip-disk1\n\tFile: /cjip-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjip-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjip-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjip-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-baremetal-disk1\n\tFile: /database-server-baremetal.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"database-baremetal-disk1\" {\n\t\t54 |   count             = local.only_in_production\n\t\t55 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t56 |   availability_zone = \"${local.region}a\"\n\t\t57 |   type              = \"gp2\"\n\t\t58 |   encrypted         = true\n\t\t59 |   size              = 4000\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"database-baremetal-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.app-baremetal-disk2\n\tFile: /database-server-baremetal.tf:98-112\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t98  | resource \"aws_ebs_volume\" \"app-baremetal-disk2\" {\n\t\t99  |   count             = local.only_in_production\n\t\t100 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t101 |   availability_zone = \"${local.region}a\"\n\t\t102 |   type              = \"gp2\"\n\t\t103 |   encrypted         = true\n\t\t104 |   size              = 2000\n\t\t105 | \n\t\t106 |   tags = merge(\n\t\t107 |     local.tags,\n\t\t108 |     {\n\t\t109 |       Name = \"app-baremetal-disk2-${local.application_name}\"\n\t\t110 |     }\n\t\t111 |   )\n\t\t112 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk1\n\tFile: /database-server.tf:50-64\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t50 | resource \"aws_ebs_volume\" \"database-disk1\" {\n\t\t51 |   depends_on        = [aws_instance.database-server]\n\t\t52 |   availability_zone = \"${local.region}a\"\n\t\t53 |   type              = \"gp2\"\n\t\t54 |   encrypted         = true\n\t\t55 | \n\t\t56 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n\t\t57 | \n\t\t58 |   tags = merge(\n\t\t59 |     local.tags,\n\t\t60 |     {\n\t\t61 |       Name = \"database-disk1-${local.application_name}\"\n\t\t62 |     }\n\t\t63 |   )\n\t\t64 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk2\n\tFile: /database-server.tf:77-91\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t77 | resource \"aws_ebs_volume\" \"database-disk2\" {\n\t\t78 |   depends_on        = [aws_instance.database-server]\n\t\t79 |   availability_zone = \"${local.region}a\"\n\t\t80 |   type              = \"gp2\"\n\t\t81 |   encrypted         = true\n\t\t82 | \n\t\t83 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n\t\t84 | \n\t\t85 |   tags = merge(\n\t\t86 |     local.tags,\n\t\t87 |     {\n\t\t88 |       Name = \"database-disk2-${local.application_name}\"\n\t\t89 |     }\n\t\t90 |   )\n\t\t91 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk3\n\tFile: /database-server.tf:102-116\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t102 | resource \"aws_ebs_volume\" \"database-disk3\" {\n\t\t103 |   depends_on        = [aws_instance.database-server]\n\t\t104 |   availability_zone = \"${local.region}a\"\n\t\t105 |   type              = \"gp2\"\n\t\t106 |   encrypted         = true\n\t\t107 | \n\t\t108 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n\t\t109 | \n\t\t110 |   tags = merge(\n\t\t111 |     local.tags,\n\t\t112 |     {\n\t\t113 |       Name = \"database-disk3-${local.application_name}\"\n\t\t114 |     }\n\t\t115 |   )\n\t\t116 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk4\n\tFile: /database-server.tf:126-140\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t126 | resource \"aws_ebs_volume\" \"database-disk4\" {\n\t\t127 |   depends_on        = [aws_instance.database-server]\n\t\t128 |   availability_zone = \"${local.region}a\"\n\t\t129 |   type              = \"gp2\"\n\t\t130 |   encrypted         = true\n\t\t131 | \n\t\t132 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n\t\t133 | \n\t\t134 |   tags = merge(\n\t\t135 |     local.tags,\n\t\t136 |     {\n\t\t137 |       Name = \"database-disk4-${local.application_name}\"\n\t\t138 |     }\n\t\t139 |   )\n\t\t140 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk5\n\tFile: /database-server.tf:150-164\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t150 | resource \"aws_ebs_volume\" \"database-disk5\" {\n\t\t151 |   depends_on        = [aws_instance.database-server]\n\t\t152 |   availability_zone = \"${local.region}a\"\n\t\t153 |   type              = \"gp2\"\n\t\t154 |   encrypted         = true\n\t\t155 | \n\t\t156 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n\t\t157 | \n\t\t158 |   tags = merge(\n\t\t159 |     local.tags,\n\t\t160 |     {\n\t\t161 |       Name = \"database-disk5-${local.application_name}\"\n\t\t162 |     }\n\t\t163 |   )\n\t\t164 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk6\n\tFile: /database-server.tf:175-191\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t175 | resource \"aws_ebs_volume\" \"database-disk6\" {\n\t\t176 |   depends_on        = [aws_instance.database-server]\n\t\t177 |   availability_zone = \"${local.region}a\"\n\t\t178 |   type              = \"gp2\"\n\t\t179 |   encrypted         = true\n\t\t180 | \n\t\t181 |   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n\t\t182 | \n\t\t183 |   size = 300\n\t\t184 | \n\t\t185 |   tags = merge(\n\t\t186 |     local.tags,\n\t\t187 |     {\n\t\t188 |       Name = \"database-disk6-${local.application_name}\"\n\t\t189 |     }\n\t\t190 |   )\n\t\t191 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk7\n\tFile: /database-server.tf:201-215\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t201 | resource \"aws_ebs_volume\" \"database-disk7\" {\n\t\t202 |   depends_on        = [aws_instance.database-server]\n\t\t203 |   availability_zone = \"${local.region}a\"\n\t\t204 |   type              = \"gp2\"\n\t\t205 |   encrypted         = true\n\t\t206 | \n\t\t207 |   size = 300\n\t\t208 | \n\t\t209 |   tags = merge(\n\t\t210 |     local.tags,\n\t\t211 |     {\n\t\t212 |       Name = \"database-disk7-${local.application_name}\"\n\t\t213 |     }\n\t\t214 |   )\n\t\t215 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.infra1-disk1\n\tFile: /domain-controllers.tf:146-159\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t146 | resource \"aws_ebs_volume\" \"infra1-disk1\" {\n\t\t147 |   availability_zone = \"${local.region}a\"\n\t\t148 |   type              = \"gp2\"\n\t\t149 |   encrypted         = true\n\t\t150 | \n\t\t151 |   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n\t\t152 | \n\t\t153 |   tags = merge(\n\t\t154 |     local.tags,\n\t\t155 |     {\n\t\t156 |       Name = \"infra1-disk1-${local.application_name}\"\n\t\t157 |     }\n\t\t158 |   )\n\t\t159 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk1\n\tFile: /exchange-server.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"exchange-disk1\" {\n\t\t54 |   depends_on        = [aws_instance.exchange-server]\n\t\t55 |   availability_zone = \"${local.region}a\"\n\t\t56 |   type              = \"gp2\"\n\t\t57 |   encrypted         = true\n\t\t58 | \n\t\t59 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"exchange-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk2\n\tFile: /exchange-server.tf:80-94\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t80 | resource \"aws_ebs_volume\" \"exchange-disk2\" {\n\t\t81 |   depends_on        = [aws_instance.exchange-server]\n\t\t82 |   availability_zone = \"${local.region}a\"\n\t\t83 |   type              = \"gp2\"\n\t\t84 |   encrypted         = true\n\t\t85 | \n\t\t86 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n\t\t87 | \n\t\t88 |   tags = merge(\n\t\t89 |     local.tags,\n\t\t90 |     {\n\t\t91 |       Name = \"exchange-disk2-${local.application_name}\"\n\t\t92 |     }\n\t\t93 |   )\n\t\t94 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.disk_xvdf\n\tFile: /importmachine.tf:91-105\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t91  | resource \"aws_ebs_volume\" \"disk_xvdf\" {\n\t\t92  |   depends_on        = [aws_instance.importmachine]\n\t\t93  |   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n\t\t94  |   availability_zone = \"${local.region}a\"\n\t\t95  |   type              = \"gp2\"\n\t\t96  |   encrypted         = true\n\t\t97  |   size              = 6000\n\t\t98  | \n\t\t99  |   tags = merge(\n\t\t100 |     local.tags,\n\t\t101 |     {\n\t\t102 |       Name = \"importmachine-${local.application_name}-disk\"\n\t\t103 |     }\n\t\t104 |   )\n\t\t105 | }\n\nCheck: CKV_AWS_23: \"Ensure every security groups rule has a description\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-bastion\n\tFile: /network-infrastructure.tf:148-155\n\tGuide: https://docs.bridgecrew.io/docs/networking_31\n\n\t\t148 | resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n\t\t149 |   from_port                = 3389\n\t\t150 |   protocol                 = \"TCP\"\n\t\t151 |   security_group_id        = aws_security_group.sms_server.id\n\t\t152 |   to_port                  = 3389\n\t\t153 |   type                     = \"ingress\"\n\t\t154 |   source_security_group_id = module.bastion_linux.bastion_security_group\n\t\t155 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.prtg_acl\n\tFile: /prtg-load-balancer.tf:139-204\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.waf_acl\n\tFile: /waf-load-balancer.tf:242-307\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\n\ncheckov_exitcode=1\n```\n\n</details>\n\n#### `CTFLint Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nSetting default tflint config...\nRunning tflint --init...\nInstalling `aws` plugin...\nInstalled `aws` (source: github.com/terraform-linters/tflint-ruleset-aws, version: 0.15.0)\ntflint will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning tflint in terraform/environments/xhibit-portal\n17 issue(s) found:\n\nWarning: Module source \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\" is not pinned (terraform_module_pinned_source)\n\n  on /github/workspace/terraform/environments/xhibit-portal/importrole.tf line 3:\n   3:   source = \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_module_pinned_source.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 138:\n 138:       \"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 188:\n 188:     resources = [\"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 98:\n  98:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 232:\n 232:   log_destination_configs = [\"${aws_s3_bucket.prtg_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 251:\n 251:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 290:\n 290:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 315:\n 315:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 322:\n 322:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 202:\n 202:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 350:\n 350:       \"${aws_s3_bucket.loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 400:\n 400:     resources = [\"${aws_s3_bucket.loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 430:\n 430:   log_destination_configs = [\"${aws_s3_bucket.waf_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 449:\n 449:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 488:\n 488:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 513:\n 513:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 520:\n 520:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\ntflint_exitcode=2\n```\n\n</details>\n",
                "#### `TFSEC Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nTFSEC will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning TFSEC in terraform/environments/xhibit-portal\nExcluding the following checks: AWS095\n\nResult #1 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   19  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #2 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:20\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   20  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #3 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:29\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   29  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #4 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:30\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   30  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResults #5-8 CRITICAL Security group rule allows ingress from public internet. (4 similar results)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:26-34\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   18    resource \"aws_security_group_rule\" \"ingestion_lb_allow_web_users\" {\n   ..  \n   26  \u250c   cidr_blocks = [\n   27  \u2502     \"10.182.60.51/32\",  # NLE CGI proxy \n   28  \u2502     \"195.59.75.151/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   29  \u2502     \"195.59.75.152/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   30  \u2502     \"194.33.192.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   31  \u2502     \"194.33.196.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   32  \u2514     \"194.33.248.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  Individual Causes\n  - ingestion-load-balancer.tf:18-38 (aws_security_group_rule.ingestion_lb_allow_web_users) 4 instances\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #9 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #10 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:123\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #11 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:187\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #12 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:188\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #13 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:199\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  191    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv4\" {\n  192      depends_on        = [aws_security_group.sms_server]\n  193      security_group_id = aws_security_group.sms_server.id\n  194      type              = \"egress\"\n  195      description       = \"allow all ipv4\"\n  196      from_port         = 0\n  197      to_port           = 0\n  198      protocol          = \"-1\"\n  199  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  200    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #14 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:210\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  202    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv6\" {\n  203      depends_on        = [aws_security_group.sms_server]\n  204      security_group_id = aws_security_group.sms_server.id\n  205      type              = \"egress\"\n  206      description       = \"allow all ipv6\"\n  207      from_port         = 0\n  208      to_port           = 0\n  209      protocol          = \"-1\"\n  210  [   ipv6_cidr_blocks  = [\"::/0\"]\n  211    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #15 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:276\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #16 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:277\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #17 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:288\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #18 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:289\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #19 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:82\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   73    resource \"aws_lb_listener\" \"prtg_lb_listener\" {\n   ..  \n   82  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n   ..  \n   90    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #20 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:99\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   90    resource \"aws_lb_listener\" \"waf_lb_listener\" {\n   ..  \n   99  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n  ...  \n  107    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #21 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #22 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #23 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #24 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #25 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:57\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50    resource \"aws_elb\" \"ingestion_lb\" {\n   ..  \n   57  [   internal        = false (false)\n   ..  \n   95    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #26 HIGH IAM policy document uses sensitive action 'ec2:DeregisterImage' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:114\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  104    resource \"aws_iam_role\" \"delete_snapshot_lambda\" {\n  ...  \n  114  [       Version = \"2012-10-17\"\n  ...  \n  137    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #27 HIGH IAM policy document uses sensitive action 'ec2:CreateTags' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:22\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_iam_role\" \"snapshot_lambda\" {\n   ..  \n   22  [       Version = \"2012-10-17\"\n   ..  \n   45    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #28 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:12-37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12  \u250c resource \"aws_lb\" \"prtg_lb\" {\n   13  \u2502 \n   14  \u2502   depends_on = [\n   15  \u2502     aws_security_group.prtg_lb,\n   16  \u2502   ]\n   17  \u2502 \n   18  \u2502   name                       = \"prtg-lb-${var.networking[0].application}\"\n   19  \u2502   internal                   = false\n   20  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #29 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_lb\" \"prtg_lb\" {\n   ..  \n   19  [   internal                   = false (false)\n   ..  \n   37    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #30 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #31 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #32 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #33 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #34 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:30-55\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30  \u250c resource \"aws_lb\" \"waf_lb\" {\n   31  \u2502 \n   32  \u2502   depends_on = [\n   33  \u2502     aws_security_group.waf_lb,\n   34  \u2502   ]\n   35  \u2502 \n   36  \u2502   name                       = \"waf-lb-${var.networking[0].application}\"\n   37  \u2502   internal                   = false\n   38  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #35 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #36 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #37 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #38 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #39 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30    resource \"aws_lb\" \"waf_lb\" {\n   ..  \n   37  [   internal                   = false (false)\n   ..  \n   55    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #40 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #41 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #42 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #43 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #44 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #45 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #46 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #47 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #48 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  build-server.tf:46-60\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   46  \u250c resource \"aws_ebs_volume\" \"build-disk1\" {\n   47  \u2502   depends_on        = [aws_instance.build-server]\n   48  \u2502   availability_zone = \"${local.region}a\"\n   49  \u2502   type              = \"gp2\"\n   50  \u2502   encrypted         = true\n   51  \u2502 \n   52  \u2502   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n   53  \u2502 \n   54  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #49 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjim-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjim-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjim-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #50 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjip-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjip-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjip-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #51 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:102-116\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102  \u250c resource \"aws_ebs_volume\" \"database-disk3\" {\n  103  \u2502   depends_on        = [aws_instance.database-server]\n  104  \u2502   availability_zone = \"${local.region}a\"\n  105  \u2502   type              = \"gp2\"\n  106  \u2502   encrypted         = true\n  107  \u2502 \n  108  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n  109  \u2502 \n  110  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #52 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:126-140\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  126  \u250c resource \"aws_ebs_volume\" \"database-disk4\" {\n  127  \u2502   depends_on        = [aws_instance.database-server]\n  128  \u2502   availability_zone = \"${local.region}a\"\n  129  \u2502   type              = \"gp2\"\n  130  \u2502   encrypted         = true\n  131  \u2502 \n  132  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n  133  \u2502 \n  134  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #53 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:150-164\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  150  \u250c resource \"aws_ebs_volume\" \"database-disk5\" {\n  151  \u2502   depends_on        = [aws_instance.database-server]\n  152  \u2502   availability_zone = \"${local.region}a\"\n  153  \u2502   type              = \"gp2\"\n  154  \u2502   encrypted         = true\n  155  \u2502 \n  156  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n  157  \u2502 \n  158  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #54 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:175-191\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  175  \u250c resource \"aws_ebs_volume\" \"database-disk6\" {\n  176  \u2502   depends_on        = [aws_instance.database-server]\n  177  \u2502   availability_zone = \"${local.region}a\"\n  178  \u2502   type              = \"gp2\"\n  179  \u2502   encrypted         = true\n  180  \u2502 \n  181  \u2502   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n  182  \u2502 \n  183  \u2514   size = 300\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #55 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:201-215\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  201  \u250c resource \"aws_ebs_volume\" \"database-disk7\" {\n  202  \u2502   depends_on        = [aws_instance.database-server]\n  203  \u2502   availability_zone = \"${local.region}a\"\n  204  \u2502   type              = \"gp2\"\n  205  \u2502   encrypted         = true\n  206  \u2502 \n  207  \u2502   size = 300\n  208  \u2502 \n  209  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #56 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:50-64\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50  \u250c resource \"aws_ebs_volume\" \"database-disk1\" {\n   51  \u2502   depends_on        = [aws_instance.database-server]\n   52  \u2502   availability_zone = \"${local.region}a\"\n   53  \u2502   type              = \"gp2\"\n   54  \u2502   encrypted         = true\n   55  \u2502 \n   56  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n   57  \u2502 \n   58  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #57 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:77-91\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   77  \u250c resource \"aws_ebs_volume\" \"database-disk2\" {\n   78  \u2502   depends_on        = [aws_instance.database-server]\n   79  \u2502   availability_zone = \"${local.region}a\"\n   80  \u2502   type              = \"gp2\"\n   81  \u2502   encrypted         = true\n   82  \u2502 \n   83  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n   84  \u2502 \n   85  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #58 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  domain-controllers.tf:146-159\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  146  \u250c resource \"aws_ebs_volume\" \"infra1-disk1\" {\n  147  \u2502   availability_zone = \"${local.region}a\"\n  148  \u2502   type              = \"gp2\"\n  149  \u2502   encrypted         = true\n  150  \u2502 \n  151  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n  152  \u2502 \n  153  \u2502   tags = merge(\n  154  \u2514     local.tags,\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #59 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:53-67\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   53  \u250c resource \"aws_ebs_volume\" \"exchange-disk1\" {\n   54  \u2502   depends_on        = [aws_instance.exchange-server]\n   55  \u2502   availability_zone = \"${local.region}a\"\n   56  \u2502   type              = \"gp2\"\n   57  \u2502   encrypted         = true\n   58  \u2502 \n   59  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n   60  \u2502 \n   61  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #60 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:80-94\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   80  \u250c resource \"aws_ebs_volume\" \"exchange-disk2\" {\n   81  \u2502   depends_on        = [aws_instance.exchange-server]\n   82  \u2502   availability_zone = \"${local.region}a\"\n   83  \u2502   type              = \"gp2\"\n   84  \u2502   encrypted         = true\n   85  \u2502 \n   86  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n   87  \u2502 \n   88  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #61 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:91-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   91  \u250c resource \"aws_ebs_volume\" \"disk_xvdf\" {\n   92  \u2502   depends_on        = [aws_instance.importmachine]\n   93  \u2502   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n   94  \u2502   availability_zone = \"${local.region}a\"\n   95  \u2502   type              = \"gp2\"\n   96  \u2502   encrypted         = true\n   97  \u2502   size              = 6000\n   98  \u2502 \n   99  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #62 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #63 LOW Security group rule does not have a description. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:148-155\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  148    resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n  149      from_port                = 3389\n  150      protocol                 = \"TCP\"\n  151      security_group_id        = aws_security_group.sms_server.id\n  152      to_port                  = 3389\n  153      type                     = \"ingress\"\n  154      source_security_group_id = module.bastion_linux.bastion_security_group\n  155    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-add-description-to-security-group-rule\n      Impact Descriptions provide context for the firewall rule reasons\n  Resolution Add descriptions for all security groups rules\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #64 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #65 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #66 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\n  timings\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  disk i/o             1.100514ms\n  parsing              2.193758839s\n  adaptation           6.432183ms\n  checks               49.554641ms\n  total                2.250846177s\n\n  counts\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  modules downloaded   3\n  modules processed    5\n  blocks processed     356\n  files read           43\n\n  results\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  passed               248\n  ignored              58\n  critical             20\n  high                 23\n  medium               4\n  low                  19\n\n  248 passed, 58 ignored, 66 potential problem(s) detected.\n\ntfsec_exitcode=1\n```\n\n</details>\n\n#### `Checkov Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nCheckov will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning Checkov in terraform/environments/xhibit-portal\n2022-08-04 14:51:35,743 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import:None (for external modules, the --download-external-modules flag is required)\n2022-08-04 14:51:35,744 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-bastion-linux?ref=v3.0.4:None (for external modules, the --download-external-modules flag is required)\nterraform scan results:\n\nPassed checks: 400, Failed checks: 45, Skipped checks: 6\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.build-disk1\n\tFile: /build-server.tf:46-60\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t46 | resource \"aws_ebs_volume\" \"build-disk1\" {\n\t\t47 |   depends_on        = [aws_instance.build-server]\n\t\t48 |   availability_zone = \"${local.region}a\"\n\t\t49 |   type              = \"gp2\"\n\t\t50 |   encrypted         = true\n\t\t51 | \n\t\t52 |   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n\t\t53 | \n\t\t54 |   tags = merge(\n\t\t55 |     local.tags,\n\t\t56 |     {\n\t\t57 |       Name = \"build-disk1-${local.application_name}\"\n\t\t58 |     }\n\t\t59 |   )\n\t\t60 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjim-disk1\n\tFile: /cjim-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjim-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjim-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjim-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjip-disk1\n\tFile: /cjip-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjip-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjip-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjip-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-baremetal-disk1\n\tFile: /database-server-baremetal.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"database-baremetal-disk1\" {\n\t\t54 |   count             = local.only_in_production\n\t\t55 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t56 |   availability_zone = \"${local.region}a\"\n\t\t57 |   type              = \"gp2\"\n\t\t58 |   encrypted         = true\n\t\t59 |   size              = 4000\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"database-baremetal-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.app-baremetal-disk2\n\tFile: /database-server-baremetal.tf:98-112\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t98  | resource \"aws_ebs_volume\" \"app-baremetal-disk2\" {\n\t\t99  |   count             = local.only_in_production\n\t\t100 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t101 |   availability_zone = \"${local.region}a\"\n\t\t102 |   type              = \"gp2\"\n\t\t103 |   encrypted         = true\n\t\t104 |   size              = 2000\n\t\t105 | \n\t\t106 |   tags = merge(\n\t\t107 |     local.tags,\n\t\t108 |     {\n\t\t109 |       Name = \"app-baremetal-disk2-${local.application_name}\"\n\t\t110 |     }\n\t\t111 |   )\n\t\t112 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk1\n\tFile: /database-server.tf:50-64\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t50 | resource \"aws_ebs_volume\" \"database-disk1\" {\n\t\t51 |   depends_on        = [aws_instance.database-server]\n\t\t52 |   availability_zone = \"${local.region}a\"\n\t\t53 |   type              = \"gp2\"\n\t\t54 |   encrypted         = true\n\t\t55 | \n\t\t56 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n\t\t57 | \n\t\t58 |   tags = merge(\n\t\t59 |     local.tags,\n\t\t60 |     {\n\t\t61 |       Name = \"database-disk1-${local.application_name}\"\n\t\t62 |     }\n\t\t63 |   )\n\t\t64 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk2\n\tFile: /database-server.tf:77-91\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t77 | resource \"aws_ebs_volume\" \"database-disk2\" {\n\t\t78 |   depends_on        = [aws_instance.database-server]\n\t\t79 |   availability_zone = \"${local.region}a\"\n\t\t80 |   type              = \"gp2\"\n\t\t81 |   encrypted         = true\n\t\t82 | \n\t\t83 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n\t\t84 | \n\t\t85 |   tags = merge(\n\t\t86 |     local.tags,\n\t\t87 |     {\n\t\t88 |       Name = \"database-disk2-${local.application_name}\"\n\t\t89 |     }\n\t\t90 |   )\n\t\t91 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk3\n\tFile: /database-server.tf:102-116\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t102 | resource \"aws_ebs_volume\" \"database-disk3\" {\n\t\t103 |   depends_on        = [aws_instance.database-server]\n\t\t104 |   availability_zone = \"${local.region}a\"\n\t\t105 |   type              = \"gp2\"\n\t\t106 |   encrypted         = true\n\t\t107 | \n\t\t108 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n\t\t109 | \n\t\t110 |   tags = merge(\n\t\t111 |     local.tags,\n\t\t112 |     {\n\t\t113 |       Name = \"database-disk3-${local.application_name}\"\n\t\t114 |     }\n\t\t115 |   )\n\t\t116 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk4\n\tFile: /database-server.tf:126-140\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t126 | resource \"aws_ebs_volume\" \"database-disk4\" {\n\t\t127 |   depends_on        = [aws_instance.database-server]\n\t\t128 |   availability_zone = \"${local.region}a\"\n\t\t129 |   type              = \"gp2\"\n\t\t130 |   encrypted         = true\n\t\t131 | \n\t\t132 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n\t\t133 | \n\t\t134 |   tags = merge(\n\t\t135 |     local.tags,\n\t\t136 |     {\n\t\t137 |       Name = \"database-disk4-${local.application_name}\"\n\t\t138 |     }\n\t\t139 |   )\n\t\t140 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk5\n\tFile: /database-server.tf:150-164\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t150 | resource \"aws_ebs_volume\" \"database-disk5\" {\n\t\t151 |   depends_on        = [aws_instance.database-server]\n\t\t152 |   availability_zone = \"${local.region}a\"\n\t\t153 |   type              = \"gp2\"\n\t\t154 |   encrypted         = true\n\t\t155 | \n\t\t156 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n\t\t157 | \n\t\t158 |   tags = merge(\n\t\t159 |     local.tags,\n\t\t160 |     {\n\t\t161 |       Name = \"database-disk5-${local.application_name}\"\n\t\t162 |     }\n\t\t163 |   )\n\t\t164 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk6\n\tFile: /database-server.tf:175-191\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t175 | resource \"aws_ebs_volume\" \"database-disk6\" {\n\t\t176 |   depends_on        = [aws_instance.database-server]\n\t\t177 |   availability_zone = \"${local.region}a\"\n\t\t178 |   type              = \"gp2\"\n\t\t179 |   encrypted         = true\n\t\t180 | \n\t\t181 |   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n\t\t182 | \n\t\t183 |   size = 300\n\t\t184 | \n\t\t185 |   tags = merge(\n\t\t186 |     local.tags,\n\t\t187 |     {\n\t\t188 |       Name = \"database-disk6-${local.application_name}\"\n\t\t189 |     }\n\t\t190 |   )\n\t\t191 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk7\n\tFile: /database-server.tf:201-215\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t201 | resource \"aws_ebs_volume\" \"database-disk7\" {\n\t\t202 |   depends_on        = [aws_instance.database-server]\n\t\t203 |   availability_zone = \"${local.region}a\"\n\t\t204 |   type              = \"gp2\"\n\t\t205 |   encrypted         = true\n\t\t206 | \n\t\t207 |   size = 300\n\t\t208 | \n\t\t209 |   tags = merge(\n\t\t210 |     local.tags,\n\t\t211 |     {\n\t\t212 |       Name = \"database-disk7-${local.application_name}\"\n\t\t213 |     }\n\t\t214 |   )\n\t\t215 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.infra1-disk1\n\tFile: /domain-controllers.tf:146-159\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t146 | resource \"aws_ebs_volume\" \"infra1-disk1\" {\n\t\t147 |   availability_zone = \"${local.region}a\"\n\t\t148 |   type              = \"gp2\"\n\t\t149 |   encrypted         = true\n\t\t150 | \n\t\t151 |   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n\t\t152 | \n\t\t153 |   tags = merge(\n\t\t154 |     local.tags,\n\t\t155 |     {\n\t\t156 |       Name = \"infra1-disk1-${local.application_name}\"\n\t\t157 |     }\n\t\t158 |   )\n\t\t159 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk1\n\tFile: /exchange-server.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"exchange-disk1\" {\n\t\t54 |   depends_on        = [aws_instance.exchange-server]\n\t\t55 |   availability_zone = \"${local.region}a\"\n\t\t56 |   type              = \"gp2\"\n\t\t57 |   encrypted         = true\n\t\t58 | \n\t\t59 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"exchange-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk2\n\tFile: /exchange-server.tf:80-94\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t80 | resource \"aws_ebs_volume\" \"exchange-disk2\" {\n\t\t81 |   depends_on        = [aws_instance.exchange-server]\n\t\t82 |   availability_zone = \"${local.region}a\"\n\t\t83 |   type              = \"gp2\"\n\t\t84 |   encrypted         = true\n\t\t85 | \n\t\t86 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n\t\t87 | \n\t\t88 |   tags = merge(\n\t\t89 |     local.tags,\n\t\t90 |     {\n\t\t91 |       Name = \"exchange-disk2-${local.application_name}\"\n\t\t92 |     }\n\t\t93 |   )\n\t\t94 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.disk_xvdf\n\tFile: /importmachine.tf:91-105\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t91  | resource \"aws_ebs_volume\" \"disk_xvdf\" {\n\t\t92  |   depends_on        = [aws_instance.importmachine]\n\t\t93  |   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n\t\t94  |   availability_zone = \"${local.region}a\"\n\t\t95  |   type              = \"gp2\"\n\t\t96  |   encrypted         = true\n\t\t97  |   size              = 6000\n\t\t98  | \n\t\t99  |   tags = merge(\n\t\t100 |     local.tags,\n\t\t101 |     {\n\t\t102 |       Name = \"importmachine-${local.application_name}-disk\"\n\t\t103 |     }\n\t\t104 |   )\n\t\t105 | }\n\nCheck: CKV_AWS_23: \"Ensure every security groups rule has a description\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-bastion\n\tFile: /network-infrastructure.tf:148-155\n\tGuide: https://docs.bridgecrew.io/docs/networking_31\n\n\t\t148 | resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n\t\t149 |   from_port                = 3389\n\t\t150 |   protocol                 = \"TCP\"\n\t\t151 |   security_group_id        = aws_security_group.sms_server.id\n\t\t152 |   to_port                  = 3389\n\t\t153 |   type                     = \"ingress\"\n\t\t154 |   source_security_group_id = module.bastion_linux.bastion_security_group\n\t\t155 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.prtg_acl\n\tFile: /prtg-load-balancer.tf:139-204\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.waf_acl\n\tFile: /waf-load-balancer.tf:242-307\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\n\ncheckov_exitcode=1\n```\n\n</details>\n\n#### `CTFLint Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nSetting default tflint config...\nRunning tflint --init...\nInstalling `aws` plugin...\nInstalled `aws` (source: github.com/terraform-linters/tflint-ruleset-aws, version: 0.15.0)\ntflint will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning tflint in terraform/environments/xhibit-portal\n17 issue(s) found:\n\nWarning: Module source \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\" is not pinned (terraform_module_pinned_source)\n\n  on /github/workspace/terraform/environments/xhibit-portal/importrole.tf line 3:\n   3:   source = \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_module_pinned_source.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 138:\n 138:       \"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 188:\n 188:     resources = [\"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 98:\n  98:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 232:\n 232:   log_destination_configs = [\"${aws_s3_bucket.prtg_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 251:\n 251:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 290:\n 290:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 315:\n 315:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 322:\n 322:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 202:\n 202:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 350:\n 350:       \"${aws_s3_bucket.loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 400:\n 400:     resources = [\"${aws_s3_bucket.loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 430:\n 430:   log_destination_configs = [\"${aws_s3_bucket.waf_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 449:\n 449:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 488:\n 488:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 513:\n 513:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 520:\n 520:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\ntflint_exitcode=2\n```\n\n</details>\n",
                "#### `TFSEC Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nTFSEC will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning TFSEC in terraform/environments/xhibit-portal\nExcluding the following checks: AWS095\n\nResult #1 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   19  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #2 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:20\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   20  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #3 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:29\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   29  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #4 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:30\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   30  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResults #5-8 CRITICAL Security group rule allows ingress from public internet. (4 similar results)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:26-34\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   18    resource \"aws_security_group_rule\" \"ingestion_lb_allow_web_users\" {\n   ..  \n   26  \u250c   cidr_blocks = [\n   27  \u2502     \"10.182.60.51/32\",  # NLE CGI proxy \n   28  \u2502     \"195.59.75.151/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   29  \u2502     \"195.59.75.152/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   30  \u2502     \"194.33.192.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   31  \u2502     \"194.33.196.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   32  \u2514     \"194.33.248.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  Individual Causes\n  - ingestion-load-balancer.tf:18-38 (aws_security_group_rule.ingestion_lb_allow_web_users) 4 instances\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #9 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #10 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:123\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #11 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:187\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #12 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:188\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #13 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:199\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  191    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv4\" {\n  192      depends_on        = [aws_security_group.sms_server]\n  193      security_group_id = aws_security_group.sms_server.id\n  194      type              = \"egress\"\n  195      description       = \"allow all ipv4\"\n  196      from_port         = 0\n  197      to_port           = 0\n  198      protocol          = \"-1\"\n  199  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  200    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #14 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:210\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  202    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv6\" {\n  203      depends_on        = [aws_security_group.sms_server]\n  204      security_group_id = aws_security_group.sms_server.id\n  205      type              = \"egress\"\n  206      description       = \"allow all ipv6\"\n  207      from_port         = 0\n  208      to_port           = 0\n  209      protocol          = \"-1\"\n  210  [   ipv6_cidr_blocks  = [\"::/0\"]\n  211    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #15 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:276\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #16 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:277\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #17 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:288\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #18 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:289\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #19 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:82\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   73    resource \"aws_lb_listener\" \"prtg_lb_listener\" {\n   ..  \n   82  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n   ..  \n   90    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #20 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:99\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   90    resource \"aws_lb_listener\" \"waf_lb_listener\" {\n   ..  \n   99  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n  ...  \n  107    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #21 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #22 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #23 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #24 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #25 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:57\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50    resource \"aws_elb\" \"ingestion_lb\" {\n   ..  \n   57  [   internal        = false (false)\n   ..  \n   95    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #26 HIGH IAM policy document uses sensitive action 'ec2:DeregisterImage' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:114\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  104    resource \"aws_iam_role\" \"delete_snapshot_lambda\" {\n  ...  \n  114  [       Version = \"2012-10-17\"\n  ...  \n  137    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #27 HIGH IAM policy document uses sensitive action 'ec2:CreateTags' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:22\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_iam_role\" \"snapshot_lambda\" {\n   ..  \n   22  [       Version = \"2012-10-17\"\n   ..  \n   45    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #28 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:12-37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12  \u250c resource \"aws_lb\" \"prtg_lb\" {\n   13  \u2502 \n   14  \u2502   depends_on = [\n   15  \u2502     aws_security_group.prtg_lb,\n   16  \u2502   ]\n   17  \u2502 \n   18  \u2502   name                       = \"prtg-lb-${var.networking[0].application}\"\n   19  \u2502   internal                   = false\n   20  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #29 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_lb\" \"prtg_lb\" {\n   ..  \n   19  [   internal                   = false (false)\n   ..  \n   37    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #30 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #31 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #32 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #33 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #34 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:30-55\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30  \u250c resource \"aws_lb\" \"waf_lb\" {\n   31  \u2502 \n   32  \u2502   depends_on = [\n   33  \u2502     aws_security_group.waf_lb,\n   34  \u2502   ]\n   35  \u2502 \n   36  \u2502   name                       = \"waf-lb-${var.networking[0].application}\"\n   37  \u2502   internal                   = false\n   38  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #35 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #36 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #37 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #38 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #39 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30    resource \"aws_lb\" \"waf_lb\" {\n   ..  \n   37  [   internal                   = false (false)\n   ..  \n   55    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #40 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #41 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #42 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #43 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #44 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #45 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #46 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #47 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #48 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  build-server.tf:46-60\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   46  \u250c resource \"aws_ebs_volume\" \"build-disk1\" {\n   47  \u2502   depends_on        = [aws_instance.build-server]\n   48  \u2502   availability_zone = \"${local.region}a\"\n   49  \u2502   type              = \"gp2\"\n   50  \u2502   encrypted         = true\n   51  \u2502 \n   52  \u2502   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n   53  \u2502 \n   54  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #49 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjim-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjim-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjim-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #50 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjip-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjip-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjip-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #51 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:102-116\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102  \u250c resource \"aws_ebs_volume\" \"database-disk3\" {\n  103  \u2502   depends_on        = [aws_instance.database-server]\n  104  \u2502   availability_zone = \"${local.region}a\"\n  105  \u2502   type              = \"gp2\"\n  106  \u2502   encrypted         = true\n  107  \u2502 \n  108  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n  109  \u2502 \n  110  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #52 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:126-140\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  126  \u250c resource \"aws_ebs_volume\" \"database-disk4\" {\n  127  \u2502   depends_on        = [aws_instance.database-server]\n  128  \u2502   availability_zone = \"${local.region}a\"\n  129  \u2502   type              = \"gp2\"\n  130  \u2502   encrypted         = true\n  131  \u2502 \n  132  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n  133  \u2502 \n  134  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #53 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:150-164\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  150  \u250c resource \"aws_ebs_volume\" \"database-disk5\" {\n  151  \u2502   depends_on        = [aws_instance.database-server]\n  152  \u2502   availability_zone = \"${local.region}a\"\n  153  \u2502   type              = \"gp2\"\n  154  \u2502   encrypted         = true\n  155  \u2502 \n  156  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n  157  \u2502 \n  158  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #54 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:175-191\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  175  \u250c resource \"aws_ebs_volume\" \"database-disk6\" {\n  176  \u2502   depends_on        = [aws_instance.database-server]\n  177  \u2502   availability_zone = \"${local.region}a\"\n  178  \u2502   type              = \"gp2\"\n  179  \u2502   encrypted         = true\n  180  \u2502 \n  181  \u2502   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n  182  \u2502 \n  183  \u2514   size = 300\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #55 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:201-215\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  201  \u250c resource \"aws_ebs_volume\" \"database-disk7\" {\n  202  \u2502   depends_on        = [aws_instance.database-server]\n  203  \u2502   availability_zone = \"${local.region}a\"\n  204  \u2502   type              = \"gp2\"\n  205  \u2502   encrypted         = true\n  206  \u2502 \n  207  \u2502   size = 300\n  208  \u2502 \n  209  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #56 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:50-64\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50  \u250c resource \"aws_ebs_volume\" \"database-disk1\" {\n   51  \u2502   depends_on        = [aws_instance.database-server]\n   52  \u2502   availability_zone = \"${local.region}a\"\n   53  \u2502   type              = \"gp2\"\n   54  \u2502   encrypted         = true\n   55  \u2502 \n   56  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n   57  \u2502 \n   58  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #57 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:77-91\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   77  \u250c resource \"aws_ebs_volume\" \"database-disk2\" {\n   78  \u2502   depends_on        = [aws_instance.database-server]\n   79  \u2502   availability_zone = \"${local.region}a\"\n   80  \u2502   type              = \"gp2\"\n   81  \u2502   encrypted         = true\n   82  \u2502 \n   83  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n   84  \u2502 \n   85  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #58 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  domain-controllers.tf:146-159\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  146  \u250c resource \"aws_ebs_volume\" \"infra1-disk1\" {\n  147  \u2502   availability_zone = \"${local.region}a\"\n  148  \u2502   type              = \"gp2\"\n  149  \u2502   encrypted         = true\n  150  \u2502 \n  151  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n  152  \u2502 \n  153  \u2502   tags = merge(\n  154  \u2514     local.tags,\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #59 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:53-67\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   53  \u250c resource \"aws_ebs_volume\" \"exchange-disk1\" {\n   54  \u2502   depends_on        = [aws_instance.exchange-server]\n   55  \u2502   availability_zone = \"${local.region}a\"\n   56  \u2502   type              = \"gp2\"\n   57  \u2502   encrypted         = true\n   58  \u2502 \n   59  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n   60  \u2502 \n   61  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #60 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:80-94\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   80  \u250c resource \"aws_ebs_volume\" \"exchange-disk2\" {\n   81  \u2502   depends_on        = [aws_instance.exchange-server]\n   82  \u2502   availability_zone = \"${local.region}a\"\n   83  \u2502   type              = \"gp2\"\n   84  \u2502   encrypted         = true\n   85  \u2502 \n   86  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n   87  \u2502 \n   88  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #61 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:91-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   91  \u250c resource \"aws_ebs_volume\" \"disk_xvdf\" {\n   92  \u2502   depends_on        = [aws_instance.importmachine]\n   93  \u2502   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n   94  \u2502   availability_zone = \"${local.region}a\"\n   95  \u2502   type              = \"gp2\"\n   96  \u2502   encrypted         = true\n   97  \u2502   size              = 6000\n   98  \u2502 \n   99  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #62 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #63 LOW Security group rule does not have a description. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:148-155\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  148    resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n  149      from_port                = 3389\n  150      protocol                 = \"TCP\"\n  151      security_group_id        = aws_security_group.sms_server.id\n  152      to_port                  = 3389\n  153      type                     = \"ingress\"\n  154      source_security_group_id = module.bastion_linux.bastion_security_group\n  155    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-add-description-to-security-group-rule\n      Impact Descriptions provide context for the firewall rule reasons\n  Resolution Add descriptions for all security groups rules\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #64 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #65 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #66 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\n  timings\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  disk i/o             3.522846ms\n  parsing              5.305512809s\n  adaptation           10.052316ms\n  checks               62.589527ms\n  total                5.381677498s\n\n  counts\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  modules downloaded   3\n  modules processed    5\n  blocks processed     356\n  files read           43\n\n  results\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  passed               248\n  ignored              58\n  critical             20\n  high                 23\n  medium               4\n  low                  19\n\n  248 passed, 58 ignored, 66 potential problem(s) detected.\n\ntfsec_exitcode=1\n```\n\n</details>\n\n#### `Checkov Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nCheckov will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning Checkov in terraform/environments/xhibit-portal\n2022-08-04 14:55:38,899 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import:None (for external modules, the --download-external-modules flag is required)\n2022-08-04 14:55:38,900 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-bastion-linux?ref=v3.0.4:None (for external modules, the --download-external-modules flag is required)\nterraform scan results:\n\nPassed checks: 400, Failed checks: 45, Skipped checks: 6\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.build-disk1\n\tFile: /build-server.tf:46-60\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t46 | resource \"aws_ebs_volume\" \"build-disk1\" {\n\t\t47 |   depends_on        = [aws_instance.build-server]\n\t\t48 |   availability_zone = \"${local.region}a\"\n\t\t49 |   type              = \"gp2\"\n\t\t50 |   encrypted         = true\n\t\t51 | \n\t\t52 |   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n\t\t53 | \n\t\t54 |   tags = merge(\n\t\t55 |     local.tags,\n\t\t56 |     {\n\t\t57 |       Name = \"build-disk1-${local.application_name}\"\n\t\t58 |     }\n\t\t59 |   )\n\t\t60 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjim-disk1\n\tFile: /cjim-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjim-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjim-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjim-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjip-disk1\n\tFile: /cjip-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjip-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjip-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjip-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-baremetal-disk1\n\tFile: /database-server-baremetal.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"database-baremetal-disk1\" {\n\t\t54 |   count             = local.only_in_production\n\t\t55 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t56 |   availability_zone = \"${local.region}a\"\n\t\t57 |   type              = \"gp2\"\n\t\t58 |   encrypted         = true\n\t\t59 |   size              = 4000\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"database-baremetal-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.app-baremetal-disk2\n\tFile: /database-server-baremetal.tf:98-112\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t98  | resource \"aws_ebs_volume\" \"app-baremetal-disk2\" {\n\t\t99  |   count             = local.only_in_production\n\t\t100 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t101 |   availability_zone = \"${local.region}a\"\n\t\t102 |   type              = \"gp2\"\n\t\t103 |   encrypted         = true\n\t\t104 |   size              = 2000\n\t\t105 | \n\t\t106 |   tags = merge(\n\t\t107 |     local.tags,\n\t\t108 |     {\n\t\t109 |       Name = \"app-baremetal-disk2-${local.application_name}\"\n\t\t110 |     }\n\t\t111 |   )\n\t\t112 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk1\n\tFile: /database-server.tf:50-64\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t50 | resource \"aws_ebs_volume\" \"database-disk1\" {\n\t\t51 |   depends_on        = [aws_instance.database-server]\n\t\t52 |   availability_zone = \"${local.region}a\"\n\t\t53 |   type              = \"gp2\"\n\t\t54 |   encrypted         = true\n\t\t55 | \n\t\t56 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n\t\t57 | \n\t\t58 |   tags = merge(\n\t\t59 |     local.tags,\n\t\t60 |     {\n\t\t61 |       Name = \"database-disk1-${local.application_name}\"\n\t\t62 |     }\n\t\t63 |   )\n\t\t64 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk2\n\tFile: /database-server.tf:77-91\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t77 | resource \"aws_ebs_volume\" \"database-disk2\" {\n\t\t78 |   depends_on        = [aws_instance.database-server]\n\t\t79 |   availability_zone = \"${local.region}a\"\n\t\t80 |   type              = \"gp2\"\n\t\t81 |   encrypted         = true\n\t\t82 | \n\t\t83 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n\t\t84 | \n\t\t85 |   tags = merge(\n\t\t86 |     local.tags,\n\t\t87 |     {\n\t\t88 |       Name = \"database-disk2-${local.application_name}\"\n\t\t89 |     }\n\t\t90 |   )\n\t\t91 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk3\n\tFile: /database-server.tf:102-116\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t102 | resource \"aws_ebs_volume\" \"database-disk3\" {\n\t\t103 |   depends_on        = [aws_instance.database-server]\n\t\t104 |   availability_zone = \"${local.region}a\"\n\t\t105 |   type              = \"gp2\"\n\t\t106 |   encrypted         = true\n\t\t107 | \n\t\t108 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n\t\t109 | \n\t\t110 |   tags = merge(\n\t\t111 |     local.tags,\n\t\t112 |     {\n\t\t113 |       Name = \"database-disk3-${local.application_name}\"\n\t\t114 |     }\n\t\t115 |   )\n\t\t116 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk4\n\tFile: /database-server.tf:126-140\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t126 | resource \"aws_ebs_volume\" \"database-disk4\" {\n\t\t127 |   depends_on        = [aws_instance.database-server]\n\t\t128 |   availability_zone = \"${local.region}a\"\n\t\t129 |   type              = \"gp2\"\n\t\t130 |   encrypted         = true\n\t\t131 | \n\t\t132 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n\t\t133 | \n\t\t134 |   tags = merge(\n\t\t135 |     local.tags,\n\t\t136 |     {\n\t\t137 |       Name = \"database-disk4-${local.application_name}\"\n\t\t138 |     }\n\t\t139 |   )\n\t\t140 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk5\n\tFile: /database-server.tf:150-164\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t150 | resource \"aws_ebs_volume\" \"database-disk5\" {\n\t\t151 |   depends_on        = [aws_instance.database-server]\n\t\t152 |   availability_zone = \"${local.region}a\"\n\t\t153 |   type              = \"gp2\"\n\t\t154 |   encrypted         = true\n\t\t155 | \n\t\t156 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n\t\t157 | \n\t\t158 |   tags = merge(\n\t\t159 |     local.tags,\n\t\t160 |     {\n\t\t161 |       Name = \"database-disk5-${local.application_name}\"\n\t\t162 |     }\n\t\t163 |   )\n\t\t164 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk6\n\tFile: /database-server.tf:175-191\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t175 | resource \"aws_ebs_volume\" \"database-disk6\" {\n\t\t176 |   depends_on        = [aws_instance.database-server]\n\t\t177 |   availability_zone = \"${local.region}a\"\n\t\t178 |   type              = \"gp2\"\n\t\t179 |   encrypted         = true\n\t\t180 | \n\t\t181 |   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n\t\t182 | \n\t\t183 |   size = 300\n\t\t184 | \n\t\t185 |   tags = merge(\n\t\t186 |     local.tags,\n\t\t187 |     {\n\t\t188 |       Name = \"database-disk6-${local.application_name}\"\n\t\t189 |     }\n\t\t190 |   )\n\t\t191 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk7\n\tFile: /database-server.tf:201-215\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t201 | resource \"aws_ebs_volume\" \"database-disk7\" {\n\t\t202 |   depends_on        = [aws_instance.database-server]\n\t\t203 |   availability_zone = \"${local.region}a\"\n\t\t204 |   type              = \"gp2\"\n\t\t205 |   encrypted         = true\n\t\t206 | \n\t\t207 |   size = 300\n\t\t208 | \n\t\t209 |   tags = merge(\n\t\t210 |     local.tags,\n\t\t211 |     {\n\t\t212 |       Name = \"database-disk7-${local.application_name}\"\n\t\t213 |     }\n\t\t214 |   )\n\t\t215 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.infra1-disk1\n\tFile: /domain-controllers.tf:146-159\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t146 | resource \"aws_ebs_volume\" \"infra1-disk1\" {\n\t\t147 |   availability_zone = \"${local.region}a\"\n\t\t148 |   type              = \"gp2\"\n\t\t149 |   encrypted         = true\n\t\t150 | \n\t\t151 |   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n\t\t152 | \n\t\t153 |   tags = merge(\n\t\t154 |     local.tags,\n\t\t155 |     {\n\t\t156 |       Name = \"infra1-disk1-${local.application_name}\"\n\t\t157 |     }\n\t\t158 |   )\n\t\t159 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk1\n\tFile: /exchange-server.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"exchange-disk1\" {\n\t\t54 |   depends_on        = [aws_instance.exchange-server]\n\t\t55 |   availability_zone = \"${local.region}a\"\n\t\t56 |   type              = \"gp2\"\n\t\t57 |   encrypted         = true\n\t\t58 | \n\t\t59 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"exchange-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk2\n\tFile: /exchange-server.tf:80-94\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t80 | resource \"aws_ebs_volume\" \"exchange-disk2\" {\n\t\t81 |   depends_on        = [aws_instance.exchange-server]\n\t\t82 |   availability_zone = \"${local.region}a\"\n\t\t83 |   type              = \"gp2\"\n\t\t84 |   encrypted         = true\n\t\t85 | \n\t\t86 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n\t\t87 | \n\t\t88 |   tags = merge(\n\t\t89 |     local.tags,\n\t\t90 |     {\n\t\t91 |       Name = \"exchange-disk2-${local.application_name}\"\n\t\t92 |     }\n\t\t93 |   )\n\t\t94 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.disk_xvdf\n\tFile: /importmachine.tf:91-105\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t91  | resource \"aws_ebs_volume\" \"disk_xvdf\" {\n\t\t92  |   depends_on        = [aws_instance.importmachine]\n\t\t93  |   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n\t\t94  |   availability_zone = \"${local.region}a\"\n\t\t95  |   type              = \"gp2\"\n\t\t96  |   encrypted         = true\n\t\t97  |   size              = 6000\n\t\t98  | \n\t\t99  |   tags = merge(\n\t\t100 |     local.tags,\n\t\t101 |     {\n\t\t102 |       Name = \"importmachine-${local.application_name}-disk\"\n\t\t103 |     }\n\t\t104 |   )\n\t\t105 | }\n\nCheck: CKV_AWS_23: \"Ensure every security groups rule has a description\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-bastion\n\tFile: /network-infrastructure.tf:148-155\n\tGuide: https://docs.bridgecrew.io/docs/networking_31\n\n\t\t148 | resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n\t\t149 |   from_port                = 3389\n\t\t150 |   protocol                 = \"TCP\"\n\t\t151 |   security_group_id        = aws_security_group.sms_server.id\n\t\t152 |   to_port                  = 3389\n\t\t153 |   type                     = \"ingress\"\n\t\t154 |   source_security_group_id = module.bastion_linux.bastion_security_group\n\t\t155 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.prtg_acl\n\tFile: /prtg-load-balancer.tf:139-204\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.waf_acl\n\tFile: /waf-load-balancer.tf:242-307\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\n\ncheckov_exitcode=1\n```\n\n</details>\n\n#### `CTFLint Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nSetting default tflint config...\nRunning tflint --init...\nInstalling `aws` plugin...\nInstalled `aws` (source: github.com/terraform-linters/tflint-ruleset-aws, version: 0.15.0)\ntflint will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning tflint in terraform/environments/xhibit-portal\n17 issue(s) found:\n\nWarning: Module source \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\" is not pinned (terraform_module_pinned_source)\n\n  on /github/workspace/terraform/environments/xhibit-portal/importrole.tf line 3:\n   3:   source = \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_module_pinned_source.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 138:\n 138:       \"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 188:\n 188:     resources = [\"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 98:\n  98:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 232:\n 232:   log_destination_configs = [\"${aws_s3_bucket.prtg_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 251:\n 251:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 290:\n 290:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 315:\n 315:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 322:\n 322:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 202:\n 202:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 350:\n 350:       \"${aws_s3_bucket.loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 400:\n 400:     resources = [\"${aws_s3_bucket.loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 430:\n 430:   log_destination_configs = [\"${aws_s3_bucket.waf_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 449:\n 449:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 488:\n 488:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 513:\n 513:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 520:\n 520:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\ntflint_exitcode=2\n```\n\n</details>\n",
                "#### `TFSEC Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nTFSEC will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning TFSEC in terraform/environments/xhibit-portal\nExcluding the following checks: AWS095\n\nResult #1 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   19  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #2 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:20\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   20  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #3 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:29\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   29  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #4 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:30\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   30  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResults #5-8 CRITICAL Security group rule allows ingress from public internet. (4 similar results)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:26-34\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   18    resource \"aws_security_group_rule\" \"ingestion_lb_allow_web_users\" {\n   ..  \n   26  \u250c   cidr_blocks = [\n   27  \u2502     \"10.182.60.51/32\",  # NLE CGI proxy \n   28  \u2502     \"195.59.75.151/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   29  \u2502     \"195.59.75.152/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   30  \u2502     \"194.33.192.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   31  \u2502     \"194.33.196.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   32  \u2514     \"194.33.248.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  Individual Causes\n  - ingestion-load-balancer.tf:18-38 (aws_security_group_rule.ingestion_lb_allow_web_users) 4 instances\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #9 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #10 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:123\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #11 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:187\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #12 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:188\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #13 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:199\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  191    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv4\" {\n  192      depends_on        = [aws_security_group.sms_server]\n  193      security_group_id = aws_security_group.sms_server.id\n  194      type              = \"egress\"\n  195      description       = \"allow all ipv4\"\n  196      from_port         = 0\n  197      to_port           = 0\n  198      protocol          = \"-1\"\n  199  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  200    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #14 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:210\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  202    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv6\" {\n  203      depends_on        = [aws_security_group.sms_server]\n  204      security_group_id = aws_security_group.sms_server.id\n  205      type              = \"egress\"\n  206      description       = \"allow all ipv6\"\n  207      from_port         = 0\n  208      to_port           = 0\n  209      protocol          = \"-1\"\n  210  [   ipv6_cidr_blocks  = [\"::/0\"]\n  211    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #15 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:276\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #16 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:277\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #17 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:288\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #18 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:289\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #19 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:82\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   73    resource \"aws_lb_listener\" \"prtg_lb_listener\" {\n   ..  \n   82  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n   ..  \n   90    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #20 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:99\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   90    resource \"aws_lb_listener\" \"waf_lb_listener\" {\n   ..  \n   99  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n  ...  \n  107    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #21 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #22 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #23 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #24 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #25 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:57\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50    resource \"aws_elb\" \"ingestion_lb\" {\n   ..  \n   57  [   internal        = false (false)\n   ..  \n   95    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #26 HIGH IAM policy document uses sensitive action 'ec2:DeregisterImage' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:114\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  104    resource \"aws_iam_role\" \"delete_snapshot_lambda\" {\n  ...  \n  114  [       Version = \"2012-10-17\"\n  ...  \n  137    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #27 HIGH IAM policy document uses sensitive action 'ec2:CreateTags' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:22\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_iam_role\" \"snapshot_lambda\" {\n   ..  \n   22  [       Version = \"2012-10-17\"\n   ..  \n   45    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #28 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:12-37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12  \u250c resource \"aws_lb\" \"prtg_lb\" {\n   13  \u2502 \n   14  \u2502   depends_on = [\n   15  \u2502     aws_security_group.prtg_lb,\n   16  \u2502   ]\n   17  \u2502 \n   18  \u2502   name                       = \"prtg-lb-${var.networking[0].application}\"\n   19  \u2502   internal                   = false\n   20  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #29 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_lb\" \"prtg_lb\" {\n   ..  \n   19  [   internal                   = false (false)\n   ..  \n   37    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #30 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #31 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #32 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #33 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #34 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:30-55\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30  \u250c resource \"aws_lb\" \"waf_lb\" {\n   31  \u2502 \n   32  \u2502   depends_on = [\n   33  \u2502     aws_security_group.waf_lb,\n   34  \u2502   ]\n   35  \u2502 \n   36  \u2502   name                       = \"waf-lb-${var.networking[0].application}\"\n   37  \u2502   internal                   = false\n   38  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #35 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #36 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #37 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #38 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #39 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30    resource \"aws_lb\" \"waf_lb\" {\n   ..  \n   37  [   internal                   = false (false)\n   ..  \n   55    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #40 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #41 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #42 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #43 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #44 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #45 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #46 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #47 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #48 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  build-server.tf:46-60\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   46  \u250c resource \"aws_ebs_volume\" \"build-disk1\" {\n   47  \u2502   depends_on        = [aws_instance.build-server]\n   48  \u2502   availability_zone = \"${local.region}a\"\n   49  \u2502   type              = \"gp2\"\n   50  \u2502   encrypted         = true\n   51  \u2502 \n   52  \u2502   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n   53  \u2502 \n   54  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #49 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjim-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjim-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjim-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #50 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjip-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjip-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjip-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #51 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:102-116\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102  \u250c resource \"aws_ebs_volume\" \"database-disk3\" {\n  103  \u2502   depends_on        = [aws_instance.database-server]\n  104  \u2502   availability_zone = \"${local.region}a\"\n  105  \u2502   type              = \"gp2\"\n  106  \u2502   encrypted         = true\n  107  \u2502 \n  108  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n  109  \u2502 \n  110  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #52 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:126-140\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  126  \u250c resource \"aws_ebs_volume\" \"database-disk4\" {\n  127  \u2502   depends_on        = [aws_instance.database-server]\n  128  \u2502   availability_zone = \"${local.region}a\"\n  129  \u2502   type              = \"gp2\"\n  130  \u2502   encrypted         = true\n  131  \u2502 \n  132  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n  133  \u2502 \n  134  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #53 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:150-164\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  150  \u250c resource \"aws_ebs_volume\" \"database-disk5\" {\n  151  \u2502   depends_on        = [aws_instance.database-server]\n  152  \u2502   availability_zone = \"${local.region}a\"\n  153  \u2502   type              = \"gp2\"\n  154  \u2502   encrypted         = true\n  155  \u2502 \n  156  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n  157  \u2502 \n  158  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #54 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:175-191\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  175  \u250c resource \"aws_ebs_volume\" \"database-disk6\" {\n  176  \u2502   depends_on        = [aws_instance.database-server]\n  177  \u2502   availability_zone = \"${local.region}a\"\n  178  \u2502   type              = \"gp2\"\n  179  \u2502   encrypted         = true\n  180  \u2502 \n  181  \u2502   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n  182  \u2502 \n  183  \u2514   size = 300\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #55 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:201-215\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  201  \u250c resource \"aws_ebs_volume\" \"database-disk7\" {\n  202  \u2502   depends_on        = [aws_instance.database-server]\n  203  \u2502   availability_zone = \"${local.region}a\"\n  204  \u2502   type              = \"gp2\"\n  205  \u2502   encrypted         = true\n  206  \u2502 \n  207  \u2502   size = 300\n  208  \u2502 \n  209  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #56 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:50-64\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50  \u250c resource \"aws_ebs_volume\" \"database-disk1\" {\n   51  \u2502   depends_on        = [aws_instance.database-server]\n   52  \u2502   availability_zone = \"${local.region}a\"\n   53  \u2502   type              = \"gp2\"\n   54  \u2502   encrypted         = true\n   55  \u2502 \n   56  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n   57  \u2502 \n   58  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #57 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:77-91\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   77  \u250c resource \"aws_ebs_volume\" \"database-disk2\" {\n   78  \u2502   depends_on        = [aws_instance.database-server]\n   79  \u2502   availability_zone = \"${local.region}a\"\n   80  \u2502   type              = \"gp2\"\n   81  \u2502   encrypted         = true\n   82  \u2502 \n   83  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n   84  \u2502 \n   85  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #58 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  domain-controllers.tf:146-159\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  146  \u250c resource \"aws_ebs_volume\" \"infra1-disk1\" {\n  147  \u2502   availability_zone = \"${local.region}a\"\n  148  \u2502   type              = \"gp2\"\n  149  \u2502   encrypted         = true\n  150  \u2502 \n  151  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n  152  \u2502 \n  153  \u2502   tags = merge(\n  154  \u2514     local.tags,\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #59 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:53-67\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   53  \u250c resource \"aws_ebs_volume\" \"exchange-disk1\" {\n   54  \u2502   depends_on        = [aws_instance.exchange-server]\n   55  \u2502   availability_zone = \"${local.region}a\"\n   56  \u2502   type              = \"gp2\"\n   57  \u2502   encrypted         = true\n   58  \u2502 \n   59  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n   60  \u2502 \n   61  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #60 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:80-94\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   80  \u250c resource \"aws_ebs_volume\" \"exchange-disk2\" {\n   81  \u2502   depends_on        = [aws_instance.exchange-server]\n   82  \u2502   availability_zone = \"${local.region}a\"\n   83  \u2502   type              = \"gp2\"\n   84  \u2502   encrypted         = true\n   85  \u2502 \n   86  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n   87  \u2502 \n   88  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #61 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:91-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   91  \u250c resource \"aws_ebs_volume\" \"disk_xvdf\" {\n   92  \u2502   depends_on        = [aws_instance.importmachine]\n   93  \u2502   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n   94  \u2502   availability_zone = \"${local.region}a\"\n   95  \u2502   type              = \"gp2\"\n   96  \u2502   encrypted         = true\n   97  \u2502   size              = 6000\n   98  \u2502 \n   99  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #62 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #63 LOW Security group rule does not have a description. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:148-155\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  148    resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n  149      from_port                = 3389\n  150      protocol                 = \"TCP\"\n  151      security_group_id        = aws_security_group.sms_server.id\n  152      to_port                  = 3389\n  153      type                     = \"ingress\"\n  154      source_security_group_id = module.bastion_linux.bastion_security_group\n  155    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-add-description-to-security-group-rule\n      Impact Descriptions provide context for the firewall rule reasons\n  Resolution Add descriptions for all security groups rules\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #64 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #65 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #66 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\n  timings\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  disk i/o             1.179818ms\n  parsing              2.430116201s\n  adaptation           7.089988ms\n  checks               46.598981ms\n  total                2.484984988s\n\n  counts\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  modules downloaded   3\n  modules processed    5\n  blocks processed     356\n  files read           43\n\n  results\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  passed               248\n  ignored              58\n  critical             20\n  high                 23\n  medium               4\n  low                  19\n\n  248 passed, 58 ignored, 66 potential problem(s) detected.\n\ntfsec_exitcode=1\n```\n\n</details>\n\n#### `Checkov Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nCheckov will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning Checkov in terraform/environments/xhibit-portal\n2022-08-04 15:11:46,027 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import:None (for external modules, the --download-external-modules flag is required)\n2022-08-04 15:11:46,027 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-bastion-linux?ref=v3.0.4:None (for external modules, the --download-external-modules flag is required)\nterraform scan results:\n\nPassed checks: 400, Failed checks: 45, Skipped checks: 6\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.build-disk1\n\tFile: /build-server.tf:46-60\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t46 | resource \"aws_ebs_volume\" \"build-disk1\" {\n\t\t47 |   depends_on        = [aws_instance.build-server]\n\t\t48 |   availability_zone = \"${local.region}a\"\n\t\t49 |   type              = \"gp2\"\n\t\t50 |   encrypted         = true\n\t\t51 | \n\t\t52 |   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n\t\t53 | \n\t\t54 |   tags = merge(\n\t\t55 |     local.tags,\n\t\t56 |     {\n\t\t57 |       Name = \"build-disk1-${local.application_name}\"\n\t\t58 |     }\n\t\t59 |   )\n\t\t60 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjim-disk1\n\tFile: /cjim-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjim-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjim-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjim-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjip-disk1\n\tFile: /cjip-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjip-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjip-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjip-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-baremetal-disk1\n\tFile: /database-server-baremetal.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"database-baremetal-disk1\" {\n\t\t54 |   count             = local.only_in_production\n\t\t55 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t56 |   availability_zone = \"${local.region}a\"\n\t\t57 |   type              = \"gp2\"\n\t\t58 |   encrypted         = true\n\t\t59 |   size              = 4000\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"database-baremetal-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.app-baremetal-disk2\n\tFile: /database-server-baremetal.tf:98-112\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t98  | resource \"aws_ebs_volume\" \"app-baremetal-disk2\" {\n\t\t99  |   count             = local.only_in_production\n\t\t100 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t101 |   availability_zone = \"${local.region}a\"\n\t\t102 |   type              = \"gp2\"\n\t\t103 |   encrypted         = true\n\t\t104 |   size              = 2000\n\t\t105 | \n\t\t106 |   tags = merge(\n\t\t107 |     local.tags,\n\t\t108 |     {\n\t\t109 |       Name = \"app-baremetal-disk2-${local.application_name}\"\n\t\t110 |     }\n\t\t111 |   )\n\t\t112 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk1\n\tFile: /database-server.tf:50-64\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t50 | resource \"aws_ebs_volume\" \"database-disk1\" {\n\t\t51 |   depends_on        = [aws_instance.database-server]\n\t\t52 |   availability_zone = \"${local.region}a\"\n\t\t53 |   type              = \"gp2\"\n\t\t54 |   encrypted         = true\n\t\t55 | \n\t\t56 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n\t\t57 | \n\t\t58 |   tags = merge(\n\t\t59 |     local.tags,\n\t\t60 |     {\n\t\t61 |       Name = \"database-disk1-${local.application_name}\"\n\t\t62 |     }\n\t\t63 |   )\n\t\t64 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk2\n\tFile: /database-server.tf:77-91\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t77 | resource \"aws_ebs_volume\" \"database-disk2\" {\n\t\t78 |   depends_on        = [aws_instance.database-server]\n\t\t79 |   availability_zone = \"${local.region}a\"\n\t\t80 |   type              = \"gp2\"\n\t\t81 |   encrypted         = true\n\t\t82 | \n\t\t83 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n\t\t84 | \n\t\t85 |   tags = merge(\n\t\t86 |     local.tags,\n\t\t87 |     {\n\t\t88 |       Name = \"database-disk2-${local.application_name}\"\n\t\t89 |     }\n\t\t90 |   )\n\t\t91 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk3\n\tFile: /database-server.tf:102-116\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t102 | resource \"aws_ebs_volume\" \"database-disk3\" {\n\t\t103 |   depends_on        = [aws_instance.database-server]\n\t\t104 |   availability_zone = \"${local.region}a\"\n\t\t105 |   type              = \"gp2\"\n\t\t106 |   encrypted         = true\n\t\t107 | \n\t\t108 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n\t\t109 | \n\t\t110 |   tags = merge(\n\t\t111 |     local.tags,\n\t\t112 |     {\n\t\t113 |       Name = \"database-disk3-${local.application_name}\"\n\t\t114 |     }\n\t\t115 |   )\n\t\t116 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk4\n\tFile: /database-server.tf:126-140\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t126 | resource \"aws_ebs_volume\" \"database-disk4\" {\n\t\t127 |   depends_on        = [aws_instance.database-server]\n\t\t128 |   availability_zone = \"${local.region}a\"\n\t\t129 |   type              = \"gp2\"\n\t\t130 |   encrypted         = true\n\t\t131 | \n\t\t132 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n\t\t133 | \n\t\t134 |   tags = merge(\n\t\t135 |     local.tags,\n\t\t136 |     {\n\t\t137 |       Name = \"database-disk4-${local.application_name}\"\n\t\t138 |     }\n\t\t139 |   )\n\t\t140 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk5\n\tFile: /database-server.tf:150-164\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t150 | resource \"aws_ebs_volume\" \"database-disk5\" {\n\t\t151 |   depends_on        = [aws_instance.database-server]\n\t\t152 |   availability_zone = \"${local.region}a\"\n\t\t153 |   type              = \"gp2\"\n\t\t154 |   encrypted         = true\n\t\t155 | \n\t\t156 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n\t\t157 | \n\t\t158 |   tags = merge(\n\t\t159 |     local.tags,\n\t\t160 |     {\n\t\t161 |       Name = \"database-disk5-${local.application_name}\"\n\t\t162 |     }\n\t\t163 |   )\n\t\t164 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk6\n\tFile: /database-server.tf:175-191\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t175 | resource \"aws_ebs_volume\" \"database-disk6\" {\n\t\t176 |   depends_on        = [aws_instance.database-server]\n\t\t177 |   availability_zone = \"${local.region}a\"\n\t\t178 |   type              = \"gp2\"\n\t\t179 |   encrypted         = true\n\t\t180 | \n\t\t181 |   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n\t\t182 | \n\t\t183 |   size = 300\n\t\t184 | \n\t\t185 |   tags = merge(\n\t\t186 |     local.tags,\n\t\t187 |     {\n\t\t188 |       Name = \"database-disk6-${local.application_name}\"\n\t\t189 |     }\n\t\t190 |   )\n\t\t191 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk7\n\tFile: /database-server.tf:201-215\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t201 | resource \"aws_ebs_volume\" \"database-disk7\" {\n\t\t202 |   depends_on        = [aws_instance.database-server]\n\t\t203 |   availability_zone = \"${local.region}a\"\n\t\t204 |   type              = \"gp2\"\n\t\t205 |   encrypted         = true\n\t\t206 | \n\t\t207 |   size = 300\n\t\t208 | \n\t\t209 |   tags = merge(\n\t\t210 |     local.tags,\n\t\t211 |     {\n\t\t212 |       Name = \"database-disk7-${local.application_name}\"\n\t\t213 |     }\n\t\t214 |   )\n\t\t215 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.infra1-disk1\n\tFile: /domain-controllers.tf:146-159\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t146 | resource \"aws_ebs_volume\" \"infra1-disk1\" {\n\t\t147 |   availability_zone = \"${local.region}a\"\n\t\t148 |   type              = \"gp2\"\n\t\t149 |   encrypted         = true\n\t\t150 | \n\t\t151 |   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n\t\t152 | \n\t\t153 |   tags = merge(\n\t\t154 |     local.tags,\n\t\t155 |     {\n\t\t156 |       Name = \"infra1-disk1-${local.application_name}\"\n\t\t157 |     }\n\t\t158 |   )\n\t\t159 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk1\n\tFile: /exchange-server.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"exchange-disk1\" {\n\t\t54 |   depends_on        = [aws_instance.exchange-server]\n\t\t55 |   availability_zone = \"${local.region}a\"\n\t\t56 |   type              = \"gp2\"\n\t\t57 |   encrypted         = true\n\t\t58 | \n\t\t59 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"exchange-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk2\n\tFile: /exchange-server.tf:80-94\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t80 | resource \"aws_ebs_volume\" \"exchange-disk2\" {\n\t\t81 |   depends_on        = [aws_instance.exchange-server]\n\t\t82 |   availability_zone = \"${local.region}a\"\n\t\t83 |   type              = \"gp2\"\n\t\t84 |   encrypted         = true\n\t\t85 | \n\t\t86 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n\t\t87 | \n\t\t88 |   tags = merge(\n\t\t89 |     local.tags,\n\t\t90 |     {\n\t\t91 |       Name = \"exchange-disk2-${local.application_name}\"\n\t\t92 |     }\n\t\t93 |   )\n\t\t94 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.disk_xvdf\n\tFile: /importmachine.tf:91-105\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t91  | resource \"aws_ebs_volume\" \"disk_xvdf\" {\n\t\t92  |   depends_on        = [aws_instance.importmachine]\n\t\t93  |   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n\t\t94  |   availability_zone = \"${local.region}a\"\n\t\t95  |   type              = \"gp2\"\n\t\t96  |   encrypted         = true\n\t\t97  |   size              = 6000\n\t\t98  | \n\t\t99  |   tags = merge(\n\t\t100 |     local.tags,\n\t\t101 |     {\n\t\t102 |       Name = \"importmachine-${local.application_name}-disk\"\n\t\t103 |     }\n\t\t104 |   )\n\t\t105 | }\n\nCheck: CKV_AWS_23: \"Ensure every security groups rule has a description\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-bastion\n\tFile: /network-infrastructure.tf:148-155\n\tGuide: https://docs.bridgecrew.io/docs/networking_31\n\n\t\t148 | resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n\t\t149 |   from_port                = 3389\n\t\t150 |   protocol                 = \"TCP\"\n\t\t151 |   security_group_id        = aws_security_group.sms_server.id\n\t\t152 |   to_port                  = 3389\n\t\t153 |   type                     = \"ingress\"\n\t\t154 |   source_security_group_id = module.bastion_linux.bastion_security_group\n\t\t155 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.prtg_acl\n\tFile: /prtg-load-balancer.tf:139-204\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.waf_acl\n\tFile: /waf-load-balancer.tf:242-307\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\n\ncheckov_exitcode=1\n```\n\n</details>\n\n#### `CTFLint Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nSetting default tflint config...\nRunning tflint --init...\nInstalling `aws` plugin...\nInstalled `aws` (source: github.com/terraform-linters/tflint-ruleset-aws, version: 0.15.0)\ntflint will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning tflint in terraform/environments/xhibit-portal\n17 issue(s) found:\n\nWarning: Module source \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\" is not pinned (terraform_module_pinned_source)\n\n  on /github/workspace/terraform/environments/xhibit-portal/importrole.tf line 3:\n   3:   source = \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_module_pinned_source.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 138:\n 138:       \"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 188:\n 188:     resources = [\"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 98:\n  98:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 232:\n 232:   log_destination_configs = [\"${aws_s3_bucket.prtg_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 251:\n 251:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 290:\n 290:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 315:\n 315:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 322:\n 322:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 202:\n 202:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 350:\n 350:       \"${aws_s3_bucket.loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 400:\n 400:     resources = [\"${aws_s3_bucket.loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 430:\n 430:   log_destination_configs = [\"${aws_s3_bucket.waf_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 449:\n 449:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 488:\n 488:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 513:\n 513:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 520:\n 520:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.1/docs/rules/terraform_deprecated_interpolation.md\n\ntflint_exitcode=2\n```\n\n</details>\n",
                "#### `TFSEC Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nTFSEC will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning TFSEC in terraform/environments/xhibit-portal\nExcluding the following checks: AWS095\n\nResult #1 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   19  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #2 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:20\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   20  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #3 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:29\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   29  [     cidr_blocks      = [\"0.0.0.0/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #4 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:30\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1    resource \"aws_security_group\" \"importmachine\" {\n    .  \n   30  [     ipv6_cidr_blocks = [\"::/0\"]\n   ..  \n   33    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResults #5-8 CRITICAL Security group rule allows ingress from public internet. (4 similar results)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:26-34\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   18    resource \"aws_security_group_rule\" \"ingestion_lb_allow_web_users\" {\n   ..  \n   26  \u250c   cidr_blocks = [\n   27  \u2502     \"10.182.60.51/32\",  # NLE CGI proxy \n   28  \u2502     \"195.59.75.151/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   29  \u2502     \"195.59.75.152/32\", # New proxy IPs from Prashanth for testing ingestion NLE DEV\n   30  \u2502     \"194.33.192.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   31  \u2502     \"194.33.196.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   32  \u2514     \"194.33.248.0/24\",  # New proxy IPs from Prashanth for testing ingestion LE PROD\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  Individual Causes\n  - ingestion-load-balancer.tf:18-38 (aws_security_group_rule.ingestion_lb_allow_web_users) 4 instances\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #9 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #10 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:123\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  114    resource \"aws_security_group_rule\" \"exchange-outbound-all\" {\n  115      depends_on        = [aws_security_group.exchange_server]\n  116      security_group_id = aws_security_group.exchange_server.id\n  117      type              = \"egress\"\n  118      description       = \"allow all\"\n  119      from_port         = 0\n  120      to_port           = 0\n  121      protocol          = \"-1\"\n  122      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #11 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:187\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #12 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:188\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  179    resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n  180      depends_on        = [aws_security_group.sms_server]\n  181      security_group_id = aws_security_group.sms_server.id\n  182      type              = \"ingress\"\n  183      description       = \"allow all\"\n  184      from_port         = 0\n  185      to_port           = 0\n  186      protocol          = \"-1\"\n  187      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #13 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:199\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  191    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv4\" {\n  192      depends_on        = [aws_security_group.sms_server]\n  193      security_group_id = aws_security_group.sms_server.id\n  194      type              = \"egress\"\n  195      description       = \"allow all ipv4\"\n  196      from_port         = 0\n  197      to_port           = 0\n  198      protocol          = \"-1\"\n  199  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  200    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #14 CRITICAL Security group rule allows egress to multiple public internet addresses. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:210\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  202    resource \"aws_security_group_rule\" \"sms-outbound-all-ipv6\" {\n  203      depends_on        = [aws_security_group.sms_server]\n  204      security_group_id = aws_security_group.sms_server.id\n  205      type              = \"egress\"\n  206      description       = \"allow all ipv6\"\n  207      from_port         = 0\n  208      to_port           = 0\n  209      protocol          = \"-1\"\n  210  [   ipv6_cidr_blocks  = [\"::/0\"]\n  211    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-egress-sgr\n      Impact Your port is egressing data to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #15 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:276\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #16 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:277\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  268    resource \"aws_security_group_rule\" \"waf_lb_allow_web_users\" {\n  269      depends_on        = [aws_security_group.waf_lb]\n  270      security_group_id = aws_security_group.waf_lb.id\n  271      type              = \"ingress\"\n  272      description       = \"allow web traffic to get to ingestion server\"\n  273      from_port         = 443\n  274      to_port           = 443\n  275      protocol          = \"TCP\"\n  276      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #17 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:288\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288  [   cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #18 CRITICAL Security group rule allows ingress from public internet. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:289\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  280    resource \"aws_security_group_rule\" \"prtg_lb_allow_web_users\" {\n  281      depends_on        = [aws_security_group.prtg_lb]\n  282      security_group_id = aws_security_group.prtg_lb.id\n  283      type              = \"ingress\"\n  284      description       = \"allow web traffic to get to prtg Load Balancer over SSL \"\n  285      from_port         = 443\n  286      to_port           = 443\n  287      protocol          = \"TCP\"\n  288      cidr_blocks       = [\"0.0.0.0/0\"]\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-no-public-ingress-sgr\n      Impact Your port exposed to the internet\n  Resolution Set a more restrictive cidr range\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #19 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:82\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   73    resource \"aws_lb_listener\" \"prtg_lb_listener\" {\n   ..  \n   82  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n   ..  \n   90    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #20 CRITICAL Listener uses an outdated TLS policy. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:99\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   90    resource \"aws_lb_listener\" \"waf_lb_listener\" {\n   ..  \n   99  [   ssl_policy        = \"ELBSecurityPolicy-2016-08\" (\"ELBSecurityPolicy-2016-08\")\n  ...  \n  107    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-use-secure-tls-policy\n      Impact The SSL policy is outdated and has known vulnerabilities\n  Resolution Use a more recent TLS/SSL policy for the load balancer\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/use-secure-tls-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #21 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #22 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #23 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #24 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #25 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:57\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50    resource \"aws_elb\" \"ingestion_lb\" {\n   ..  \n   57  [   internal        = false (false)\n   ..  \n   95    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #26 HIGH IAM policy document uses sensitive action 'ec2:DeregisterImage' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:114\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  104    resource \"aws_iam_role\" \"delete_snapshot_lambda\" {\n  ...  \n  114  [       Version = \"2012-10-17\"\n  ...  \n  137    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #27 HIGH IAM policy document uses sensitive action 'ec2:CreateTags' on wildcarded resource '*' \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  lambda.tf:22\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_iam_role\" \"snapshot_lambda\" {\n   ..  \n   22  [       Version = \"2012-10-17\"\n   ..  \n   45    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-iam-no-policy-wildcards\n      Impact Overly permissive policies may grant access to sensitive resources\n  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #28 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:12-37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12  \u250c resource \"aws_lb\" \"prtg_lb\" {\n   13  \u2502 \n   14  \u2502   depends_on = [\n   15  \u2502     aws_security_group.prtg_lb,\n   16  \u2502   ]\n   17  \u2502 \n   18  \u2502   name                       = \"prtg-lb-${var.networking[0].application}\"\n   19  \u2502   internal                   = false\n   20  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #29 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:19\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   12    resource \"aws_lb\" \"prtg_lb\" {\n   ..  \n   19  [   internal                   = false (false)\n   ..  \n   37    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #30 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #31 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #32 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #33 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #34 HIGH Application load balancer is not set to drop invalid headers. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:30-55\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30  \u250c resource \"aws_lb\" \"waf_lb\" {\n   31  \u2502 \n   32  \u2502   depends_on = [\n   33  \u2502     aws_security_group.waf_lb,\n   34  \u2502   ]\n   35  \u2502 \n   36  \u2502   name                       = \"waf-lb-${var.networking[0].application}\"\n   37  \u2502   internal                   = false\n   38  \u2514   load_balancer_type         = \"application\"\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-drop-invalid-headers\n      Impact Invalid headers being passed through to the target of the load balance may exploit vulnerabilities\n  Resolution Set drop_invalid_header_fields to true\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #35 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #36 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #37 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #38 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #39 HIGH Load balancer is exposed publicly. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:37\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   30    resource \"aws_lb\" \"waf_lb\" {\n   ..  \n   37  [   internal                   = false (false)\n   ..  \n   55    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-elb-alb-not-public\n      Impact The load balancer is exposed on the internet\n  Resolution Switch to an internal load balancer or add a tfsec ignore\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #40 HIGH No public access block so not blocking public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable blocking any PUT calls with a public ACL specified\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #41 HIGH No public access block so not blocking public policies \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-block-public-policy\n      Impact Users could put a policy that allows public access\n  Resolution Prevent policies that allow public access being PUT\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/block-public-policy/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #42 HIGH No public access block so not ignoring public acls \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-ignore-public-acls\n      Impact PUT calls with public ACLs specified can make objects public\n  Resolution Enable ignoring the application of public ACLs in PUT calls\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/ignore-public-acls/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #43 HIGH No public access block so not restricting public buckets \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-no-public-buckets\n      Impact Public buckets can be accessed by anyone\n  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/no-public-buckets/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #44 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #45 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #46 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #47 MEDIUM Bucket does not have versioning enabled \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-enable-versioning\n      Impact Deleted or modified data would not be recoverable\n  Resolution Enable versioning to protect against accidental/malicious removal or modification\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/enable-versioning/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #48 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  build-server.tf:46-60\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   46  \u250c resource \"aws_ebs_volume\" \"build-disk1\" {\n   47  \u2502   depends_on        = [aws_instance.build-server]\n   48  \u2502   availability_zone = \"${local.region}a\"\n   49  \u2502   type              = \"gp2\"\n   50  \u2502   encrypted         = true\n   51  \u2502 \n   52  \u2502   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n   53  \u2502 \n   54  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #49 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjim-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjim-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjim-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #50 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  cjip-server.tf:48-62\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   48  \u250c resource \"aws_ebs_volume\" \"cjip-disk1\" {\n   49  \u2502   depends_on        = [aws_instance.cjip-server]\n   50  \u2502   availability_zone = \"${local.region}a\"\n   51  \u2502   type              = \"gp2\"\n   52  \u2502   encrypted         = true\n   53  \u2502 \n   54  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n   55  \u2502 \n   56  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #51 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:102-116\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102  \u250c resource \"aws_ebs_volume\" \"database-disk3\" {\n  103  \u2502   depends_on        = [aws_instance.database-server]\n  104  \u2502   availability_zone = \"${local.region}a\"\n  105  \u2502   type              = \"gp2\"\n  106  \u2502   encrypted         = true\n  107  \u2502 \n  108  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n  109  \u2502 \n  110  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #52 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:126-140\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  126  \u250c resource \"aws_ebs_volume\" \"database-disk4\" {\n  127  \u2502   depends_on        = [aws_instance.database-server]\n  128  \u2502   availability_zone = \"${local.region}a\"\n  129  \u2502   type              = \"gp2\"\n  130  \u2502   encrypted         = true\n  131  \u2502 \n  132  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n  133  \u2502 \n  134  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #53 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:150-164\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  150  \u250c resource \"aws_ebs_volume\" \"database-disk5\" {\n  151  \u2502   depends_on        = [aws_instance.database-server]\n  152  \u2502   availability_zone = \"${local.region}a\"\n  153  \u2502   type              = \"gp2\"\n  154  \u2502   encrypted         = true\n  155  \u2502 \n  156  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n  157  \u2502 \n  158  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #54 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:175-191\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  175  \u250c resource \"aws_ebs_volume\" \"database-disk6\" {\n  176  \u2502   depends_on        = [aws_instance.database-server]\n  177  \u2502   availability_zone = \"${local.region}a\"\n  178  \u2502   type              = \"gp2\"\n  179  \u2502   encrypted         = true\n  180  \u2502 \n  181  \u2502   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n  182  \u2502 \n  183  \u2514   size = 300\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #55 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:201-215\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  201  \u250c resource \"aws_ebs_volume\" \"database-disk7\" {\n  202  \u2502   depends_on        = [aws_instance.database-server]\n  203  \u2502   availability_zone = \"${local.region}a\"\n  204  \u2502   type              = \"gp2\"\n  205  \u2502   encrypted         = true\n  206  \u2502 \n  207  \u2502   size = 300\n  208  \u2502 \n  209  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #56 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:50-64\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   50  \u250c resource \"aws_ebs_volume\" \"database-disk1\" {\n   51  \u2502   depends_on        = [aws_instance.database-server]\n   52  \u2502   availability_zone = \"${local.region}a\"\n   53  \u2502   type              = \"gp2\"\n   54  \u2502   encrypted         = true\n   55  \u2502 \n   56  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n   57  \u2502 \n   58  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #57 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  database-server.tf:77-91\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   77  \u250c resource \"aws_ebs_volume\" \"database-disk2\" {\n   78  \u2502   depends_on        = [aws_instance.database-server]\n   79  \u2502   availability_zone = \"${local.region}a\"\n   80  \u2502   type              = \"gp2\"\n   81  \u2502   encrypted         = true\n   82  \u2502 \n   83  \u2502   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n   84  \u2502 \n   85  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #58 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  domain-controllers.tf:146-159\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  146  \u250c resource \"aws_ebs_volume\" \"infra1-disk1\" {\n  147  \u2502   availability_zone = \"${local.region}a\"\n  148  \u2502   type              = \"gp2\"\n  149  \u2502   encrypted         = true\n  150  \u2502 \n  151  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n  152  \u2502 \n  153  \u2502   tags = merge(\n  154  \u2514     local.tags,\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #59 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:53-67\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   53  \u250c resource \"aws_ebs_volume\" \"exchange-disk1\" {\n   54  \u2502   depends_on        = [aws_instance.exchange-server]\n   55  \u2502   availability_zone = \"${local.region}a\"\n   56  \u2502   type              = \"gp2\"\n   57  \u2502   encrypted         = true\n   58  \u2502 \n   59  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n   60  \u2502 \n   61  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #60 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  exchange-server.tf:80-94\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   80  \u250c resource \"aws_ebs_volume\" \"exchange-disk2\" {\n   81  \u2502   depends_on        = [aws_instance.exchange-server]\n   82  \u2502   availability_zone = \"${local.region}a\"\n   83  \u2502   type              = \"gp2\"\n   84  \u2502   encrypted         = true\n   85  \u2502 \n   86  \u2502   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n   87  \u2502 \n   88  \u2514   tags = merge(\n   ..  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #61 LOW EBS volume does not use a customer-managed KMS key. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  importmachine.tf:91-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   91  \u250c resource \"aws_ebs_volume\" \"disk_xvdf\" {\n   92  \u2502   depends_on        = [aws_instance.importmachine]\n   93  \u2502   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n   94  \u2502   availability_zone = \"${local.region}a\"\n   95  \u2502   type              = \"gp2\"\n   96  \u2502   encrypted         = true\n   97  \u2502   size              = 6000\n   98  \u2502 \n   99  \u2514   tags = merge(\n  ...  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-volume-encryption-customer-key\n      Impact Using AWS managed keys does not allow for fine grained control\n  Resolution Enable encryption using customer managed keys\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/volume-encryption-customer-key/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #62 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  ingestion-load-balancer.tf:102-105\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  102    resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n  103      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n  104      force_destroy = true\n  105    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #63 LOW Security group rule does not have a description. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  network-infrastructure.tf:148-155\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  148    resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n  149      from_port                = 3389\n  150      protocol                 = \"TCP\"\n  151      security_group_id        = aws_security_group.sms_server.id\n  152      to_port                  = 3389\n  153      type                     = \"ingress\"\n  154      source_security_group_id = module.bastion_linux.bastion_security_group\n  155    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-ec2-add-description-to-security-group-rule\n      Impact Descriptions provide context for the firewall rule reasons\n  Resolution Add descriptions for all security groups rules\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #64 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  prtg-load-balancer.tf:211-214\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  211    resource \"aws_s3_bucket\" \"prtg_logs\" {\n  212      bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  213      force_destroy = true\n  214    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #65 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:314-317\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  314    resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n  315      bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n  316      force_destroy = true\n  317    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nResult #66 LOW Bucket does not have a corresponding public access block. \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  waf-load-balancer.tf:409-412\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  409    resource \"aws_s3_bucket\" \"waf_logs\" {\n  410      bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n  411      force_destroy = true\n  412    }\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n          ID aws-s3-specify-public-access-block\n      Impact Public access policies may be applied to sensitive data buckets\n  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies\n\n  More Information\n  - https://aquasecurity.github.io/tfsec/latest/checks/aws/s3/specify-public-access-block/\n  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\n  timings\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  disk i/o             1.7426ms\n  parsing              2.618917067s\n  adaptation           9.446636ms\n  checks               57.558268ms\n  total                2.687664571s\n\n  counts\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  modules downloaded   3\n  modules processed    5\n  blocks processed     356\n  files read           43\n\n  results\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  passed               248\n  ignored              58\n  critical             20\n  high                 23\n  medium               4\n  low                  19\n\n  248 passed, 58 ignored, 66 potential problem(s) detected.\n\ntfsec_exitcode=1\n```\n\n</details>\n\n#### `Checkov Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nCheckov will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning Checkov in terraform/environments/xhibit-portal\n2022-08-05 09:03:15,832 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import:None (for external modules, the --download-external-modules flag is required)\n2022-08-05 09:03:15,832 [MainThread  ] [WARNI]  Failed to download module github.com/ministryofjustice/modernisation-platform-terraform-bastion-linux?ref=v3.0.4:None (for external modules, the --download-external-modules flag is required)\nterraform scan results:\n\nPassed checks: 400, Failed checks: 45, Skipped checks: 6\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.build-disk1\n\tFile: /build-server.tf:46-60\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t46 | resource \"aws_ebs_volume\" \"build-disk1\" {\n\t\t47 |   depends_on        = [aws_instance.build-server]\n\t\t48 |   availability_zone = \"${local.region}a\"\n\t\t49 |   type              = \"gp2\"\n\t\t50 |   encrypted         = true\n\t\t51 | \n\t\t52 |   snapshot_id = local.application_data.accounts[local.environment].buildserver-disk-1-snapshot\n\t\t53 | \n\t\t54 |   tags = merge(\n\t\t55 |     local.tags,\n\t\t56 |     {\n\t\t57 |       Name = \"build-disk1-${local.application_name}\"\n\t\t58 |     }\n\t\t59 |   )\n\t\t60 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjim-disk1\n\tFile: /cjim-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjim-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjim-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig04-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjim-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.cjip-disk1\n\tFile: /cjip-server.tf:48-62\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t48 | resource \"aws_ebs_volume\" \"cjip-disk1\" {\n\t\t49 |   depends_on        = [aws_instance.cjip-server]\n\t\t50 |   availability_zone = \"${local.region}a\"\n\t\t51 |   type              = \"gp2\"\n\t\t52 |   encrypted         = true\n\t\t53 | \n\t\t54 |   snapshot_id = local.application_data.accounts[local.environment].suprig05-disk-1-snapshot\n\t\t55 | \n\t\t56 |   tags = merge(\n\t\t57 |     local.tags,\n\t\t58 |     {\n\t\t59 |       Name = \"cjip-disk1-${local.application_name}\"\n\t\t60 |     }\n\t\t61 |   )\n\t\t62 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-baremetal-disk1\n\tFile: /database-server-baremetal.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"database-baremetal-disk1\" {\n\t\t54 |   count             = local.only_in_production\n\t\t55 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t56 |   availability_zone = \"${local.region}a\"\n\t\t57 |   type              = \"gp2\"\n\t\t58 |   encrypted         = true\n\t\t59 |   size              = 4000\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"database-baremetal-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.app-baremetal-disk2\n\tFile: /database-server-baremetal.tf:98-112\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t98  | resource \"aws_ebs_volume\" \"app-baremetal-disk2\" {\n\t\t99  |   count             = local.only_in_production\n\t\t100 |   depends_on        = [aws_instance.database-server-baremetal]\n\t\t101 |   availability_zone = \"${local.region}a\"\n\t\t102 |   type              = \"gp2\"\n\t\t103 |   encrypted         = true\n\t\t104 |   size              = 2000\n\t\t105 | \n\t\t106 |   tags = merge(\n\t\t107 |     local.tags,\n\t\t108 |     {\n\t\t109 |       Name = \"app-baremetal-disk2-${local.application_name}\"\n\t\t110 |     }\n\t\t111 |   )\n\t\t112 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk1\n\tFile: /database-server.tf:50-64\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t50 | resource \"aws_ebs_volume\" \"database-disk1\" {\n\t\t51 |   depends_on        = [aws_instance.database-server]\n\t\t52 |   availability_zone = \"${local.region}a\"\n\t\t53 |   type              = \"gp2\"\n\t\t54 |   encrypted         = true\n\t\t55 | \n\t\t56 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-1-snapshot\n\t\t57 | \n\t\t58 |   tags = merge(\n\t\t59 |     local.tags,\n\t\t60 |     {\n\t\t61 |       Name = \"database-disk1-${local.application_name}\"\n\t\t62 |     }\n\t\t63 |   )\n\t\t64 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk2\n\tFile: /database-server.tf:77-91\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t77 | resource \"aws_ebs_volume\" \"database-disk2\" {\n\t\t78 |   depends_on        = [aws_instance.database-server]\n\t\t79 |   availability_zone = \"${local.region}a\"\n\t\t80 |   type              = \"gp2\"\n\t\t81 |   encrypted         = true\n\t\t82 | \n\t\t83 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-2-snapshot\n\t\t84 | \n\t\t85 |   tags = merge(\n\t\t86 |     local.tags,\n\t\t87 |     {\n\t\t88 |       Name = \"database-disk2-${local.application_name}\"\n\t\t89 |     }\n\t\t90 |   )\n\t\t91 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk3\n\tFile: /database-server.tf:102-116\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t102 | resource \"aws_ebs_volume\" \"database-disk3\" {\n\t\t103 |   depends_on        = [aws_instance.database-server]\n\t\t104 |   availability_zone = \"${local.region}a\"\n\t\t105 |   type              = \"gp2\"\n\t\t106 |   encrypted         = true\n\t\t107 | \n\t\t108 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-3-snapshot\n\t\t109 | \n\t\t110 |   tags = merge(\n\t\t111 |     local.tags,\n\t\t112 |     {\n\t\t113 |       Name = \"database-disk3-${local.application_name}\"\n\t\t114 |     }\n\t\t115 |   )\n\t\t116 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk4\n\tFile: /database-server.tf:126-140\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t126 | resource \"aws_ebs_volume\" \"database-disk4\" {\n\t\t127 |   depends_on        = [aws_instance.database-server]\n\t\t128 |   availability_zone = \"${local.region}a\"\n\t\t129 |   type              = \"gp2\"\n\t\t130 |   encrypted         = true\n\t\t131 | \n\t\t132 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-4-snapshot\n\t\t133 | \n\t\t134 |   tags = merge(\n\t\t135 |     local.tags,\n\t\t136 |     {\n\t\t137 |       Name = \"database-disk4-${local.application_name}\"\n\t\t138 |     }\n\t\t139 |   )\n\t\t140 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk5\n\tFile: /database-server.tf:150-164\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t150 | resource \"aws_ebs_volume\" \"database-disk5\" {\n\t\t151 |   depends_on        = [aws_instance.database-server]\n\t\t152 |   availability_zone = \"${local.region}a\"\n\t\t153 |   type              = \"gp2\"\n\t\t154 |   encrypted         = true\n\t\t155 | \n\t\t156 |   snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-5-snapshot\n\t\t157 | \n\t\t158 |   tags = merge(\n\t\t159 |     local.tags,\n\t\t160 |     {\n\t\t161 |       Name = \"database-disk5-${local.application_name}\"\n\t\t162 |     }\n\t\t163 |   )\n\t\t164 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk6\n\tFile: /database-server.tf:175-191\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t175 | resource \"aws_ebs_volume\" \"database-disk6\" {\n\t\t176 |   depends_on        = [aws_instance.database-server]\n\t\t177 |   availability_zone = \"${local.region}a\"\n\t\t178 |   type              = \"gp2\"\n\t\t179 |   encrypted         = true\n\t\t180 | \n\t\t181 |   #snapshot_id = local.application_data.accounts[local.environment].suprig01-disk-6-snapshot\n\t\t182 | \n\t\t183 |   size = 300\n\t\t184 | \n\t\t185 |   tags = merge(\n\t\t186 |     local.tags,\n\t\t187 |     {\n\t\t188 |       Name = \"database-disk6-${local.application_name}\"\n\t\t189 |     }\n\t\t190 |   )\n\t\t191 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.database-disk7\n\tFile: /database-server.tf:201-215\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t201 | resource \"aws_ebs_volume\" \"database-disk7\" {\n\t\t202 |   depends_on        = [aws_instance.database-server]\n\t\t203 |   availability_zone = \"${local.region}a\"\n\t\t204 |   type              = \"gp2\"\n\t\t205 |   encrypted         = true\n\t\t206 | \n\t\t207 |   size = 300\n\t\t208 | \n\t\t209 |   tags = merge(\n\t\t210 |     local.tags,\n\t\t211 |     {\n\t\t212 |       Name = \"database-disk7-${local.application_name}\"\n\t\t213 |     }\n\t\t214 |   )\n\t\t215 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.infra1-disk1\n\tFile: /domain-controllers.tf:146-159\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t146 | resource \"aws_ebs_volume\" \"infra1-disk1\" {\n\t\t147 |   availability_zone = \"${local.region}a\"\n\t\t148 |   type              = \"gp2\"\n\t\t149 |   encrypted         = true\n\t\t150 | \n\t\t151 |   snapshot_id = local.application_data.accounts[local.environment].infra1-disk-1-snapshot\n\t\t152 | \n\t\t153 |   tags = merge(\n\t\t154 |     local.tags,\n\t\t155 |     {\n\t\t156 |       Name = \"infra1-disk1-${local.application_name}\"\n\t\t157 |     }\n\t\t158 |   )\n\t\t159 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk1\n\tFile: /exchange-server.tf:53-67\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t53 | resource \"aws_ebs_volume\" \"exchange-disk1\" {\n\t\t54 |   depends_on        = [aws_instance.exchange-server]\n\t\t55 |   availability_zone = \"${local.region}a\"\n\t\t56 |   type              = \"gp2\"\n\t\t57 |   encrypted         = true\n\t\t58 | \n\t\t59 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-1-snapshot\n\t\t60 | \n\t\t61 |   tags = merge(\n\t\t62 |     local.tags,\n\t\t63 |     {\n\t\t64 |       Name = \"exchange-disk1-${local.application_name}\"\n\t\t65 |     }\n\t\t66 |   )\n\t\t67 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.exchange-disk2\n\tFile: /exchange-server.tf:80-94\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t80 | resource \"aws_ebs_volume\" \"exchange-disk2\" {\n\t\t81 |   depends_on        = [aws_instance.exchange-server]\n\t\t82 |   availability_zone = \"${local.region}a\"\n\t\t83 |   type              = \"gp2\"\n\t\t84 |   encrypted         = true\n\t\t85 | \n\t\t86 |   snapshot_id = local.application_data.accounts[local.environment].infra6-disk-2-snapshot\n\t\t87 | \n\t\t88 |   tags = merge(\n\t\t89 |     local.tags,\n\t\t90 |     {\n\t\t91 |       Name = \"exchange-disk2-${local.application_name}\"\n\t\t92 |     }\n\t\t93 |   )\n\t\t94 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group.importmachine\n\tFile: /importmachine.tf:1-33\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t1  | resource \"aws_security_group\" \"importmachine\" {\n\t\t2  |   description = \"Configure importmachine access - ingress should be only from Bastion\"\n\t\t3  |   name        = \"importmachine-${local.application_name}\"\n\t\t4  |   vpc_id      = local.vpc_id\n\t\t5  | \n\t\t6  |   ingress {\n\t\t7  |     description     = \"SSH from Bastion\"\n\t\t8  |     from_port       = 0\n\t\t9  |     to_port         = \"3389\"\n\t\t10 |     protocol        = \"TCP\"\n\t\t11 |     security_groups = [module.bastion_linux.bastion_security_group]\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   ingress {\n\t\t15 |     description      = \"from all\"\n\t\t16 |     from_port        = 0\n\t\t17 |     to_port          = 0\n\t\t18 |     protocol         = \"-1\"\n\t\t19 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t20 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t21 | \n\t\t22 |   }\n\t\t23 | \n\t\t24 |   egress {\n\t\t25 |     description      = \"allow all\"\n\t\t26 |     from_port        = 0\n\t\t27 |     to_port          = 0\n\t\t28 |     protocol         = \"-1\"\n\t\t29 |     cidr_blocks      = [\"0.0.0.0/0\"]\n\t\t30 |     ipv6_cidr_blocks = [\"::/0\"]\n\t\t31 |   }\n\t\t32 | \n\t\t33 | }\n\nCheck: CKV_AWS_189: \"Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)\"\n\tFAILED for resource: aws_ebs_volume.disk_xvdf\n\tFile: /importmachine.tf:91-105\n\tGuide: https://docs.bridgecrew.io/docs/bc_aws_general_109\n\n\t\t91  | resource \"aws_ebs_volume\" \"disk_xvdf\" {\n\t\t92  |   depends_on        = [aws_instance.importmachine]\n\t\t93  |   snapshot_id       = local.application_data.accounts[local.environment].importmachine-data-snapshot\n\t\t94  |   availability_zone = \"${local.region}a\"\n\t\t95  |   type              = \"gp2\"\n\t\t96  |   encrypted         = true\n\t\t97  |   size              = 6000\n\t\t98  | \n\t\t99  |   tags = merge(\n\t\t100 |     local.tags,\n\t\t101 |     {\n\t\t102 |       Name = \"importmachine-${local.application_name}-disk\"\n\t\t103 |     }\n\t\t104 |   )\n\t\t105 | }\n\nCheck: CKV_AWS_23: \"Ensure every security groups rule has a description\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-bastion\n\tFile: /network-infrastructure.tf:148-155\n\tGuide: https://docs.bridgecrew.io/docs/networking_31\n\n\t\t148 | resource \"aws_security_group_rule\" \"sms-inbound-bastion\" {\n\t\t149 |   from_port                = 3389\n\t\t150 |   protocol                 = \"TCP\"\n\t\t151 |   security_group_id        = aws_security_group.sms_server.id\n\t\t152 |   to_port                  = 3389\n\t\t153 |   type                     = \"ingress\"\n\t\t154 |   source_security_group_id = module.bastion_linux.bastion_security_group\n\t\t155 | }\n\nCheck: CKV_AWS_24: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 22\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_1-port-security\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_260: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_25: \"Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389\"\n\tFAILED for resource: aws_security_group_rule.sms-inbound-all\n\tFile: /network-infrastructure.tf:179-189\n\tGuide: https://docs.bridgecrew.io/docs/networking_2\n\n\t\t179 | resource \"aws_security_group_rule\" \"sms-inbound-all\" {\n\t\t180 |   depends_on        = [aws_security_group.sms_server]\n\t\t181 |   security_group_id = aws_security_group.sms_server.id\n\t\t182 |   type              = \"ingress\"\n\t\t183 |   description       = \"allow all\"\n\t\t184 |   from_port         = 0\n\t\t185 |   to_port           = 0\n\t\t186 |   protocol          = \"-1\"\n\t\t187 |   cidr_blocks       = [\"0.0.0.0/0\"]\n\t\t188 |   ipv6_cidr_blocks  = [\"::/0\"]\n\t\t189 | }\n\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.prtg_acl\n\tFile: /prtg-load-balancer.tf:139-204\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_192: \"Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell\"\n\tFAILED for resource: aws_wafv2_web_acl.waf_acl\n\tFile: /waf-load-balancer.tf:242-307\n\tGuide: https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_144: \"Ensure that S3 bucket has cross-region replication enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_21: \"Ensure all data stored in the S3 bucket have versioning enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV2_AWS_6: \"Ensure that S3 bucket has a Public Access block\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_18: \"Ensure the S3 bucket has access logging enabled\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/s3_13-enable-logging\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.ingestion_loadbalancer_logs\n\tFile: /ingestion-load-balancer.tf:102-105\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t102 | resource \"aws_s3_bucket\" \"ingestion_loadbalancer_logs\" {\n\t\t103 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-ingestion-lblogs\"\n\t\t104 |   force_destroy = true\n\t\t105 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.waf_logs\n\tFile: /waf-load-balancer.tf:409-412\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t409 | resource \"aws_s3_bucket\" \"waf_logs\" {\n\t\t410 |   bucket        = \"aws-waf-logs-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t411 |   force_destroy = true\n\t\t412 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.loadbalancer_logs\n\tFile: /waf-load-balancer.tf:314-317\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t314 | resource \"aws_s3_bucket\" \"loadbalancer_logs\" {\n\t\t315 |   bucket        = \"${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}-lblogs\"\n\t\t316 |   force_destroy = true\n\t\t317 | }\n\nCheck: CKV_AWS_145: \"Ensure that S3 buckets are encrypted with KMS by default\"\n\tFAILED for resource: aws_s3_bucket.prtg_logs\n\tFile: /prtg-load-balancer.tf:211-214\n\tGuide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default\n\n\t\t211 | resource \"aws_s3_bucket\" \"prtg_logs\" {\n\t\t212 |   bucket        = \"aws-waf-logs-prtg-${var.networking[0].application}.${var.networking[0].business-unit}-${local.environment}\"\n\t\t213 |   force_destroy = true\n\t\t214 | }\n\n\ncheckov_exitcode=1\n```\n\n</details>\n\n#### `CTFLint Scan` Failed\n<details><summary>Show Output</summary>\n\n```hcl\n\n*****************************\n\nSetting default tflint config...\nRunning tflint --init...\nInstalling `aws` plugin...\nInstalled `aws` (source: github.com/terraform-linters/tflint-ruleset-aws, version: 0.15.0)\ntflint will check the following folders:\nterraform/environments/xhibit-portal\n\n*****************************\n\nRunning tflint in terraform/environments/xhibit-portal\n17 issue(s) found:\n\nWarning: Module source \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\" is not pinned (terraform_module_pinned_source)\n\n  on /github/workspace/terraform/environments/xhibit-portal/importrole.tf line 3:\n   3:   source = \"github.com/ministryofjustice/modernisation-platform-terraform-aws-vm-import\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_module_pinned_source.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 138:\n 138:       \"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/ingestion-load-balancer.tf line 188:\n 188:     resources = [\"${aws_s3_bucket.ingestion_loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 98:\n  98:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 232:\n 232:   log_destination_configs = [\"${aws_s3_bucket.prtg_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 251:\n 251:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 290:\n 290:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 315:\n 315:       \"${aws_s3_bucket.prtg_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/prtg-load-balancer.tf line 322:\n 322:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 202:\n 202:     \"${local.application_data.accounts[local.environment].public_dns_name_web}\",\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 350:\n 350:       \"${aws_s3_bucket.loadbalancer_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 400:\n 400:     resources = [\"${aws_s3_bucket.loadbalancer_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 430:\n 430:   log_destination_configs = [\"${aws_s3_bucket.waf_logs.arn}\"]\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 449:\n 449:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 488:\n 488:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 513:\n 513:       \"${aws_s3_bucket.waf_logs.arn}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\nWarning: Interpolation-only expressions are deprecated in Terraform v0.12.14 (terraform_deprecated_interpolation)\n\n  on /github/workspace/terraform/environments/xhibit-portal/waf-load-balancer.tf line 520:\n 520:         \"${data.aws_caller_identity.current.account_id}\"\n\nReference: https://github.com/terraform-linters/tflint/blob/v0.39.2/docs/rules/terraform_deprecated_interpolation.md\n\ntflint_exitcode=2\n```\n\n</details>\n",
                "dry run is set to true",
                "deleting is still set to dry run so approved"
            ],
            "commits": [
                "e1c49f09e51c34775e08a08e048929bccd8e4a2a",
                "0aac136ef46f5fbf1caa88671343eed002500163",
                "15d25cd09ca1fa6437859b9646e1053eb822145d",
                "89e558a12c6d813dbeaa49b0301a12136a5d97d3",
                "5c6911951b2ba5c0285f32e486cc5ff5f6f96385"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/openinfrastructure/terraform-google-multinic/pull/17",
        "content": {
            "title": "Autoscaler",
            "body": " * Setup iperf on endpoints for autoscale testing\r\n * Configure endpoints in the same zone to reduce zone egress network costs.\r\n * Switch endpoints to Debian 10 for iperf2 multi-client support\r\n * Run iperf directly from the startup script, it was misbehaving when run from systemd.\r\n * Run 180 sequential iperf runs, 10 seconds each to create persistent upward pressure on the autoscaler and TCP window sizes.\r\n * Add role label with value of multinic-endpoint, iperf-client, or iperf-server to help build charts in the Monitoring console.\r\n * Set max replicas per zone to 6\r\n\r\nResolves: https://github.com/openinfrastructure/terraform-google-multinic/issues/16",
            "comments": [
                "![image](https://user-images.githubusercontent.com/8972/94353442-20900a00-0026-11eb-8013-bff374df0e54.png)\r\n\r\n![image](https://user-images.githubusercontent.com/8972/94353444-2685eb00-0026-11eb-97a1-f9643f16cada.png)\r\n\r\n![image](https://user-images.githubusercontent.com/8972/94353448-28e84500-0026-11eb-9456-5a885500fe86.png)\r\n",
                "CPU Utilization Autoscaler\r\n===\r\n\r\n6 iperf clients, 128 connections each, 10 second runs, 30 minute runtime.\r\n\r\n![image](https://user-images.githubusercontent.com/8972/94368703-7acab280-009a-11eb-9593-9eef0d10fd4a.png)\r\n\r\n![image](https://user-images.githubusercontent.com/8972/94368704-7dc5a300-009a-11eb-9bd7-cb013a39b757.png)\r\n\r\n![image](https://user-images.githubusercontent.com/8972/94368706-8027fd00-009a-11eb-86fc-177ca40050fd.png)\r\n"
            ],
            "commits": [
                "620750695d8f83d79451948d2a43bf920b48c062"
            ]
        },
        "codes": [
            "saving",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ryte/INF-tf-rds/pull/15",
        "content": {
            "title": "Add cost-allocation tags",
            "body": "",
            "comments": [],
            "commits": [
                "2a58175560b313dbaa2e9dea8a498c50fc05764c"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/CheesecakeLabs/django-drf-boilerplate/pull/70",
        "content": {
            "title": "Temporary fix for NAT setup (increase in billing)",
            "body": "**NOTE: this hasn't been tested with an existing cluster yet**\r\n\r\nOur latest ECS cluster configuration adds a private subnet layer that talks to the pubic subnet using a NAT gateway. Since AWS charges NAT gateway by the hour, it impacts in an additional cost of 35~40 dollars per gateway, which is not needed in most cases. This is not a final config, but it's an intermediary step, that can be applied to existing clusters without much impact.",
            "comments": [],
            "commits": [
                "00df3397fdb018ccbe0162871727bc6c78148b49",
                "e4003aa3c51b789e2a2b5828768a7d0f34659209",
                "2ff1bcf8e991c23c5b53ddcc1ff3366d370c25b0",
                "805f23e03112db6d5e1108eaabd1ef250a5f7172"
            ]
        },
        "codes": [
            "increase",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/segmentio/stack/pull/138",
        "content": {
            "title": "feat(vpc): Optionally use NAT instances instead of NAT gateways",
            "body": "IF NAT instances are used, optional inputs are whether to use Elastic\r\nIPs, an SSH key name, and the EC2 instance type. The latest Amazon VPC\r\nNAT AMI is used. The use of NAT instances can be less expensive than NAT\r\ngateways for development VPCs. NAT instances can be stopped when not in\r\nuse.",
            "comments": [
                "Nope, makes total sense. Thanks both of you guys!",
                "Looks great! \r\n",
                "Thank you @achille-roussel @calvinfo and @yields - it was a pleasure to add to this module.",
                "I've committed some fixes to this branch - ignoring new Amazon NAT AMIs, no longer using associate_public_ip_address to avoid recreating NAT instances when they are stopped and not using an Elastic IP, and adding a cidr_block output.",
                "The changes look great, @calvinfo @yields unless you guys have concerns I'll merge this tomorrow.",
                "Looks good, thanks for your contributions \ud83d\udc4d "
            ],
            "commits": [
                "e27f8951d4387d5a2f6e03fd7f5a4f3c6ee53c66",
                "df2336638a3106e8cd48a3c13cdd741a03df83ab",
                "1debbbf739f871acdd2d9ded722198d7172af5fa"
            ]
        },
        "codes": [
            "saving",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/kabisa/terraform-datadog-costs/pull/1",
        "content": {
            "title": "updated costs alerts to use generic monitor 0.5.1",
            "body": "",
            "comments": [],
            "commits": [
                "adaf03ac0d5a324880e9e6aa10d54b9de6b4e635"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/covidapihub/terraform-covidapihub/pull/1",
        "content": {
            "title": "scale the cluster, but use m5 instances",
            "body": "Scales the cluster, but uses the m5 instances to do so. These are cheaper to run at on-demand prices.\r\n\r\nThe new instances will join the cluster without issue even-though they're in a different worker group",
            "comments": [
                "I used m5s because they're a newer series than the m4s, and they're cheaper to run. These will join the cluster as standard workers.",
                "So I'm not really done commenting.  I think that if these are newer, better and cheaper, why are we keeping the existing m4 pool around.  We should:\r\n\r\n1. Provision six of these new m5 instances.\r\n2. When they are available, decommission the existing `general` pool.\r\n3. Name them `m5-general` as this is probably a pattern that will repeat and the name is something you can schedule against.",
                "@joshua-rutherford I've addressed your comments.  This will now spin up 6 m5.xlarge instances and has renamed the working group",
                "so why are they m5s and do you need to specifically schedule certain things against them?  Also, is the plan to move to m5s totally (i.e., decommission the general worker group)?",
                "LGTM"
            ],
            "commits": [
                "946e27c0e55ab85c9e782be1d55b54d3915d17ce"
            ]
        },
        "codes": [
            "cluster",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/mattermost/mattermost-cloud-database-factory/pull/23",
        "content": {
            "title": "Add a cost allocation tag to postgres instances",
            "body": "\r\n#### Summary\r\nIf this commit applied the postgres instances will have a tag that is used for cost_allocation\r\n\r\n\r\n#### Ticket Link\r\nhttps://mattermost.atlassian.net/browse/MM-36254\r\n\r\n#### Release Note\r\n<!--\r\nIf no, just write \"NONE\" in the release-note block below.\r\nIf yes, a release note is required:\r\nEnter your extended release note in the block below. If the PR requires additional action from users switching to the new release, include the string \"action required\".\r\n\r\n-->\r\n\r\n```release-note\r\nAdd `multitenant-rds` cost allocation tag to postgres multi-tenant instances.\r\n```\r\n",
            "comments": [
                "LGTM \ud83d\udc4c "
            ],
            "commits": [
                "3794d676f4375842364a080e78750b41d9af22d5"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/wellcomecollection/buildkite-infrastructure/pull/13",
        "content": {
            "title": "Increase the disk space on the Buildkite instances",
            "body": "We've been seeing a lot of low disk space errors recently; increasing the disk size is cheap, so let's do it!",
            "comments": [],
            "commits": [
                "50957e0478fd4c4d945ac593822436f6a7ec8111"
            ]
        },
        "codes": [
            "awareness",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/hazelops/terraform-aws-ecs-datadog-agent/pull/5",
        "content": {
            "title": "Use public.ecr.aws registry for the default datadog-agent image",
            "body": "Using public.erc.aws registry provides a better integration on the\nAWS ECS environment:\n* reduce network cost\n* better availability\n",
            "comments": [
                "@clamoriniere So sorry for a belated review, it completely fell through the cracks.\r\n\r\nThanks for the contribution, change totally makes sense."
            ],
            "commits": [
                "a10df203e8892e1a868bd88d798589719a582ba6"
            ]
        },
        "codes": [
            "saving",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/thoughtbot/flightdeck/pull/39",
        "content": {
            "title": "Disable annotations/labels in logs by default",
            "body": "Fluent Bit can add the pod annotations and labels to log output which makes it possible to find and aggregate logs by labels. While this could be useful, it creates extremely large log entries, which can be expensive in Cloudwatch.\n\nThis removes most of the Kubernetes metadata from the log output. It leaves namespace, container name, and pod name, which makes it possible to filter by a particular application or process.\n",
            "comments": [
                "![logs-incoming-bytes](https://user-images.githubusercontent.com/7591/132046801-81aeed0c-8edd-4556-af73-eddd73506970.png)",
                "This is maybe a fairer graph, setting the y axis minimum to zero:\r\n\r\n![Screenshot from 2021-09-03 13-48-35](https://user-images.githubusercontent.com/7591/132046926-0548afb3-dbf5-4810-90b7-6521df41613c.png)\r\n"
            ],
            "commits": [
                "c784bc0a3f747b66ab7cd01f23bbbdbad3bfe705"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/SUSE/ha-sap-terraform-deployments/pull/365",
        "content": {
            "title": "Fix iscsi queue_depth configuration error and hard code of instance type of iscsi/monitoring nodes on aws",
            "body": "Fix issue#357 and issue#258\r\n\r\nRemove the hard code of instance type of iscsi/monitoring nodes, since it is different per region.\r\nCorrect the queue_depth configuration of iscsi pillar file.",
            "comments": [
                "> Hi @nick-wang ,\r\n> I think that for some recent changes, the monitoring and iscsi server code is now in modules, so this change would have conflicts (and it has).\r\n> Besides that, I would split the image of monitoring and iscsi in 2 different variables (maybe with the modules they are not even named `instancetype`...).\r\n\r\n@arbulu89 No problem, I can modify and test again based on the new change.\r\nFor sure, i can split the variables for monitoring/iscsi images. But i assume most of time, they are using the minimum standard image. So my idea\r\nis we have a default less cost(free tier) instancetype, like `t2.micro`. Then have 2 variables for monitoring and iscsi image but by default is empty. It will replace the `free tier` image unless explicit defined. In this case, customer doesn't need to remember modify all the `free tier` images when switch to a new region.\r\nHow do you think of it? \r\n\r\n(My AWS account is expired... i will ask Diego for the access of team account if it is OK)\r\n\r\n> \r\n> About the `depth` thing, I don't really know what's the difference, so I trust in your change hehe\r\n\r\nI meet a error message in iscsi server about the unknown parser of `queue_depth` of iscsi pillar. I forget to copy the content. If you have the iscsi node, maybe you can find the error in system log.\r\nFor sure, the `queue_depth` didn't effect with the original configuration. For the new method of configuring in iscsi configuration, i did check the result in my deployment.\r\n",
                "@nick-wang Yes, I like that. Have the a small instance type by default, being able to be changed. And the same for the image, yes, do this.\r\n\r\nThanks! ",
                "@arbulu89 merged with the latest change and split the instancetype of iscsi/monitoring. \r\nPls help to check.",
                "Thanks for the review.",
                "Hi @nick-wang ,\r\nI think that for some recent changes, the monitoring and iscsi server code is now in modules, so this change would have conflicts (and it has). \r\nBesides that, I would split the image of monitoring and iscsi in 2 different variables (maybe with the modules they are not even named `instancetype`...).\r\n\r\nAbout the `depth` thing, I don't really know what's the difference, so I trust in your change hehe",
                "Hey @nick-wang ,\r\nI have seen that you documented the `netweaver_instancetype` but it's not used anywhere. I guess you forgot to set it in the `main.tf` file. I would just do the same than the others.\r\nIf `netweaver_instancetype` is defined, use it, otherwise use the `instancetype` variable.\r\nWhat do you think?",
                "@nick-wang sorry, I failed checking this `netweaver_instancetype`. It's totally fine as it is.\r\nApproved!"
            ],
            "commits": [
                "a4e492d856a36b0a156c89607f747ec2a70bf621"
            ]
        },
        "codes": [
            "unsure"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/SUSE/ha-sap-terraform-deployments/pull/303",
        "content": {
            "title": "Change instance type for SAP certified systems",
            "body": "This PR changes all instance type default value to systems certified by SAP.\r\n\r\nRecommendations found [here](https://www.sap.com/dmc/exp/2014-09-02-hana-hardware/enEN/iaas.html#) (Certified and supported SAP HANA Hardware Directory)\r\n\r\nI choose systems with filter `Clustering = yes`\r\n\r\n**AWS**:\r\n r3.8xlarge - [SAP Certified IaaS Platforms for AWS](https://www.sap.com/dmc/exp/2014-09-02-hana-hardware/enEN/iaas.html#categories=Amazon%20Web%20Services)\r\n\r\n**GCP**:\r\n n1-highmem-32 - [SAP Certified IaaS Platforms for GCP](https://www.sap.com/dmc/exp/2014-09-02-hana-hardware/enEN/iaas.html#categories=Google%20Cloud%20Platform)\r\n\r\n**Azure**: \r\nStandard_M128s - [SAP Certified IaaS Platforms for Azure](https://www.sap.com/dmc/exp/2014-09-02-hana-hardware/enEN/iaas.html#categories=Microsoft%20Azure)\r\n\r\nTODO:\r\n\r\n\r\n- [x] Waiting feedback about chosen instance type\r\n\r\n- [x] Update README to warn the user that instance type is configured for production, that means cost could be very expensive and should be change for testing purpose.",
            "comments": [
                "> @juadk Any objection with that. The webside says this anyway:\r\n> \r\n> ```\r\n> IaaS configurations for OLAP, OLTP and SAP Business One.\r\n> ```\r\n> \r\n> Is HANA among them?\r\n\r\nSorry for the delay, I didn't see notification about your comment...\r\nIIUC, HANA is included there, for example you can click on r3.8xlarge and have more details. You will find additional information [here](https://aws.amazon.com/fr/sap/solutions/saphana/) as well.",
                "@juadk We will merge `develop` branch to `master` as soon as some current PRs are merged.\r\nIs this PR ready to be merged and go to `master`?",
                "Code rebased and README updated, I think we are ready to merge this one.",
                "@juadk Any objection with that. The webside says this anyway:\r\n```\r\nIaaS configurations for OLAP, OLTP and SAP Business One.\r\n```\r\nIs HANA among them?",
                "LGTM",
                "LGTM",
                "@juadk Good from my side.\r\nIn the future we could change the `machine_type` to `instancetype` to be aligned, but not antyhing to worry about right now"
            ],
            "commits": [
                "9a5455f0e3e5c3fb9e8f2694208cd0977f20ce09"
            ]
        },
        "codes": [
            "unsure"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/SUSE/ha-sap-terraform-deployments/pull/184",
        "content": {
            "title": "Adapt pillars to disable ha_exporter by default",
            "body": "For automatic pillar enable if monitoring_enabled\r\n\r\nI'm testing this now\r\n\r\n(@stefanotorresi  added in CC just as a turist for moment but feel free to look even :) )\r\n\r\nfix #181 ",
            "comments": [
                "@MalloZup It looks good! (we could maybe implement it as one line code, but this is clear).\r\n\r\nJust one other request, could be do the same with the hanadb_exporter. We just need to update [pillar](https://github.com/SUSE/ha-sap-terraform-deployments/blob/master/pillar_examples/automatic/hana.sls) and make the same concept as you did here with the `exporter` entry. In hana it works a bit different. If the entry exist, the exporter is created, if it's not defined, it's not installed. Easy XD",
                "Great! I think it's good enough!",
                "tested with libvirt works fine",
                "@MalloZup Just one last comment.\r\nMaybe we should change the default value of this parameter here too: [variables.tf](https://github.com/SUSE/ha-sap-terraform-deployments/blob/master/libvirt/variables.tf#L122).\r\n\r\nI would say that the monitoring stack is an additional feature that shouldn't be deployed by default.\r\nTo need to change the `terraform.tfvars` file and set the value to True makes you understand better what you are doing.\r\nWhat do you think?",
                "done thx. Please remember to update then your main.tf and variables then. DOn't ping me if monitoring doesn't work ! since it will be disabled :grin: ",
                "> @MalloZup Just one last comment.\r\n> Maybe we should change the default value of this parameter here too: [variables.tf](https://github.com/SUSE/ha-sap-terraform-deployments/blob/master/libvirt/variables.tf#L122).\r\n> \r\n> I would say that the monitoring stack is an additional feature that shouldn't be deployed by default.\r\n> To need to change the `terraform.tfvars` file and set the value to True makes you understand better what you are doing.\r\n> What do you think?\r\n\r\nI agree, and I said that from the beginning... the nice thing is if the customer don't need monitoring, it will save him time and resources especially on cloud providers, because spinning out another instance costs money. Other than this, LGTM!",
                "ok I'm testing it with libvirt thx. I will merge once tests are ok",
                "> > @MalloZup Just one last comment.\r\n> > Maybe we should change the default value of this parameter here too: [variables.tf](https://github.com/SUSE/ha-sap-terraform-deployments/blob/master/libvirt/variables.tf#L122).\r\n> > I would say that the monitoring stack is an additional feature that shouldn't be deployed by default.\r\n> > To need to change the `terraform.tfvars` file and set the value to True makes you understand better what you are doing.\r\n> > What do you think?\r\n> \r\n> I agree, and I said that from the beginning... the nice thing is if the customer don't need monitoring, it will save him time and resources especially on cloud providers, because spinning out another instance costs money. Other than this, LGTM!\r\n\r\nSame for QA, It will save costs money for SUSE and time to deploy. Thx"
            ],
            "commits": [
                "ebc72a11aedc2c3c0537a9a5828afeb832149c99"
            ]
        },
        "codes": [
            "awareness",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/SUSE/ha-sap-terraform-deployments/pull/762",
        "content": {
            "title": "Change azure default iscsi vm size",
            "body": "SBD on ISCSI shouldn't need that big of a vm.",
            "comments": [
                "The follow up ticket should include all VM types.\r\nThe default size should be cost effective but supported/certified for HANA/Netweaver (where needed).",
                "Could we have a follow up ticket to expand this to the other cloud providers?"
            ],
            "commits": [
                "93ee12adde6ac773c76b590fe89c24df372f326b"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/SUSE/ha-sap-terraform-deployments/pull/455",
        "content": {
            "title": "Implement drbd module for AWS provider",
            "body": "I have some doubts with current change:\r\n\r\n1. I created the network resources: subnet, routes for drbd, is this fine or should it use the infrastructure resources?\r\n2. What should I set for the defaul drbd `instance_type` type and size?\r\n3. drbd `drbd_cluster_vip` should use the same subnet?\r\n4 drbd volume_size for block_device: setting a default size to 15 & harcoded the values for `root_block_device`\r\n\r\nPlease also verify these addresses calculations:\r\n -current `drbd_ips` calculation using the drbd_count in main.tf\r\n -`drbd_subnet_address_range` calculation in the infrastructure locals\r\n \r\nTo-do: \r\nUpdate/verify the grains entry to set in drbd salt provisioner\r\nadd logic to use drbd storage or aws efs\r\nupdate readme and doc",
            "comments": [
                "@Simranpal I did a first round of review. Check the comments please",
                "@Simranpal The implementation is taking a good shape!\r\nI think we only miss some small adjustments and efs storage proper implementation.\r\nGood job. Continue working",
                "@Simranpal More comments added.\r\nThins that are pending:\r\n- Add documentation about how to use EFS or DRBD storage\r\n- Add the outputs of DRBD in the main `outputs.tf` file\r\n- Add DRBD monitoring to the monitoring module if this exists",
                "@Simranpal The code looks fine. Just add some docu in `netweaver.md` and test with and without DRBD to see if we have not broken anything.\r\nGood job!",
                "@Simranpal Perfect! Thanks.\r\nIf all the tests are green this is ready to be merged!\r\nGreat job!",
                "LGTM, only one comment regarding the VM size.",
                "> * I created the network resources: subnet, routes for drbd, is this fine or should it use the infrastructure resources?\r\n\r\nIt would be better if DRBD use different subnet/routes than corosync(infrastructure resources), but it is fine to use the same network.\r\n\r\n> * What should I set for the defaul drbd `instance_type` type and size?\r\n\r\nAs the backing device of NFS share, i think the minimal/economic instance_type should be fine to DRBD. \r\n\r\nAbove are my two cents for reference.",
                "A question about the purpose of implementing DRBD. \r\nI thought AWS has its EFS service for file storage and initially decide to use this. Any reason or benefit to change to DRBD/NFS?",
                "@Simranpal More things.\r\n- We need to update the nfs share used by netweaver, so the logic would be: If we setup drbd, we use the nfs share created by drbd like in azure/gcp. otherwise use the efs share. So, the efs share creation must be optional. Maybe we have to move it to `infrastructure.tf` (most probably)\r\n- We need to document that usage\r\n- We need to update the pillar files (automatic folder) to make sure that drbd works\r\n- We need to change https://github.com/SUSE/ha-sap-terraform-deployments/blob/develop/salt/drbd_node/files/templates/drbd_cluster.j2 to use aws related resources\r\n\r\nWe can discuss this points online",
                "> A question about the purpose of implementing DRBD.\r\n> I thought AWS has its EFS service for file storage and initially decide to use this. Any reason or benefit to change to DRBD/NFS?\r\n\r\n@nick-wang This was requested by QA team, to have the option for using drbd inplace of efs",
                "@arbulu89 I wanted to get opinion on the logic for nfs share used by netweaver\r\n\r\n(`aws_efs_mount_target` needs the `file_system_id` from `aws_efs_mount_target` so these two resources are better together.)\r\n\r\n1. moving the EFS resouces to infrastructure\r\nThey need the `subnet_id` from nw subnet created in the nw module, which could be passed via nw module outputs. Then we can set and pass the `netweaver_nfs_share` variable with efs/nfs share value\r\n\r\n2. keep EFS resouces in nw module\r\nhere need to create EFS resources based on drbd_enabled variable(maybe add a new variable) and pass drbd nfs share variable, then choose in the salt provisioner between efs/nfs share\r\n\r\nI followed the 1st method first but the dependencies are more in that case, so I am planning to use the second approach now.",
                "> @arbulu89 I wanted to get opinion on the logic for nfs share used by netweaver\r\n> \r\n> (`aws_efs_mount_target` needs the `file_system_id` from `aws_efs_mount_target` so these two resources are better together.)\r\n> \r\n>     1. moving the EFS resouces to infrastructure\r\n>        They need the `subnet_id` from nw subnet created in the nw module, which could be passed via nw module outputs. Then we can set and pass the `netweaver_nfs_share` variable with efs/nfs share value\r\n> \r\n>     2. keep EFS resouces in nw module\r\n>        here need to create EFS resources based on drbd_enabled variable(maybe add a new variable) and pass drbd nfs share variable, then choose in the salt provisioner between efs/nfs share\r\n> \r\n> \r\n> I followed the 1st method first but the dependencies are more in that case, so I am planning to use the second approach now.\r\n\r\n@Simranpal , I see the issue. I would go with the next option:\r\nWe can just move the creation of the efs creation to `infrastructure.tf` and keep the mount targets in the netweaver module. This is a good idea, if for some reason, some customer wants to use an already existing EFS storage (because they share the storage for different deployments for example, and reduce costs). So in this case, we would only create the mounting points with the subnets. So we can implement the usage of an already existing EFS storage in the future would be super easy.\r\n\r\nWhat do you think?",
                "> @Simranpal The implementation is taking a good shape!\r\n> I think we only miss some small adjustments and efs storage proper implementation.\r\n> Good job. Continue working\r\n\r\nI have done the changes, and doing the testing. I faced issue with deployment, about subnets for hana, nw not matching instance addresses. it is not related to this changes, I will update after deployment is successful",
                "Hi @diegoakechi  @arbulu89, in AWS we are using the shared NFS share to store the NW installation software. Using DRBD, this means that the replicated disk might size around 30GB, is this an issue? I have been trying deployments today and it takes long time and deployment fails with the timeouts.\r\nShould we change the strategy and download the NW installation software to a local disk for all the nodes?"
            ],
            "commits": [
                "16c0055952e67041b0e4cd68578876899d84f2f9",
                "885e3f42de0a1d15596c47e2cb071e7760c75ea5",
                "f87d129dcc7d49f778cccc024a31f51d056a4430",
                "21aa0448b96fb95b6aadfc9a5d46853f3b56a58d",
                "90abdc26dd512d06c11b48a9ea437dca81cfc9c2",
                "f35d0f93530e6e20a7304cfa3cce41ce4ec77f56",
                "1a5135736fa74c72678ab5472237be8b65396f2f",
                "d4f65458898621e4ccd8b2dd1c54d633653d6f26",
                "83e447d1276debb3b94531a8ff772f73b87f42ef",
                "9d997957770de855bf35f29b13c7270730685454",
                "49eda2c11c06cc57cd0041077c9ff802e6fc298f",
                "67d1c2967a34961f6e9445ae6a38b5f320df92dc",
                "33551cd8d5c4f2cf206b2f43743d76d2a6031a8e"
            ]
        },
        "codes": [
            "unsure"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/SUSE/ha-sap-terraform-deployments/pull/173",
        "content": {
            "title": "Add option to set disk type and caching for HANA",
            "body": "When I was doing benchmark tests in Azure, I noticed that we don't use SSD as DATA disks in Azure like we are doing in other cloud providers.\r\n\r\nThis PR changes:\r\n\r\n- Default DATA disks from `Standard_LRS` to `StandardSSD_LRS`.\r\nDisk type could be set with `hana_data_disk_type` variable.\r\n\r\n- New variable `hana_data_disk_caching` added to manage data disk caching.\r\nCould be None, ReadOnly or ReadWrite (ReadWrite by default).",
            "comments": [
                "THX I'm not sure we need a variable, I mean in sake of minimalism perhaps we can just hardcode the values.\r\n\r\n I think that adding more variable we will loose control . I know that I was doubting which was the best approach but for me imho is better we just hardcode this STD value..s",
                "Just a small comment but LGTM",
                "retrospectively even if I contradict myself, I think it make more sense to just hardcode this values Because having variable add complexity and different behaviour from provider to provider.\r\n\r\nIn theory what we want in future would be to keep the difference between providers really low",
                "if we wanna do this, we need to add to all providers when applicable . thx",
                "feel free either to merge this and do follow-up PRs or just do everything in 1 pr as you wish",
                "> THX I'm not sure we need a variable, I mean in sake of minimalism perhaps we can just hardcode the values.\r\n\r\nHardcore doesn't let choice for customers, some people may want to use more cheaper HDD maybe.\r\n\r\n> I think that adding more variable we will loose control.\r\n\r\nI don't agree with this, at least I agree that thousand of variables is not so good, but we don't have so much here and this one is clearly important IMHO. And we should add the same for the other providers I think (to be consistent).",
                "> retrospectively even if I contradict myself, I think it make more sense to just hardcode this values Because having variable add complexity and different behaviour from provider to provider.\r\n> \r\n> In theory what we want in future would be to keep the difference between providers really low\r\n\r\nI understand your point of view but maybe this variable is more important than the others because it has a cost impact for the customer.",
                "OK I can see the value of this variable but just add to all providers right now, so we don't forget it. thx! ",
                "> feel free either to merge this and do follow-up PRs or just do everything in 1 pr as you wish\r\n\r\nI will do another one PR to standardize disks variables usage."
            ],
            "commits": [
                "ac0f73b2215bd6688c391edc9afbec8bfe403204"
            ]
        },
        "codes": [
            "storage",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/SUSE/ha-sap-terraform-deployments/pull/86",
        "content": {
            "title": "Feature/cost optimized",
            "body": "Add required new variables to enable the cost optimized scenario",
            "comments": [
                "It looks good to me!",
                "LGTM. Thanks @arbulu89 "
            ],
            "commits": [
                "0e69a9978eae9e3432de8f16c2ca1b38033c23a7",
                "948727c5b1e87b970a7a9dee4cd67bb84d19abf8"
            ]
        },
        "codes": [
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/SUSE/ha-sap-terraform-deployments/pull/116",
        "content": {
            "title": "move to terraform 12",
            "body": "# Description:\r\n\r\nMigrate to terraform 12 syntax. Start with the modules of libvirt then do the rest ( I might check if other providers require some work @ldevulder cc)\r\n\r\n# Todos:\r\n\r\n- [x] libvirt\r\n    - [X]   SBD as shared disk\r\n    - [x]   SBD using ISCSI server\r\n     -[X]   With and without monitoring VM\r\n\r\n- [x] remove syslink from all providers\r\n     - [x] update documentation \r\n\r\n- [x]    Cloud providers:\r\n     - [x] gcp \r\n     - [x] azure\r\n     - [x] aws\r\n\r\n- [x] fix travis\r\n- [ ] fix Jenkins CI\r\n     - [ ] update pkg to terraform v12\r\n- [x] final tests\r\n\r\n",
            "comments": [
                "So far, and without knowing any defail about the t12 changes, the PR looks logical and well structured.\r\nI have added some few comments in changes that I have some doubts",
                "Glanced over the READMEs, but did have a good look at the configuration files. A couple of comments/questions.\r\n\r\nWill be testing with SLES for SAP Applications 12-SP5 Beta4 in all PC providers shortly.",
                "I'm wating with this because , i need to fix the monitoring part otherwise i iwill have conflicts in this when monitoring pr merged",
                "AWS, GCP and Azure work very well with terraform v0.12 for the salt deployment (12SP5 images used with salt-minion included)\r\n",
                "Tested yesterday with Azure and worked fine!",
                "@alvarocarvajald  I'm merging this since we need Terraform12 for end of this week.\r\n\r\nI have already tested mysefl and with help of @juadk and @diegoakechi  already on all cloud providers and worked fine.\r\n\r\nFeel free to continue your tests. For any feedback , feel free to open issue or write me here so I can adress later on. we can still improve some small things later. thx!\r\n\r\n:+1: \r\n",
                "I'm done testing with GCP, but still not done with the rest of the PC providers.\r\n\r\nI would really expect that this doesn't happen often, as this repo is also used for automated QA testing, so we require the current master to be always stable. I'm not saying it isn't ATM, but looking at the PR, there's not a single approval from QA yet. On top of that, this was a BV week for SLES 12-SP5 Beta4, so having the constraint that this needed to be merged **this week** is not very much in sync with QA's priorities for the week.\r\n\r\nRegarding my tests, let me at least add what I have so far:\r\n\r\nTested with terraform v0.12.6 and SLES for SAP Applications 12-SP5 Beta4.\r\n\r\nFor GCP used:\r\n\r\n```\r\n+ provider.google v2.13.0\r\n+ provider.null v2.1.2\r\n+ provider.template v2.1.2\r\n```\r\n\r\nTests:\r\n\r\n1. GCP with `init_type = \"skip-hana\"`: works as expected\r\n2. GCP with `init_type = \"all\"`: works as expected\r\n3. GCP with `scenario_type = \"cost-optimized\"`: node 2 failed to start Hana. First error message status was:\r\n\r\n```\r\nComment: Error running hana command: su -lc \"HDB start\" prdadm\r\n```\r\n\r\nHave the `/tmp/provisioning.log` of failed node if needed.\r\n\r\n4. GCP with `scenario_type = \"performance-optimized\"`: works as expected\r\n5. AWS with `init_type = \"skip-hana\"`: pending.\r\n6. AWS with `init_type = \"all\"`: pending.\r\n7. AWS with `scenario_type = \"cost-optimized\"`: will skip\r\n8. AWS with `scenario_type = \"performance-optimized\"`: will skip\r\n9. Azure with `init_type = \"skip-hana\"`: pending.\r\n10. Azure with `init_type = \"all\"`: pending.\r\n11. Azure with `scenario_type = \"cost-optimized\"`: will skip\r\n12. Azure with `scenario_type = \"performance-optimized\"`: will skip\r\n13. terraform.tfvars.example in all providers has a syntax error on a commented line. This can lead to confusion and errors like this one:\r\n\r\n```\r\nError: Argument or block definition required\r\n\r\n  on terraform.tfvars line 76:\r\n  76: scenario_type: \"performance-optimized\"\r\n\r\nAn argument or block definition is required here. To set an argument, use the\r\nequals sign \"=\" to introduce the argument value.\r\n```\r\n\r\nI thought this could also have been fixed in this same PR, but I guess you can fix this later.\r\n\r\nOverall conclusions:\r\n\r\n* I don't think this PR should introduce a variable for `scenario_type` unless all valid scenarios are working. As it is, if the cost optimized scenario is not working (in GCP at least), this should work in performance optimized until everything is ready for cost optimized.\r\n* On the same issue, I'm guessing the default scenario type is performance optimized basically because that one worked out of the box. Didn't see anything in the documentation that makes that clearer, and the example in `terraform.tfvars.example` seems to imply that cost optimized is the default.\r\n* A `provisioner` variable was introduced, but the only available provisioner is `salt` and the shell-based configuration was removed. Will this be reintroduced later?",
                "@alvarocarvajald  thx for feedback. I have introduced the terraform v11 tag before this for assuring we don't have any breakages: https://github.com/SUSE/ha-sap-terraform-deployments/releases/tag/v1.5.0. or we have also a `backward` compatiblitty.\r\n\r\nThe quality of the project and other projects has been always my concern. Regarding this PR, I have waited 2 weeks and during this week I have tested with @juadk and others on the cloud providers. \r\n\r\nThis way of doing things,  will not happen anymore, this was because the Terraform v12 update is disruptive and we don't want to wait to much with other things on pending. As I stated before, my aims is to have a full collaborative environment and you can see it on my actions, I always put QA as reviewers because I think your feedback is valuable and are part of the team. \r\nOn the other-side, I need to make things happening with a good quality and deadlines, so I couldn't stay blocked to much with this PR, because other things are depending on this and this was working already I hope you have understanding for this\r\n\r\nthx!"
            ],
            "commits": [
                "6295279dffd38a5c5e3176f857a9941a33cc70f3",
                "1ee509fed83de98d8db805453d3ec224b8c7d607",
                "6896fdcaa8818edc66da2dcf5d3a896e8db0cb4f",
                "1d9e1535e40ea87ee95d2e4482a6fae642aaa4c7",
                "39e47882cf32c9b3c312d78637a6dd75a5468800",
                "6c4530c42de0f228cf165e1539e916fb874100df",
                "dd80652a3b882a8a8e61f7d00b6a9ec874d4e595",
                "b14aee4e4893a701a3ad979dabcee15a813d8ad5",
                "4873066a74f41c7ff5286f386c32c8400b429675",
                "ce37b7c31d822d18612e05c2bb121769447af9eb",
                "30a2fd6573fffa0b2c9ba6cf82333c54cbe983a1",
                "393823981cebf8b052fdacf4d79ddf5bd8b0e25c",
                "c5123510cfc3f818290fc84c6f288310ac2cb713",
                "b7f5647b4bbed655918885f05d0e48f7ee40442f",
                "001470e4c2de43fc9f54e0a2856bb2fa21e9ce5f",
                "81261f8ecbfc55f3c30d316fb64f25f51bc3f744",
                "6629e055b53096252afdf2623e3810aef819fda4",
                "1027e3927e81a3e5c3e5f635b0de99b891761b97",
                "6b4e7aac317cc0ac98c855059e0dcb11c68efc20"
            ]
        },
        "codes": [
            "unsure"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/cisagov/cool-assessment-terraform/pull/148",
        "content": {
            "title": "Upgrade volumes to gp3",
            "body": "## \ud83d\udde3 Description ##\r\n\r\nThis pull request:\r\n- Upgrades disk volume types to gp3\r\n- Removes the `delete_on_termination = true` line from `root_block_device` blocks since that is already the default\r\n\r\n## \ud83d\udcad Motivation and context ##\r\n\r\ngp3 is 20% cheaper, and the baseline configuration offers better performance than gp2 for volumes smaller than 2TB.  It also allows the volume size and IOPS to be configured separately, whereas the two are intertwined with gp2.\r\n\r\nAlso note that the volume upgrades are done in place by Terraform, so this change does not result in any instance replacements that must be worked around to avoid disrupting running assessments.\r\n\r\n## \ud83e\uddea Testing ##\r\n\r\nI successfully applied these changes to env1 in our staging COOL environment.\r\n\r\n## \u2705 Checklist ##\r\n\r\n- [x] This PR has an informative and human-readable title.\r\n- [x] Changes are limited to a single goal - _eschew scope creep!_\r\n- [x] All relevant type-of-change labels have been added.\r\n- [x] I have read the [CONTRIBUTING](../blob/develop/CONTRIBUTING.md) document.\r\n- [x] These code changes follow [cisagov code standards](https://github.com/cisagov/development-guide).\r\n- [x] All new and existing tests pass.\r\n",
            "comments": [
                "Nifty!",
                "Please enjoy all of my attribute order suggestions \ud83c\udf7b",
                "You sure did merge my suggestions right as I was suggesting them x)"
            ],
            "commits": [
                "3138943ab4d15cc256d322e1128862ef11383c73",
                "9fe6b9859adb7c4d17b27923c38949dc9b652640",
                "fcdd38b0e6c56c35effe1e4bda52454b2a5ab9d6"
            ]
        },
        "codes": [
            "storage",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/cloud-gov/cg-provision/pull/1639",
        "content": {
            "title": "Waf labels",
            "body": "## Changes proposed in this pull request:\r\n- Update logic to allow more then one host for waf label and waf log drop\r\n- update logic on app listener rule to route this traffic to separate router group\r\n\r\n## Notes\r\nThis allows internal CUPs apps from customers to bypass WAF CloudWatch logging to save on logging costs as well as shift this workload off the main routers\r\n\r\nThanks to @markdboyd for the assist.\r\n\r\n## security considerations\r\nn/a\r\n",
            "comments": [],
            "commits": [
                "0faae91f7159f8d5dac6e65b96ac188e03281f0f",
                "ffe9b41690b084cca5bbedcccc8de4a80055d98c",
                "29c9d0a6ed5b03554d0915c8897ecb6f85cf97d8",
                "1b2bc3d7f15695daac6ac218f65f008cc09d8d2c",
                "09fb550e1439e64ef18fbdc23bb867290a538964",
                "ffed4faa3efd8629a194a5e135648b922288ac87",
                "2d71ed28d1d1499276cd818affa387e017696374",
                "3c0be62c189bd4c946ed57d6ca6da0330a312e9d",
                "531d77a0b0fd72b48b2c891193ff5d45fb14f4f1",
                "cda1eecdd6fb68e0b4bd48e81d9996e18e679da2",
                "9749dea474f3709c79ba9252615162269a4a2062",
                "afc8fb9d4d6e0964d3c04bbda06ad1fc00f2597e",
                "78a0a34ec27d1cce6048c1878b116254e07a5d51",
                "f3b48f6269b09ebcc8f98fa5ead774fcdd44a486",
                "9f6ef29e06e22b6ad069e6d0d1a013690a3499e5",
                "7445a7fef744f098d49227279fc08ff41069bfa1"
            ]
        },
        "codes": [
            "saving",
            "feature"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/cloud-gov/cg-provision/pull/1183",
        "content": {
            "title": "Add default tags",
            "body": "## Changes proposed in this pull request:\r\n\r\n- Add default tags to all AWS provider blocks: https://developer.hashicorp.com/terraform/tutorials/aws/aws-default-tags\r\n\r\nThese changes should ensure that all of our resources are tagged on deployment, which should then make doing cost rollups easier\r\n\r\n## security considerations\r\n\r\nNone, just adding resource tags\r\n",
            "comments": [],
            "commits": [
                "b1d84d4cc0f1e490e391084a90ccb83e7e4484b2",
                "8bd987a48c6f28d24dbe811ffdcf0d023e277010",
                "c42d52d3a7f58c19120100c3c72042038d78035a"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/cloud-gov/cg-provision/pull/1132",
        "content": {
            "title": "update lifecycle rules for log storage tiers",
            "body": "## Changes proposed in this pull request:\r\n\r\n- Update storage lifecycle for buckets created by `log_encrypted_bucket` module to:\r\n  - 0 - 3 months: s3 standard\r\n  - 3 - 12 months: glacier instant retrieval\r\n  - 12 - 30 months: glacier deep\r\n  - 30 months: delete\r\n\r\n## security considerations\r\n\r\nNone, just changing storage tiers and optimizing costs\r\n",
            "comments": [
                "You about gave me a heart attack. I think it's 12-30 months of glacier\ndeep, the deletion at 30 months, per m-21-31. But it doesn't look like\nyou've implemented deletion yet (whew)!\n\nOn Thu, Sep 29, 2022 at 2:02 PM Mark Boyd ***@***.***> wrote:\n\n> Merged #1132 <https://github.com/cloud-gov/cg-provision/pull/1132> into\n> main.\n>\n> \u2014\n> Reply to this email directly, view it on GitHub\n> <https://github.com/cloud-gov/cg-provision/pull/1132#event-7489189321>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAJHWCXZBTA7CPCSZDOKEGDWAXKSRANCNFSM6AAAAAAQZACGW4>\n> .\n> You are receiving this because your review was requested.Message ID:\n> ***@***.***>\n>\n\n\n-- \n-\n*Peter Burkholder |  *\n*cloud.gov <https://cloud.gov> ISSO, compliance & security lead*\nplease use ***@***.*** for cloud.gov matters\n\n*202-709-2028 <(202)%20209-2028> | ***@***.***\n***@***.***> *\n\n*| pronouns he-him <https://www.mypronouns.org/he-him>*\n*Free/Busy Calendar\n***@***.***>*\n",
                "@pburkholder Actually we have implemented the deletion, but it's driven by a variable:\r\n\r\nhttps://github.com/cloud-gov/cg-provision/blob/main/terraform/modules/s3_bucket/log_encrypted_bucket/log_encrypted_bucket.tf#L45-L49\r\n\r\nAnd you can see that used here:\r\n\r\nhttps://github.com/cloud-gov/cg-provision/blob/7bc9e186cd514e6ce5ae85c16cb111c632e4a178/terraform/modules/cloudfoundry/buckets.tf#L29\r\n\r\nAnd here:\r\n\r\nhttps://github.com/cloud-gov/cg-provision/blob/fa5de4812f9e7f7a6d6b23d79b0da4e3a992c2c1/terraform/modules/dns_logging/resolver_logging.tf\r\n\r\nSo we aren't configured to delete logs until 30 months+. Sorry for the typo in the original PR description"
            ],
            "commits": [
                "9b79bf91d71fba285d219b8c5960e781078696bc"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-infrastructure/pull/904",
        "content": {
            "title": "Add Grafana Tempo for distributed tracing",
            "body": "This adds Terraform to deploy the Grafana Tempo helm chart (a distributed tracing tool) in to our EKS clusters. It has Terraform to create the relevant S3 bucket and IAM Role (used as the backing store).\r\n\r\nGrafana Tempo integrates with our existing Grafana UI and is relative cheap/simple to run compared to other tracing tools (e.g. Jaeger/Zipkin/Sentry). Running it will allow us to better evaluate the value we get from tracing tools, and specifically if Tempo is the correct tool for us.\r\n\r\nTo send traces OpenTelemetry instrumentation need to be added/enabled to applications. We've shipped support for [OpenTelemetry instrumentation in govuk_app_config](https://github.com/alphagov/govuk_app_config/pull/303). This has been enabled and tested in integration.",
            "comments": [
                "Cool!"
            ],
            "commits": [
                "4e56ccf375072fe740df82b2fe4a6a9f98f56f1c",
                "b7dd20f1e0606c2be29fd0e358809deef59df448",
                "c6e250928547ba4ed7630ac66e917eee68232cf8"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-infrastructure/pull/894",
        "content": {
            "title": "Reduce Argo CD logspew + update to latest point release.",
            "body": "Argo CD notifications-controller and repo-server are quite noisy at `loglevel=info` and are the 9th and 10th noisiest workloads in the integration environment (19th and 20th in production). We don't need these info logs so let's not pay to store them. This should help towards getting us back under our log quota in LogIt.\r\n\r\nAlso set the log format to JSON so that the logs are easier to search.\r\n\r\nTested: running in integration.",
            "comments": [],
            "commits": [
                "c1d68d529c798ef52b6535683f6ac20b31b585f9",
                "3386d7637c06f84cc3cc252f96d43e511cea428e"
            ]
        },
        "codes": [
            "saving",
            "feature",
            "storage"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-infrastructure/pull/844",
        "content": {
            "title": "Productionise Prometheus/Alertmanager config.",
            "body": "- Enable the kube-prometheus-stack chart's default PodDisruptionBudget for Prometheus and Alertmanager. The default is `minAvailable: 1`, which is fine.\r\n- Set pod anti-affinity for Prometheus and Alertmanager so they can't end up with multiple replicas on the same node.\r\n- Increase Prometheus metrics rentention from 10 days to 90 days and set the sampling (and eval) interval to 1 minute.\r\n- Enable the use of ServiceMonitors and Probes in any namespace, like we already do for PodMonitors.\r\n- Fix a weird variable name.\r\n\r\nWe only want PDB and anti-affinity where we're running more than one replica, i.e. in staging and production.",
            "comments": [
                "OK"
            ],
            "commits": [
                "42823f4e3abcd728d864707a469e5fe1499d7d74",
                "ad7bb901064c0432ba6d97ca196e12c23e8b4d3d",
                "ecb92006986d9e940a96bfcc48b86e604ebe24a2",
                "9c462ddd453f249c8790818ea3407fe989bee985",
                "70af54f6530e873c979ccbcd3aaa3340bcba06a9"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-infrastructure/pull/502",
        "content": {
            "title": "Give the EKS environment its own frontend memcache.",
            "body": "We can't share the Frontend memcache with the EC2 environments, because Frontend uses it to cache rendered HTML which contains links to Rails assets. My mistake \ud83e\udd26\r\n\r\nAlso:\r\n\r\n- Tweak the config for the shared Redis while we're there; it's very similar to the memcache one so let's make the two consistent.\r\n- Remove the defaults for instance types and added those vars to the per-environment `.tfvars`, to make it less likely that we'll forget to set them appropriately when adding staging and prod.\r\n- Hardcode the standard ports for Redis and memcached; we'd never want to run them on nonstandard ports so on balance it's cleaner to get rid of the module variable and save on interface clutter.\r\n- Use a slightly smaller and cheaper instance type for Redis.\r\n- Use provider default tags to simplify tagging the Redis cluster and associated resources. Saves the repeated boilerplate merge on every tagged resource.\r\n\r\nTested: applied successfully in the test account. Clusters/instances show up healthy in the AWS web console.",
            "comments": [
                "Looks good, just some minor comments.",
                "Added those few extra bits to the description for posterity \ud83d\udc4d "
            ],
            "commits": [
                "a51a3bfcd73fd55ecd43aa36ce3f266f0cefc2dc"
            ]
        },
        "codes": [
            "saving",
            "instance",
            "feature"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-infrastructure/pull/1023",
        "content": {
            "title": "Upsize the Sidekiq Redis in staging.",
            "body": "- Use r6g.large (13 GiB) for staging instead of t4g.medium (3 GiB).\r\n- Don't bother with standby instances in nonprod \u2014 not worth it at all. Offsets some of the cost of the bigger instance in staging.\r\n\r\nThis makes staging 50% the size of prod instead of ~10%, so it should serve as a more useful canary for some of the large one-off jobs that have been going on recently.\r\n\r\nAlready applied.",
            "comments": [],
            "commits": [
                "9d0aa043e67d99d121c85ea8dbc2976c77d1329a"
            ]
        },
        "codes": [
            "instance",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-infrastructure/pull/900",
        "content": {
            "title": "Update kube-prometheus-stack and drop some unused high-cardinality metrics.",
            "body": "- Update kube-prometheus-stack to the latest minor release.\r\n- Stop scraping kube-apiserver, which it turns out is surprisingly expensive and we were only doing because it's enabled by default in kube-prometheus-stack. We're not actually using any of those metrics.\r\n\r\n```\r\nk -n monitoring exec sts/prometheus-kube-prometheus-stack-prometheus -- \\\r\n    promtool tsdb analyze /prometheus\r\n...\r\nHighest cardinality metric names:\r\n11682 apiserver_request_slo_duration_seconds_bucket\r\n8015 http_request_duration_seconds\r\n7992 router_backend_handler_response_duration_seconds_bucket\r\n7510 apiserver_request_duration_seconds_bucket\r\n6875 http_request_queue_duration_seconds\r\n6844 container_memory_failures_total\r\n5664 etcd_request_duration_seconds_bucket\r\n4641 grpc_server_handled_total\r\n4360 kube_pod_status_phase\r\n4360 kube_pod_status_reason\r\n3616 apiserver_response_sizes_bucket\r\n```\r\n\r\nTested: applied in staging.",
            "comments": [
                "LGTM"
            ],
            "commits": [
                "e60eb14bb7e7a9bbe2bb27a4f99d67ca7a1a6a65",
                "6017d0be84adac6b90b46f3d0bc2376a7e9b8e85"
            ]
        },
        "codes": [
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-infrastructure/pull/409",
        "content": {
            "title": "Naming and tagging improvements",
            "body": "* Add a workaround for the default tags not being applied to the cluster nodes and the managed node group ASG.\r\n* Include the cluster name in all the resources created by the `cluster-infrastructure` module.\r\n* Make it possible to pass in an alternative name for the cluster to the `cluster-infrastructure` module.\r\n\r\nMore detail in the commit messages.\r\n\r\nI was resistant to the idea of using TF workspaces this time around, since the experience with the ECS project was rather expensive and painful - but having actually tried it, it's quite a bit simpler this time around. I've intentionally avoided any references to `terraform.workspace` in the code, because that was a significant factor in the testing/maintenance headache last time around.\r\n\r\nUsage (for now) is like this:\r\n\r\n```\r\ntf workspace new $USER\r\ntf apply \\\r\n        -var-file=../variables/test/common.tfvars \\\r\n        -var cluster_name=$USER\r\ntf destroy \\\r\n        -var-file=../variables/test/common.tfvars \\\r\n        -var cluster_name=$USER\r\n```\r\n\r\nOnce the VPC stuff is merged (and therefore the cluster has its own subnets), you'll also need a local vars file with a unique set of subnets so as not to overlap with the main test cluster (and can of course put the `cluster_name=$you` in there as well).\r\n\r\nI propose that we don't continuously deploy anything other than the main (default) workspace; that's a big maintenance headache (not to mention significant AWS resource cost) and I don't think it provides any value since the CD pipeline itself is dead simple. Testing with tf init / plan / apply is sufficient for occasional TF changes when we don't want to take down the test cluster for whatever reason, and changes to the CD pipeline itself can just be tested on the test pipeline (which is really what it's for).\r\n\r\nTested: been running this for a couple of days now on a separate workspace. See below for TF plan (the `terraform-plan-cluster-infrastructure` check).\r\n\r\n[Trello card](https://trello.com/c/mtzlqNa5/622)",
            "comments": [
                "Looks good, just a question about whether we need to namespace the cluster-infra resources by workspace/cluster too.",
                "Great work \ud83c\udf89 "
            ],
            "commits": [
                "7ccc4aee0a72cbabab2b8d5efd000584e47885dd",
                "6ec29bb2d2cee1b2f019346b839f9b52cfbd73ab"
            ]
        },
        "codes": [
            "unsure"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-infrastructure/pull/729",
        "content": {
            "title": "Fix size and AZ diversity of redis/memcache in production.",
            "body": "See commits for more details.\r\n\r\n* Fix sizes of memcached and redis in prod. Not setting them the same in staging at this time, because they're expensive (and we don't have any evidence to justify turning up yet more big, hardly-utilised storage clusters in staging).\r\n* Enable multi-AZ for the redis cluster in prod.",
            "comments": [],
            "commits": [
                "a0b35559820aaceaa64fb883e4ffa35c9353c6fb",
                "1ebfdf3a9077b37bb2470bfdeb5a0dcc3f4fb58c"
            ]
        },
        "codes": [
            "storage",
            "cluster",
            "feature",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-infrastructure/pull/608",
        "content": {
            "title": "Add k8s resources to Argo Workflows components",
            "body": "There are 3 types of Argo Workflows components: controller, server\r\nand executor where k8s resources can be set. They seem to have\r\ntheir default values removed from the [Helm chart](https://github.com/argoproj/argo-helm/blob/master/charts/argo-workflows/values.yaml)\r\n\r\nThe values are added back and were obtained from [here](https://argoproj.github.io/argo-workflows/cost-optimisation/)\r\n\r\nRef:\r\n1. [trello card](https://trello.com/c/54xe0QEk/892-add-resource-limits-to-workflow-and-job-pods)",
            "comments": [],
            "commits": [
                "ee2b2286a02d49c7e9992d0a39ce950583e16bb7"
            ]
        },
        "codes": [
            "unsure"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-infrastructure/pull/78",
        "content": {
            "title": "Enable envoy access logs for all apps",
            "body": "As described in the AWS docs on AppMesh \"Observability\":\r\n\r\nhttps://docs.aws.amazon.com/app-mesh/latest/userguide/observability.html\r\n\r\n> When you send Envoy access logs to /dev/stdout, they are mixed in with\r\n> the Envoy container logs. You can export them to a log storage and\r\n> processing service like CloudWatch Logs using standard Docker log\r\n> drivers such as awslogs. For more information, see Using the awslogs Log\r\n> Driver in the Amazon ECS Developer Guide. To export only the Envoy\r\n> access logs (and ignore the other Envoy container logs), you can set the\r\n> ENVOY_LOG_LEVEL to off. For more information, see Access logging in the\r\n> Envoy documentation.\r\n\r\nIt's possible that this approach would get expensive at\r\nproduction-levels of traffic. I think it's worth doing for now though,\r\nas it might help use troubleshoot issues while we're developing.",
            "comments": [
                "Example query for CloudWatch Insights:\r\n\r\n```\r\nfilter @message like /^\\[.*\\] \"[A-Z]+ \\//\r\n| parse @message '[*] \"* * *\" * * * * * * \"*\" \"*\" \"*\" \"*\" \"*\"' as StartTime, Method, Path, Protocol, ResponseCode, ResponseFlags, BytesReceived, BytesSent, DurationMillis, UpstreamServiceTimeMillis, ForwardedFor, UserAgent, RequestId, Authority, UpstreamHost\r\n```\r\n\r\n[Link for those with access to the AWS Console](https://eu-west-1.console.aws.amazon.com/cloudwatch/home?region=eu-west-1#logsV2:logs-insights$3FqueryDetail$3D$257E$2528end$257E0$257Estart$257E-3600$257EtimeType$257E$2527RELATIVE$257Eunit$257E$2527seconds$257EeditorString$257E$2527filter*20*40message*20like*20*2f*5e*5c*5b.*2a*5c*5d*20*22*5bA-Z*5d*2b*20*5c*2f*2f*0a*7c*20parse*20*40message*20*27*5b*2a*5d*20*22*2a*20*2a*20*2a*22*20*2a*20*2a*20*2a*20*2a*20*2a*20*2a*20*22*2a*22*20*22*2a*22*20*22*2a*22*20*22*2a*22*20*22*2a*22*27*20as*20StartTime*2c*20Method*2c*20Path*2c*20Protocol*2c*20ResponseCode*2c*20ResponseFlags*2c*20BytesReceived*2c*20BytesSent*2c*20DurationMillis*2c*20UpstreamServiceTimeMillis*2c*20ForwardedFor*2c*20UserAgent*2c*20RequestId*2c*20Authority*2c*20UpstreamHost$257EisLiveTail$257Efalse$257EqueryId$257E$25270ba517e8-c585-4578-8204-31e9044145d1$257Esource$257E$2528$257E$2527awslogs-fargate$2529$2529)",
                "Thanks for fixing this! Amazon never ceases to surprise! \ud83d\ude02 "
            ],
            "commits": [
                "8475fbe51281a76757f7046c6c591056db182286"
            ]
        },
        "codes": [
            "awareness",
            "feature"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-infrastructure/pull/898",
        "content": {
            "title": "Avoid logging healthcheck requests to Logit.",
            "body": "These are a non-negligible fraction of log traffic and they just clutter up query results (or complicate queries by trying to exclude them), so let's not pay for the inconvenience.\r\n\r\nThis won't stop us debugging healthchecks if we ever need to; it's easier to look directly at `kubectl log` etc. for that because it's real-time.\r\n\r\nAlso switch from the nasty HCL-encoded YAML to plain YAML for representing the Filebeat config. (Separate commit for ease of reviewing.)\r\n\r\nTested: applied in staging.",
            "comments": [
                "Hm I think I may have fluffed my test queries on this one, it doesn't look like it's actually dropping any records after all. I'll see if I can fix it."
            ],
            "commits": [
                "3282086624dc272a47f01bccedbccae4fe638e81"
            ]
        },
        "codes": [
            "saving",
            "feature"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/alphagov/govuk-infrastructure/pull/876",
        "content": {
            "title": "Bump Redis cluster to large in integration",
            "body": "The old redis instance before migration was a [cache.r4.large](https://github.com/alphagov/govuk-aws/blob/main/terraform/projects/app-backend-redis/main.tf#L31). We are bumping the size of this instance to be at least a large so we can run tasks on integration without maxing out the CPU.",
            "comments": [
                "We can figure out whatever nonsense is going on in integration later and just live with even more hilarious utilization stats in the meantime \ud83d\ude43",
                "Rolling this out now (it'll drop everything in that Redis)",
                "Thanks Chris!\r\n\r\nMy theory is that our redis usage is extremely spikey, because of its use by Sidekiq as a queue. The vast majority of the time it sits there at close to 0% CPU and memory, but once in a while we'll have a publishing event which causes a storm of queued events. With the particular usage pattern we have in the Integration environment, this is enough to cause resource starvation on small / medium instances. I think large should be roughly the right size, because it was large before we attempted to right-size it with the replatforming release.\r\n\r\nThe total cost of the instance (even at on demand prices) is around $1300/year ($0.149 * 24 * 365), so while it's not completely insignificant it's not worth spending significant engineering time on.\r\n\r\nThere's also the separate consideration of whether sharing this redis instance between apps is a good idea. If it was a pure cache, I think it would be fine to share. But as it's used for lots of other things (user sessions, queues), and as we've seen a couple of examples of it running out of resources and causing multiple simultaneous failures in dependent apps, I think there's a strong case to be made for separating it out (either by app, or by usage, or both).\r\n",
                "Yeah I see where you're coming from and I agree with this change, but I think we need to be careful about drawing general conclusions on these things like we did with the RDS stuff (which turned out very poorly indeed).\r\n\r\nTo my mind, the convincing argument for chucking resources at this is that we're choosing to live with the funky dual-use of integration for user training. Otherwise there'd be a ton of benefit in catching these spiky usage issues in integration so that prod becomes more robust.",
                "Maxing out the CPU isn't a bad thing in itself. Is there a particular thing that you're trying to make faster with this change?",
                "Approving anyway cos I don't want to hold you up if you really need this, but please do check! :)",
                "Ugh let's do this."
            ],
            "commits": [
                "9c3e76fdf5a8254521d04f98d8cfd8da9792082b"
            ]
        },
        "codes": [
            "instance",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/companieshouse/ceu-terraform/pull/43",
        "content": {
            "title": "Removing SNS and alarm actions from Development account as unnecessary cost",
            "body": null,
            "comments": [],
            "commits": [
                "8733c7f4d1b395d6a8e236d0106cfae56d4ded06"
            ]
        },
        "codes": [
            "saving",
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/poseidon/typhoon/pull/1072",
        "content": {
            "title": "Switch FCOS workers to official Fedora CoreOS AMIs",
            "body": "* Fix worker nodes to use official Fedora CoreOS AMIs, instead of the older Poseidon built AMIs (now removed).\r\nThis should have been part of #1038, but was missed in code review\r\n* Poseidon build AMIs have been deleted (so I don't have to keep paying to host them for people)",
            "comments": [
                "This only related to ARM64. AMD64 was never affected"
            ],
            "commits": [
                "85252dec6ed7f0b24517089150ec89bf32b45fb2"
            ]
        },
        "codes": [
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/poseidon/typhoon/pull/312",
        "content": {
            "title": "Raise scheduler/controller-manager replicas in multi-master",
            "body": "* Continue to ensure scheduler and controller-manager run at least two replicas to support performing kubectl edits on single-master clusters (no change)\r\n* For multi-master clusters, set scheduler / controller-manager replica count to the number of masters (e.g. a 3-master cluster previously used replicas:2, now replicas:3)\r\n\r\nMotivation:\r\n\r\n`kube-apiserver` has always been run as a DaemonSet across controllers to provide high availability, but `scheduler` and `controller-manager` were always run with replicas 2 (sufficient to support kubectl edits of the control plane without downtime). But if a cluster is running multiple controller nodes, we might as well run a higher replica count, tending toward one per node (users are paying for the nodes either way).",
            "comments": [],
            "commits": [
                "43fe78a2cc0817e8bc1a8e29ed9bdc22611c5372"
            ]
        },
        "codes": [
            "cluster",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/poseidon/typhoon/pull/249",
        "content": {
            "title": " Combine AWS NLBs to use one NLB per cluster",
            "body": "* Reduce cost by ~$18/month per cluster. Typhoon AWs clusters now use one network load balancer\r\n* Listen for apiserver traffic on port 6443 and forward to controllers (with healthy apiserver)\r\n* Listen for ingress traffic on ports 80/443 and forward to workers (with healthy ingress controller)\r\n\r\n#### Affect on Ingress\r\n\r\n* Users may keep using CNAME records to `ingress_dns_name` and the `nginx-ingress` addon for Ingress (up to a few million RPS)\r\n* Users with heavy traffic (many million RPS) should create a separate NLB(s) for Ingress instead\r\n* Output worker http and https target groups to allow for custom load balancing\r\n\r\n#### Affect on Worker Pools\r\n\r\n* Worker pools no longer include an extraneous network load balancer\r\n\r\nOverall, there are no changes to variables or outputs. Typhoon AWS clusters support the same features as before, but are cheaper to run. \r\n\r\nMade possible by moving kube-apiserver from 443 to 6443 in https://github.com/poseidon/typhoon/pull/248",
            "comments": [],
            "commits": [
                "316f06df06a8c7660020babc5df96d1dea468f13"
            ]
        },
        "codes": [
            "saving",
            "cluster"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/poseidon/typhoon/pull/248",
        "content": {
            "title": "Change apiserver port from 443 to 6443 (except GCP)",
            "body": "* Change load balancers, firewall rules, security groups, and generated kubeconfig's",
            "comments": [
                "Bare-metal, DigitalOcean, and AWS work fine. Google Cloud doesn't if 6443 is used. Their TCP proxy only supports a limited set of special ports, which is unreasonable.\r\n\r\n> TCP Proxy Load Balancing supports the following ports: 25, 43, 110, 143, 195, 443, 465, 587, 700, 993, 995, 1883, 5222",
                "For now, I'll have Google Cloud stick with 443. All the rest will make the switch to 6443. Some time later, I'll get Google Cloud to make the switch too or a switch to some high port.\r\n\r\nAs a downside, this means kube-apiserver will continue to have root for a while longer."
            ],
            "commits": [
                "6c5a1964aadbb3d23a1c6c6b99cf8c44b763b21f"
            ]
        },
        "codes": [
            "unrelated",
            "note"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/poseidon/typhoon/pull/365",
        "content": {
            "title": "Change AWS default type from t2.small to t3.small",
            "body": "T3 is the next generation general purpose burstable instance type. Compared with t2.small, the t3.small is cheaper, has 2 vCPU (instead of 1) and provides 5 Gbps of pod-to-pod bandwidth (instead of 1 Gbps)\r\n\r\nreferences:\r\n* https://aws.amazon.com/ec2/instance-types/\r\n* https://aws.amazon.com/ec2/pricing/on-demand/",
            "comments": [],
            "commits": [
                "f2f4deb8bb44988eeb0b64b919e51fb556aef4fb"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/poseidon/typhoon/pull/442",
        "content": {
            "title": "Add ability to load balance TCP/UDP applications on Google Cloud",
            "body": "* Background: Existing managed instance group of workers is used in backend services for global load balancing (HTTP/HTTPS Ingress) and output for custom global load balancing use cases\r\n* Add and output a target pool of workers to allow load balancing for TCP/UDP applications (NodePort or proxied)\r\n* Health check for workers with a healthy Ingress controller. Forward rules (regional) to target pools don't support different external and internal ports so choosing nodes with Ingress allows proxying\r\n* A target pool is a logical grouping only. It doesn't add costs to clusters or worker pools\r\n\r\n![typhoon-gcp-load-balancing](https://user-images.githubusercontent.com/2253428/55298228-647a6280-53e1-11e9-891a-15ab9ea525d2.png)\r\n",
            "comments": [],
            "commits": [
                "aaa8e0261a01a62fa4a343788b3df20b9e93ee38"
            ]
        },
        "codes": [
            "awareness",
            "cluster"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/poseidon/typhoon/pull/1250",
        "content": {
            "title": "Switch Azure Fedora CoreOS default worker type",
            "body": "* Change default Azure worker_type from Standard_DS1_v2 to Standard_D2as_v5\r\n  * Get 2 VCPU, 7 GiB, 12500Mbps (vs 1 VCPU, 3.5GiB, 750 Mbps)\r\n  * Small increase in pay-as-you-go price ($53.29 -> $62.78)\r\n  * Small increase in spot price ($5.64/mo -> $7.37/mo)\r\n  * Change from Intel to AMD EPYC (`D2as_v5` cheaper than `D2s_v5`)\r\n\r\nRel:\r\n\r\n* https://github.com/poseidon/typhoon/pull/1248\r\n* https://learn.microsoft.com/en-us/azure/virtual-machines/dasv5-dadsv5-series#dasv5-series\r\n* https://learn.microsoft.com/en-us/azure/virtual-machines/dv2-dsv2-series#dsv2-series",
            "comments": [],
            "commits": [
                "b68f8bb2a9f0825af76a563051c32100386024db"
            ]
        },
        "codes": [
            "awareness",
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/poseidon/typhoon/pull/1248",
        "content": {
            "title": "Switch to Flatcar Azure gen2 images and change worker type",
            "body": "* Switch from Azure Hypervisor generation 1 to generation 2\r\n* Change default Azure `worker_type` from `Standard_DS1_v2` to `Standard_D2as_v5`\r\n  * Get 2 VCPU, 7 GiB, 12500 Mbps (vs 1 VCPU, 3.5GiB, 750 Mbps)\r\n  * Small increase in pay-as-you-go price ($53.29 -> $62.78)\r\n  * Small increase in spot price ($5.64/mo -> $7.37/mo)\r\n  * Change from Intel to AMD EPYC (`D2as_v5` cheaper than `D2s_v5`)\r\n\r\nNotes: Azure makes you accept terms for each plan:\r\n\r\n```\r\naz vm image terms accept --publish kinvolk --offer flatcar-container-linux-free --plan stable-gen2\r\n```\r\n\r\nRel:\r\n\r\n* https://learn.microsoft.com/en-us/azure/virtual-machines/dasv5-dadsv5-series#dasv5-series\r\n* https://learn.microsoft.com/en-us/azure/virtual-machines/dv2-dsv2-series#dsv2-series",
            "comments": [],
            "commits": [
                "8d2c8b8db692b27b89d18e47a40cf7b49562694e"
            ]
        },
        "codes": [
            "awareness",
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/poseidon/typhoon/pull/539",
        "content": {
            "title": "Change Azure default controller_type and worker_type",
            "body": "* Change default `controller_type` to `Standard_B2s`. The `B2s` is cheaper by $17/month and provides 2 vCPU, 4GB RAM (vs 1 vCPU, 3.5GB RAM)\r\n* Change default `worker_type` to `Standard_DS1_v2`. `F1` was the previous generation. The `DS1_v2` is newer, similar cost, more memory, and still supports Low Priority mode, if desired",
            "comments": [
                "Over the last week, I've observed this reduces etcd fsync latency on Azure as well, independent of the recent etcd v3.4 update. Azure SSD disk latency is typically worse than what's observed on AWS and Google Cloud (~10ms), but this brings it closer to them (from ~120ms to ~50ms). Its hard to be absolute about this, as Azure's performance isolation is unknown - its possible I've landed on quiet hosts, but I think not, Azure has been in the ~120ms ballpark for months."
            ],
            "commits": [
                "4a7083d94a6e199091f248f669516109fdbffb47"
            ]
        },
        "codes": [
            "saving",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/poseidon/typhoon/pull/252",
        "content": {
            "title": "Use global HTTP/TCP proxy load balancing for Ingress on GCP",
            "body": "* Switch Ingress from regional network load balancers to global HTTP/TCP Proxy load balancing\r\n* Reduce cost by ~$19/month per cluster. Google bills the first 5 global and regional forwarding rules separately. Typhoon clusters now use 3 global and 0 regional forwarding rules.\r\n* Worker pools no longer include an extraneous load balancer. Remove worker module's `ingress_static_ip` output.\r\n* Add `ingress_static_ipv4` output variable\r\n* Add `worker_instance_group` output to allow custom global load balancing\r\n* Deprecate `controllers_ipv4_public` module output\r\n* Deprecate `ingress_static_ip` module output. Use `ingress_static_ipv4`",
            "comments": [],
            "commits": [
                "0c4d59db87b67d7c7a0a0f54677961a01ed8fbe4"
            ]
        },
        "codes": [
            "saving",
            "cluster"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/aws-root-account/pull/526",
        "content": {
            "title": "Bump hashicorp/aws from 4.17.1 to 4.18.0 in /organisation-security/terraform",
            "body": "Bumps [hashicorp/aws](https://github.com/hashicorp/terraform-provider-aws) from 4.17.1 to 4.18.0.\n<details>\n<summary>Release notes</summary>\n<p><em>Sourced from <a href=\"https://github.com/hashicorp/terraform-provider-aws/releases\">hashicorp/aws's releases</a>.</em></p>\n<blockquote>\n<h2>v4.18.0</h2>\n<p>FEATURES:</p>\n<ul>\n<li><strong>New Resource:</strong> <code>aws_ce_anomaly_monitor</code> (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/251777\">#251777</a>)</li>\n<li><strong>New Resource:</strong> <code>aws_emrserverless_application</code> (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25144\">#25144</a>)</li>\n</ul>\n<p>ENHANCEMENTS:</p>\n<ul>\n<li>data-source/aws_cloudwatch_logs_groups: Make <code>log_group_name_prefix</code> optional (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25187\">#25187</a>)</li>\n<li>data-source/aws_cognito_user_pool_client: Add <code>enable_propagate_additional_user_context_data</code> argument (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25181\">#25181</a>)</li>\n<li>data-source/aws_ram_resource_share: Add <code>resource_share_status</code> argument. (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25159\">#25159</a>)</li>\n<li>resource/aws_cognito_user_pool_client: Add <code>enable_propagate_additional_user_context_data</code> argument (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25181\">#25181</a>)</li>\n<li>resource/aws_ebs_snapshot_copy: Add support for <code>timeouts</code> configuration block. (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/20912\">#20912</a>)</li>\n<li>resource/aws_ebs_volume: Add <code>final_snapshot</code> argument (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/21916\">#21916</a>)</li>\n<li>resource/aws_s3_bucket: Add error handling for <code>ErrCodeNotImplemented</code> and <code>ErrCodeXNotImplemented</code> errors when ready bucket information. (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/24764\">#24764</a>)</li>\n<li>resource/aws_vpc_ipam_pool_cidr_allocation: improve internal search mechanism (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25257\">#25257</a>)</li>\n</ul>\n<p>BUG FIXES:</p>\n<ul>\n<li>resource/aws_snapshot_create_volume_permission: Error if <code>account_id</code> is the snapshot's owner (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/12103\">#12103</a>)</li>\n<li>resource/aws_ssm_parameter: Allow <code>Intelligent-Tiering</code> to upgrade to <code>Advanced</code> tier as needed. (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25174\">#25174</a>)</li>\n</ul>\n</blockquote>\n</details>\n<details>\n<summary>Changelog</summary>\n<p><em>Sourced from <a href=\"https://github.com/hashicorp/terraform-provider-aws/blob/main/CHANGELOG.md\">hashicorp/aws's changelog</a>.</em></p>\n<blockquote>\n<h2>4.18.0 (June 10, 2022)</h2>\n<p>FEATURES:</p>\n<ul>\n<li><strong>New Resource:</strong> <code>aws_ce_anomaly_monitor</code> (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/251777\">#251777</a>)</li>\n<li><strong>New Resource:</strong> <code>aws_emrserverless_application</code> (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25144\">#25144</a>)</li>\n</ul>\n<p>ENHANCEMENTS:</p>\n<ul>\n<li>data-source/aws_cloudwatch_logs_groups: Make <code>log_group_name_prefix</code> optional (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25187\">#25187</a>)</li>\n<li>data-source/aws_cognito_user_pool_client: Add <code>enable_propagate_additional_user_context_data</code> argument (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25181\">#25181</a>)</li>\n<li>data-source/aws_ram_resource_share: Add <code>resource_share_status</code> argument. (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25159\">#25159</a>)</li>\n<li>resource/aws_cognito_user_pool_client: Add <code>enable_propagate_additional_user_context_data</code> argument (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25181\">#25181</a>)</li>\n<li>resource/aws_ebs_snapshot_copy: Add support for <code>timeouts</code> configuration block. (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/20912\">#20912</a>)</li>\n<li>resource/aws_ebs_volume: Add <code>final_snapshot</code> argument (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/21916\">#21916</a>)</li>\n<li>resource/aws_s3_bucket: Add error handling for <code>ErrCodeNotImplemented</code> and <code>ErrCodeXNotImplemented</code> errors when ready bucket information. (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/24764\">#24764</a>)</li>\n<li>resource/aws_vpc_ipam_pool_cidr_allocation: improve internal search mechanism (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25257\">#25257</a>)</li>\n</ul>\n<p>BUG FIXES:</p>\n<ul>\n<li>resource/aws_snapshot_create_volume_permission: Error if <code>account_id</code> is the snapshot's owner (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/12103\">#12103</a>)</li>\n<li>resource/aws_ssm_parameter: Allow <code>Intelligent-Tiering</code> to upgrade to <code>Advanced</code> tier as needed. (<a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25174\">#25174</a>)</li>\n</ul>\n</blockquote>\n</details>\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/hashicorp/terraform-provider-aws/commit/625bf9e8b0bc9ff3ba38a3aca4abe672039e013a\"><code>625bf9e</code></a> Update CHANGELOG.md for <a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25174\">#25174</a></li>\n<li><a href=\"https://github.com/hashicorp/terraform-provider-aws/commit/b918496ea3a7c08b94e5b0a719157012e274a08b\"><code>b918496</code></a> Merge pull request <a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25174\">#25174</a> from hashicorp/b-update-paramstore-intelligent-tier</li>\n<li><a href=\"https://github.com/hashicorp/terraform-provider-aws/commit/a85f674681bd5de76644253d03e020af3cd975a7\"><code>a85f674</code></a> Adds CHANGELOG entry</li>\n<li><a href=\"https://github.com/hashicorp/terraform-provider-aws/commit/557b1d0458a468da4929cfb1f80a4c7fdc931ac6\"><code>557b1d0</code></a> Merge pull request <a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25177\">#25177</a> from brittandeyoung/f-aws_ce_anomaly_monitor</li>\n<li><a href=\"https://github.com/hashicorp/terraform-provider-aws/commit/7611c21e9b7e191d4299c68afb086bdeb1bdf95e\"><code>7611c21</code></a> Add changelog for new anomaly monitor resource</li>\n<li><a href=\"https://github.com/hashicorp/terraform-provider-aws/commit/70452c852f4b0641458e7b98613f446dce33480d\"><code>70452c8</code></a> Rearrange anomaly monitor tests to maximize parallel runs</li>\n<li><a href=\"https://github.com/hashicorp/terraform-provider-aws/commit/b3cc7e8da177bdaee49d46db35c2630c902dd046\"><code>b3cc7e8</code></a> Merge pull request <a href=\"https://github-redirect.dependabot.com/hashicorp/terraform-provider-aws/issues/25257\">#25257</a> from drewmullen/f-ipam-allocation-search</li>\n<li><a href=\"https://github.com/hashicorp/terraform-provider-aws/commit/58429638a0734b3c8bf7fdc9f820dfdc4b2a686a\"><code>5842963</code></a> Amend cost anomaly monitor docs for style</li>\n<li><a href=\"https://github.com/hashicorp/terraform-provider-aws/commit/1dafb10ee4e0f134f05b1e7cb081c2b3e5d5b1f9\"><code>1dafb10</code></a> Add error for empty output when reading cost anomaly monitor</li>\n<li><a href=\"https://github.com/hashicorp/terraform-provider-aws/commit/3c4ee717ab796a8eeed00ba0290780b3a0d38525\"><code>3c4ee71</code></a> Implement cost anomaly monitor finder function</li>\n<li>Additional commits viewable in <a href=\"https://github.com/hashicorp/terraform-provider-aws/compare/v4.17.1...v4.18.0\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=hashicorp/aws&package-manager=terraform&previous-version=4.17.1&new-version=4.18.0)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>",
            "comments": [],
            "commits": [
                "5b666157dd036de44edeeaef7d55189bcf24048f"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/aws-root-account/pull/222",
        "content": {
            "title": "Configure a Cost and Usage report with QuickSight integration",
            "body": "This PR configures a cost and usage report which outputs files suitable for use within QuickSight.",
            "comments": [],
            "commits": [
                "d8134af9d38e1d6f26651c5efece23e78186a41f"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/aws-root-account/pull/158",
        "content": {
            "title": "Bring Cost and Usage report configuration into Terraform management",
            "body": "This PR brings the Cost and Usage report into Terraform management.",
            "comments": [],
            "commits": [
                "1d2123b68181573a0f13154401dc492880d566fb"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/aws-root-account/pull/148",
        "content": {
            "title": "Enable GuardDuty in all enabled by default regions",
            "body": "This PR enables GuardDuty in all remaining AWS 'enabled by default' regions and enrols all currently enrolled accounts from `eu-west-1` and `eu-west-2`, including:\r\n\r\n- `us-east-1`\r\n- `us-east-2`\r\n- `us-west-1`\r\n- `us-west-2`\r\n- `ap-south-1`\r\n- `ap-northeast-2`\r\n- `ap-southeast-1`\r\n- `ap-southeast-2`\r\n- `ap-northeast-1`\r\n- `ca-central-1`\r\n- `eu-central-1`\r\n- `eu-west-3`\r\n- `eu-north-1`\r\n- `sa-east-1`\r\n\r\n## AWS best practices\r\nAWS recommend that AWS GuardDuty is enabled in all supported regions. Due to the way GuardDuty works, GuardDuty only reports findings in _originating_ regions to ensure data analysed doesn't cross AWS regional boundaries. For global services, [findings are tied to `us-east-1`](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_data-sources.html#guardduty_data-sources.title).\r\n\r\n## Cost\r\nAs most of the above regions shouldn't/won't be being used by teams, the impact of cost is likely to be very low but will likely rise in us-east-1 as we start capturing global events.\r\n\r\nMost accounts should be enrolled in a free 30-day trial if it has not been enabled in these regions before, so we can do some analysis toward the end of that if useful.",
            "comments": [
                "It might be worth filtering out certain accounts until we understand the impact of cost across the MOJ /cc @TomTucka ",
                "@jakemulley Let's get this live. In terms of costs, I think we keep an eye for the next couple of months, and if the cost is prohibitive, we can address it then."
            ],
            "commits": [
                "8f7384c40d1975421851716cc4a2d274e2ad0f66"
            ]
        },
        "codes": [
            "increase",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/cisagov/freeipa-server-tf-module/pull/57",
        "content": {
            "title": "Upgrade the root volume type to gp3",
            "body": "## \ud83d\udde3 Description ##\r\n\r\nThis pull request upgrades teh root volume type to gp3.\r\n\r\n## \ud83d\udcad Motivation and context ##\r\n\r\ngp3 is 20% cheaper, and the baseline configuration offers better performance than gp2 for volumes smaller than 2TB.  It also allows the volume size and IOPS to be configured separately, whereas the two are intertwined with gp2.\r\n\r\n## \ud83e\uddea Testing ##\r\n\r\nSee cisagov/cool-assessment-terraform#148 for an example of how I tested identical changes in another repository.\r\n\r\n## \u2705 Checklist ##\r\n\r\n- [x] This PR has an informative and human-readable title.\r\n- [x] Changes are limited to a single goal - _eschew scope creep!_\r\n- [x] All relevant type-of-change labels have been added.\r\n- [x] I have read the [CONTRIBUTING](../blob/develop/CONTRIBUTING.md) document.\r\n- [x] These code changes follow [cisagov code standards](https://github.com/cisagov/development-guide).\r\n- [x] All new and existing tests pass.\r\n",
            "comments": [],
            "commits": [
                "99fd319a72d25441acf36fd2c167a875e9028935"
            ]
        },
        "codes": [
            "storage",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/terraform-google-modules/terraform-google-vault/pull/50",
        "content": {
            "title": "GCS versioning as an option",
            "body": "Hi!!\r\n\r\n  in order to have the option to increase the storage resiliency still more, I think giving the option of enable bucket versioning would be great! I keep it disabled by default, as we used to have, but you can override that with a variable. \r\n\r\n  Note: versioning, by itself, is not super-useful: given how HCV stores the data, doing point in time recovery can be time consuming (going trough tens of objects and looking the convenient version to restore, keeping the bucket consistent), while I'm not sure just restoring individual objects is acceptable (may make the storage-backend inconsistent)... but with the usage of a tool like [this](https://github.com/madisoft/s3-pit-restore) (we are working in something equivalent, but for GCS), and considering you were already promoting multiregion bucket, data resiliency / most of the backup-recovery scenarios are covered by default.\r\n",
            "comments": [
                "@sethvargo , maybe you are enjoying some bank holidays (assuming you are based in the USA).. when you are back, it'd be great to know your opinion about this. Thanks!!",
                "Hey @dcaba \r\n\r\nMy concern is that I think we need to expose all the versioning options as variables. For example, this will enable versioning, keeping all versions, potentially causing high costs for users.",
                "Hi @sethvargo !\r\n\r\n* Very good point, and reinforces the need of keeping the default set to off. In our very specific case and scenario (not a very dynamic instance, not uploading secret files), we are happy with infinite retention (after a week, we see this specific bucket is growing just a couple of tens of MB... more concerned about other buckets that are using TBs, so having the flag for this use case is welcome). There may be more users like this (so it may be worth to consider), and to enable more generic use cases, I've just committed an extra var that can be used for users interested on configuring a max retention with lifecycles (not very elegant, list of maps where users can inject their own configs if needed, but at least, we give the option). \r\n\r\n* More things in the last commits:\r\n  * encapsulating some basic tests executions (tf validate, tf fmt) in a Dockerfile - if you have a CI system, maybe that could be executed automatically\r\n  * I moved the storage props to its own file, making it easier to identify. Tempted to move all IAM/service account related things, but not sure if that matches your personal taste\r\n  * pinning the module to terraform > 0.11.10, but < 0.12 (as I see its not compatible yet)\r\n\r\nHappy to hear your feedback about this,",
                "Merged. We have an internal way of testing these, so while we appreciate the contribution, I removed it before merging. \r\n\r\nI lessened the pin to 0.11.0 and hope to get a release out shortly, then release a breaking-change version with 0.12 support.",
                "No problem @sethvargo ! Would be great to have visibility of the tests in public contribs, but yeah, I suspected there would be something given the linting was perfect :) . Thanks for the quick updates!!",
                "@sethvargo , can you create a release against the current master?"
            ],
            "commits": [
                "aac4edf680a9d250aa8a41a5480adb4697f09225",
                "83458f4acbc26981b5a37a3fe8f3319d8f7935aa",
                "93cb685c8aadddbe35fa3a42ee18e2946022c13e",
                "7312e2dbe0b7abc66ab3202a66ec10086335e348",
                "bc80b91d1ffc20996231e8ee6be2e07aeec43300",
                "f314b88a59917c70028a0c9b1e6b8f5e64c4dace",
                "e8b53dd810205a1717c6c22e72c8cc36b17e6fcd"
            ]
        },
        "codes": [
            "unsure",
            "storage",
            "increase",
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/rancher/quickstart/pull/13",
        "content": {
            "title": "Updated server from t2 to t3",
            "body": "Due to better performance and cost savings switching from t2 to t3.",
            "comments": [
                "Always nice to get better performance for a cheaper price..."
            ],
            "commits": [
                "90944271b4e8bd46e3d42ac64bc4964a33a8fdc3",
                "bb00ab772adbc611899f4522257054cb8e257106"
            ]
        },
        "codes": [
            "instance",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/TheOnly-Co/core-infrastructure/pull/46",
        "content": {
            "title": "Creating t3.micro instance & firewall file and merging to master",
            "body": "",
            "comments": [
                "1) create aws instance. t3.micro maybe?\r\n   - Should I just uncomment the instance from before \"bastion-host\"\r\n   - Or should i create a new instance somewhere else\r\n2) expose it to outside internet(the configuration is in terraform already)\r\n   - is the configuration just the ingress/egress rule in instance.tf?\r\n3) deploy your code on that machine and edit your code to read the config as a variable like this `./firewall -c /etc/mitchyfw/config`\r\n   - I don't get it at all. You mean ssh into that \"box\" like I did before. No idea how I can read a config in a variable in a \r\n     vm or on my local machine.\r\n4) test it with my ip address  \r\n   - No idea how\r\n\r\n\r\n",
                "Start with step 1. Create an instance with public ip address. we did it before . Then i'll guide u through the next steps. Make sure u watch the cost. Also change your cloudwatch to every 24 instead of 12 hours at 11:59am UTC. "
            ],
            "commits": [
                "e0cd3e8240a5b1f5c959517a2787674c712b4261",
                "0d97d199e0454594927bb590e98ce593063da8a0"
            ]
        },
        "codes": [
            "awareness",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ministryofjustice/cloud-platform-terraform-rds-instance/pull/125",
        "content": {
            "title": "enable_auto_start_stop",
            "body": "Enable auto start and stop of the RDS instances for cost saving\r\n\r\nRef:\r\nhttps://github.com/ministryofjustice/cloud-platform-terraform-aws-scheduler/pull/1",
            "comments": [],
            "commits": [
                "0e825c32901df9df18ec219f32a2a0ea9bb3dc59",
                "bd2cf2621f981fe3537528f33ba975a2b9e2e320"
            ]
        },
        "codes": [
            "instance",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/naftulikay/titan/pull/69",
        "content": {
            "title": "Optional NAT",
            "body": "This feature allows users to disable NAT gateway creation, typically for cost-savings or fully-private networks.\r\n\r\nI have tested this by hand in with NAT enabled and disabled by creating an instance in the DMZ, shelling to it, reaching the internet, then creating an instance in the admin layer, shelling to it, and validating that it can (nat_enabled=true) or cannot (nat_enabled=false) reach the internet.",
            "comments": [],
            "commits": [
                "a0ea4fd84a409fe4ee853effa9f309a005b0efc1"
            ]
        },
        "codes": [
            "saving",
            "networking"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/naftulikay/titan/pull/44",
        "content": {
            "title": "Introduce Google Cloud Platform Port of Titan",
            "body": "### TODO\r\n\r\n #### Layer Module\r\n\r\n- [x] Create subnets.\r\n- [x] Conform layer module variables and outputs to be as similar as possible to AWS.\r\n- [x] Ensure that all inputs and resource attributes are exported as output\r\n- [x] Create exports in `exports/`.\r\n- [x] Enforce tagging of resources as appropriate.\r\n\r\n#### Network Module\r\n\r\n - [x] Create network.\r\n - [x] Deploy Layers\r\n    - [x] DMZ\r\n    - [x] Routing\r\n    - [x] Services\r\n    - [x] Data\r\n    - [x] Admin\r\n - [x] Ensure that public layers route via WAN.\r\n - [x] Ensure that private layers route via NAT.\r\n - [x] Create exports in `exports/`.\r\n - [x] Enforce tagging of resources as appropriate.\r\n - [x] [DNS](https://www.terraform.io/docs/providers/google/r/dns_managed_zone.html).\r\n\r\n#### NAT Module\r\n\r\n - [x] Should create a managed instance group in each availability zone (up to `var.max_availability_zones`) of `var.nat_instances_per_zone` instances.\r\n - [x] Should provide configurability of instance type.\r\n - [x] Should provide configurability of instance metadata.\r\n - [x] Should attempt to provide auto-healing out of the box.\r\n - [x] Routes in the layer module should try to route locally to the nearest NAT gateway instance in each availability zone, and then wrap modular around `var.max_availability_zones`.\r\n - <s>Provide boolean for redundant NAT routes in each AZ to be balanced by ECMP.</s> (Not in scope for 0.1)\r\n - [x] Append `titan_dmz` tag to NAT Gateways.\r\n\r\n#### <s>DNS Module</s>\r\n\r\nNot in scope for 0.1.",
            "comments": [
                "At this point in time, we have achieved the following:\r\n\r\n 1. A network is created by the `titan_network` module.\r\n    a. Setting a network CIDR block is deprecated, so we will generate a `/16` internally and expose that as an output and as a variable to the layer modules so that they can cut subnets up.\r\n 2. A public layer is created by the `titan_layer` module.\r\n\r\nI am conducting tests presently to determine internet availability.",
                "![screenshot from 2018-05-03 15 49 44](https://user-images.githubusercontent.com/347571/39606304-a29ebf50-4ee9-11e8-9ca4-861803ee7e54.png)\r\n\r\n### TODO\r\n\r\n - [x] <s>Find a way to remove the default route created by GCP, `default-route-b3c3175f833cc856`, as this route is redundant for `dmz-public`.</s> This is not possible.",
                ":heavy_check_mark: connectivity from the DMZ works just fine to WAN.",
                "Google's [documentation for multiple HA NAT gateways is here](https://cloud.google.com/vpc/docs/special-configurations?authuser=0#multiple-natgateways).\r\n\r\nResources required:\r\n\r\n - [x] One private route, per availability zone, to the NAT Gateway IP address in that zone.\r\n - [x] One static external IP address per NAT Gateway cluster.\r\n - [x] One static internal IP address (`10.x.y.2` where `y` is the index of the availability zone) per NAT gateway cluster.\r\n - [x] An instance template per NAT Gateway cluster.\r\n - [x] A health check for all NAT Gateway nodes (TBD: Google uses a simple Python HTTP server to test kernel/network availability)\r\n - [x] An instance group for each NAT Gateway cluster.\r\n - [x] Autohealing configuration for each instance group.\r\n\r\nCaveats:\r\n\r\n - ECMP load balancing isn't perfect, an individual flow of traffic is not spread across multiple links so instance size directly dictates the max outbound bandwidth for a single connection.\r\n - If the size of the NAT pools change, TCP connections may be rebalanced resulting in a TCP RST.\r\n - Bandwidth per gateway is up to 2 Gbps per core unidirectional.",
                "Additionally, most resources' `name` field must match the following regular expression, as a note-to-self:\r\n\r\n```ruby\r\n/(?:[a-z](?:[-a-z0-9]{0,61}[a-z0-9])?)/\r\n```\r\n\r\nTherefore:\r\n\r\n```yaml\r\n- 'aa-0bcdef138': matches 'a', 'a-0bcdef13', '8'\r\n```\r\n\r\nNamely, an identifier must:\r\n - Begin with a lower-case letter.\r\n - Continue with up to 61 letters, numbers, or hyphens\r\n - End with a letter or a number.",
                "Also, zones can be listed via `gcloud compute zones list --filter=\"name=us-east1\"`:\r\n\r\n```\r\nNAME        REGION    STATUS  NEXT_MAINTENANCE  TURNDOWN_DATE\r\nus-east1-b  us-east1  UP\r\nus-east1-c  us-east1  UP\r\nus-east1-d  us-east1  UP\r\n```\r\n\r\nDocumentation for zones is [here](https://cloud.google.com/compute/docs/regions-zones/) in the Google Cloud documentation.\r\n\r\nThe largest region (`us-central1`) spans four availability zones, and every other region spans three. Therefore there are a minimum of three zones and a maximum of four. This should help predict cost for NAT instances.",
                "CIDR block documentation for subnets available here: https://gist.github.com/naftulikay/8c5e414c8ef4ccc787da384be1299c09",
                "I am discovering certain things in GCP which are simply not there yet:\r\n 1. Any custom DHCP for adding more DNS resolvers or setting a search domain.\r\n 2. Private DNS specific to a given network.\r\n 3. Reverse DNS for private names.\r\n 4. Hosted NAT.",
                "In order to work around 1-3, we may have to build a DNS module for redundant DNS behind a load balancer.",
                " - [x] nat routes are recreating and failing on recreation, remove create before delete",
                "So what the fsck.\r\n\r\n### AWS\r\n\r\nAn _autoscaling group_ spans one or more subnets. A _subnet_ is tied to a single _availability zone_ or datacenter. \r\n\r\nTo achieve high availability, have your autoscaling group span multiple subnets in different availability zones and it will schedule instances evenly across those subnets and availability zones.\r\n\r\n### GCP\r\n\r\nA _managed instance group_ is specific to one availability zone. An _instance template_ can specify one subnet for the instance to belong in. The same is true of instances, for which it does not seem possible to guarantee spanning of availability zones but it is likely that they will work correctly in absence of a race. \r\n\r\nTo achieve high availability, create one managed instance group per availability zone sharing one instance template.\r\n\r\n---\r\n\r\nGod this is so confusing.",
                "Testing of MIGs should be done to determine whether instances in a single MIG will span AZs.",
                " - [x] MIGs can be \"regional\" which means that they span all AZs.",
                "In order to retain high capacity, we will do the following:\r\n\r\n - [x] Create exactly five subnets for a given layer:\r\n     - `${var.name}-${count.index}`: `10.${var.network_id}.${(var.layer_index * 10) * (count.index *2)}.0/23`\r\n - [x] Have users fill subnet 0, then start using subnet 1, etc.\r\n - [x] At the upper end, allocate parallel container ranges at 200:\r\n       - for `10.0.8.0/23`, yield `10.0.208.0/23` as the corresponding container network.",
                "Next steps:\r\n - [x] Clean up and organize resources according to existing style guidelines.\r\n - [x] Test full creation/deletion lifecycle of everything.\r\n - [x] Refactor under `modules/gcp/v0.1` as this is a SemVer prerelease version.\r\n\r\nBugs:\r\n - [x] Unsurprisingly, the NAT routes don't work on the first run due to the MIGs being empty at create time. Switch back to IP based routing?",
                "NAT works great and the module has been cleaned up. Executing full integration test from scratch.",
                "Integration test passed with NAT; traceroute used for WAN connectivity tracing:\r\n\r\n - Can SSH to a NAT instance over WAN.\r\n - Can SSH from a NAT instance to a private instance in the admin layer.\r\n - Can SSH from the private instance in the admin layer to other instances in the network.\r\n - Can access WAN from public NAT instances.\r\n - Can access WAN from private instances via NAT routes.",
                " - Instance/group/address/etc. naming has been made consistent.\r\n - DNS.\r\n\r\n### TODO\r\n\r\nThe things I know about that need finishing:\r\n\r\n - Not in scope:\r\n   - <s>Split variables into relevant files for the layer module.</s>\r\n   - <s>Split variables into relevant files for the NAT module.</s>\r\n   - <s>Split variables into relevant files for the network module.</s>\r\n - [x] Create exports for network.\r\n - [x] Create exports for layer.\r\n - [x] Move to either `modules/gcp/v0` or `modules/gcp/v0.1`.\r\n\r\n### Validation\r\n\r\n - [x] Clean build.\r\n - [x] Assert all variables are exposed as outputs.\r\n - [x] Final lint.",
                "- [x] provide more specific NAT route options; can route now based on AZ for lowest latency route to internet\r\n- [x] allow service account for instances",
                "full plan, not likely to change due to only organizational work from here: https://gist.github.com/naftulikay/aebc0bae6bd1876e73827e6037c7092e",
                "- [x] expose names of container range aliases in layer, network module\r\n- [x] expose route details for private and public routes from NAT and network module\r\n   - [x] public\r\n   - [x] private\r\n- [x] tag nat instances with `public` by default so they get the public route.",
                "- [x] *bug*: cannot shell from NAT instances to the test instances; regression\r\n\r\nthis was a hardcoded regression in the example and not the module, testing now yields expected result.",
                " - I/O diffs have been implemented; should only contain additions and never deletions\r\n - [x] outputs/exports diffs aren't working yet, should be no difference whatsoever.",
                "Final output lint, all data mapped to the proper data type (lists, maps, strings): https://gist.github.com/naftulikay/e88af72aafe638a12cebd9452ec18b28#file-titan-gcp-network-outputs-json-L194\r\n\r\nVerified :heavy_check_mark: as of 2018-05-29 01:56:36+0000.",
                "The following lints have been completed:\r\n\r\n - :heavy_check_mark: lint of all modules I/O: every variable must be exported as an output\r\n - :heavy_check_mark: lint of all modules exports: every output must be exposed in `exports/outputs.tf`\r\n\r\nCompleted as of 2018-05-29 01:58:40+0000.",
                "- [x] move the examples to reflect accuracy\r\n- [x] test network connectivity and mobility",
                "# :rocket: IT'S GO TIME",
                ":heavy_check_mark:  `terraform apply -auto-approve && terraform destroy -force` returns 0"
            ],
            "commits": [
                "f6fa6116a317b19853d6ac958742db88b49bad22"
            ]
        },
        "codes": [
            "awareness",
            "networking",
            "instance"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ExpediaDotCom/haystack/pull/167",
        "content": {
            "title": "changed variable names and moved es inside vpc to prevent egress cost",
            "body": "",
            "comments": [],
            "commits": [
                "5e8b6f6b88db49a0508ea670d71070c92cfdbaca"
            ]
        },
        "codes": [
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/nationalarchives/tdr-grafana/pull/25",
        "content": {
            "title": "Move to manged Grafana",
            "body": null,
            "comments": [
                "She did say it's a good idea to move to it. I'll send her the cost breakdown and I'll do the ADR for it as well. Can you recheck this when you get a sec, I had to update the commit hash.",
                "Looks good. Kirsten did sign off on this regarding the cost didn't she?",
                "Looks good. Thanks"
            ],
            "commits": [
                "de90e4346a37bf1f259c2c8b13146d88d86c9439",
                "d4dda045588d1cb7a04eaf2459b6798f43482b5b"
            ]
        },
        "codes": [
            "awareness"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/ryte/INF-tf-datadog/pull/3",
        "content": {
            "title": "Add cost-allocation tags",
            "body": "",
            "comments": [],
            "commits": [
                "ccd6fd2f1034258bf15c5b432688ce6c3220a4ac"
            ]
        },
        "codes": [
            "alert"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/falldamagestudio/UE4-GHA-BuildSystem/pull/8",
        "content": {
            "title": "Change pd-ssd to pd-balanced",
            "body": "Tests have shown pd-balanced to have performance reasonably close to that of pd-ssd, but at half the cost",
            "comments": [],
            "commits": [
                "e58083adbf91e7daa8ddb5db6c3b2e5c8c0a906c"
            ]
        },
        "codes": [
            "storage",
            "saving"
        ]
    },
    {
        "type": "pull_request",
        "url": "https://github.com/akshay3030/dockerized-jenkins-master/pull/1",
        "content": {
            "title": "Ebs cost optimized",
            "body": "EBS based cost optimized dockerized jenkins master",
            "comments": [],
            "commits": [
                "ab1a6bb9e2066d1ff4bfc73d21c56839f5fdaa3d",
                "15da84f95631f840a7a8eaf2be17427448fbdeb1",
                "f350c4824110017efdfb5ab35b0af351160528ca",
                "6daa080bf2e2e5fa757daa887f1713fdd41bc151",
                "e1b1862256d328624304efc301e24e9dc8418119",
                "4356e9ebf89921898e9459f85f1173d44f3a3a6f",
                "9c266232e20bcce8f89e6783bc0563dbe498ea4d",
                "c6e472b5240922b34711feae49f4e32ada39c7e3",
                "9c0a14074580b10e88083631dc20d883052516b0",
                "66bf23edbb113815354c4f2e9b4dd3c95c7be9e2",
                "744df1eec83ec1596469f88ad32306987752ae6a",
                "7ebeb25ac53c0bec2434460ce0900399e124b079",
                "3581070b44a6be858604d75f303ebee1dc1b2066",
                "f7e2d670bc7dab71f7f6961cea46a87c98699fd2",
                "fa3baf3e48d3d27df3cf3c564d91462a3657eb36",
                "7399d7d7e18f8d5af2b8f62941c02343638bff69",
                "740dce2fd148da4a0d0eca1d3252d8da8d1f0f9b",
                "176bbc557089d1b7db963d66f7f54570527aa44f",
                "74da39be04b36442c401a3550795d01cc2ce0868",
                "7e002e4ed08ee04b71bb778578a60e0efd6f7683",
                "4efdaa6d8dedcc7ab645e651b1206dbd7b9a7ae1",
                "122ccbb5943faf1a74e6ed8140424e397d83e390",
                "bb73988551583dc113eed20cb50803a52e5a424e"
            ]
        },
        "codes": [
            "saving",
            "storage"
        ]
    }
]